function ZE_Init(){}ZE_Init.init=function(){ZE_Init.staticVersion="v80";ZE_Init.theme="gray";ZE_Init.language="en";ZE_Init.needplaintext=true;ZE_Init.editorCSS=true;ZE_Init.inlineQuotes=true;ZE_Init.modeChange=undefined;ZE_Init.spellcheckURL="lt.zoho.com";ZE_Init.domain="zoho.com";ZE_Init.tabKeyHandling=true;ZE_Init.needEditorFocus=true;ZE_Init.needEditorBorder=true;ZE_Init.needResizeImage=false;ZE_Init.removeInsertOptions=false;ZE_Init.removeFontFamily=false;ZE_Init.removeFontSize=false;ZE_Init.defaultFontSize="10pt";ZE_Init.defaultFontFamily="OpenSans,sans-serif";ZE_Init.defaultFontColor="blue";ZE_Init.outGoingFontFamily="";ZE_Init.outGoingFontSize="";ZE_Init.outGoingColor="";var B=window.location.protocol;ZE_Init.cssPath=ZE_Init.imgPath=B+"//"+ZE_Init.csskeyvalue+"/ze/"+ZE_Init.staticVersion;ZE_Init.jsPath=B+"//"+ZE_Init.jskeyvalue+"/ze/"+ZE_Init.staticVersion;ZE_Init.toolbarOrder=[[["bold","Bold (Ctrl+B)","ze_tb"],["italic","Italic (Ctrl+I)","ze_ti"],["underline","Underline (Ctrl+U)","ze_tu"],["strikethrough","Strikethrough","ze_ts"],["subscript","Subscript","ze_tsu"],["superscript","Superscript","ze_sup"]],[["fontcolor","Font Color","ze_f"],["bgcolor","Background Color","ze_tbg"],["fontfamily","Font","ze_tf"],["fontsize","Font Size","ze_tfo"],["heading","Heading","ze_hd"]],[["justifyleft","Align Text Left (Ctrl+L)","ze_tjl"],["justifyright","Align Text Right (Ctrl+R)","ze_tjr"],["justifyfull","Justify (Ctrl+J)","ze_tjf"],["justifycenter","Center (Ctrl+E)","ze_tjc"]],[["insertunorderedlist","Bullets","ze_tul"],["insertorderedlist","Numbering","ze_tol"],["outdent","Decrease Indent","ze_tou"],["indent","Increase Indent","ze_tin"]],[["removeformat","Remove Formatting","ze_trf"]],[["link","Insert Link","ze_til"],["unlink","Remove Link","ze_tuli"],["insertoptions","Insert Options","ze_spo"]],[["table","Insert Table","ze_tbl"],["inserthorizontalrule","Insert Horizontal Rule","ze_hr"],["object","Insert HTML","ze_obj"],["code","Insert Code","ze_icode"],["quote","Insert Quote","ze_quote"]]];ZE_Init.insertOptions=[["image","Insert Image","ze_tim"],["smiley","Insert smiley","ze_tis"],["link","Insert Link","ze_til"],["unlink","Remove Link","ze_tuli"],["table","Insert Table","ze_tbl"],["inserthorizontalrule","Insert Horizontal Rule","ze_hr"],["object","Insert HTML","ze_obj"],["code","Insert Code","ze_icode"],["quote","Insert Quote","ze_quote"]];ZE_Init.imgAction="/ze/uploadImage";ZE_Init.imgParameters=undefined;ZE_Init.setContentProcessed=false;var A=document,E=navigator.userAgent.toLowerCase(),C=A.createElement("img");ZE_Init.is_ie=(E.indexOf("ie")!==-1);ZE_Init.is_safari=(E.indexOf("safari")!==-1);ZE_Init.is_opera=(E.indexOf("opera")!==-1);ZE_Init.is_mac=(E.indexOf("mac")!==-1);ZE_Init.theme=ZE_Init.ElementInArray(["blue","green","gray","brown","lavender","pink","stars","heart","wood","leaf"],ZE_Init.theme)||"gray";ZE_Init.language=ZE_Init.ElementInArray(["en","zh","da","nl","fr","de","hu","it","ja","pl","pt","ru","es","sv","tr","uk"],ZE_Init.language)||"en";ZE_Init.loadURL(ZE_Init.cssPath+"/css/"+ZE_Init.theme+"/ze.min.css","css");if(ZE_Init.is_ie){try{require([ZE_Init.jsPath+"/js/i18n/"+ZE_Init.language+"/ze_ie.min.js"])}catch(D){if(D instanceof ReferenceError){ZE_Init.loadURL(ZE_Init.jsPath+"/js/i18n/"+ZE_Init.language+"/ze_ie.min.js","js")}}}else{if(ZE_Init.is_safari){try{require([ZE_Init.jsPath+"/js/i18n/"+ZE_Init.language+"/ze_sa.min.js"])}catch(D){if(D instanceof ReferenceError){ZE_Init.loadURL(ZE_Init.jsPath+"/js/i18n/"+ZE_Init.language+"/ze_sa.min.js","js")}}}else{if(ZE_Init.is_opera){try{require([ZE_Init.jsPath+"/js/i18n/"+ZE_Init.language+"/ze_op.min.js"])}catch(D){if(D instanceof ReferenceError){ZE_Init.loadURL(ZE_Init.jsPath+"/js/i18n/"+ZE_Init.language+"/ze_op.min.js","js")}}ZE_Init.toolbarOrder.pop()}else{try{require([ZE_Init.jsPath+"/js/i18n/"+ZE_Init.language+"/ze.min.js"])}catch(D){if(D instanceof ReferenceError){ZE_Init.loadURL(ZE_Init.jsPath+"/js/i18n/"+ZE_Init.language+"/ze.min.js","js")}}}}}C.src=ZE_Init.imgPath+"/images/ze_toolbar_"+ZE_Init.theme+".png";ZE_Init.loading=true;ZE_Init.hidePrevInInsertHtml=true};ZE_Init.loadURL=function(A,D){var C,E,B=document;if(D==="css"){C=B.createElement("link");C.type="text/css";C.rel="stylesheet";C.href=A;B.getElementsByTagName("head")[0].appendChild(C)}else{if(D==="js"){E=B.createElement("script");E.type="text/javascript";E.src=A;B.getElementsByTagName("head")[0].appendChild(E)}}};ZE_Init.ElementInArray=function(C,B){var A;while(A=C.shift()){if(A===B){return A}}};ZE_Init.applyTheme=function(F){if(ZE_Init.theme===F){return }if(!ZE_Init.ElementInArray(["blue","green","gray","brown","lavender","pink","stars","heart","wood","leaf"],F)){return }var B=document,E=B.getElementsByTagName("link"),G=E.length,D,A,C;while(G--){D=E[G];A=D.href;if(A.match("ze.min.css")){ZE_Init.theme=F;D.href=ZE_Init.cssPath+"/css/"+F+"/ze.min.css";C=B.createElement("img");C.src=ZE_Init.imgPath+"/images/ze_toolbar_"+F+".png"}else{if(A.match("ze1.min.css")){ZE_Init.theme=F;D.href=ZE_Init.cssPath+"/css/"+F+"/ze1.min.css"}}}};ZE_Init.toolbarOrderMapping={bold:["bold","Bold (Ctrl+B)","ze_tb"],italic:["italic","Italic (Ctrl+I)","ze_ti"],underline:["underline","Underline (Ctrl+U)","ze_tu"],strikethrough:["strikethrough","Strikethrough","ze_ts"],subscript:["subscript","Subscript","ze_tsu"],superscript:["superscript","Superscript","ze_sup"],fontcolor:["fontcolor","Font Color","ze_f"],bgcolor:["bgcolor","Background Color","ze_tbg"],fontfamily:["fontfamily","Font","ze_tf"],fontsize:["fontsize","Font Size","ze_tfo"],justifyleft:["justifyleft","Align Text Left (Ctrl+L)","ze_tjl"],justifyright:["justifyright","Align Text Right (Ctrl+R)","ze_tjr"],justifyfull:["justifyfull","Justify (Ctrl+J)","ze_tjf"],justifycenter:["justifycenter","Center (Ctrl+E)","ze_tjc"],insertunorderedlist:["insertunorderedlist","Bullets","ze_tul"],insertorderedlist:["insertorderedlist","Numbering","ze_tol"],outdent:["outdent","Decrease Indent","ze_tou"],indent:["indent","Increase Indent","ze_tin"],removeformat:["removeformat","Remove Formatting","ze_trf"],image:["image","Insert Image","ze_tim"],smiley:["smiley","Insert smiley","ze_tis"],link:["link","Insert Link","ze_til"],unlink:["unlink","Remove Link","ze_tuli"],insertoptions:["insertoptions","Insert Options","ze_spo"],edithtml:["edithtml","Edit HTML","ze_teh"],spellcheck:["spellcheck","Check Spelling","ze_sp"],spellcheckoptions:["spellcheckoptions","Spell Check Languages","ze_spo"],table:["table","Insert Table","ze_tbl"],inserthorizontalrule:["inserthorizontalrule","Insert Horizontal Rule","ze_hr"],object:["object","Insert HTML","ze_obj"],code:["code","Insert Code","ze_icode"],quote:["quote","Insert Quote","ze_quote"]};ZE_Init.toolbarOrderGenerate=function(E){var C=[],D,A,B,F;for(B in E){if(E.hasOwnProperty(B)){A=E[B];D=[];for(F in A){if(A.hasOwnProperty(F)){D.push(ZE_Init.toolbarOrderMapping[A[F]])}}C.push(D)}}return C};ZE_Init.insertOptionsGenerate=function(D){var A=[],B=D.length,C=0;for(;C<B;C++){A[C]=ZE_Init.toolbarOrderMapping[D[C]]}return A};ZE_Init.language=jsLocale;ZE_Init.inlineQuotes=false;ZE_Init.needEditorFocus=false;ZE_Init.needplaintext=false;ZE_Init.defaultFontColor="black";ZE_Init.csskeyvalue="css.zohostatic.com";ZE_Init.jskeyvalue="js.zohostatic.com";ZE_Init.domain="zoho.com";ZE_Init.contextVal="";ZE_Init.csrfCookieName="zccpn";ZE_Init.csrfParamVal="zccpn";ZE_Init.smileyPath="/ze/images";if(typeof getConfig==="function"){var configJson=getConfig();if(configJson.production==="true"){ZE_Init.csskeyvalue=configJson.cssStaticServer;ZE_Init.jskeyvalue=configJson.jsStaticServer;ZE_Init.domain=configJson.domainVal}}ZE_Init.loadFontCss=function(A,C){if(A.doc==undefined||(A.state!=undefined&&A.state=="loading")){setTimeout(function(){ZE_Init.loadFontCss(A,C)},500);return false}var B=A.doc.createElement("link");B.rel="stylesheet";B.type="text/css";B.href=C;A.doc.head.appendChild(B)};ZE_Init.FontFamilyDefinition={Arimo:"Arimo",ComicNeue:"ComicNeue",Ptmono:"Ptmono",EBGaramond:"EBGaramond",Heuristica:"Heuristica",RobotoCondensed:"RobotoCondensed",Serif:"serif",OpenSans:"OpenSans",Tinos:"Tinos",Lato:"Lato",DejaVuSans:"DejaVuSans",Carlito:"Carlito",ArchivoBlack:"ArchivoBlack"};ZE_Init.init();var colorId="";function showColorDialog(A){var B=docid("color_div");B.style.display="block";colorId=A;if(A=="plaintxt"){docid("clrpickrow").style.display=rowdisp}}var prevColor="000000";var prevBkColor="000000";var is_bkcolor=0;function View(A){docid("ColorPreview").style.backgroundColor="#"+A;docid("ColorHex").value="#"+A}function setPrevColor(A){docid("PrevColor").style.backgroundColor="#"+A}function Set(I){var G=ValidateColor(I);if(G==null){alert("Invalid color code: "+I)}else{View(G);setPrevColor(G);if(docid(colorId+"color")){docid(colorId+"color").value=G}if(colorId=="header"){var L=docid("hdrprivclr");L.bgColor=G;var J=docid(colorId+"clrpicker");J.style.backgroundColor=G}else{if(colorId=="border"){var E=docid("bdrprivclr");E.style.borderColor="#"+G;var K=docid(colorId+"clrpicker");K.style.backgroundColor=G}}if(colorId=="viewhdr"){if(docid(colorId+"privclr")){docid(colorId+"privclr").bgColor=G}var J=docid(colorId+"clrpicker");J.style.backgroundColor=G;if(docid("calhdrprivclr")){docid("calhdrprivclr").bgColor=G}if(docid("sumryhdrprivclr")){docid("sumryhdrprivclr").bgColor=G}}else{if(colorId=="viewbdr"){if(docid(colorId+"privclr")){docid(colorId+"privclr").style.borderColor="#"+G}var K=docid(colorId+"clrpicker");K.style.backgroundColor=G;if(docid("calbdrprivclr")){docid("calbdrprivclr").style.borderColor="#"+G}if(docid("sumrybdrprivclr")){docid("sumrybdrprivclr").style.borderColor="#"+G}}else{if(colorId=="calBg"){var F=docid(colorId+"clrpicker");F.style.backgroundColor=G;var B=docid(colorId+"privclr");B.style.backgroundColor=G;var D=docid(colorId+"privclr1");D.style.backgroundColor=G;var A=docid(colorId+"privclr2");A.style.backgroundColor=G}else{if(colorId=="calgrid"){var C=docid(colorId+"clrpicker");C.style.backgroundColor=G;var H=docid(colorId+"privclr");H.style.backgroundColor=G}else{if(colorId=="labelbg"){docid(colorId+"clrpicker").style.backgroundColor=G;docid(colorId+"privclr").style.backgroundColor=G;docid(colorId+"privclr1").style.backgroundColor=G}else{if(colorId=="altrow"){docid(colorId+"clrpicker").style.backgroundColor=G;docid(colorId+"privclr").style.backgroundColor=G}}}}}}if(colorId=="header"||colorId=="border"){generateSnippet()}if(colorId=="viewhdr"||colorId=="viewbdr"||colorId=="calBg"||colorId=="calgrid"||colorId=="labelbg"||colorId=="altrow"){if(docid("readsnippet"+vilinkId).style.display=="none"){genJsSnippet()}else{genViewSnippet()}}if(colorId=="plaintxt"){TE.exec("forecolor",false,G)}closePicker()}}function ValidateColor(C){C=C||"";C=C+"";C=C.toUpperCase();var E="0123456789ABCDEF";var B="";for(var D=0;D<C.length;D++){var A=C.charAt(D);if(E.indexOf(A)!=-1){B+=A}}if(B.length!=6){return null}return B}function closePicker(){docid("color_div").style.display="none";if(colorId=="plaintxt"){docid("clrpickrow").style.display="none"}}
/* jQuery v2.0.3 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license
//@ sourceMappingURL=jquery-2.0.3.min.map
*/
(function(e,undefined){var t,n,r=typeof undefined,i=e.location,o=e.document,s=o.documentElement,a=e.jQuery,u=e.$,l={},c=[],p="2.0.3",f=c.concat,h=c.push,d=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,x=function(e,n){return new x.fn.init(e,n,t)},b=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,w=/\S+/g,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^-ms-/,N=/-([\da-z])/gi,E=function(e,t){return t.toUpperCase()},S=function(){o.removeEventListener("DOMContentLoaded",S,!1),e.removeEventListener("load",S,!1),x.ready()};x.fn=x.prototype={jquery:p,constructor:x,init:function(e,t,n){var r,i;if(!e){return this}if("string"==typeof e){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:T.exec(e),!r||!r[1]&&t){return !t||t.jquery?(t||n).find(e):this.constructor(t).find(e)}if(r[1]){if(t=t instanceof x?t[0]:t,x.merge(this,x.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:o,!0)),C.test(r[1])&&x.isPlainObject(t)){for(r in t){x.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r])}}return this}return i=o.getElementById(r[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):x.isFunction(e)?n.ready(e):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),x.makeArray(e,this))},selector:"",length:0,toArray:function(){return d.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return x.each(this,e,t)},ready:function(e){return x.ready.promise().done(e),this},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(x.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:h,sort:[].sort,splice:[].splice},x.fn.init.prototype=x.fn,x.extend=x.fn.extend=function(){var e,t,n,r,i,o,s=arguments[0]||{},a=1,u=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[1]||{},a=2),"object"==typeof s||x.isFunction(s)||(s={}),u===a&&(s=this,--a);u>a;a++){if(null!=(e=arguments[a])){for(t in e){n=s[t],r=e[t],s!==r&&(l&&r&&(x.isPlainObject(r)||(i=x.isArray(r)))?(i?(i=!1,o=n&&x.isArray(n)?n:[]):o=n&&x.isPlainObject(n)?n:{},s[t]=x.extend(l,o,r)):r!==undefined&&(s[t]=r))}}}return s},x.extend({expando:"jQuery"+(p+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===x&&(e.$=u),t&&e.jQuery===x&&(e.jQuery=a),x},isReady:!1,readyWait:1,holdReady:function(e){e?x.readyWait++:x.ready(!0)},ready:function(e){(e===!0?--x.readyWait:x.isReady)||(x.isReady=!0,e!==!0&&--x.readyWait>0||(n.resolveWith(o,[x]),x.fn.trigger&&x(o).trigger("ready").off("ready")))},isFunction:function(e){return"function"===x.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return !isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[m.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==x.type(e)||e.nodeType||x.isWindow(e)){return !1}try{if(e.constructor&&!y.call(e.constructor.prototype,"isPrototypeOf")){return !1}}catch(t){return !1}return !0},isEmptyObject:function(e){var t;for(t in e){return !1}return !0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e){return null}"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=x.buildFragment([e],t,i),i&&x(i).remove(),x.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var t,n;if(!e||"string"!=typeof e){return null}try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&x.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(e){var t,n=eval;e=x.trim(e),e&&(1===e.indexOf("use strict")?(t=o.createElement("script"),t.text=e,o.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(k,"ms-").replace(N,E)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,s=j(e);if(n){if(s){for(;o>i;i++){if(r=t.apply(e[i],n),r===!1){break}}}else{for(i in e){if(r=t.apply(e[i],n),r===!1){break}}}}else{if(s){for(;o>i;i++){if(r=t.call(e[i],i,e[i]),r===!1){break}}}else{for(i in e){if(r=t.call(e[i],i,e[i]),r===!1){break}}}}return e},trim:function(e){return null==e?"":v.call(e)},makeArray:function(e,t){var n=t||[];return null!=e&&(j(Object(e))?x.merge(n,"string"==typeof e?[e]:e):h.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:g.call(t,e,n)},merge:function(e,t){var n=t.length,r=e.length,i=0;if("number"==typeof n){for(;n>i;i++){e[r++]=t[i]}}else{while(t[i]!==undefined){e[r++]=t[i++]}}return e.length=r,e},grep:function(e,t,n){var r,i=[],o=0,s=e.length;for(n=!!n;s>o;o++){r=!!t(e[o],o),n!==r&&i.push(e[o])}return i},map:function(e,t,n){var r,i=0,o=e.length,s=j(e),a=[];if(s){for(;o>i;i++){r=t(e[i],i,n),null!=r&&(a[a.length]=r)}}else{for(i in e){r=t(e[i],i,n),null!=r&&(a[a.length]=r)}}return f.apply([],a)},guid:1,proxy:function(e,t){var n,r,i;return"string"==typeof t&&(n=e[t],t=e,e=n),x.isFunction(e)?(r=d.call(arguments,2),i=function(){return e.apply(t||this,r.concat(d.call(arguments)))},i.guid=e.guid=e.guid||x.guid++,i):undefined},access:function(e,t,n,r,i,o,s){var a=0,u=e.length,l=null==n;if("object"===x.type(n)){i=!0;for(a in n){x.access(e,t,a,n[a],!0,o,s)}}else{if(r!==undefined&&(i=!0,x.isFunction(r)||(s=!0),l&&(s?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(x(e),n)})),t)){for(;u>a;a++){t(e[a],n,s?r:r.call(e[a],a,t(e[a],n)))}}}return i?e:l?t.call(e):u?t(e[0],n):o},now:Date.now,swap:function(e,t,n,r){var i,o,s={};for(o in t){s[o]=e.style[o],e.style[o]=t[o]}i=n.apply(e,r||[]);for(o in t){e.style[o]=s[o]}return i}}),x.ready.promise=function(t){return n||(n=x.Deferred(),"complete"===o.readyState?setTimeout(x.ready):(o.addEventListener("DOMContentLoaded",S,!1),e.addEventListener("load",S,!1))),n.promise(t)},x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});function j(e){var t=e.length,n=x.type(e);return x.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}t=x(o),function(e,undefined){var t,n,r,i,o,s,a,u,l,c,p,f,h,d,g,m,y,v="sizzle"+-new Date,b=e.document,w=0,T=0,C=st(),k=st(),N=st(),E=!1,S=function(e,t){return e===t?(E=!0,0):0},j=typeof undefined,D=1<<31,A={}.hasOwnProperty,L=[],q=L.pop,H=L.push,O=L.push,F=L.slice,P=L.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++){if(this[t]===e){return t}}return -1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",W="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",$=W.replace("w","w#"),B="\\["+M+"*("+W+")"+M+"*(?:([*^$|!~]?=)"+M+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+$+")|)|)"+M+"*\\]",I=":("+W+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+B.replace(3,8)+")*)|.*)\\)|)",z=RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=RegExp("^"+M+"*,"+M+"*"),X=RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=RegExp(M+"*[+~]"),Y=RegExp("="+M+"*([^\\]'\"]*)"+M+"*\\]","g"),V=RegExp(I),G=RegExp("^"+$+"$"),J={ID:RegExp("^#("+W+")"),CLASS:RegExp("^\\.("+W+")"),TAG:RegExp("^("+W.replace("w","w*")+")"),ATTR:RegExp("^"+B),PSEUDO:RegExp("^"+I),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:RegExp("^(?:"+R+")$","i"),needsContext:RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Q=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Z=/^(?:input|select|textarea|button)$/i,et=/^h\d$/i,tt=/'|\\/g,nt=RegExp("\\\\([\\da-f]{1,6}"+M+"?|("+M+")|.)","ig"),rt=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{O.apply(L=F.call(b.childNodes),b.childNodes),L[b.childNodes.length].nodeType}catch(it){O={apply:L.length?function(e,t){H.apply(e,F.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]){}e.length=n-1}}}function ot(e,t,r,i){var o,s,a,u,l,f,g,m,x,w;if((t?t.ownerDocument||t:b)!==p&&c(t),t=t||p,r=r||[],!e||"string"!=typeof e){return r}if(1!==(u=t.nodeType)&&9!==u){return[]}if(h&&!i){if(o=K.exec(e)){if(a=o[1]){if(9===u){if(s=t.getElementById(a),!s||!s.parentNode){return r}if(s.id===a){return r.push(s),r}}else{if(t.ownerDocument&&(s=t.ownerDocument.getElementById(a))&&y(t,s)&&s.id===a){return r.push(s),r}}}else{if(o[2]){return O.apply(r,t.getElementsByTagName(e)),r}if((a=o[3])&&n.getElementsByClassName&&t.getElementsByClassName){return O.apply(r,t.getElementsByClassName(a)),r}}}if(n.qsa&&(!d||!d.test(e))){if(m=g=v,x=t,w=9===u&&e,1===u&&"object"!==t.nodeName.toLowerCase()){f=gt(e),(g=t.getAttribute("id"))?m=g.replace(tt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",l=f.length;while(l--){f[l]=m+mt(f[l])}x=U.test(e)&&t.parentNode||t,w=f.join(",")}if(w){try{return O.apply(r,x.querySelectorAll(w)),r}catch(T){}finally{g||t.removeAttribute("id")}}}}return kt(e.replace(z,"$1"),t,r,i)}function st(){var e=[];function t(n,r){return e.push(n+=" ")>i.cacheLength&&delete t[e.shift()],t[n]=r}return t}function at(e){return e[v]=!0,e}function ut(e){var t=p.createElement("div");try{return !!e(t)}catch(n){return !1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function lt(e,t){var n=e.split("|"),r=e.length;while(r--){i.attrHandle[n[r]]=t}}function ct(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||D)-(~e.sourceIndex||D);if(r){return r}if(n){while(n=n.nextSibling){if(n===t){return -1}}}return e?1:-1}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function ft(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ht(e){return at(function(t){return t=+t,at(function(n,r){var i,o=e([],n.length,t),s=o.length;while(s--){n[i=o[s]]&&(n[i]=!(r[i]=n[i]))}})})}s=ot.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},n=ot.support={},c=ot.setDocument=function(e){var t=e?e.ownerDocument||e:b,r=t.defaultView;return t!==p&&9===t.nodeType&&t.documentElement?(p=t,f=t.documentElement,h=!s(t),r&&r.attachEvent&&r!==r.top&&r.attachEvent("onbeforeunload",function(){c()}),n.attributes=ut(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ut(function(e){return e.appendChild(t.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=ut(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),n.getById=ut(function(e){return f.appendChild(e).id=v,!t.getElementsByName||!t.getElementsByName(v).length}),n.getById?(i.find.ID=function(e,t){if(typeof t.getElementById!==j&&h){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){return e.getAttribute("id")===t}}):(delete i.find.ID,i.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){var n=typeof e.getAttributeNode!==j&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=n.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==j?t.getElementsByTagName(e):undefined}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++]){1===n.nodeType&&r.push(n)}return r}return o},i.find.CLASS=n.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==j&&h?t.getElementsByClassName(e):undefined},g=[],d=[],(n.qsa=Q.test(t.querySelectorAll))&&(ut(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll(":checked").length||d.push(":checked")}),ut(function(e){var n=t.createElement("input");n.setAttribute("type","hidden"),e.appendChild(n).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&d.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||d.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),d.push(",.*:")})),(n.matchesSelector=Q.test(m=f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&ut(function(e){n.disconnectedMatch=m.call(e,"div"),m.call(e,"[s!='']:x"),g.push("!=",I)}),d=d.length&&RegExp(d.join("|")),g=g.length&&RegExp(g.join("|")),y=Q.test(f.contains)||f.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t){while(t=t.parentNode){if(t===e){return !0}}}return !1},S=f.compareDocumentPosition?function(e,r){if(e===r){return E=!0,0}var i=r.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(r);return i?1&i||!n.sortDetached&&r.compareDocumentPosition(e)===i?e===t||y(b,e)?-1:r===t||y(b,r)?1:l?P.call(l,e)-P.call(l,r):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,n){var r,i=0,o=e.parentNode,s=n.parentNode,a=[e],u=[n];if(e===n){return E=!0,0}if(!o||!s){return e===t?-1:n===t?1:o?-1:s?1:l?P.call(l,e)-P.call(l,n):0}if(o===s){return ct(e,n)}r=e;while(r=r.parentNode){a.unshift(r)}r=n;while(r=r.parentNode){u.unshift(r)}while(a[i]===u[i]){i++}return i?ct(a[i],u[i]):a[i]===b?-1:u[i]===b?1:0},t):p},ot.matches=function(e,t){return ot(e,null,null,t)},ot.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&c(e),t=t.replace(Y,"='$1']"),!(!n.matchesSelector||!h||g&&g.test(t)||d&&d.test(t))){try{var r=m.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType){return r}}catch(i){}}return ot(t,p,null,[e]).length>0},ot.contains=function(e,t){return(e.ownerDocument||e)!==p&&c(e),y(e,t)},ot.attr=function(e,t){(e.ownerDocument||e)!==p&&c(e);var r=i.attrHandle[t.toLowerCase()],o=r&&A.call(i.attrHandle,t.toLowerCase())?r(e,t,!h):undefined;return o===undefined?n.attributes||!h?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null:o},ot.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},ot.uniqueSort=function(e){var t,r=[],i=0,o=0;if(E=!n.detectDuplicates,l=!n.sortStable&&e.slice(0),e.sort(S),E){while(t=e[o++]){t===e[o]&&(i=r.push(o))}while(i--){e.splice(r[i],1)}}return e},o=ot.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent){return e.textContent}for(e=e.firstChild;e;e=e.nextSibling){n+=o(e)}}else{if(3===i||4===i){return e.nodeValue}}}else{for(;t=e[r];r++){n+=o(t)}}return n},i=ot.selectors={cacheLength:50,createPseudo:at,match:J,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(nt,rt),e[3]=(e[4]||e[5]||"").replace(nt,rt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ot.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ot.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return J.CHILD.test(e[0])?null:(e[3]&&e[4]!==undefined?e[2]=e[4]:n&&V.test(n)&&(t=gt(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(nt,rt).toLowerCase();return"*"===e?function(){return !0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=C[e+" "];return t||(t=RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&C(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==j&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ot.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===i?function(e){return !!e.parentNode}:function(t,n,u){var l,c,p,f,h,d,g=o!==s?"nextSibling":"previousSibling",m=t.parentNode,y=a&&t.nodeName.toLowerCase(),x=!u&&!a;if(m){if(o){while(g){p=t;while(p=p[g]){if(a?p.nodeName.toLowerCase()===y:1===p.nodeType){return !1}}d=g="only"===e&&!d&&"nextSibling"}return !0}if(d=[s?m.firstChild:m.lastChild],s&&x){c=m[v]||(m[v]={}),l=c[e]||[],h=l[0]===w&&l[1],f=l[0]===w&&l[2],p=h&&m.childNodes[h];while(p=++h&&p&&p[g]||(f=h=0)||d.pop()){if(1===p.nodeType&&++f&&p===t){c[e]=[w,h,f];break}}}else{if(x&&(l=(t[v]||(t[v]={}))[e])&&l[0]===w){f=l[1]}else{while(p=++h&&p&&p[g]||(f=h=0)||d.pop()){if((a?p.nodeName.toLowerCase()===y:1===p.nodeType)&&++f&&(x&&((p[v]||(p[v]={}))[e]=[w,f]),p===t)){break}}}}return f-=i,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||ot.error("unsupported pseudo: "+e);return r[v]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?at(function(e,n){var i,o=r(e,t),s=o.length;while(s--){i=P.call(e,o[s]),e[i]=!(n[i]=o[s])}}):function(e){return r(e,0,n)}):r}},pseudos:{not:at(function(e){var t=[],n=[],r=a(e.replace(z,"$1"));return r[v]?at(function(e,t,n,i){var o,s=r(e,null,i,[]),a=e.length;while(a--){(o=s[a])&&(e[a]=!(t[a]=o))}}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:at(function(e){return function(t){return ot(e,t).length>0}}),contains:at(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:at(function(e){return G.test(e||"")||ot.error("unsupported lang: "+e),e=e.replace(nt,rt).toLowerCase(),function(t){var n;do{if(n=h?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang")){return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-")}}while((t=t.parentNode)&&1===t.nodeType);return !1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===f},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling){if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType){return !1}}return !0},parent:function(e){return !i.pseudos.empty(e)},header:function(e){return et.test(e.nodeName)},input:function(e){return Z.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:ht(function(){return[0]}),last:ht(function(e,t){return[t-1]}),eq:ht(function(e,t,n){return[0>n?n+t:n]}),even:ht(function(e,t){var n=0;for(;t>n;n+=2){e.push(n)}return e}),odd:ht(function(e,t){var n=1;for(;t>n;n+=2){e.push(n)}return e}),lt:ht(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;){e.push(r)}return e}),gt:ht(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;){e.push(r)}return e})}},i.pseudos.nth=i.pseudos.eq;for(t in {radio:!0,checkbox:!0,file:!0,password:!0,image:!0}){i.pseudos[t]=pt(t)}for(t in {submit:!0,reset:!0}){i.pseudos[t]=ft(t)}function dt(){}dt.prototype=i.filters=i.pseudos,i.setFilters=new dt;function gt(e,t){var n,r,o,s,a,u,l,c=k[e+" "];if(c){return t?0:c.slice(0)}a=e,u=[],l=i.preFilter;while(a){(!n||(r=_.exec(a)))&&(r&&(a=a.slice(r[0].length)||a),u.push(o=[])),n=!1,(r=X.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(z," ")}),a=a.slice(n.length));for(s in i.filter){!(r=J[s].exec(a))||l[s]&&!(r=l[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length))}if(!n){break}}return t?a.length:a?ot.error(e):k(e,u).slice(0)}function mt(e){var t=0,n=e.length,r="";for(;n>t;t++){r+=e[t].value}return r}function yt(e,t,n){var i=t.dir,o=n&&"parentNode"===i,s=T++;return t.first?function(t,n,r){while(t=t[i]){if(1===t.nodeType||o){return e(t,n,r)}}}:function(t,n,a){var u,l,c,p=w+" "+s;if(a){while(t=t[i]){if((1===t.nodeType||o)&&e(t,n,a)){return !0}}}else{while(t=t[i]){if(1===t.nodeType||o){if(c=t[v]||(t[v]={}),(l=c[i])&&l[0]===p){if((u=l[1])===!0||u===r){return u===!0}}else{if(l=c[i]=[p],l[1]=e(t,n,a)||r,l[1]===!0){return !0}}}}}}}function vt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--){if(!e[i](t,n,r)){return !1}}return !0}:e[0]}function xt(e,t,n,r,i){var o,s=[],a=0,u=e.length,l=null!=t;for(;u>a;a++){(o=e[a])&&(!n||n(o,r,i))&&(s.push(o),l&&t.push(a))}return s}function bt(e,t,n,r,i,o){return r&&!r[v]&&(r=bt(r)),i&&!i[v]&&(i=bt(i,o)),at(function(o,s,a,u){var l,c,p,f=[],h=[],d=s.length,g=o||Ct(t||"*",a.nodeType?[a]:a,[]),m=!e||!o&&t?g:xt(g,f,e,a,u),y=n?i||(o?e:d||r)?[]:s:m;if(n&&n(m,y,a,u),r){l=xt(y,h),r(l,[],a,u),c=l.length;while(c--){(p=l[c])&&(y[h[c]]=!(m[h[c]]=p))}}if(o){if(i||e){if(i){l=[],c=y.length;while(c--){(p=y[c])&&l.push(m[c]=p)}i(null,y=[],l,u)}c=y.length;while(c--){(p=y[c])&&(l=i?P.call(o,p):f[c])>-1&&(o[l]=!(s[l]=p))}}}else{y=xt(y===s?y.splice(d,y.length):y),i?i(null,s,y,u):O.apply(s,y)}})}function wt(e){var t,n,r,o=e.length,s=i.relative[e[0].type],a=s||i.relative[" "],l=s?1:0,c=yt(function(e){return e===t},a,!0),p=yt(function(e){return P.call(t,e)>-1},a,!0),f=[function(e,n,r){return !s&&(r||n!==u)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];for(;o>l;l++){if(n=i.relative[e[l].type]){f=[yt(vt(f),n)]}else{if(n=i.filter[e[l].type].apply(null,e[l].matches),n[v]){for(r=++l;o>r;r++){if(i.relative[e[r].type]){break}}return bt(l>1&&vt(f),l>1&&mt(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(z,"$1"),n,r>l&&wt(e.slice(l,r)),o>r&&wt(e=e.slice(r)),o>r&&mt(e))}f.push(n)}}return vt(f)}function Tt(e,t){var n=0,o=t.length>0,s=e.length>0,a=function(a,l,c,f,h){var d,g,m,y=[],v=0,x="0",b=a&&[],T=null!=h,C=u,k=a||s&&i.find.TAG("*",h&&l.parentNode||l),N=w+=null==C?1:Math.random()||0.1;for(T&&(u=l!==p&&l,r=n);null!=(d=k[x]);x++){if(s&&d){g=0;while(m=e[g++]){if(m(d,l,c)){f.push(d);break}}T&&(w=N,r=++n)}o&&((d=!m&&d)&&v--,a&&b.push(d))}if(v+=x,o&&x!==v){g=0;while(m=t[g++]){m(b,y,l,c)}if(a){if(v>0){while(x--){b[x]||y[x]||(y[x]=q.call(f))}}y=xt(y)}O.apply(f,y),T&&!a&&y.length>0&&v+t.length>1&&ot.uniqueSort(f)}return T&&(w=N,u=C),b};return o?at(a):a}a=ot.compile=function(e,t){var n,r=[],i=[],o=N[e+" "];if(!o){t||(t=gt(e)),n=t.length;while(n--){o=wt(t[n]),o[v]?r.push(o):i.push(o)}o=N(e,Tt(i,r))}return o};function Ct(e,t,n){var r=0,i=t.length;for(;i>r;r++){ot(e,t[r],n)}return n}function kt(e,t,r,o){var s,u,l,c,p,f=gt(e);if(!o&&1===f.length){if(u=f[0]=f[0].slice(0),u.length>2&&"ID"===(l=u[0]).type&&n.getById&&9===t.nodeType&&h&&i.relative[u[1].type]){if(t=(i.find.ID(l.matches[0].replace(nt,rt),t)||[])[0],!t){return r}e=e.slice(u.shift().value.length)}s=J.needsContext.test(e)?0:u.length;while(s--){if(l=u[s],i.relative[c=l.type]){break}if((p=i.find[c])&&(o=p(l.matches[0].replace(nt,rt),U.test(u[0].type)&&t.parentNode||t))){if(u.splice(s,1),e=o.length&&mt(u),!e){return O.apply(r,o),r}break}}}return a(e,f)(o,t,!h,r,U.test(e)),r}n.sortStable=v.split("").sort(S).join("")===v,n.detectDuplicates=E,c(),n.sortDetached=ut(function(e){return 1&e.compareDocumentPosition(p.createElement("div"))}),ut(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||lt("type|href|height|width",function(e,t,n){return n?undefined:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&ut(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||lt("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?undefined:e.defaultValue}),ut(function(e){return null==e.getAttribute("disabled")})||lt(R,function(e,t,n){var r;return n?undefined:(r=e.getAttributeNode(t))&&r.specified?r.value:e[t]===!0?t.toLowerCase():null}),x.find=ot,x.expr=ot.selectors,x.expr[":"]=x.expr.pseudos,x.unique=ot.uniqueSort,x.text=ot.getText,x.isXMLDoc=ot.isXML,x.contains=ot.contains}(e);var D={};function A(e){var t=D[e]={};return x.each(e.match(w)||[],function(e,n){t[n]=!0}),t}x.Callbacks=function(e){e="string"==typeof e?D[e]||A(e):x.extend({},e);var t,n,r,i,o,s,a=[],u=!e.once&&[],l=function(p){for(t=e.memory&&p,n=!0,s=i||0,i=0,o=a.length,r=!0;a&&o>s;s++){if(a[s].apply(p[0],p[1])===!1&&e.stopOnFalse){t=!1;break}}r=!1,a&&(u?u.length&&l(u.shift()):t?a=[]:c.disable())},c={add:function(){if(a){var n=a.length;(function s(t){x.each(t,function(t,n){var r=x.type(n);"function"===r?e.unique&&c.has(n)||a.push(n):n&&n.length&&"string"!==r&&s(n)})})(arguments),r?o=a.length:t&&(i=n,l(t))}return this},remove:function(){return a&&x.each(arguments,function(e,t){var n;while((n=x.inArray(t,a,n))>-1){a.splice(n,1),r&&(o>=n&&o--,s>=n&&s--)}}),this},has:function(e){return e?x.inArray(e,a)>-1:!(!a||!a.length)},empty:function(){return a=[],o=0,this},disable:function(){return a=u=t=undefined,this},disabled:function(){return !a},lock:function(){return u=undefined,t||c.disable(),this},locked:function(){return !u},fireWith:function(e,t){return !a||n&&!u||(t=t||[],t=[e,t.slice?t.slice():t],r?u.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return !!n}};return c},x.extend({Deferred:function(e){var t=[["resolve","done",x.Callbacks("once memory"),"resolved"],["reject","fail",x.Callbacks("once memory"),"rejected"],["notify","progress",x.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return x.Deferred(function(n){x.each(t,function(t,o){var s=o[0],a=x.isFunction(e[t])&&e[t];i[o[1]](function(){var e=a&&a.apply(this,arguments);e&&x.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===r?n.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?x.extend(e,r):r}},i={};return r.pipe=r.then,x.each(t,function(e,o){var s=o[2],a=o[3];r[o[1]]=s.add,a&&s.add(function(){n=a},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=s.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=d.call(arguments),r=n.length,i=1!==r||e&&x.isFunction(e.promise)?r:0,o=1===i?e:x.Deferred(),s=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?d.call(arguments):r,n===a?o.notifyWith(t,n):--i||o.resolveWith(t,n)}},a,u,l;if(r>1){for(a=Array(r),u=Array(r),l=Array(r);r>t;t++){n[t]&&x.isFunction(n[t].promise)?n[t].promise().done(s(t,l,n)).fail(o.reject).progress(s(t,u,a)):--i}}return i||o.resolveWith(l,n),o.promise()}}),x.support=function(t){var n=o.createElement("input"),r=o.createDocumentFragment(),i=o.createElement("div"),s=o.createElement("select"),a=s.appendChild(o.createElement("option"));return n.type?(n.type="checkbox",t.checkOn=""!==n.value,t.optSelected=a.selected,t.reliableMarginRight=!0,t.boxSizingReliable=!0,t.pixelPosition=!1,n.checked=!0,t.noCloneChecked=n.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!a.disabled,n=o.createElement("input"),n.value="t",n.type="radio",t.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),r.appendChild(n),t.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,t.focusinBubbles="onfocusin" in e,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===i.style.backgroundClip,x(function(){var n,r,s="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",a=o.getElementsByTagName("body")[0];a&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(i),i.innerHTML="",i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",x.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===i.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(i,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(i,null)||{width:"4px"}).width,r=i.appendChild(o.createElement("div")),r.style.cssText=i.style.cssText=s,r.style.marginRight=r.style.width="0",i.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),a.removeChild(n))}),t):t}({});var L,q,H=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,O=/([A-Z])/g;function F(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=x.expando+Math.random()}F.uid=1,F.accepts=function(e){return e.nodeType?1===e.nodeType||9===e.nodeType:!0},F.prototype={key:function(e){if(!F.accepts(e)){return 0}var t={},n=e[this.expando];if(!n){n=F.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,x.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),o=this.cache[i];if("string"==typeof t){o[t]=n}else{if(x.isEmptyObject(o)){x.extend(this.cache[i],t)}else{for(r in t){o[r]=t[r]}}}return o},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(e,t,n){var r;return t===undefined||t&&"string"==typeof t&&n===undefined?(r=this.get(e,t),r!==undefined?r:this.get(e,x.camelCase(t))):(this.set(e,t,n),n!==undefined?n:t)},remove:function(e,t){var n,r,i,o=this.key(e),s=this.cache[o];if(t===undefined){this.cache[o]={}}else{x.isArray(t)?r=t.concat(t.map(x.camelCase)):(i=x.camelCase(t),t in s?r=[t,i]:(r=i,r=r in s?[r]:r.match(w)||[])),n=r.length;while(n--){delete s[r[n]]}}},hasData:function(e){return !x.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},L=new F,q=new F,x.extend({acceptData:F.accepts,hasData:function(e){return L.hasData(e)||q.hasData(e)},data:function(e,t,n){return L.access(e,t,n)},removeData:function(e,t){L.remove(e,t)},_data:function(e,t,n){return q.access(e,t,n)},_removeData:function(e,t){q.remove(e,t)}}),x.fn.extend({data:function(e,t){var n,r,i=this[0],o=0,s=null;if(e===undefined){if(this.length&&(s=L.get(i),1===i.nodeType&&!q.get(i,"hasDataAttrs"))){for(n=i.attributes;n.length>o;o++){r=n[o].name,0===r.indexOf("data-")&&(r=x.camelCase(r.slice(5)),P(i,r,s[r]))}q.set(i,"hasDataAttrs",!0)}return s}return"object"==typeof e?this.each(function(){L.set(this,e)}):x.access(this,function(t){var n,r=x.camelCase(e);if(i&&t===undefined){if(n=L.get(i,e),n!==undefined){return n}if(n=L.get(i,r),n!==undefined){return n}if(n=P(i,r,undefined),n!==undefined){return n}}else{this.each(function(){var n=L.get(this,r);L.set(this,r,t),-1!==e.indexOf("-")&&n!==undefined&&L.set(this,e,t)})}},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){L.remove(this,e)})}});function P(e,t,n){var r;if(n===undefined&&1===e.nodeType){if(r="data-"+t.replace(O,"-$1").toLowerCase(),n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:H.test(n)?JSON.parse(n):n}catch(i){}L.set(e,t,n)}else{n=undefined}}return n}x.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=q.get(e,t),n&&(!r||x.isArray(n)?r=q.access(e,t,x.makeArray(n)):r.push(n)),r||[]):undefined},dequeue:function(e,t){t=t||"fx";var n=x.queue(e,t),r=n.length,i=n.shift(),o=x._queueHooks(e,t),s=function(){x.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,s,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return q.get(e,n)||q.access(e,n,{empty:x.Callbacks("once memory").add(function(){q.remove(e,[t+"queue",n])})})}}),x.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),n>arguments.length?x.queue(this[0],e):t===undefined?this:this.each(function(){var n=x.queue(this,e,t);x._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&x.dequeue(this,e)})},dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},delay:function(e,t){return e=x.fx?x.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=x.Deferred(),o=this,s=this.length,a=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=undefined),e=e||"fx";while(s--){n=q.get(o[s],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(a))}return a(),i.promise(t)}});var R,M,W=/[\t\r\n\f]/g,$=/\r/g,B=/^(?:input|select|textarea|button)$/i;x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)})},prop:function(e,t){return x.access(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[x.propFix[e]||e]})},addClass:function(e){var t,n,r,i,o,s=0,a=this.length,u="string"==typeof e&&e;if(x.isFunction(e)){return this.each(function(t){x(this).addClass(e.call(this,t,this.className))})}if(u){for(t=(e||"").match(w)||[];a>s;s++){if(n=this[s],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):" ")){o=0;while(i=t[o++]){0>r.indexOf(" "+i+" ")&&(r+=i+" ")}n.className=x.trim(r)}}}return this},removeClass:function(e){var t,n,r,i,o,s=0,a=this.length,u=0===arguments.length||"string"==typeof e&&e;if(x.isFunction(e)){return this.each(function(t){x(this).removeClass(e.call(this,t,this.className))})}if(u){for(t=(e||"").match(w)||[];a>s;s++){if(n=this[s],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):"")){o=0;while(i=t[o++]){while(r.indexOf(" "+i+" ")>=0){r=r.replace(" "+i+" "," ")}}n.className=e?x.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):x.isFunction(e)?this.each(function(n){x(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var t,i=0,o=x(this),s=e.match(w)||[];while(t=s[i++]){o.hasClass(t)?o.removeClass(t):o.addClass(t)}}else{(n===r||"boolean"===n)&&(this.className&&q.set(this,"__className__",this.className),this.className=this.className||e===!1?"":q.get(this,"__className__")||"")}})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++){if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(W," ").indexOf(t)>=0){return !0}}return !1},val:function(e){var t,n,r,i=this[0];if(arguments.length){return r=x.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(i=r?e.call(this,n,x(this).val()):e,null==i?i="":"number"==typeof i?i+="":x.isArray(i)&&(i=x.map(i,function(e){return null==e?"":e+""})),t=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],t&&"set" in t&&t.set(this,i,"value")!==undefined||(this.value=i))})}if(i){return t=x.valHooks[i.type]||x.valHooks[i.nodeName.toLowerCase()],t&&"get" in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,"string"==typeof n?n.replace($,""):null==n?"":n)}}}),x.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return !t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,s=o?null:[],a=o?i+1:r.length,u=0>i?a:o?i:0;for(;a>u;u++){if(n=r[u],!(!n.selected&&u!==i||(x.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&x.nodeName(n.parentNode,"optgroup"))){if(t=x(n).val(),o){return t}s.push(t)}}return s},set:function(e,t){var n,r,i=e.options,o=x.makeArray(t),s=i.length;while(s--){r=i[s],(r.selected=x.inArray(x(r).val(),o)>=0)&&(n=!0)}return n||(e.selectedIndex=-1),o}}},attr:function(e,t,n){var i,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s){return typeof e.getAttribute===r?x.prop(e,t,n):(1===s&&x.isXMLDoc(e)||(t=t.toLowerCase(),i=x.attrHooks[t]||(x.expr.match.bool.test(t)?M:R)),n===undefined?i&&"get" in i&&null!==(o=i.get(e,t))?o:(o=x.find.attr(e,t),null==o?undefined:o):null!==n?i&&"set" in i&&(o=i.set(e,n,t))!==undefined?o:(e.setAttribute(t,n+""),n):(x.removeAttr(e,t),undefined))}},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(w);if(o&&1===e.nodeType){while(n=o[i++]){r=x.propFix[n]||n,x.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)}}},attrHooks:{type:{set:function(e,t){if(!x.support.radioValue&&"radio"===t&&x.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s){return o=1!==s||!x.isXMLDoc(e),o&&(t=x.propFix[t]||t,i=x.propHooks[t]),n!==undefined?i&&"set" in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get" in i&&null!==(r=i.get(e,t))?r:e[t]}},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||B.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),M={set:function(e,t,n){return t===!1?x.removeAttr(e,n):e.setAttribute(n,n),n}},x.each(x.expr.match.bool.source.match(/\w+/g),function(e,t){var n=x.expr.attrHandle[t]||x.find.attr;x.expr.attrHandle[t]=function(e,t,r){var i=x.expr.attrHandle[t],o=r?undefined:(x.expr.attrHandle[t]=undefined)!=n(e,t,r)?t.toLowerCase():null;return x.expr.attrHandle[t]=i,o}}),x.support.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(e,t){return x.isArray(t)?e.checked=x.inArray(x(e).val(),t)>=0:undefined}},x.support.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var I=/^key/,z=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,X=/^([^.]*)(?:\.(.+)|)$/;function U(){return !0}function Y(){return !1}function V(){try{return o.activeElement}catch(e){}}x.event={global:{},add:function(e,t,n,i,o){var s,a,u,l,c,p,f,h,d,g,m,y=q.get(e);if(y){n.handler&&(s=n,n=s.handler,o=s.selector),n.guid||(n.guid=x.guid++),(l=y.events)||(l=y.events={}),(a=y.handle)||(a=y.handle=function(e){return typeof x===r||e&&x.event.triggered===e.type?undefined:x.event.dispatch.apply(a.elem,arguments)},a.elem=e),t=(t||"").match(w)||[""],c=t.length;while(c--){u=X.exec(t[c])||[],d=m=u[1],g=(u[2]||"").split(".").sort(),d&&(f=x.event.special[d]||{},d=(o?f.delegateType:f.bindType)||d,f=x.event.special[d]||{},p=x.extend({type:d,origType:m,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&x.expr.match.needsContext.test(o),namespace:g.join(".")},s),(h=l[d])||(h=l[d]=[],h.delegateCount=0,f.setup&&f.setup.call(e,i,g,a)!==!1||e.addEventListener&&e.addEventListener(d,a,!1)),f.add&&(f.add.call(e,p),p.handler.guid||(p.handler.guid=n.guid)),o?h.splice(h.delegateCount++,0,p):h.push(p),x.event.global[d]=!0)}e=null}},remove:function(e,t,n,r,i){var o,s,a,u,l,c,p,f,h,d,g,m=q.hasData(e)&&q.get(e);if(m&&(u=m.events)){t=(t||"").match(w)||[""],l=t.length;while(l--){if(a=X.exec(t[l])||[],h=g=a[1],d=(a[2]||"").split(".").sort(),h){p=x.event.special[h]||{},h=(r?p.delegateType:p.bindType)||h,f=u[h]||[],a=a[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=f.length;while(o--){c=f[o],!i&&g!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(f.splice(o,1),c.selector&&f.delegateCount--,p.remove&&p.remove.call(e,c))}s&&!f.length&&(p.teardown&&p.teardown.call(e,d,m.handle)!==!1||x.removeEvent(e,h,m.handle),delete u[h])}else{for(h in u){x.event.remove(e,h+t[l],n,r,!0)}}}x.isEmptyObject(u)&&(delete m.handle,q.remove(e,"events"))}},trigger:function(t,n,r,i){var s,a,u,l,c,p,f,h=[r||o],d=y.call(t,"type")?t.type:t,g=y.call(t,"namespace")?t.namespace.split("."):[];if(a=u=r=r||o,3!==r.nodeType&&8!==r.nodeType&&!_.test(d+x.event.triggered)&&(d.indexOf(".")>=0&&(g=d.split("."),d=g.shift(),g.sort()),c=0>d.indexOf(":")&&"on"+d,t=t[x.expando]?t:new x.Event(d,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=g.join("."),t.namespace_re=t.namespace?RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=undefined,t.target||(t.target=r),n=null==n?[t]:x.makeArray(n,[t]),f=x.event.special[d]||{},i||!f.trigger||f.trigger.apply(r,n)!==!1)){if(!i&&!f.noBubble&&!x.isWindow(r)){for(l=f.delegateType||d,_.test(l+d)||(a=a.parentNode);a;a=a.parentNode){h.push(a),u=a}u===(r.ownerDocument||o)&&h.push(u.defaultView||u.parentWindow||e)}s=0;while((a=h[s++])&&!t.isPropagationStopped()){t.type=s>1?l:f.bindType||d,p=(q.get(a,"events")||{})[t.type]&&q.get(a,"handle"),p&&p.apply(a,n),p=c&&a[c],p&&x.acceptData(a)&&p.apply&&p.apply(a,n)===!1&&t.preventDefault()}return t.type=d,i||t.isDefaultPrevented()||f._default&&f._default.apply(h.pop(),n)!==!1||!x.acceptData(r)||c&&x.isFunction(r[d])&&!x.isWindow(r)&&(u=r[c],u&&(r[c]=null),x.event.triggered=d,r[d](),x.event.triggered=undefined,u&&(r[c]=u)),t.result}},dispatch:function(e){e=x.event.fix(e);var t,n,r,i,o,s=[],a=d.call(arguments),u=(q.get(this,"events")||{})[e.type]||[],l=x.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){s=x.event.handlers.call(this,e,u),t=0;while((i=s[t++])&&!e.isPropagationStopped()){e.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!e.isImmediatePropagationStopped()){(!e.namespace_re||e.namespace_re.test(o.namespace))&&(e.handleObj=o,e.data=o.data,r=((x.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,a),r!==undefined&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}}return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,o,s=[],a=t.delegateCount,u=e.target;if(a&&u.nodeType&&(!e.button||"click"!==e.type)){for(;u!==this;u=u.parentNode||this){if(u.disabled!==!0||"click"!==e.type){for(r=[],n=0;a>n;n++){o=t[n],i=o.selector+" ",r[i]===undefined&&(r[i]=o.needsContext?x(i,this).index(u)>=0:x.find(i,this,null,[u]).length),r[i]&&r.push(o)}r.length&&s.push({elem:u,handlers:r})}}}return t.length>a&&s.push({elem:this,handlers:t.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||o,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||s===undefined||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[x.expando]){return e}var t,n,r,i=e.type,s=e,a=this.fixHooks[i];a||(this.fixHooks[i]=a=z.test(i)?this.mouseHooks:I.test(i)?this.keyHooks:{}),r=a.props?this.props.concat(a.props):this.props,e=new x.Event(s),t=r.length;while(t--){n=r[t],e[n]=s[n]}return e.target||(e.target=o),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==V()&&this.focus?(this.focus(),!1):undefined},delegateType:"focusin"},blur:{trigger:function(){return this===V()&&this.blur?(this.blur(),!1):undefined},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&x.nodeName(this,"input")?(this.click(),!1):undefined},_default:function(e){return x.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=x.extend(new x.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?x.event.trigger(i,null,t):x.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},x.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},x.Event=function(e,t){return this instanceof x.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?U:Y):this.type=e,t&&x.extend(this,t),this.timeStamp=e&&e.timeStamp||x.now(),this[x.expando]=!0,undefined):new x.Event(e,t)},x.Event.prototype={isDefaultPrevented:Y,isPropagationStopped:Y,isImmediatePropagationStopped:Y,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=U,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=U,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=U,this.stopPropagation()}},x.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return(!i||i!==r&&!x.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){x.event.simulate(t,e.target,x.event.fix(e),!0)};x.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),x.fn.extend({on:function(e,t,n,r,i){var o,s;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=undefined);for(s in e){this.on(s,t,n,e[s],i)}return this}if(null==n&&null==r?(r=t,n=t=undefined):null==r&&("string"==typeof t?(r=n,n=undefined):(r=n,n=t,t=undefined)),r===!1){r=Y}else{if(!r){return this}}return 1===i&&(o=r,r=function(e){return x().off(e),o.apply(this,arguments)},r.guid=o.guid||(o.guid=x.guid++)),this.each(function(){x.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj){return r=e.handleObj,x(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this}if("object"==typeof e){for(i in e){this.off(i,t,e[i])}return this}return(t===!1||"function"==typeof t)&&(n=t,t=undefined),n===!1&&(n=Y),this.each(function(){x.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?x.event.trigger(e,t,n,!0):undefined}});var G=/^.[^:#\[\.,]*$/,J=/^(?:parents|prev(?:Until|All))/,Q=x.expr.match.needsContext,K={children:!0,contents:!0,next:!0,prev:!0};x.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e){return this.pushStack(x(e).filter(function(){for(t=0;i>t;t++){if(x.contains(r[t],this)){return !0}}}))}for(t=0;i>t;t++){x.find(e,r[t],n)}return n=this.pushStack(i>1?x.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t=x(e,this),n=t.length;return this.filter(function(){var e=0;for(;n>e;e++){if(x.contains(this,t[e])){return !0}}})},not:function(e){return this.pushStack(et(this,e||[],!0))},filter:function(e){return this.pushStack(et(this,e||[],!1))},is:function(e){return !!et(this,"string"==typeof e&&Q.test(e)?x(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,o=[],s=Q.test(e)||"string"!=typeof e?x(e,t||this.context):0;for(;i>r;r++){for(n=this[r];n&&n!==t;n=n.parentNode){if(11>n.nodeType&&(s?s.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,e))){n=o.push(n);break}}}return this.pushStack(o.length>1?x.unique(o):o)},index:function(e){return e?"string"==typeof e?g.call(x(e),this[0]):g.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?x(e,t):x.makeArray(e&&e.nodeType?[e]:e),r=x.merge(this.get(),n);return this.pushStack(x.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}});function Z(e,t){while((e=e[t])&&1!==e.nodeType){}return e}x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x.dir(e,"parentNode")},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)},next:function(e){return Z(e,"nextSibling")},prev:function(e){return Z(e,"previousSibling")},nextAll:function(e){return x.dir(e,"nextSibling")},prevAll:function(e){return x.dir(e,"previousSibling")},nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return x.dir(e,"previousSibling",n)},siblings:function(e){return x.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return x.sibling(e.firstChild)},contents:function(e){return e.contentDocument||x.merge([],e.childNodes)}},function(e,t){x.fn[e]=function(n,r){var i=x.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=x.filter(r,i)),this.length>1&&(K[e]||x.unique(i),J.test(e)&&i.reverse()),this.pushStack(i)}}),x.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?x.find.matchesSelector(r,e)?[r]:[]:x.find.matches(e,x.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&9!==e.nodeType){if(1===e.nodeType){if(i&&x(e).is(n)){break}r.push(e)}}return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling){1===e.nodeType&&e!==t&&n.push(e)}return n}});function et(e,t,n){if(x.isFunction(t)){return x.grep(e,function(e,r){return !!t.call(e,r,e)!==n})}if(t.nodeType){return x.grep(e,function(e){return e===t!==n})}if("string"==typeof t){if(G.test(t)){return x.filter(t,e,n)}t=x.filter(t,e)}return x.grep(e,function(e){return g.call(t,e)>=0!==n})}var tt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,nt=/<([\w:]+)/,rt=/<|&#?\w+;/,it=/<(?:script|style|link)/i,ot=/^(?:checkbox|radio)$/i,st=/checked\s*(?:[^=]|=\s*.checked.)/i,at=/^$|\/(?:java|ecma)script/i,ut=/^true\/(.*)/,lt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ct={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ct.optgroup=ct.option,ct.tbody=ct.tfoot=ct.colgroup=ct.caption=ct.thead,ct.th=ct.td,x.fn.extend({text:function(e){return x.access(this,function(e){return e===undefined?x.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?x.filter(e,this):this,i=0;for(;null!=(n=r[i]);i++){t||1!==n.nodeType||x.cleanData(mt(n)),n.parentNode&&(t&&x.contains(n.ownerDocument,n)&&dt(mt(n,"script")),n.parentNode.removeChild(n))}return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++){1===e.nodeType&&(x.cleanData(mt(e,!1)),e.textContent="")}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)})},html:function(e){return x.access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&1===t.nodeType){return t.innerHTML}if("string"==typeof e&&!it.test(e)&&!ct[(nt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(tt,"<$1></$2>");try{for(;r>n;n++){t=this[n]||{},1===t.nodeType&&(x.cleanData(mt(t,!1)),t.innerHTML=e)}t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=x.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),x(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=f.apply([],e);var r,i,o,s,a,u,l=0,c=this.length,p=this,h=c-1,d=e[0],g=x.isFunction(d);if(g||!(1>=c||"string"!=typeof d||x.support.checkClone)&&st.test(d)){return this.each(function(r){var i=p.eq(r);g&&(e[0]=d.call(this,r,i.html())),i.domManip(e,t,n)})}if(c&&(r=x.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=r.firstChild,1===r.childNodes.length&&(r=i),i)){for(o=x.map(mt(r,"script"),ft),s=o.length;c>l;l++){a=r,l!==h&&(a=x.clone(a,!0,!0),s&&x.merge(o,mt(a,"script"))),t.call(this[l],a,l)}if(s){for(u=o[o.length-1].ownerDocument,x.map(o,ht),l=0;s>l;l++){a=o[l],at.test(a.type||"")&&!q.access(a,"globalEval")&&x.contains(u,a)&&(a.src?x._evalUrl(a.src):x.globalEval(a.textContent.replace(lt,"")))}}}return this}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){x.fn[e]=function(e){var n,r=[],i=x(e),o=i.length-1,s=0;for(;o>=s;s++){n=s===o?this:this.clone(!0),x(i[s])[t](n),h.apply(r,n.get())}return this.pushStack(r)}}),x.extend({clone:function(e,t,n){var r,i,o,s,a=e.cloneNode(!0),u=x.contains(e.ownerDocument,e);if(!(x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e))){for(s=mt(a),o=mt(e),r=0,i=o.length;i>r;r++){yt(o[r],s[r])}}if(t){if(n){for(o=o||mt(e),s=s||mt(a),r=0,i=o.length;i>r;r++){gt(o[r],s[r])}}else{gt(e,a)}}return s=mt(a,"script"),s.length>0&&dt(s,!u&&mt(e,"script")),a},buildFragment:function(e,t,n,r){var i,o,s,a,u,l,c=0,p=e.length,f=t.createDocumentFragment(),h=[];for(;p>c;c++){if(i=e[c],i||0===i){if("object"===x.type(i)){x.merge(h,i.nodeType?[i]:i)}else{if(rt.test(i)){o=o||f.appendChild(t.createElement("div")),s=(nt.exec(i)||["",""])[1].toLowerCase(),a=ct[s]||ct._default,o.innerHTML=a[1]+i.replace(tt,"<$1></$2>")+a[2],l=a[0];while(l--){o=o.lastChild}x.merge(h,o.childNodes),o=f.firstChild,o.textContent=""}else{h.push(t.createTextNode(i))}}}}f.textContent="",c=0;while(i=h[c++]){if((!r||-1===x.inArray(i,r))&&(u=x.contains(i.ownerDocument,i),o=mt(f.appendChild(i),"script"),u&&dt(o),n)){l=0;while(i=o[l++]){at.test(i.type||"")&&n.push(i)}}}return f},cleanData:function(e){var t,n,r,i,o,s,a=x.event.special,u=0;for(;(n=e[u])!==undefined;u++){if(F.accepts(n)&&(o=n[q.expando],o&&(t=q.cache[o]))){if(r=Object.keys(t.events||{}),r.length){for(s=0;(i=r[s])!==undefined;s++){a[i]?x.event.remove(n,i):x.removeEvent(n,i,t.handle)}}q.cache[o]&&delete q.cache[o]}delete L.cache[n[L.expando]]}},_evalUrl:function(e){return x.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}});function pt(e,t){return x.nodeName(e,"table")&&x.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ft(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function ht(e){var t=ut.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function dt(e,t){var n=e.length,r=0;for(;n>r;r++){q.set(e[r],"globalEval",!t||q.get(t[r],"globalEval"))}}function gt(e,t){var n,r,i,o,s,a,u,l;if(1===t.nodeType){if(q.hasData(e)&&(o=q.access(e),s=q.set(t,o),l=o.events)){delete s.handle,s.events={};for(i in l){for(n=0,r=l[i].length;r>n;n++){x.event.add(t,i,l[i][n])}}}L.hasData(e)&&(a=L.access(e),u=x.extend({},a),L.set(t,u))}}function mt(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===undefined||t&&x.nodeName(e,t)?x.merge([e],n):n}function yt(e,t){var n=t.nodeName.toLowerCase();"input"===n&&ot.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}x.fn.extend({wrapAll:function(e){var t;return x.isFunction(e)?this.each(function(t){x(this).wrapAll(e.call(this,t))}):(this[0]&&(t=x(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild){e=e.firstElementChild}return e}).append(this)),this)},wrapInner:function(e){return x.isFunction(e)?this.each(function(t){x(this).wrapInner(e.call(this,t))}):this.each(function(){var t=x(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=x.isFunction(e);return this.each(function(n){x(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){x.nodeName(this,"body")||x(this).replaceWith(this.childNodes)}).end()}});var vt,xt,bt=/^(none|table(?!-c[ea]).+)/,wt=/^margin/,Tt=RegExp("^("+b+")(.*)$","i"),Ct=RegExp("^("+b+")(?!px)[a-z%]+$","i"),kt=RegExp("^([+-])=("+b+")","i"),Nt={BODY:"block"},Et={position:"absolute",visibility:"hidden",display:"block"},St={letterSpacing:0,fontWeight:400},jt=["Top","Right","Bottom","Left"],Dt=["Webkit","O","Moz","ms"];function At(e,t){if(t in e){return t}var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Dt.length;while(i--){if(t=Dt[i]+n,t in e){return t}}return r}function Lt(e,t){return e=t||e,"none"===x.css(e,"display")||!x.contains(e.ownerDocument,e)}function qt(t){return e.getComputedStyle(t,null)}function Ht(e,t){var n,r,i,o=[],s=0,a=e.length;for(;a>s;s++){r=e[s],r.style&&(o[s]=q.get(r,"olddisplay"),n=r.style.display,t?(o[s]||"none"!==n||(r.style.display=""),""===r.style.display&&Lt(r)&&(o[s]=q.access(r,"olddisplay",Rt(r.nodeName)))):o[s]||(i=Lt(r),(n&&"none"!==n||!i)&&q.set(r,"olddisplay",i?n:x.css(r,"display"))))}for(s=0;a>s;s++){r=e[s],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[s]||"":"none"))}return e}x.fn.extend({css:function(e,t){return x.access(this,function(e,t,n){var r,i,o={},s=0;if(x.isArray(t)){for(r=qt(e),i=t.length;i>s;s++){o[t[s]]=x.css(e,t[s],!1,r)}return o}return n!==undefined?x.style(e,t,n):x.css(e,t)},e,t,arguments.length>1)},show:function(){return Ht(this,!0)},hide:function(){return Ht(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Lt(this)?x(this).show():x(this).hide()})}}),x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=vt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,s,a=x.camelCase(t),u=e.style;return t=x.cssProps[a]||(x.cssProps[a]=At(u,a)),s=x.cssHooks[t]||x.cssHooks[a],n===undefined?s&&"get" in s&&(i=s.get(e,!1,r))!==undefined?i:u[t]:(o=typeof n,"string"===o&&(i=kt.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(x.css(e,t)),o="number"),null==n||"number"===o&&isNaN(n)||("number"!==o||x.cssNumber[a]||(n+="px"),x.support.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),s&&"set" in s&&(n=s.set(e,n,r))===undefined||(u[t]=n)),undefined)}},css:function(e,t,n,r){var i,o,s,a=x.camelCase(t);return t=x.cssProps[a]||(x.cssProps[a]=At(e.style,a)),s=x.cssHooks[t]||x.cssHooks[a],s&&"get" in s&&(i=s.get(e,!0,n)),i===undefined&&(i=vt(e,t,r)),"normal"===i&&t in St&&(i=St[t]),""===n||n?(o=parseFloat(i),n===!0||x.isNumeric(o)?o||0:i):i}}),vt=function(e,t,n){var r,i,o,s=n||qt(e),a=s?s.getPropertyValue(t)||s[t]:undefined,u=e.style;return s&&(""!==a||x.contains(e.ownerDocument,e)||(a=x.style(e,t)),Ct.test(a)&&wt.test(t)&&(r=u.width,i=u.minWidth,o=u.maxWidth,u.minWidth=u.maxWidth=u.width=a,a=s.width,u.width=r,u.minWidth=i,u.maxWidth=o)),a};function Ot(e,t,n){var r=Tt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Ft(e,t,n,r,i){var o=n===(r?"border":"content")?4:"width"===t?1:0,s=0;for(;4>o;o+=2){"margin"===n&&(s+=x.css(e,n+jt[o],!0,i)),r?("content"===n&&(s-=x.css(e,"padding"+jt[o],!0,i)),"margin"!==n&&(s-=x.css(e,"border"+jt[o]+"Width",!0,i))):(s+=x.css(e,"padding"+jt[o],!0,i),"padding"!==n&&(s+=x.css(e,"border"+jt[o]+"Width",!0,i)))}return s}function Pt(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=qt(e),s=x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,o);if(0>=i||null==i){if(i=vt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Ct.test(i)){return i}r=s&&(x.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+Ft(e,t,n||(s?"border":"content"),r,o)+"px"}function Rt(e){var t=o,n=Nt[e];return n||(n=Mt(e,t),"none"!==n&&n||(xt=(xt||x("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(xt[0].contentWindow||xt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=Mt(e,t),xt.detach()),Nt[e]=n),n}function Mt(e,t){var n=x(t.createElement(e)).appendTo(t.body),r=x.css(n[0],"display");return n.remove(),r}x.each(["height","width"],function(e,t){x.cssHooks[t]={get:function(e,n,r){return n?0===e.offsetWidth&&bt.test(x.css(e,"display"))?x.swap(e,Et,function(){return Pt(e,t,r)}):Pt(e,t,r):undefined},set:function(e,n,r){var i=r&&qt(e);return Ot(e,n,r?Ft(e,t,r,x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,i),i):0)}}}),x(function(){x.support.reliableMarginRight||(x.cssHooks.marginRight={get:function(e,t){return t?x.swap(e,{display:"inline-block"},vt,[e,"marginRight"]):undefined}}),!x.support.pixelPosition&&x.fn.position&&x.each(["top","left"],function(e,t){x.cssHooks[t]={get:function(e,n){return n?(n=vt(e,t),Ct.test(n)?x(e).position()[t]+"px":n):undefined}}})}),x.expr&&x.expr.filters&&(x.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight},x.expr.filters.visible=function(e){return !x.expr.filters.hidden(e)}),x.each({margin:"",padding:"",border:"Width"},function(e,t){x.cssHooks[e+t]={expand:function(n){var r=0,i={},o="string"==typeof n?n.split(" "):[n];for(;4>r;r++){i[e+jt[r]+t]=o[r]||o[r-2]||o[0]}return i}},wt.test(e)||(x.cssHooks[e+t].set=Ot)});var Wt=/%20/g,$t=/\[\]$/,Bt=/\r?\n/g,It=/^(?:submit|button|image|reset|file)$/i,zt=/^(?:input|select|textarea|keygen)/i;x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&zt.test(this.nodeName)&&!It.test(e)&&(this.checked||!ot.test(e))}).map(function(e,t){var n=x(this).val();return null==n?null:x.isArray(n)?x.map(n,function(e){return{name:t.name,value:e.replace(Bt,"\r\n")}}):{name:t.name,value:n.replace(Bt,"\r\n")}}).get()}}),x.param=function(e,t){var n,r=[],i=function(e,t){t=x.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===undefined&&(t=x.ajaxSettings&&x.ajaxSettings.traditional),x.isArray(e)||e.jquery&&!x.isPlainObject(e)){x.each(e,function(){i(this.name,this.value)})}else{for(n in e){_t(n,e[n],t,i)}}return r.join("&").replace(Wt,"+")};function _t(e,t,n,r){var i;if(x.isArray(t)){x.each(t,function(t,i){n||$t.test(e)?r(e,i):_t(e+"["+("object"==typeof i?t:"")+"]",i,n,r)})}else{if(n||"object"!==x.type(t)){r(e,t)}else{for(i in t){_t(e+"["+i+"]",t[i],n,r)}}}}x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){x.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),x.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Xt,Ut,Yt=x.now(),Vt=/\?/,Gt=/#.*$/,Jt=/([?&])_=[^&]*/,Qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Kt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Zt=/^(?:GET|HEAD)$/,en=/^\/\//,tn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,nn=x.fn.load,rn={},on={},sn="*/".concat("*");try{Ut=i.href}catch(an){Ut=o.createElement("a"),Ut.href="",Ut=Ut.href}Xt=tn.exec(Ut.toLowerCase())||[];function un(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(w)||[];if(x.isFunction(n)){while(r=o[i++]){"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}}}function ln(e,t,n,r){var i={},o=e===on;function s(a){var u;return i[a]=!0,x.each(e[a]||[],function(e,a){var l=a(t,n,r);return"string"!=typeof l||o||i[l]?o?!(u=l):undefined:(t.dataTypes.unshift(l),s(l),!1)}),u}return s(t.dataTypes[0])||!i["*"]&&s("*")}function cn(e,t){var n,r,i=x.ajaxSettings.flatOptions||{};for(n in t){t[n]!==undefined&&((i[n]?e:r||(r={}))[n]=t[n])}return r&&x.extend(!0,e,r),e}x.fn.load=function(e,t,n){if("string"!=typeof e&&nn){return nn.apply(this,arguments)}var r,i,o,s=this,a=e.indexOf(" ");return a>=0&&(r=e.slice(a),e=e.slice(0,a)),x.isFunction(t)?(n=t,t=undefined):t&&"object"==typeof t&&(i="POST"),s.length>0&&x.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){o=arguments,s.html(r?x("<div>").append(x.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){s.each(n,o||[e.responseText,t,e])}),this},x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){x.fn[t]=function(e){return this.on(t,e)}}),x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ut,type:"GET",isLocal:Kt.test(Xt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":sn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?cn(cn(e,x.ajaxSettings),t):cn(x.ajaxSettings,e)},ajaxPrefilter:un(rn),ajaxTransport:un(on),ajax:function(e,t){"object"==typeof e&&(t=e,e=undefined),t=t||{};var n,r,i,o,s,a,u,l,c=x.ajaxSetup({},t),p=c.context||c,f=c.context&&(p.nodeType||p.jquery)?x(p):x.event,h=x.Deferred(),d=x.Callbacks("once memory"),g=c.statusCode||{},m={},y={},v=0,b="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(2===v){if(!o){o={};while(t=Qt.exec(i)){o[t[1].toLowerCase()]=t[2]}}t=o[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===v?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return v||(e=y[n]=y[n]||e,m[e]=t),this},overrideMimeType:function(e){return v||(c.mimeType=e),this},statusCode:function(e){var t;if(e){if(2>v){for(t in e){g[t]=[g[t],e[t]]}}else{T.always(e[T.status])}}return this},abort:function(e){var t=e||b;return n&&n.abort(t),k(0,t),this}};if(h.promise(T).complete=d.add,T.success=T.done,T.error=T.fail,c.url=((e||c.url||Ut)+"").replace(Gt,"").replace(en,Xt[1]+"//"),c.type=t.method||t.type||c.method||c.type,c.dataTypes=x.trim(c.dataType||"*").toLowerCase().match(w)||[""],null==c.crossDomain&&(a=tn.exec(c.url.toLowerCase()),c.crossDomain=!(!a||a[1]===Xt[1]&&a[2]===Xt[2]&&(a[3]||("http:"===a[1]?"80":"443"))===(Xt[3]||("http:"===Xt[1]?"80":"443")))),c.data&&c.processData&&"string"!=typeof c.data&&(c.data=x.param(c.data,c.traditional)),ln(rn,c,t,T),2===v){return T}u=c.global,u&&0===x.active++&&x.event.trigger("ajaxStart"),c.type=c.type.toUpperCase(),c.hasContent=!Zt.test(c.type),r=c.url,c.hasContent||(c.data&&(r=c.url+=(Vt.test(r)?"&":"?")+c.data,delete c.data),c.cache===!1&&(c.url=Jt.test(r)?r.replace(Jt,"$1_="+Yt++):r+(Vt.test(r)?"&":"?")+"_="+Yt++)),c.ifModified&&(x.lastModified[r]&&T.setRequestHeader("If-Modified-Since",x.lastModified[r]),x.etag[r]&&T.setRequestHeader("If-None-Match",x.etag[r])),(c.data&&c.hasContent&&c.contentType!==!1||t.contentType)&&T.setRequestHeader("Content-Type",c.contentType),T.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+("*"!==c.dataTypes[0]?", "+sn+"; q=0.01":""):c.accepts["*"]);for(l in c.headers){T.setRequestHeader(l,c.headers[l])}if(c.beforeSend&&(c.beforeSend.call(p,T,c)===!1||2===v)){return T.abort()}b="abort";for(l in {success:1,error:1,complete:1}){T[l](c[l])}if(n=ln(on,c,t,T)){T.readyState=1,u&&f.trigger("ajaxSend",[T,c]),c.async&&c.timeout>0&&(s=setTimeout(function(){T.abort("timeout")},c.timeout));try{v=1,n.send(m,k)}catch(C){if(!(2>v)){throw C}k(-1,C)}}else{k(-1,"No Transport")}function k(e,t,o,a){var l,m,y,b,w,C=t;2!==v&&(v=2,s&&clearTimeout(s),n=undefined,i=a||"",T.readyState=e>0?4:0,l=e>=200&&300>e||304===e,o&&(b=pn(c,T,o)),b=fn(c,b,T,l),l?(c.ifModified&&(w=T.getResponseHeader("Last-Modified"),w&&(x.lastModified[r]=w),w=T.getResponseHeader("etag"),w&&(x.etag[r]=w)),204===e||"HEAD"===c.type?C="nocontent":304===e?C="notmodified":(C=b.state,m=b.data,y=b.error,l=!y)):(y=C,(e||!C)&&(C="error",0>e&&(e=0))),T.status=e,T.statusText=(t||C)+"",l?h.resolveWith(p,[m,C,T]):h.rejectWith(p,[T,C,y]),T.statusCode(g),g=undefined,u&&f.trigger(l?"ajaxSuccess":"ajaxError",[T,c,l?m:y]),d.fireWith(p,[T,C]),u&&(f.trigger("ajaxComplete",[T,c]),--x.active||x.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return x.get(e,t,n,"json")},getScript:function(e,t){return x.get(e,undefined,t,"script")}}),x.each(["get","post"],function(e,t){x[t]=function(e,n,r,i){return x.isFunction(n)&&(i=i||r,r=n,n=undefined),x.ajax({url:e,type:t,dataType:i,data:n,success:r})}});function pn(e,t,n){var r,i,o,s,a=e.contents,u=e.dataTypes;while("*"===u[0]){u.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"))}if(r){for(i in a){if(a[i]&&a[i].test(r)){u.unshift(i);break}}}if(u[0] in n){o=u[0]}else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}s||(s=i)}o=o||s}return o?(o!==u[0]&&u.unshift(o),n[o]):undefined}function fn(e,t,n,r){var i,o,s,a,u,l={},c=e.dataTypes.slice();if(c[1]){for(s in e.converters){l[s.toLowerCase()]=e.converters[s]}}o=c.shift();while(o){if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift()){if("*"===o){o=u}else{if("*"!==u&&u!==o){if(s=l[u+" "+o]||l["* "+o],!s){for(i in l){if(a=i.split(" "),a[1]===o&&(s=l[u+" "+a[0]]||l["* "+a[0]])){s===!0?s=l[i]:l[i]!==!0&&(o=a[0],c.unshift(a[1]));break}}}if(s!==!0){if(s&&e["throws"]){t=s(t)}else{try{t=s(t)}catch(p){return{state:"parsererror",error:s?p:"No conversion from "+u+" to "+o}}}}}}}}return{state:"success",data:t}}x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),x.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=x("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),o.head.appendChild(t[0])},abort:function(){n&&n()}}}});var hn=[],dn=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=hn.pop()||x.expando+"_"+Yt++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",function(t,n,r){var i,o,s,a=t.jsonp!==!1&&(dn.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&dn.test(t.data)&&"data");return a||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=x.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(dn,"$1"+i):t.jsonp!==!1&&(t.url+=(Vt.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return s||x.error(i+" was not called"),s[0]},t.dataTypes[0]="json",o=e[i],e[i]=function(){s=arguments},r.always(function(){e[i]=o,t[i]&&(t.jsonpCallback=n.jsonpCallback,hn.push(i)),s&&x.isFunction(o)&&o(s[0]),s=o=undefined}),"script"):undefined}),x.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var gn=x.ajaxSettings.xhr(),mn={0:200,1223:204},yn=0,vn={};e.ActiveXObject&&x(e).on("unload",function(){for(var e in vn){vn[e]()}vn=undefined}),x.support.cors=!!gn&&"withCredentials" in gn,x.support.ajax=gn=!!gn,x.ajaxTransport(function(e){var t;return x.support.cors||gn&&!e.crossDomain?{send:function(n,r){var i,o,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields){for(i in e.xhrFields){s[i]=e.xhrFields[i]}}e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n){s.setRequestHeader(i,n[i])}t=function(e){return function(){t&&(delete vn[o],t=s.onload=s.onerror=null,"abort"===e?s.abort():"error"===e?r(s.status||404,s.statusText):r(mn[s.status]||s.status,s.statusText,"string"==typeof s.responseText?{text:s.responseText}:undefined,s.getAllResponseHeaders()))}},s.onload=t(),s.onerror=t("error"),t=vn[o=yn++]=t("abort"),s.send(e.hasContent&&e.data||null)},abort:function(){t&&t()}}:undefined});var xn,bn,wn=/^(?:toggle|show|hide)$/,Tn=RegExp("^(?:([+-])=|)("+b+")([a-z%]*)$","i"),Cn=/queueHooks$/,kn=[An],Nn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Tn.exec(t),o=i&&i[3]||(x.cssNumber[e]?"":"px"),s=(x.cssNumber[e]||"px"!==o&&+r)&&Tn.exec(x.css(n.elem,e)),a=1,u=20;if(s&&s[3]!==o){o=o||s[3],i=i||[],s=+r||1;do{a=a||".5",s/=a,x.style(n.elem,e,s+o)}while(a!==(a=n.cur()/r)&&1!==a&&--u)}return i&&(s=n.start=+s||+r||0,n.unit=o,n.end=i[1]?s+(i[1]+1)*i[2]:+i[2]),n}]};function En(){return setTimeout(function(){xn=undefined}),xn=x.now()}function Sn(e,t,n){var r,i=(Nn[t]||[]).concat(Nn["*"]),o=0,s=i.length;for(;s>o;o++){if(r=i[o].call(n,t,e)){return r}}}function jn(e,t,n){var r,i,o=0,s=kn.length,a=x.Deferred().always(function(){delete u.elem}),u=function(){if(i){return !1}var t=xn||En(),n=Math.max(0,l.startTime+l.duration-t),r=n/l.duration||0,o=1-r,s=0,u=l.tweens.length;for(;u>s;s++){l.tweens[s].run(o)}return a.notifyWith(e,[l,o,n]),1>o&&u?n:(a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:xn||En(),duration:n.duration,tweens:[],createTween:function(t,n){var r=x.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i){return this}for(i=!0;r>n;n++){l.tweens[n].run(1)}return t?a.resolveWith(e,[l,t]):a.rejectWith(e,[l,t]),this}}),c=l.props;for(Dn(c,l.opts.specialEasing);s>o;o++){if(r=kn[o].call(l,e,c,l.opts)){return r}}return x.map(c,Sn,l),x.isFunction(l.opts.start)&&l.opts.start.call(e,l),x.fx.timer(x.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function Dn(e,t){var n,r,i,o,s;for(n in e){if(r=x.camelCase(n),i=t[r],o=e[n],x.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),s=x.cssHooks[r],s&&"expand" in s){o=s.expand(o),delete e[r];for(n in o){n in e||(e[n]=o[n],t[n]=i)}}else{t[r]=i}}}x.Animation=x.extend(jn,{tweener:function(e,t){x.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++){n=e[r],Nn[n]=Nn[n]||[],Nn[n].unshift(t)}},prefilter:function(e,t){t?kn.unshift(e):kn.push(e)}});function An(e,t,n){var r,i,o,s,a,u,l=this,c={},p=e.style,f=e.nodeType&&Lt(e),h=q.get(e,"fxshow");n.queue||(a=x._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,u=a.empty.fire,a.empty.fire=function(){a.unqueued||u()}),a.unqueued++,l.always(function(){l.always(function(){a.unqueued--,x.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height" in t||"width" in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===x.css(e,"display")&&"none"===x.css(e,"float")&&(p.display="inline-block")),n.overflow&&(p.overflow="hidden",l.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t){if(i=t[r],wn.exec(i)){if(delete t[r],o=o||"toggle"===i,i===(f?"hide":"show")){if("show"!==i||!h||h[r]===undefined){continue}f=!0}c[r]=h&&h[r]||x.style(e,r)}}if(!x.isEmptyObject(c)){h?"hidden" in h&&(f=h.hidden):h=q.access(e,"fxshow",{}),o&&(h.hidden=!f),f?x(e).show():l.done(function(){x(e).hide()}),l.done(function(){var t;q.remove(e,"fxshow");for(t in c){x.style(e,t,c[t])}});for(r in c){s=Sn(f?h[r]:0,r,l),r in h||(h[r]=s.start,f&&(s.end=s.start,s.start="width"===r||"height"===r?1:0))}}}function Ln(e,t,n,r,i){return new Ln.prototype.init(e,t,n,r,i)}x.Tween=Ln,Ln.prototype={constructor:Ln,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(x.cssNumber[n]?"":"px")},cur:function(){var e=Ln.propHooks[this.prop];return e&&e.get?e.get(this):Ln.propHooks._default.get(this)},run:function(e){var t,n=Ln.propHooks[this.prop];return this.pos=t=this.options.duration?x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ln.propHooks._default.set(this),this}},Ln.prototype.init.prototype=Ln.prototype,Ln.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=x.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[x.cssProps[e.prop]]||x.cssHooks[e.prop])?x.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Ln.propHooks.scrollTop=Ln.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.each(["toggle","show","hide"],function(e,t){var n=x.fn[t];x.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(qn(t,!0),e,r,i)}}),x.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Lt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=x.isEmptyObject(e),o=x.speed(t,n,r),s=function(){var t=jn(this,x.extend({},e),o);(i||q.get(this,"finish"))&&t.stop(!0)};return s.finish=s,i||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=x.timers,s=q.get(this);if(i){s[i]&&s[i].stop&&r(s[i])}else{for(i in s){s[i]&&s[i].stop&&Cn.test(i)&&r(s[i])}}for(i=o.length;i--;){o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1))}(t||!n)&&x.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=q.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=x.timers,s=r?r.length:0;for(n.finish=!0,x.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;){o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1))}for(t=0;s>t;t++){r[t]&&r[t].finish&&r[t].finish.call(this)}delete n.finish})}});function qn(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t){n=jt[i],r["margin"+n]=r["padding"+n]=e}return t&&(r.opacity=r.width=e),r}x.each({slideDown:qn("show"),slideUp:qn("hide"),slideToggle:qn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){x.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),x.speed=function(e,t,n){var r=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||x.isFunction(e)&&e,duration:e,easing:n&&t||t&&!x.isFunction(t)&&t};return r.duration=x.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in x.fx.speeds?x.fx.speeds[r.duration]:x.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){x.isFunction(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)},r},x.easing={linear:function(e){return e},swing:function(e){return 0.5-Math.cos(e*Math.PI)/2}},x.timers=[],x.fx=Ln.prototype.init,x.fx.tick=function(){var e,t=x.timers,n=0;for(xn=x.now();t.length>n;n++){e=t[n],e()||t[n]!==e||t.splice(n--,1)}t.length||x.fx.stop(),xn=undefined},x.fx.timer=function(e){e()&&x.timers.push(e)&&x.fx.start()},x.fx.interval=13,x.fx.start=function(){bn||(bn=setInterval(x.fx.tick,x.fx.interval))},x.fx.stop=function(){clearInterval(bn),bn=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fx.step={},x.expr&&x.expr.filters&&(x.expr.filters.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length}),x.fn.offset=function(e){if(arguments.length){return e===undefined?this:this.each(function(t){x.offset.setOffset(this,e,t)})}var t,n,i=this[0],o={top:0,left:0},s=i&&i.ownerDocument;if(s){return t=s.documentElement,x.contains(t,i)?(typeof i.getBoundingClientRect!==r&&(o=i.getBoundingClientRect()),n=Hn(s),{top:o.top+n.pageYOffset-t.clientTop,left:o.left+n.pageXOffset-t.clientLeft}):o}},x.offset={setOffset:function(e,t,n){var r,i,o,s,a,u,l,c=x.css(e,"position"),p=x(e),f={};"static"===c&&(e.style.position="relative"),a=p.offset(),o=x.css(e,"top"),u=x.css(e,"left"),l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1,l?(r=p.position(),s=r.top,i=r.left):(s=parseFloat(o)||0,i=parseFloat(u)||0),x.isFunction(t)&&(t=t.call(e,n,a)),null!=t.top&&(f.top=t.top-a.top+s),null!=t.left&&(f.left=t.left-a.left+i),"using" in t?t.using.call(e,f):p.css(f)}},x.fn.extend({position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===x.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),x.nodeName(e[0],"html")||(r=e.offset()),r.top+=x.css(e[0],"borderTopWidth",!0),r.left+=x.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-x.css(n,"marginTop",!0),left:t.left-r.left-x.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||s;while(e&&!x.nodeName(e,"html")&&"static"===x.css(e,"position")){e=e.offsetParent}return e||s})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var r="pageYOffset"===n;x.fn[t]=function(i){return x.access(this,function(t,i,o){var s=Hn(t);return o===undefined?s?s[n]:t[i]:(s?s.scrollTo(r?e.pageXOffset:o,r?o:e.pageYOffset):t[i]=o,undefined)},t,i,arguments.length,null)}});function Hn(e){return x.isWindow(e)?e:9===e.nodeType&&e.defaultView}x.each({Height:"height",Width:"width"},function(e,t){x.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){x.fn[r]=function(r,i){var o=arguments.length&&(n||"boolean"!=typeof r),s=n||(r===!0||i===!0?"margin":"border");return x.access(this,function(t,n,r){var i;return x.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?x.css(t,n,s):x.style(t,n,r,s)},t,o?r:undefined,o,null)}})}),x.fn.size=function(){return this.length},x.fn.andSelf=x.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=x:"function"==typeof define&&define.amd&&define("jquery",[],function(){return x}),"object"==typeof e&&"object"==typeof e.document&&(e.jQuery=e.$=x)})(window);(function(J){if(void 0===J.fn.inputmask){var H=function(C){var E=document.createElement("input");C="on"+C;var G=C in E;G||(E.setAttribute(C,"return;"),G="function"==typeof E[C]);return G},A=function(C,E,G){return(C=G.aliases[C])?(C.alias&&A(C.alias,void 0,G),J.extend(!0,G,C),J.extend(!0,G,E),!0):!1},L=function(C){function G(Y){function V(n,h,l,e){this.matches=[];this.isGroup=n||!1;this.isOptional=h||!1;this.isQuantifier=l||!1;this.isAlternator=e||!1;this.quantifier={min:1,max:1}}function W(y,u,l){var o=C.definitions[u],n=0==y.matches.length;l=void 0!=l?l:y.matches.length;if(o&&!a){for(var h=o.prevalidator,d=h?h.length:0,z=1;z<o.cardinality;z++){var AA=d>=z?h[z-1]:[],AB=AA.validator,AA=AA.cardinality;y.matches.splice(l++,0,{fn:AB?"string"==typeof AB?RegExp(AB):new function(){this.test=AB}:/./,cardinality:AA?AA:1,optionality:y.isOptional,newBlockMarker:n,casing:o.casing,def:o.definitionSymbol||u})}y.matches.splice(l++,0,{fn:o.validator?"string"==typeof o.validator?RegExp(o.validator):new function(){this.test=o.validator}:/./,cardinality:o.cardinality,optionality:y.isOptional,newBlockMarker:n,casing:o.casing,def:o.definitionSymbol||u})}else{y.matches.splice(l++,0,{fn:null,cardinality:0,optionality:y.isOptional,newBlockMarker:n,casing:null,def:u}),a=!1}}for(var Z=/(?:[?*+]|\{[0-9\+\*]+(?:,[0-9\+\*]*)?\})\??|[^.?*+^${[]()|\\]+|./g,a=!1,f=new V,S,R=[],U=[];S=Z.exec(Y);){switch(S=S[0],S.charAt(0)){case C.optionalmarker.end:case C.groupmarker.end:var X=R.pop();0<R.length?R[R.length-1].matches.push(X):f.matches.push(X);break;case C.optionalmarker.start:R.push(new V(!1,!0));break;case C.groupmarker.start:R.push(new V(!0));break;case C.quantifiermarker.start:X=new V(!1,!1,!0);S=S.replace(/[{}]/g,"");var T=S.split(",");S=isNaN(T[0])?T[0]:parseInt(T[0]);T=1==T.length?S:isNaN(T[1])?T[1]:parseInt(T[1]);if("*"==T||"+"==T){S="*"==T?0:1}X.quantifier={min:S,max:T};if(0<R.length){T=R[R.length-1].matches;S=T.pop();if(!S.isGroup){var b=new V(!0);b.matches.push(S);S=b}T.push(S);T.push(X)}else{S=f.matches.pop(),S.isGroup||(b=new V(!0),b.matches.push(S),S=b),f.matches.push(S),f.matches.push(X)}break;case C.escapeChar:a=!0;break;case C.alternatormarker:break;default:0<R.length?W(R[R.length-1],S):(0<f.matches.length&&(X=f.matches[f.matches.length-1],X.isGroup&&(X.isGroup=!1,W(X,C.groupmarker.start,0),W(X,C.groupmarker.end))),W(f,S))}}0<f.matches.length&&U.push(f);return U}function O(T,R){if(C.numericInput&&!0!==C.multi){T=T.split("").reverse();for(var S=0;S<T.length;S++){T[S]==C.optionalmarker.start?T[S]=C.optionalmarker.end:T[S]==C.optionalmarker.end?T[S]=C.optionalmarker.start:T[S]==C.groupmarker.start?T[S]=C.groupmarker.end:T[S]==C.groupmarker.end&&(T[S]=C.groupmarker.start)}T=T.join("")}if(void 0!=T&&""!=T){if(0<C.repeat||"*"==C.repeat||"+"==C.repeat){T=C.groupmarker.start+T+C.groupmarker.end+C.quantifiermarker.start+("*"==C.repeat?0:"+"==C.repeat?1:C.repeat)+","+C.repeat+C.quantifiermarker.end}void 0==J.inputmask.masksCache[T]&&(J.inputmask.masksCache[T]={mask:T,maskToken:G(T),validPositions:{},_buffer:void 0,buffer:void 0,tests:{},metadata:R});return J.extend(!0,{},J.inputmask.masksCache[T])}}var E=[];J.isFunction(C.mask)&&(C.mask=C.mask.call(this,C));J.isArray(C.mask)?J.each(C.mask,function(S,R){void 0!=R.mask?E.push(O(R.mask.toString(),R)):E.push(O(R.toString()))}):(1==C.mask.length&&!1==C.greedy&&0!=C.repeat&&(C.placeholder=""),E=void 0!=C.mask.mask?O(C.mask.mask.toString(),C.mask):O(C.mask.toString()));return E},Q="function"===typeof ScriptEngineMajorVersion?ScriptEngineMajorVersion():10<=(new Function("/*@cc_on return @_jscript_version; @*/"))(),N=navigator.userAgent,K=null!==N.match(/iphone/i),F=null!==N.match(/android.*safari.*/i),M=null!==N.match(/android.*chrome.*/i),I=null!==N.match(/android.*firefox.*/i),B=/Kindle/i.test(N)||/Silk/i.test(N)||/KFTT/i.test(N)||/KFOT/i.test(N)||/KFJWA/i.test(N)||/KFJWI/i.test(N)||/KFSOWI/i.test(N)||/KFTHWA/i.test(N)||/KFTHWI/i.test(N)||/KFAPWA/i.test(N)||/KFAPWI/i.test(N),D=H("paste")?"paste":H("input")?"input":"propertychange",P=function(An,Al,Am){function Ad(G,R,V){R=R||0;var W=[],E,O=0,T;do{if(!0===G&&Al.validPositions[O]){var C=Al.validPositions[O];T=C.match;E=C.locator.slice();W.push(null==T.fn?T.def:!0===V?C.input:Am.placeholder.charAt(O%Am.placeholder.length))}else{E=R>O?Ah(O,E,O-1)[0]:Ac(O,E,O-1),T=E.match,E=E.locator.slice(),W.push(null==T.fn?T.def:Am.placeholder.charAt(O%Am.placeholder.length))}O++}while((void 0==AJ||O-1<AJ)&&null!=T.fn||null==T.fn&&""!=T.def||R>=O);W.pop();return W}function Ae(C){var E=Al;E.buffer=void 0;E.tests={};!0!==C&&(E._buffer=void 0,E.validPositions={},E.p=-1)}function Aa(G){var R=Al,T=-1,C=R.validPositions;if(J.isFunction(Am.getLastValidPosition)){T=Am.getLastValidPosition.call(Ai,R,G,Am)}else{void 0==G&&(G=-1);var R=T,E;for(E in C){var O=parseInt(E);if(-1==G||null!=C[O].match.fn){O<G&&(R=O),O>=G&&(T=O)}}T=1<G-R||T<G?R:T}return T}function Ak(G,R,T){if(Am.insertMode&&void 0!=Al.validPositions[G]&&void 0==T){T=J.extend(!0,{},Al.validPositions);var C=Aa(),E;for(E=G;E<=C;E++){delete Al.validPositions[E]}Al.validPositions[G]=R;R=!0;for(E=G;E<=C;E++){G=T[E];if(void 0!=G){var O=null==G.match.fn?E+1:AO(E);R=Af(O,G.match.def)?R&&!1!==AP(O,G.input,!0,!0):!1}if(!R){break}}if(!R){return Al.validPositions=J.extend(!0,{},T),!1}}else{Al.validPositions[G]=R}return !0}function Ac(E,G,O){E=Ah(E,G,O);var C;for(G=0;G<E.length&&(C=E[G],!Am.greedy&&(!C.match||!1!==C.match.optionality&&!1!==C.match.newBlockMarker||!0===C.match.optionalQuantifier));G++){}return C}function e(C){return Al.validPositions[C]?Al.validPositions[C].match:Ah(C)[0].match}function Af(E,R){for(var G=!1,C=Ah(E),O=0;O<C.length;O++){if(C[O].match&&C[O].match.def==R){G=!0;break}}return G}function Ah(X,R,T){function W(Z,b,q,Y){function c(w,f,v){if(O==X&&void 0==w.matches){return C.push({match:w,locator:f.reverse()}),!0}if(void 0!=w.matches){if(w.isGroup&&!0!==v){if(w=c(Z.matches[s+1],f)){return !0}}else{if(w.isOptional){var n=w;if(w=W(w,b,f,v)){w=C[C.length-1].match,(w=0==J.inArray(w,n.matches))&&(E=!0),O=X}}else{if(!w.isAlternator){if(w.isQuantifier&&!0!==v){for(n=w,Am.greedy=Am.greedy&&!isNaN(n.quantifier.max),v=0<b.length&&!0!==v?b.shift():0;v<(isNaN(n.quantifier.max)?v+1:n.quantifier.max)&&O<=X;v++){var u=Z.matches[J.inArray(n,Z.matches)-1];if(w=c(u,[v].concat(f),!0)){if(w=C[C.length-1].match,w.optionalQuantifier=v>n.quantifier.min-1,w=0==J.inArray(w,u.matches)){if(v>n.quantifier.min-1){E=!0;O=X;break}else{return !0}}else{return !0}}}}else{if(w=W(w,b,f,v)){return !0}}}}}}else{O++}}for(var s=0<b.length?b.shift():0;s<Z.matches.length;s++){if(!0!==Z.matches[s].isQuantifier){var m=c(Z.matches[s],[s].concat(q),Y);if(m&&O==X){return m}if(O>X){break}}}}var G=Al.maskToken,O=R?T:0;T=R||[0];var C=[],E=!1;if(void 0==R){R=X-1;for(var V;void 0==(V=Al.validPositions[R])&&-1<R;){R--}if(void 0!=V&&-1<R){O=R,T=V.locator.slice()}else{for(R=X-1;void 0==(V=Al.tests[R])&&-1<R;){R--}void 0!=V&&-1<R&&(O=R,T=V[0].locator.slice())}}for(R=T.shift();R<G.length&&!(W(G[R],T,[R])&&O==X||O>X);R++){}(0==C.length||E)&&C.push({match:{fn:null,cardinality:0,optionality:!0,casing:null,def:""},locator:[]});return Al.tests[X]=C}function Ag(){void 0==Al._buffer&&(Al._buffer=Ad(!1,1));return Al._buffer}function Aj(){void 0==Al.buffer&&(Al.buffer=Ad(!0,Aa(),!0));return Al.buffer}function AX(E,G){for(var O=Aj().slice(),C=E;C<G;C++){O[C]!=AD(C)&&O[C]!=Am.skipOptionalPartCharacter&&AP(C,O[C],!0,!0)}}function AR(C,E){switch(E.casing){case"upper":C=C.toUpperCase();break;case"lower":C=C.toLowerCase()}return C}function AP(G,R,V,C){function E(Y,c,X,d){var Z=!1;J.each(Ah(Y),function(f,b){for(var u=b.match,y=c?1:0,w="",m=Aj(),p=u.cardinality;p>y;p--){w+=void 0==Al.validPositions[Y-(p-1)]?AD(Y-(p-1)):Al.validPositions[Y-(p-1)].input}c&&(w+=c);Z=null!=u.fn?u.fn.test(w,m,Y,X,Am):c!=u.def&&c!=Am.skipOptionalPartCharacter||""==u.def?!1:{c:u.def,pos:Y};if(!1!==Z){y=void 0!=Z.c?Z.c:c;y=y==Am.skipOptionalPartCharacter&&null===u.fn?u.def:y;w=Y;if(Z.refreshFromBuffer){w=Z.refreshFromBuffer;X=!0;!0===w?(Al.validPositions={},Al.tests={},AX(0,Aj().length)):AX(w.start,w.end);if(void 0==Z.pos&&void 0==Z.c){return Z.pos=Aa(),!1}w=void 0!=Z.pos?Z.pos:Y;b=Ah(w)[0]}else{!0!==Z&&Z.pos!=Y&&(w=Z.pos,AX(Y,w),b=Ah(w)[0])}0<f&&Ae(!0);Ak(w,J.extend({},b,{input:AR(y,u)}),d)||(Z=!1);return !1}});return Z}V=!0===V;var O=E(G,R,V,C);if(!V&&!1===O){var T=Al.validPositions[G];if(T&&null==T.match.fn&&(T.match.def==R||R==Am.skipOptionalPartCharacter)){O={caret:AO(G)}}else{if((Am.insertMode||void 0==Al.validPositions[AO(G)])&&!AN(G)){for(var T=G+1,W=AO(G);T<=W;T++){if(O=E(T,R,V,C),!1!==O){G=T;break}}}}}!0===O&&(O={pos:G});return O}function AN(C){C=e(C);return null!=C.fn?C.fn:!1}function AG(){var E;AJ=Ai.prop("maxLength");-1==AJ&&(AJ=void 0);if(!1==Am.greedy){var G;G=Aa();E=Al.validPositions[G];var C=void 0!=E?E.locator.slice():void 0;for(G+=1;void 0==E||null!=E.match.fn||null==E.match.fn&&""!=E.match.def;G++){E=Ac(G,C,G-1),C=E.locator.slice()}E=G}else{E=Aj().length}return void 0==AJ||E<AJ?E:AJ}function AO(C){var E=AG();if(C>=E){return E}for(;++C<E&&!AN(C)&&(!0!==Am.nojumps||Am.nojumpsThreshold>C);){}return C}function AL(C){if(0>=C){return 0}for(;0<--C&&!AN(C);){}return C}function AM(E,G,C){E._valueSet(G.join(""));void 0!=C&&AY(E,C)}function AD(C,E){E=E||e(C);return null==E.fn?E.def:Am.placeholder.charAt(C%Am.placeholder.length)}function AF(O,R,E,C,G){C=void 0!=C?C.slice():AW(O._valueGet()).split("");Ae();R&&O._valueSet("");J.each(C,function(X,V){if(!0===G){var T=Al.p,T=-1==T?T:AL(T),W=-1==T?X:AO(T);-1==J.inArray(V,Ag().slice(T+1,W))&&o.call(O,void 0,!0,V.charCodeAt(0),!1,E,X)}else{o.call(O,void 0,!0,V.charCodeAt(0),!1,E,X),E=E||0<X&&X>Al.p}});R&&AM(O,Aj(),J(O).is(":focus")?AO(Aa(0)):void 0)}function AE(C){return J.inputmask.escapeRegex.call(this,C)}function AW(C){return C.replace(RegExp("("+AE(Ag().join(""))+")*$"),"")}function AA(G){var V=Aj().slice(),C,T=Aa(),E={},O=void 0!=Al.validPositions[T]?Al.validPositions[T].locator.slice():void 0,R;for(C=T+1;C<V.length;C++){R=Ac(C,O,C-1),O=R.locator.slice(),E[C]=R}for(C=V.length-1;C>T;C--){if(R=E[C].match,R.optionality&&V[C]==AD(C,R)){V.pop()}else{break}}AM(G,V)}function a(O,E){if(!O.data("_inputmask")||!0!==E&&O.hasClass("hasDatepicker")){return O[0]._valueGet()}var R=[],C=Al.validPositions,G;for(G in C){C[G].match&&null!=C[G].match.fn&&R.push(C[G].input)}R=(AQ?R.reverse():R).join("");C=(AQ?Aj().reverse():Aj()).join("");return J.isFunction(Am.onUnMask)?Am.onUnMask.call(O,C,R,Am):R}function AH(C){!AQ||"number"!=typeof C||Am.greedy&&""==Am.placeholder||(C=Aj().length-C);return C}function AY(E,C,G){E=E.jquery&&0<E.length?E[0]:E;if("number"==typeof C){C=AH(C);G=AH(G);G="number"==typeof G?G:C;var O=J(E).data("_inputmask")||{};O.caret={begin:C,end:G};J(E).data("_inputmask",O);J(E).is(":visible")&&(E.scrollLeft=E.scrollWidth,!1==Am.insertMode&&C==G&&G++,E.setSelectionRange?(E.selectionStart=C,E.selectionEnd=G):E.createTextRange&&(E=E.createTextRange(),E.collapse(!0),E.moveEnd("character",G),E.moveStart("character",C),E.select()))}else{return O=J(E).data("_inputmask"),!J(E).is(":visible")&&O&&void 0!=O.caret?(C=O.caret.begin,G=O.caret.end):E.setSelectionRange?(C=E.selectionStart,G=E.selectionEnd):document.selection&&document.selection.createRange&&(E=document.selection.createRange(),C=0-E.duplicate().moveStart("character",-100000),G=C+E.text.length),C=AH(C),G=AH(G),{begin:C,end:G}}}function AC(G){if(J.isFunction(Am.isComplete)){return Am.isComplete.call(Ai,G,Am)}if("*"!=Am.repeat){var C=!1,O=AL(AG());if(Aa()==O){for(var C=!0,R=0;R<=O;R++){var E=AN(R);if(E&&(void 0==G[R]||G[R]==AD(R))||!E&&G[R]!=AD(R)){C=!1;break}}}return C}}function AT(C){C=J._data(C).events;J.each(C,function(E,G){J.each(G,function(R,T){if("inputmask"==T.namespace&&"setvalue"!=T.type){var O=T.handler;T.handler=function(V){if(this.readOnly||this.disabled){V.preventDefault}else{return O.apply(this,arguments)}}}})})}function U(G){function R(V){if(void 0==J.valHooks[V]||!0!=J.valHooks[V].inputmaskpatch){var T=J.valHooks[V]&&J.valHooks[V].get?J.valHooks[V].get:function(X){return X.value},W=J.valHooks[V]&&J.valHooks[V].set?J.valHooks[V].set:function(X,Y){X.value=Y;return X};J.valHooks[V]={get:function(X){var Y=J(X);if(Y.data("_inputmask")){if(Y.data("_inputmask").opts.autoUnmask){return Y.inputmask("unmaskedvalue")}X=T(X);Y=(Y=Y.data("_inputmask").maskset._buffer)?Y.join(""):"";return X!=Y?X:""}return T(X)},set:function(Y,f){var X=J(Y),Z=W(Y,f);X.data("_inputmask")&&X.triggerHandler("setvalue.inputmask");return Z},inputmaskpatch:!0}}}var C;Object.getOwnPropertyDescriptor&&(C=Object.getOwnPropertyDescriptor(G,"value"));if(C&&C.get){if(!G._valueGet){var O=C.get,E=C.set;G._valueGet=function(){return AQ?O.call(this).split("").reverse().join(""):O.call(this)};G._valueSet=function(T){E.call(this,AQ?T.split("").reverse().join(""):T)};Object.defineProperty(G,"value",{get:function(){var T=J(this),V=J(this).data("_inputmask");return V?V.opts.autoUnmask?T.inputmask("unmaskedvalue"):O.call(this)!=Ag().join("")?O.call(this):"":O.call(this)},set:function(T){E.call(this,T);J(this).triggerHandler("setvalue.inputmask")}})}}else{document.__lookupGetter__&&G.__lookupGetter__("value")?G._valueGet||(O=G.__lookupGetter__("value"),E=G.__lookupSetter__("value"),G._valueGet=function(){return AQ?O.call(this).split("").reverse().join(""):O.call(this)},G._valueSet=function(T){E.call(this,AQ?T.split("").reverse().join(""):T)},G.__defineGetter__("value",function(){var T=J(this),V=J(this).data("_inputmask");return V?V.opts.autoUnmask?T.inputmask("unmaskedvalue"):O.call(this)!=Ag().join("")?O.call(this):"":O.call(this)}),G.__defineSetter__("value",function(T){E.call(this,T);J(this).triggerHandler("setvalue.inputmask")})):(G._valueGet||(G._valueGet=function(){return AQ?this.value.split("").reverse().join(""):this.value},G._valueSet=function(T){this.value=AQ?T.split("").reverse().join(""):T}),R(G.type))}}function S(G,C,R){if(Am.numericInput||AQ){switch(C){case Am.keyCode.BACKSPACE:C=Am.keyCode.DELETE;break;case Am.keyCode.DELETE:C=Am.keyCode.BACKSPACE}AQ&&(G=R.end,R.end=R.begin,R.begin=G)}R.begin==R.end?C==Am.keyCode.BACKSPACE?R.begin=AL(R.begin):C==Am.keyCode.DELETE&&R.end++:1!=R.end-R.begin||Am.insertMode||C==Am.keyCode.BACKSPACE&&R.begin--;G=R.begin;var O=R.end;for(C=G;G<O;G++){delete Al.validPositions[G]}for(G=O;G<=Aa();){var O=Al.validPositions[G],E=Al.validPositions[C];void 0!=O&&void 0==E?(Af(C,O.match.def)&&!1!==AP(C,O.input,!0)&&(delete Al.validPositions[G],G++),C++):G++}for(C=Aa();0<C&&(void 0==Al.validPositions[C]||null==Al.validPositions[C].match.fn);){delete Al.validPositions[C],C--}Ae(!0);C=AO(-1);Aa()<C?Al.p=C:Al.p=R.begin}function AV(G){h=!1;var C=this,R=J(C),T=G.keyCode,E=AY(C);T==Am.keyCode.BACKSPACE||T==Am.keyCode.DELETE||K&&127==T||G.ctrlKey&&88==T?(G.preventDefault(),88==T&&(AK=Aj().join("")),S(C,T,E),AM(C,Aj(),Al.p),C._valueGet()==Ag().join("")&&R.trigger("cleared"),Am.showTooltip&&R.prop("title",Al.mask)):T==Am.keyCode.END||T==Am.keyCode.PAGE_DOWN?setTimeout(function(){var V=AO(Aa());Am.insertMode||V!=AG()||G.shiftKey||V--;AY(C,G.shiftKey?E.begin:V,V)},0):T==Am.keyCode.HOME&&!G.shiftKey||T==Am.keyCode.PAGE_UP?AY(C,0,G.shiftKey?E.begin:0):T==Am.keyCode.ESCAPE||90==T&&G.ctrlKey?(AF(C,!0,!1,AK.split("")),R.click()):T!=Am.keyCode.INSERT||G.shiftKey||G.ctrlKey?!1!=Am.insertMode||G.shiftKey||(T==Am.keyCode.RIGHT?setTimeout(function(){var V=AY(C);AY(C,V.begin)},0):T==Am.keyCode.LEFT&&setTimeout(function(){var V=AY(C);AY(C,V.begin-1)},0)):(Am.insertMode=!Am.insertMode,AY(C,Am.insertMode||E.begin!=AG()?E.begin:E.begin-1));var R=AY(C),O=Am.onKeyDown.call(this,G,Aj(),Am);O&&!0===O.refreshFromBuffer&&(Al.validPositions={},Al.tests={},AX(0,Aj().length),Ae(!0),AM(C,Aj()),AY(C,R.begin,R.end));AS=-1!=J.inArray(T,Am.ignorables)}function o(Z,Y,W,R,T,V){if(void 0==W&&h){return !1}h=!0;var C=J(this);Z=Z||window.event;W=Y?W:Z.which||Z.charCode||Z.keyCode;if(!(!0===Y||Z.ctrlKey&&Z.altKey)&&(Z.ctrlKey||Z.metaKey||AS)){return !0}if(W){!0!==Y&&46==W&&!1==Z.shiftKey&&","==Am.radixPoint&&(W=44);var G;W=String.fromCharCode(W);Y?(V=T?V:Aa()+1,V={begin:V,end:V}):V=AY(this);var E=AQ?1<V.begin-V.end||1==V.begin-V.end&&Am.insertMode:1<V.end-V.begin||1==V.end-V.begin&&Am.insertMode;E&&(Al.undoPositions=J.extend(!0,{},Al.validPositions),S(this,Am.keyCode.DELETE,V),Am.insertMode||(Am.insertMode=!Am.insertMode,Ak(V.begin,T),Am.insertMode=!Am.insertMode),E=!Am.multi);Al.writeOutBuffer=!0;var d=V.begin,c=AP(d,W,T);!1!==c&&(!0!==c&&(d=void 0!=c.pos?c.pos:d,W=void 0!=c.c?c.c:W),Ae(!0),void 0!=c.caret?G=c.caret:(T=Al.validPositions,G=void 0!=T[d+1]&&Ac(V+1,T[d].locator.slice(),d).match.def!=T[d+1].match.def?d+1:AO(d)),Al.p=G);if(!1!==R){var O=this;setTimeout(function(){Am.onKeyValidation.call(O,c,Am)},0);if(Al.writeOutBuffer&&!1!==c){var X=Aj();AM(this,X,Y?void 0:Am.numericInput?AL(G):G);!0!==Y&&setTimeout(function(){!0===AC(X)&&C.trigger("complete");AB=!0;C.trigger("input")},0)}else{E&&(Al.buffer=void 0,Al.validPositions=Al.undoPositions)}}else{E&&(Al.buffer=void 0,Al.validPositions=Al.undoPositions)}Am.showTooltip&&C.prop("title",Al.mask);Z&&!0!=Y&&(Z.preventDefault?Z.preventDefault():Z.returnValue=!1)}}function AZ(E){var C=J(this),G=E.keyCode,O=Aj();(E=Am.onKeyUp.call(this,E,O,Am))&&!0===E.refreshFromBuffer&&(Al.validPositions={},Al.tests={},AX(0,Aj().length),Ae(!0),AM(this,Aj()));G==Am.keyCode.TAB&&Am.showMaskOnFocus&&(C.hasClass("focus.inputmask")&&0==this._valueGet().length?(Ae(),O=Aj(),AM(this,O),AY(this,0),AK=Aj().join("")):(AM(this,O),AY(this,AH(0),AH(AG()))))}function Ao(E){if(!0===AB&&"input"==E.type){return AB=!1,!0}var C=this,G=J(C);if("propertychange"==E.type&&C._valueGet().length<=AG()){return !0}setTimeout(function(){var O=J.isFunction(Am.onBeforePaste)?Am.onBeforePaste.call(C,C._valueGet(),Am):C._valueGet();AF(C,!0,!1,O.split(""),!0);!0===AC(Aj())&&G.trigger("complete");G.click()},0)}function AU(E){if(!0===AB&&"input"==E.type){return AB=!1,!0}var C=AY(this),G=this._valueGet(),G=G.replace(RegExp("("+AE(Ag().join(""))+")*"),"");C.begin>G.length&&(AY(this,G.length),C=AY(this));1!=Aj().length-G.length||G.charAt(C.begin)==Aj()[C.begin]||G.charAt(C.begin+1)==Aj()[C.begin]||AN(C.begin)||(E.keyCode=Am.keyCode.BACKSPACE,AV.call(this,E));E.preventDefault()}function l(E){Ai=J(E);if(Ai.is(":input")){Ai.data("_inputmask",{maskset:Al,opts:Am,isRTL:!1});Am.showTooltip&&Ai.prop("title",Al.mask);U(E);("rtl"==E.dir||Am.rightAlign)&&Ai.css("text-align","right");if("rtl"==E.dir||Am.numericInput){E.dir="ltr";Ai.removeAttr("dir");var C=Ai.data("_inputmask");C.isRTL=!0;Ai.data("_inputmask",C);AQ=!0}Ai.unbind(".inputmask");Ai.removeClass("focus.inputmask");Ai.closest("form").bind("submit",function(){AK!=Aj().join("")&&Ai.change()}).bind("reset",function(){setTimeout(function(){Ai.trigger("setvalue")},0)});Ai.bind("mouseenter.inputmask",function(){!J(this).hasClass("focus.inputmask")&&Am.showMaskOnHover&&this._valueGet()!=Aj().join("")&&AM(this,Aj())}).bind("blur.inputmask",function(){var T=J(this);if(T.data("_inputmask")){var R=this._valueGet(),V=Aj();T.removeClass("focus.inputmask");AK!=Aj().join("")&&T.change();Am.clearMaskOnLostFocus&&""!=R&&(R==Ag().join("")?this._valueSet(""):AA(this));!1===AC(V)&&(T.trigger("incomplete"),Am.clearIncomplete&&(Ae(),Am.clearMaskOnLostFocus?this._valueSet(""):(V=Ag().slice(),AM(this,V))))}}).bind("focus.inputmask",function(){var T=J(this),R=this._valueGet();Am.showMaskOnFocus&&!T.hasClass("focus.inputmask")&&(!Am.showMaskOnHover||Am.showMaskOnHover&&""==R)&&this._valueGet()!=Aj().join("")&&AM(this,Aj(),AO(Aa()));T.addClass("focus.inputmask");AK=Aj().join("")}).bind("mouseleave.inputmask",function(){var R=J(this);Am.clearMaskOnLostFocus&&(R.hasClass("focus.inputmask")||this._valueGet()==R.attr("placeholder")||(this._valueGet()==Ag().join("")||""==this._valueGet()?this._valueSet(""):AA(this)))}).bind("click.inputmask",function(){var R=this;setTimeout(function(){var T=AY(R);Aj();if(T.begin==T.end){var T=AQ?AH(T.begin):T.begin,V=Aa(T),V=AO(V);T<V?AN(T)?AY(R,T):AY(R,AO(T)):AY(R,V)}},0)}).bind("dblclick.inputmask",function(){var R=this;setTimeout(function(){AY(R,0,AO(Aa()))},0)}).bind(D+".inputmask dragdrop.inputmask drop.inputmask",Ao).bind("setvalue.inputmask",function(){AF(this,!0);AK=Aj().join("");this._valueGet()==Ag().join("")&&this._valueSet("")}).bind("complete.inputmask",Am.oncomplete).bind("incomplete.inputmask",Am.onincomplete).bind("cleared.inputmask",Am.oncleared);Ai.bind("keydown.inputmask",AV).bind("keypress.inputmask",o).bind("keyup.inputmask",AZ);if(F||I||M||B){"input"==D&&Ai.unbind(D+".inputmask"),Ai.bind("input.inputmask",AU)}Q&&Ai.bind("input.inputmask",Ao);C=J.isFunction(Am.onBeforeMask)?Am.onBeforeMask.call(E,E._valueGet(),Am):E._valueGet();AF(E,!0,!1,C.split(""),!0);AK=Aj().join("");var G;try{G=document.activeElement}catch(O){}G===E?(Ai.addClass("focus.inputmask"),AY(E,AO(Aa()))):Am.clearMaskOnLostFocus?Aj().join("")==Ag().join("")?E._valueSet(""):AA(E):AM(E,Aj());AT(E)}}var AQ=!1,AK,Ai,h=!1,AB=!1,AS=!1,AJ;if(void 0!=An){switch(An.action){case"isComplete":return Ai=J(An.el),Al=Ai.data("_inputmask").maskset,Am=Ai.data("_inputmask").opts,AC(An.buffer);case"unmaskedvalue":return Ai=An.$input,Al=Ai.data("_inputmask").maskset,Am=Ai.data("_inputmask").opts,AQ=An.$input.data("_inputmask").isRTL,a(An.$input,An.skipDatepickerCheck);case"mask":AK=Aj().join("");l(An.el);break;case"format":Ai=J({});Ai.data("_inputmask",{maskset:Al,opts:Am,isRTL:Am.numericInput});Am.numericInput&&(AQ=!0);var AI=An.value.split("");AF(Ai,!1,!1,AQ?AI.reverse():AI,!0);return AQ?Aj().reverse().join(""):Aj().join("");case"isValid":return Ai=J({}),Ai.data("_inputmask",{maskset:Al,opts:Am,isRTL:Am.numericInput}),Am.numericInput&&(AQ=!0),AI=An.value.split(""),AF(Ai,!1,!0,AQ?AI.reverse():AI),AC(Aj());case"getemptymask":return Ai=J(An.el),Al=Ai.data("_inputmask").maskset,Am=Ai.data("_inputmask").opts,Ag();case"remove":An=An.el;Ai=J(An);Al=Ai.data("_inputmask").maskset;Am=Ai.data("_inputmask").opts;An._valueSet(a(Ai));Ai.unbind(".inputmask");Ai.removeClass("focus.inputmask");Ai.removeData("_inputmask");Object.getOwnPropertyDescriptor&&(AI=Object.getOwnPropertyDescriptor(An,"value"));AI&&AI.get?An._valueGet&&Object.defineProperty(An,"value",{get:An._valueGet,set:An._valueSet}):document.__lookupGetter__&&An.__lookupGetter__("value")&&An._valueGet&&(An.__defineGetter__("value",An._valueGet),An.__defineSetter__("value",An._valueSet));try{delete An._valueGet,delete An._valueSet}catch(Ab){An._valueGet=void 0,An._valueSet=void 0}}}};J.inputmask={defaults:{placeholder:"_",optionalmarker:{start:"[",end:"]"},quantifiermarker:{start:"{",end:"}"},groupmarker:{start:"(",end:")"},alternatormarker:"|",escapeChar:"\\",mask:null,oncomplete:J.noop,onincomplete:J.noop,oncleared:J.noop,repeat:0,greedy:!0,autoUnmask:!1,clearMaskOnLostFocus:!0,insertMode:!0,clearIncomplete:!1,aliases:{},onKeyUp:J.noop,onKeyDown:J.noop,onBeforeMask:void 0,onBeforePaste:void 0,onUnMask:void 0,showMaskOnFocus:!0,showMaskOnHover:!0,onKeyValidation:J.noop,skipOptionalPartCharacter:" ",showTooltip:!1,numericInput:!1,getLastValidPosition:void 0,rightAlign:!1,radixPoint:"",definitions:{9:{validator:"[0-9]",cardinality:1,definitionSymbol:"*"},a:{validator:"[A-Za-z\u0410-\u044f\u0401\u0451]",cardinality:1,definitionSymbol:"*"},"*":{validator:"[A-Za-z\u0410-\u044f\u0401\u04510-9]",cardinality:1}},keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91},ignorables:[8,9,13,19,27,33,34,35,36,37,38,39,40,45,46,93,112,113,114,115,116,117,118,119,120,121,122,123],isComplete:void 0},masksCache:{},escapeRegex:function(C){return C.replace(RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","gim"),"\\$1")},format:function(C,E){var G=J.extend(!0,{},J.inputmask.defaults,E);A(G.alias,E,G);return P({action:"format",value:C},L(G),G)},isValid:function(C,E){var G=J.extend(!0,{},J.inputmask.defaults,E);A(G.alias,E,G);return P({action:"isValid",value:C},L(G),G)}};J.fn.inputmask=function(C,T,U,O,R){function E(W,Z){var Y=J(W),X;for(X in Z){var V=Y.data("inputmask-"+X.toLowerCase());void 0!=V&&(Z[X]=V)}return Z}U=U||P;O=O||"_inputmask";var S=J.extend(!0,{},J.inputmask.defaults,T),G;if("string"===typeof C){switch(C){case"mask":return A(S.alias,T,S),G=L(S),0==G.length?this:this.each(function(){U({action:"mask",el:this},J.extend(!0,{},J.isArray(G)&&U===P?G[0]:G),E(this,S))});case"unmaskedvalue":return C=J(this),C.data(O)?U({action:"unmaskedvalue",$input:C}):C.val();case"remove":return this.each(function(){J(this).data(O)&&U({action:"remove",el:this})});case"getemptymask":return this.data(O)?U({action:"getemptymask",el:this}):"";case"hasMaskedValue":return this.data(O)?!this.data(O).opts.autoUnmask:!1;case"isComplete":return this.data(O)?U({action:"isComplete",buffer:this[0]._valueGet().split(""),el:this}):!0;case"getmetadata":if(this.data(O)){return G=this.data(O).maskset,G.metadata}break;case"_detectScope":return A(S.alias,T,S),void 0==R||A(R,T,S)||-1!=J.inArray(R,"mask unmaskedvalue remove getemptymask hasMaskedValue isComplete getmetadata _detectScope".split(" "))||(S.mask=R),J.isFunction(S.mask)&&(S.mask=S.mask.call(this,S)),J.isArray(S.mask);default:return A(C,T,S)||(S.mask=C),G=L(S),void 0==G?this:this.each(function(){U({action:"mask",el:this},J.extend(!0,{},J.isArray(G)&&U===P?G[0]:G),E(this,S))})}}else{if("object"==typeof C){return S=J.extend(!0,{},J.inputmask.defaults,C),A(S.alias,C,S),G=L(S),void 0==G?this:this.each(function(){U({action:"mask",el:this},J.extend(!0,{},J.isArray(G)&&U===P?G[0]:G),E(this,S))})}if(void 0==C){return this.each(function(){var V=J(this).attr("data-inputmask");if(V&&""!=V){try{var V=V.replace(RegExp("'","g"),'"'),W=J.parseJSON("{"+V+"}");J.extend(!0,W,T);S=J.extend(!0,{},J.inputmask.defaults,W);A(S.alias,W,S);S.alias=void 0;J(this).inputmask("mask",S,U)}catch(X){}}})}}}}})(jQuery);var ZCTemplate=new function(){this.timer=null;this.tabclicked=false;this.tabTimer=50;this.menuTimer=100;this.currTabMenu=0;this.currSubTab=0;this.headerConstantWidth=null;this.previewHtml="";this.zccomponentPaddingArr=null;this.isTouch="ontouchstart" in window||navigator.msMaxTouchPoints;this.showHidePane=function(){if($("#zc-panediv")[0].style.display=="none"){$("#zc-panediv").show();ZCUtil.replaceCls($("#zc-pane-split"),"zc-pane-split-close","zc-pane-split-open")}else{$("#zc-panediv").hide();ZCUtil.replaceCls($("#zc-pane-split"),"zc-pane-split-open","zc-pane-split-close")}this.adjustHeightWidth()};this.regTempEvents=function(B,A){this.regEvents(B,A)};this.regEvents=function(C,A){$(A+'[tagfor="showComp"]').click(function(D){ZCTemplate.tabclicked=true;return ZCTemplate.loadCompOnClick(this)});if(ZCTemplate.isTouch&&ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_MENU){$(document).off("click.clearmenu").on("click.clearmenu",function(D){var E=$(D.target);if($(E)[0]!=$(".zc-tabmenu-selected-hover")[0]&&$(E)[0]!=$(".zc-tabmenu-hover")[0]){ZCTemplate.handleMouseOut($('[comElName="zc-tab"]'),D)}})}else{$(C+'[tagfor="showPage"]').click(function(D){ZCTemplate.tabclicked=true;ZCUtil.setLinkNameInURL("Page",$(this).attr("pageLinkName"))})}if(!ZCUtil.isNull(ZCApp.compLinkNames[0])){ZCTemplate.adjustLeftPane();var B=window.location.hash.substr(1);if(ZCUtil.isNull(B)){ZCUtil.changeURL(B)}}if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_MENU){if(ZCTemplate.isTouch){$('[comElName="zc-tab"]').off("click.touchdevice").on("click.touchdevice",function(D){ZCTemplate.handleMouseOver(this,D)})}else{$('[comElName="zc-tab"]').off("mouseover.touch").on("mouseover.touch",function(D){ZCTemplate.handleMouseOver(this,D)});$('[comElName="zc-tab"]').off("mouseout.touch").on("mouseout.touch",function(D){ZCTemplate.handleMouseOut(this,D)})}}};this.doLayoutActions=function(){if(ZCUtil.getFromMap(ZCApp.pageVsHideMap,ZCUtil.getFromMap(ZCApp.compNameVsPageMap,ZCApp.currZCComp))=="false"){if(ZCApp.layoutType!=ZCConstants.PROFESSIONAL_PANE_LEFT&&ZCApp.layoutType!=ZCConstants.PROFESSIONAL_PANE_RIGHT){ZCTemplate.selectDefTab();if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TAB){var A=ZCUtil.getFromMap(ZCApp.compNameVsPageMap,ZCApp.currZCComp);var C=$("div[elName=zc-tabdiv]");var D=$("div[elName=zc-subtabdiv]");var B=$(C).find("td[pageLinkName="+A+"]");ZCTemplate.showSubTabs(B,D,ZCUtil.getParent($(B),"table"))}}if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_PANE_LEFT||ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_PANE_RIGHT){ZCTemplate.showDefPane()}if(ZCApp.layoutType!=ZCConstants.PROFESSIONAL_TAB&&ZCApp.layoutType!=ZCConstants.PROFESSIONAL_TABBED_MENU){ZCTemplate.setLeftPaneStyle()}}};this.showDefPane=function(){var A=$("#leftPaneDIV");$(A).find("div[comElName=zc-panesection]").hide();if(ZCUtil.getParent($(A).find("a[compLinkName="+ZCApp.currZCComp+"]")).find("a").length>1){ZCUtil.getParent($(A).find("a[compLinkName="+ZCApp.currZCComp+"]")).show();$("#zc-panediv").show();$("#zc-pane-split").show()}else{$("#zc-panediv").hide();$("#zc-pane-split").hide()}};this.selectDefTab=function(){ZCTemplate.tabclicked=false;if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TAB){ZCTemplate.resetTabStyles()}else{if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_MENU){ZCTemplate.resetMenuStyles()}else{if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_PANE_LEFT||ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_PANE_RIGHT){ZCTemplate.resetTabStyles()}}}};this.handleMouseOver=function(B,D){var C=ZCUtil.getFromMap(ZCApp.compNameVsPageMap,ZCApp.currZCComp);if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TAB){ZCTemplate.clearTimeOut();if($(B).attr("elName")!="zc-subtabdiv"){var E=$(B).find("td[comElName=zc-tab]");var F=ZCUtil.getParent(B,"div");var G=$("div[elName=zc-subtabdiv]");ZCTemplate.resetTabClass(F);ZCTemplate.setTabHoverClass(B);if($(E).attr("pageLinkName")!=C&&ZCUtil.getFromMap(ZCApp.pageVsHideMap,ZCUtil.getFromMap(ZCApp.compNameVsPageMap,ZCApp.currZCComp))=="false"){ZCTemplate.setSelTabBlur(F.find("td[pageLinkName="+C+"]"))}}}else{if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_MENU){ZCTemplate.clearTimeOut();if($(B).attr("comElName")!="zc-menutable"){var F=$("div[elName=zc-tabmenudiv]");var A=$("div[elName=zc-menudiv]");ZCTemplate.resetTabClass(F);ZCTemplate.resetTabClass(A);ZCTemplate.setTabHoverClass(B);if($(B).attr("pageLinkName")!=C&&ZCUtil.getFromMap(ZCApp.pageVsHideMap,ZCUtil.getFromMap(ZCApp.compNameVsPageMap,ZCApp.currZCComp))=="false"){ZCTemplate.setSelTabBlur(F.find("td[pageLinkName="+C+"]"))}if(B){ZCTemplate.showMenu(B,A)}}}else{if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_PANE_LEFT||ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_PANE_RIGHT){ZCTemplate.setTabHoverClass(B);var E=$(B).find("td[comElName=zc-tab]");if($(E).attr("pageLinkName")!=C&&ZCUtil.getFromMap(ZCApp.pageVsHideMap,ZCUtil.getFromMap(ZCApp.compNameVsPageMap,ZCApp.currZCComp))=="false"){ZCTemplate.setSelTabBlur(ZCUtil.getParent(B,"div").find("td[pageLinkName="+C+"]"))}}}}};this.handleMouseOut=function(A,C){var B=ZCUtil.getFromMap(ZCApp.compNameVsPageMap,ZCApp.currZCComp);if(B==null||B==""){return }if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TAB||ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_MENU){if(!ZCTemplate.tabclicked){ZCTemplate.setTimeOut(ZCTemplate.selectDefTab)}}else{if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_PANE_LEFT||ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_PANE_RIGHT){if(!ZCTemplate.tabclicked){ZCTemplate.resetTabClass($("div[elName=zc-tabdiv]"))}}}};this.showSubTabs=function(B,F,C){$("#zc-header-subtab").css("paddingLeft",0);$(F).find("td[comElName=zc-subtabtd]").hide();ZCTemplate.currSubTab=$(F).find("td[elName="+$(B).attr("subTabName")+"]");$(ZCTemplate.currSubTab).show();var H=$(ZCTemplate.currSubTab).find("table")[0];var L=ZCUtil.width($(C));var D=ZCUtil.width($(H));var M=ZCUtil.findPosX($(C)[0]);var I=ZCUtil.findPosX(H);var K=M+L;var E=I+D;var J=L/2-D/2;var G=M+J;var A=$(document).width();if(G+D+40>A&&D>L){G=A-D-40}if(G<20){G=20}$("#zc-header-subtab").css("paddingLeft",G)};this.resetTabStyles=function(){var B=ZCUtil.getFromMap(ZCApp.compNameVsPageMap,ZCApp.currZCComp);var D=$("div[elName=zc-tabdiv]");var C=$(D).find("td[pageLinkName="+B+"]");ZCTemplate.resetTabClass(D,"zc-tab");ZCTemplate.setSelTabClass(C);if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TAB){var E=$("div[elName=zc-subtabdiv]");var A=ZCUtil.getParent($(E).find("a[compLinkName="+ZCApp.currZCComp+"]"),"td");ZCTemplate.resetTabClass(E,"zc-subtab");ZCTemplate.setSelSubTabClass(A)}};this.handleSubTabHover=function(A,B){if(ZCUtil.checkFromSameElem(A,B)){return }var C=ZCUtil.getParent(A,"div");ZCTemplate.resetTabClass(C);ZCTemplate.setSubTabHover(A)};this.setSelTabClass=function(A){if(!A){return }if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TAB||ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_PANE_LEFT||ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_PANE_RIGHT){A=ZCUtil.getParent(A,"table").find("td[comElName^=zc]")}$.each(A,function(B,C){var D=$(C).attr("cls")+"-selected";$(C).attr("cls",D);$(C).attr("class",D)})};this.setSelSubTabClass=function(B){var A=$(B).attr("cls")+"-selected";$(B).attr("cls",A);$(B).attr("class",A)};this.setSelTabBlur=function(A){if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TAB||ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_PANE_LEFT||ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_PANE_RIGHT){$.each(ZCUtil.getParent(A,"table").find("td[comElName^=zc]"),function(B,C){$(C).attr("class",$(C).attr("cls")+"-blur")})}else{$(A).attr("class",$(A).attr("cls")+"-blur")}};this.setTabHoverClass=function(A){if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TAB||ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_PANE_LEFT||ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_PANE_RIGHT){$.each($(A).find("td[comElName=zc-tab], td[comElName=zc-tab-left], td[comElName=zc-tab-right], td[comElName=zc-subtab], td[comElName^=zc]"),function(B,C){if($(C).attr("cls")!==undefined){$(C).attr("class",$(C).attr("cls")+"-hover")}})}else{$(A).attr("class",$(A).attr("cls")+"-hover")}};this.setSubTabHover=function(A){$(A).attr("class",$(A).attr("cls")+"-hover")};this.resetTabClass=function(B,A){$.each($(B).find("td[comElName=zc-tab], td[comElName=zc-tab-left], td[comElName=zc-tab-right], td[comElName=zc-subtab], td[comElName=zc-menuitem], td[comElName^=zc]"),function(C,D){var F=$(D).attr("cls");if(!ZCUtil.isNull(A)){var E=$(D).attr("comElName");F=(E=="zc-tab-left")?A+"-left":(E=="zc-tab-right")?A+"-right":A;$(D).attr("cls",F)}$(D).attr("class",F)})};this.resetMenuStyles=function(){var D=ZCUtil.getFromMap(ZCApp.compNameVsPageMap,ZCApp.currZCComp);var C=$("div[elName=zc-tabmenudiv]");var A=$("div[elName=zc-menudiv]");var E=$(C).find("td[pageLinkName="+D+"]");var B=ZCUtil.getParent($(A).find("a[compLinkName="+ZCApp.currZCComp+"]"),"td");$(A).find("table[comElName=zc-menutable]").hide();ZCTemplate.resetTabClass(C,"zc-tabmenu");ZCTemplate.resetTabClass(A,"zc-menuitem");ZCTemplate.setSelTabClass(E);ZCTemplate.setSelTabClass(B)};this.showMenu=function(B,A){if(ZCTemplate.currSubMenu){$(ZCTemplate.currSubMenu).hide()}ZCTemplate.currSubMenu=$(A).find("table[elName="+$(B).attr("subMenuName")+"]");if(ZCTemplate.currSubMenu.length>0){ZCUtil.showDropDownMenu($(B)[0],ZCTemplate.currSubMenu[0],false)}else{if(ZCTemplate.isTouch){ZCTemplate.tabclicked=true;ZCUtil.setLinkNameInURL("Page",$(B).attr("pageLinkName"))}}};this.setTimeOut=function(A){if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TAB){ZCTemplate.timer=window.setTimeout(A,ZCTemplate.tabTimer)}else{if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_MENU){ZCTemplate.timer=window.setTimeout(A,ZCTemplate.menuTimer)}}};this.clearTimeOut=function(){if(ZCTemplate.timer){window.clearTimeout(ZCTemplate.timer);ZCTemplate.timer=null}};this.handlePaneHover=function(B,C){var A=ZCUtil.getParent(B,"div[comElName=zc-panesection]");ZCTemplate.resetPaneClass(A);if(C=="mover"){ZCTemplate.setPaneHoverClass(B)}};this.resetPaneClass=function(A,B){$.each($(A).find("a"),function(D,E){var C=$(E).attr("cls");if(!ZCUtil.isNull(B)){C=B;$(E).attr("cls",B)}$(E).attr("class",$(E).attr("comcls")+" "+C)})};this.setPaneHoverClass=function(A){var B=$(A).attr("cls")+"-hover";$(A).attr("class",$(A).attr("comcls")+" "+B)};this.showhidePaneMenu=function(B){var A=$("#leftPaneDIV").find("div[elName="+$(B).attr("subMenuName")+"]");if($(A)[0].style.display=="none"){A.slideDown("fast")}else{A.slideUp("fast")}};this.setLeftPaneStyle=function(){var A=$("#leftPaneDIV").find("div[comElName=zc-panesection]");$.each(A,function(B,C){ZCTemplate.resetPaneClass(C,"zc-pane-left-a");var D=$(C).find("a");$.each($(D),function(E,G){var F=$(G).attr("cls");if($(G).attr("compLinkName")==ZCApp.currZCComp){F=F+"-sel"}var H=(E==D.length-1)?(E==0)?"-first-last":"-last":(E==0)?"-first":"";F=F+H;$(G).attr("cls",F);$(G).attr("class",$(G).attr("comcls")+" "+F)})})};this.showHideMenu=function(B,A){var C=$("td[elName="+B+"]");var D=$(C).attr("subMenuName");D=D?D:$(C).attr("elName");if(A){ZCUtil.showDropDownMenu($(C)[0],$("div[elName="+D+"]")[0])}else{ZCUtil.hideMenu($(C)[0],$("div[elName="+D+"]")[0])}};this.loadCompOnClick=function(B){var A=$("span[elname=zc-saveViewRecsEl]").attr("status");if(A==="enable"){return false}if(!ZCUtil.isNull(window.location.search)){ZCUtil.changeHref($(B).attr("compLinkName"))}if($(B).attr("compLinkName")==ZCApp.currZCComp){ZCTemplate.getZCComp($(B).attr("compLinkName"),$(B).attr("compType"),$(B).attr("compLinkID"))}};this.loadPage=function(D,A){var F=ZCUtil.getCompNameFromURL();if(!ZCUtil.isNull(D)){if(D==ZCApp.currZCComp&&A!="true"){return }}if(D){var D=ZCUtil.getLinkNameFromURL();var B=(F==ZCApp.compProps["compName-"+ZCConstants.PAGE])?ZCUtil.contains(ZCApp.pageLinkNames,D):false;var I=B?false:ZCUtil.contains(ZCApp.compLinkNames,D);var C=(F==ZCApp.compProps["compName-"+ZCConstants.SCRIPT])?true:false;if(B){isViewBeta=true;ZCTemplate.showZCPage(D)}else{if(I){isViewBeta=true;ZCTemplate.getZCComp(D,ZCUtil.getFromMap(ZCApp.compNameVsTypeMap,D),ZCUtil.getFromMap(ZCApp.compNameVsLinkIDMap,D),true)}else{if(C){ZCTemplate.doScriptAction(D)}else{if(ZCApp.loginUser!=ZCApp.sharedBy&&ZCApp.compLinkNames.length>0){ZCTemplate.showZCPage(ZCApp.pageLinkNames[0]);return }if(F!=ZCApp.compProps["compName-"+ZCConstants.PAGE]&&F!=ZCApp.compProps["compName-"+ZCConstants.FORM]&&F!=ZCApp.compProps["compName-"+ZCConstants.VIEW]){F="component"}var H=F;if(F=="Form"){H=i18n.form}else{if(F=="View"){H=i18n.view}else{if(F=="Report"){H=i18n.report}else{if(F=="Page"){H=i18n.page}else{if(F=="component"){H=i18n.component}}}}}var E=replaceParams(i18n.noMsg,new Array(H));alert(E)}}}}else{var G=ZCApp.pageLinkNames[0];$.each(ZCApp.pageLinkNames,function(J,K){if(ZCUtil.getFromMap(ZCApp.pageVsHideMap,K)=="false"){G=K;return false}});ZCTemplate.showZCPage(G)}};this.doScriptAction=function(N){closeDialog();var L=false;if(ZCApp.currURL&&ZCApp.currURL.split("?")[1]){var B=ZCApp.currURL.split("?")[1];var C=B.split("&");for(var E=0;E<C.length;E++){var I=(C[E]).split("=");if(I[0]=="zc_LoadIn"&&I[1]=="dialog"){L=true;break}}}if(N=="page.back"){ZCUtil.setURLInLocationBar(ZCApp.prevURL);ZCApp.reloadSameURL(ZCApp.currURL)}else{if(N=="page.reload"||N=="page.refresh"){if(!L){ZCUtil.setURLInLocationBar(ZCApp.currURL);ZCApp.reloadSameURL(ZCApp.currURL)}else{ZCUtil.setURLInLocationBar(ZCApp.prevURL)}}else{if(N=="page.close"){window.close()}else{if(N=="dialog.close"){if(!L){ZCUtil.setURLInLocationBar(ZCApp.currURL)}else{ZCUtil.setURLInLocationBar(ZCApp.prevURL)}}else{if(N=="dialog.closeAll"){closeAllDialog();if(!L){ZCUtil.setURLInLocationBar(ZCApp.currURL)}else{ZCUtil.setURLInLocationBar(ZCApp.prevURL)}}else{if(N.indexOf("page.open")!=-1){var H=N.indexOf('"');var F=N.lastIndexOf(",");var M=N.slice(H+1,F);M=M.slice(0,M.lastIndexOf('"'));var K=N.slice(F+1,N.lastIndexOf('"'));K=K.slice(K.indexOf('"')+1);var A=$.trim(M);var G=$.trim(K);var D=A.slice(0,A.indexOf(":"));if(D=="Form"||D=="View"||D=="Script"){A="#"+A}openWindowTask(A,G)}else{if(N=="page.parent.close"){var J=ZCUtil.getWindowObject("parent");J.close()}else{if(N=="page.parent.back"){var J=ZCUtil.getWindowObject("parent");ZCUtil.setURLInLocationBar(J.ZCApp.prevURL,"parent");ZCApp.reloadSameURL(J.ZCApp.currURL,"parent")}else{if(N=="page.parent.reload"||N=="page.parent.refresh"){var J=ZCUtil.getWindowObject("parent");ZCUtil.setURLInLocationBar(J.ZCApp.currURL,"parent");ZCApp.reloadSameURL(J.ZCApp.currURL,"parent")}}}}}}}}}};this.showZCPage=function(C){ZCTemplate.firstTime=true;if(ZCUtil.getFromMap(ZCApp.pageVsCompNameMap,C).length==0){alert(i18n.noComponent)}else{var A=ZCUtil.getFromMap(ZCApp.pageVsCompNameMap,C)[0];var B=ZCUtil.getFromMap(ZCApp.compNameVsTypeMap,A);var D=ZCUtil.getFromMap(ZCApp.compNameVsLinkIDMap,A);ZCTemplate.getZCComp(A,B,D)}};this.getZCView=function(B,E,G,H,K){var J=ZCApp.compProps["compName-"+E];var D=ZCApp.compProps["actionURL-"+E];var I=ZCApp.compProps["paramName-"+E];var A=ZCView.viewArr[B];var C=ZCUtil.getFromMap(A,"privateLink");if(!ZCUtil.isNull(C)){D="/showPermaView.do"}ZCUtil.setInMap(A,"fromIDX",1);ZCUtil.setInMap(A,"viewType",H);ZCUtil.setInMap(A,"pageSize",K);ZCUtil.removeFromMap(A,"showPage");var F=ZCUtil.getFromMap(ZCApp.compNameVsCompDispName,B);B=ZCUtil.getFromMap(A,"zc_LoadIn")=="html"?ZCUtil.getFromMap(A,"parentComp"):B;ZCApp.currZCComp=B;if(ZCUtil.getFromMap(A,"zc_LoadIn")=="html"){window.location.reload()}if(H==2){ZCUtil.removeFromMap(A,"recLinkID")}ZCUtil.sendRequest(D,ZCUtil.getParamsFromMap(A),"html","ZCApp.loadZCComponent",ZCUtil.getParamsAsMap("compLinkName="+B+"&compName="+J),i18n.loadingmsg+" "+F)};this.getZCComp=function(M,L,A){var I=ZCApp.compProps["compName-"+L];var F=ZCApp.compProps["actionURL-"+L];var G=ZCApp.compProps["paramName-"+L];var R=G+"="+M;var J=ZCUtil.getURLParams();R=R+"&"+ZCUtil.getURLParams();var O="{";if(R!==undefined&&R!==""&&R.indexOf("zc_Criteria=[")!==-1){var H=R.substring(0,R.indexOf("zc_Criteria=[")-1);var D=R.substring(R.indexOf("zc_Criteria=["),R.indexOf("]"));var B=R.substring(R.indexOf("]")+1,R.length);var K=D.split("zc_Criteria=[");R=H+B;R=R+"&zc_Criteria="+(F.indexOf(ZCApp.compProps["actionURL-2"])!=-1?K[1]:encodeURIComponent(K[1]))}if(J!=undefined&&J!=""){if(J.indexOf("zc_Criteria=[")!==-1){var H=J.substring(0,J.indexOf("zc_Criteria=[")-1);var D=J.substring(J.indexOf("zc_Criteria=["),J.indexOf("]"));var B=J.substring(J.indexOf("]")+1,J.length);J=H+B}var C=J.split("&");for(var N=0;N<C.length;N++){var K=(C[N]).split("=");var S=K[0];if(S!="isViewBeta"){if(O!="{"){O=O+","}O=O+'"'+K[0]+'":"'+K[1]+'"'}}}O=O+"}";R=R+"&urlParams="+(F.indexOf(ZCApp.compProps["actionURL-2"])!=-1?O:encodeURIComponent(O));R=R+"&isPageLoad=true";var E=ZCUtil.getFromMap(ZCApp.compNameVsCompDispName,M);E=E.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&#39;/g,"'").replace(/&quot;/g,'"');var Q=ZCUtil.getParamsAsMap(R);var P=ZCUtil.getFromMap(Q,"zc_ShowAction");if(P=="import"&&I=="Form"){ZCForm.showImportDialog(M)}else{ZCUtil.sendRequest(F,R,"html","ZCApp.loadZCComponent",ZCUtil.getParamsAsMap("compLinkName="+M+"&compName="+I),i18n.loadingmsg+" "+E)}};this.insertCompLink=function(D,E,C){if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_PANE_LEFT||ZCApp.layoutType==ZCConstants.PROFESSIONAL_PANE_RIGHT||ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_PANE_LEFT||ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_PANE_RIGHT){var F=$("#leftPaneDIV");var B=F.find("a[compLinkName="+D+"]");var A=ZCUtil.getParent(B,"div[comElName=zc-panesection]");var G=B.clone();G.attr("compLinkName",E);G.attr("href","#View:"+E);G.html(C);A.append(G);ZCTemplate.setLeftPaneStyle()}else{if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TAB){}else{if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_MENU){}}}};this.adjustLeftPane=function(){if(ZCApp.layoutType==ZCConstants.PROFESSIONAL_PANE_LEFT||ZCApp.layoutType==ZCConstants.PROFESSIONAL_PANE_RIGHT||ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_PANE_LEFT||ZCApp.layoutType==ZCConstants.PROFESSIONAL_TABBED_PANE_RIGHT){var B=$("#leftPaneDIV");var C=0;$.each($(B.find("div[elname=zc_section]")),function(F,D){var E=ZCUtil.getWidthForText($(D).html());if(E>C){C=E}});$.each($(B.find("a[tagfor=showComp]")),function(F,D){var E=ZCUtil.getWidthForText($(D).html());if(E>C){C=E}});var A=40;if($.browser.msie){A=20}if(C>220){$("#zc-panediv").width(C-A);$.each($(B.find("div[elname=zc_section]")),function(E,D){$(D).width(C-A)});$.each($(B.find("a[tagfor=showComp]")),function(E,D){$(D).width(C-A)})}}};this.adjustHeightWidth=function(){if(!ZCApp.currZCComp||ZCApp.currZCComp==null){return }this.setPaddingFixForHtmlView();this.adjustForForm();ZCApp.adjustForView()};this.setPaddingFixForHtmlView=function(){var B=ZCApp.currZCComp;var A=$("#zc-component");A.css("padding","");if(ZCUtil.getFromMap(ZCApp.compNameVsTypeMap,B)==ZCConstants.HTML_PAGE){A.css("padding",0)}};this.adjustForForm=function(){var A=ZCApp.currZCComp;if(ZCUtil.getFromMap(ZCApp.compNameVsTypeMap,A)==ZCConstants.FORM){if(!isViewBeta){var J=0;if($.browser.msie){J=20}var F=ZCForm.getForm(A,ZCConstants.FORM_ALONE);var E=0;var K=ZCForm.getFormCont(A,ZCConstants.FORM_ALONE);$.each($(F.find("table:eq(0)").find("td[elName=zc-formHalfTable]")),function(M,N){E=E+N.clientWidth});var C=$(window).width();var G=$(document).width()-J;if(E<C){if(G>C){F.find("td[elName=zc-formTableFix]").width((G-C)+"px");$.each($(F.find("table:eq(0)").find("td[elName=zc-formHalfTable]")),function(M,N){$(N).width((C/2)+"px")})}else{var B=$("#zc-pane-right").width();F.find("td[elName=zc-formTableFix]").width("1px");var L=0;var I=0;var H=$("#zc-panediv");var D=$("#zc-pane-split");if(H.length==1){L=(H[0].offsetWidth-parseInt(H.css("paddingLeft"))-parseInt(H.css("paddingRight")))}if(D.length==1){I=(D[0].offsetWidth-parseInt(D.css("paddingLeft"))-parseInt(D.css("paddingRight")))}if(C>K.width()+L+I+60){$.each($(F.find("table:eq(0)").find("td[elName=zc-formHalfTable]")),function(M,N){$(N).width((B/2-J)+"px")})}}}else{var F=ZCForm.getForm(A,ZCConstants.FORM_ALONE);F.find("td[elName=zc-formTableFix]").width("1px");ZCForm.handleScreenResize(F)}}else{var F=ZCForm.getForm(A,ZCConstants.FORM_ALONE);F.find("td[elName=zc-formTableFix]").width("1px");ZCForm.handleScreenResize(F)}}};this.getHeaderHeight=function(){var B=0;var A=new Array("#zc-header-top","#zc-header-publicapp","#zc-header-demo","#zc-header-tab","#zc-header-subtab","#zc-header-preview","#zc-header-share");for(var C=0;C<A.length;C++){if($(A[C]).length>0){if($(A[C])[0].style.display!="none"){B=B+$(A[C]).innerHeight()}}}return B};this.onThemeChange=function(C){var E=$("#zc-preview-theme").val();var F=E.substring(5);if((E.substring(0,4)).match("cust")!=null){var A=C.options[C.selectedIndex];F=$(A).attr("themeValue")}for(var D=1;D<=4;D++){$("#zc-preview-strip").find("select[themeValue="+D+"]").attr("id","");$("#zc-preview-strip").find("select[themeValue="+D+"]").hide()}var B=$("#zc-preview-strip").find("select[themeValue="+F+"]");$(B).attr("id","zc-preview-color");$(B).show()};this.previewStyle=function(B){var C=$("#zc-preview-theme").val();if(B==null){B="false"}var A=true;if((C.substring(0,4)).match("cust")!=null){A=false}if(A){location.href="/"+ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/preview/zc_layout="+$("#zc-preview-layout").val()+"&zc_theme="+C.substring(5)+"&zc_color="+$("#zc-preview-color").val()+"&zc_isEdit="+B+"#"+window.location.hash.substr(1)}else{location.href="/appcreator/jsp/edit/customize/themewaitmsg.jsp?sharedBy="+ZCApp.sharedByDisp+"&appLinkName="+ZCApp.appLinkName+"&zc_layout="+$("#zc-preview-layout").val()+"&zc_themeId="+C.substring(5)+"&zc_dirValue=-1&zc_color="+$("#zc-preview-color").val()+"&zc_isEdit="+B+"#"+window.location.hash.substr(1)}};this.applyStyle=function(B,C){var A="true";var D=$("#zc-preview-theme").val();if((D.substring(0,4)).match("cust")!=null){A="false"}if(C){ZCUtil.sendRequest("/saveState.do","applink="+ZCApp.appLinkName+"&zc_layout="+$("#zc-preview-layout").val()+"&zc_theme="+D.substring(5)+"&zc_color="+$("#zc-preview-color").val()+"&zc_default="+A+"&type=applyfrompreview&compName="+window.location.hash.substr(1)+"&"+ZCApp.csrfParamName+"="+ZCApp.csrfParamValue,"html","ZCTemplate.fromEditCancelStyle","",i18n.applystyleMsg)}else{ZCUtil.sendRequest("/saveState.do","applink="+ZCApp.appLinkName+"&zc_layout="+$("#zc-preview-layout").val()+"&zc_theme="+D.substring(5)+"&zc_color="+$("#zc-preview-color").val()+"&zc_default="+A+"&type=applyfrompreview&compName="+window.location.hash.substr(1)+"&"+ZCApp.csrfParamName+"="+ZCApp.csrfParamValue,"html","ZCTemplate.fromLiveCancelStyle","",i18n.applystyleMsg)}};this.fromEditCancelStyle=function(A){if(A!=null&&A.trim()=="error"){alert("error occurred")}else{ZCTemplate.cancelStyle(true,false)}};this.fromLiveCancelStyle=function(A){if(A!=null&&A.trim()=="error"){alert("error occurred")}else{ZCTemplate.cancelStyle(true,false)}};this.cancelStyle=function(B,F){if(false){window.close()}else{if(B!=null){var D=window.location+"";var C=D.substring(D.indexOf("#"));if(D.indexOf("/preview/")==-1){var E=window.location.pathname+window.location.hash;var A=E;if(C!="#"&&D.indexOf("#Page:")==-1){A=ZCUtil.changeHref(ZCApp.currZCComp)}if(E==A){location.reload()}}else{location.href=D.substring(0,D.indexOf("/preview/"))+"/"+C}}else{$("#zc-header-preview").hide();ZCTemplate.correctViewHeader()}}};this.correctViewHeader=function(){var A=$(ZCView.viewCont).find("div[elName=zc-viewheader-div]");if(A.length>0){ZCView.pageHeaderHeight=A.position().top}ZCApp.scroll()};this.hideComponent=function(A){$(A).hide(500)};this.showPreview=function(){if(ZCTemplate.previewHtml==""){ZCUtil.sendRequest("/previewStrip.do","appLinkName="+ZCApp.appLinkName+"&sharedBy="+ZCApp.sharedByDisp+"&zccpn="+ZCApp.csrfParamValue,"html","ZCTemplate.loadPreview","",i18n.pleasewait)}else{ZCTemplate.showPreviewStrip()}};this.fillPreviewHtml=function(){ZCTemplate.previewHtml=$("#zc-header-preview").html().trim()};this.loadPreview=function(A){ZCTemplate.previewHtml=A;ZCTemplate.showPreviewStrip()};this.showPreviewStrip=function(){$("#zc-header-preview").html(ZCTemplate.previewHtml);$("#zc-header-share").hide();ZCUtil.hideMenu(null,$("#zc-copyappdiv")[0]);$("#zc-header-preview").show();ZCTemplate.correctViewHeader()};this.showShare=function(){$("#zc-header-preview").hide(500);ZCUtil.hideMenu(null,$("#zc-copyappdiv")[0]);$("#zc-header-share").show(500)};this.makePrivate=function(){var A=ZCTemplate.getCurrentShareComp().split(":")[0];if(A=="App"){ZCUtil.sendRequest("/changeAccess.do","sharedBy="+ZCApp.sharedByDisp+"&appLinkName="+ZCApp.appLinkName+"&rtype=xhr&access=private&zc_LiveMode=true","text","ZCTemplate.showPrivate","",i18n.pleasewait)}else{ZCUtil.sendRequest("/deleteFromLiveMode.do","sharedBy="+ZCApp.sharedByDisp+"&applink="+ZCApp.appLinkName+"&compName="+ZCTemplate.getCurrentShareComp()+"&zc_LiveMode=true","text","ZCTemplate.showPrivate","",i18n.pleasewait)}};this.showPrivate=function(B){if(B=="true"){$("#zc-header-sharepublic").hide();$("#zc-header-sharetable-1").show();$("#zc-header-sharetable-2").show();var A=ZCTemplate.getCurrentShareComp().split(":")[0];$("#zc_share_comp").html(A)}else{alert("An error has occurred. Please try again later. If this error persists, please contact support@zohocreator.com")}};this.makePublic=function(){var A=ZCTemplate.getCurrentShareComp().split(":")[0];if(A=="App"){ZCUtil.sendRequest("/changeAccess.do","sharedBy="+ZCApp.sharedByDisp+"&appLinkName="+ZCApp.appLinkName+"&rtype=xhr&access=public&zc_LiveMode=true","text","ZCTemplate.showPublic","",i18n.pleasewait)}else{ZCUtil.sendRequest("/shareFromLiveMode.do","sharedBy="+ZCApp.sharedByDisp+"&applink="+ZCApp.appLinkName+"&compName="+ZCTemplate.getCurrentShareComp()+"&zc_shareemails=public@zohocreator.com&zc_sharesendmail="+$("#zc_sendinvite").val()+"&zc_LiveMode=true","text","ZCTemplate.showPublic","",i18n.pleasewait)}};this.showPublic=function(B){if(B=="true"){$("#zc-header-sharepublic").show();$("#zc-header-sharetable-2").hide();$("#zc-header-sharetable-1").hide();var A=ZCTemplate.getCurrentShareComp().split(":")[0];if(A!="App"){$("#zc_share_comp").html(A);$("#zc-header-sharetable-1").show()}else{$("#zc_share_comp").html("Application")}}else{alert("An error has occurred. Please try again later. If this error persists, please contact support@zohocreator.com")}};this.checkPublic=function(A){ZCUtil.sendRequest("/checkPublic.do","sharedBy="+ZCApp.sharedByDisp+"&appLinkName="+ZCApp.appLinkName+"&compName="+$(A).val(),"text","ZCTemplate.selectPublic","",i18n.pleasewait)};this.selectPublic=function(A){if(A.trim()=="true"){$("#zc_share_comp").html(ZCTemplate.getCurrentShareComp().split(":")[0]);$("#zc-header-sharepublic").show();$("#zc-header-sharetable-1").show();$("#zc-header-sharetable-2").hide()}else{$("#zc-header-sharepublic").hide();$("#zc-header-sharetable-1").show();$("#zc-header-sharetable-2").show()}};this.shareEmails=function(){var A=$("#zc-header-sharetable-2").find("textarea").val();if(A.trim()==""||A=="Enter email ids one per line."){alert("Please Enter atleast one email id");return }ZCUtil.sendRequest("/shareFromLiveMode.do","sharedBy="+ZCApp.sharedByDisp+"&"+ZCApp.csrfParamName+"="+ZCApp.csrfParamValue+"&applink="+ZCApp.appLinkName+"&compName="+ZCTemplate.getCurrentShareComp()+"&zc_shareemails="+A+"&zc_sharesendmail="+$("#zc_sendinvite").val()+"&zc_LiveMode=true","text","ZCTemplate.showSentMails","",i18n.pleasewait)};this.showSentMails=function(C){if(C.trim()=="true"){var B=ZCTemplate.getCurrentShareComp();var A=$("#zc-header-sharetable-1").find("option[value="+B+"]").html();A=A.replace(/&nbsp;+/g,"");alert(A+" is shared to the given email ids");$("#zc-header-share").hide();$("#zc-header-sharetable-2").find("textarea").val("Enter email ids one per line.");$("#zc-header-sharetable-2").find("textarea").css("color","#999999")}else{alert("An error has occurred. Please try again later. If this error persists, please contact support@zohocreator.com")}};this.getCurrentShareComp=function(){return $("#zc-header-sharetable-1").find("select").val()}};window.dhtmlHistory={isIE:false,isOpera:false,isSafari:false,isGecko:false,isSupported:false,create:function(){var D=this;var E=navigator.userAgent.toLowerCase();var B=navigator.platform.toLowerCase();var H=navigator.vendor||"";if(typeof window.opera!=="undefined"){this.isOpera=true;this.isSupported=true}else{if(typeof document.all!=="undefined"){this.isIE=true;this.isSupported=true}else{if(H.indexOf("Apple Computer, Inc.")>-1){this.isSafari=true;this.isSupported=true}else{if(E.indexOf("gecko")!=-1){this.isGecko=true;this.isSupported=true}}}}var C="";if(this.isOpera){var F=document.createElement("img");F.setAttribute("style","left:-1000px;top:-1000px;width:1px;height:1px;border:0;position:absolute;");F.src="javascript:location.href='javascript:dhtmlHistory.checkLocation();';";document.body.appendChild(F)}else{if(this.isIE){var G=document.createElement("iframe");G.setAttribute("style","left:-1000px;top:-1000px;width:1px;height:1px;border:0;position:absolute;display:nono;");G.id="rshHistoryFrame";var A=(document.location.protocol=="https:")?"https":"http";G.src=A+"://"+documentdomain+"/creator/rshblank.html";G.style.display="none";document.body.appendChild(G);this.ignoreLocationChange=true;this.iframe=G;D.firstLoad=true}}this.currentLocation=C;var J=function(){D.firstLoad=null};this.addEventListener(window,"unload",J);var I=function(){D.checkLocation()};setInterval(I,this.waitTime)},getIframeHash:function(){var C;try{var B=this.iframe.contentWindow.document;C=String(B.location.search)}catch(A){C=""}if(C.length==1&&C.charAt(0)=="?"){C=""}else{if(C.length>=2&&C.charAt(0)=="?"){C=C.substring(1)}}return C},addListener:function(A){this.listener=A},addHistory:function(B){if(B.indexOf("undefined")==-1){this.ignoreLocationChange=false;if(this.isIE){var A=(document.location.protocol=="https:")?"https":"http";this.iframe.src=A+"://"+documentdomain+"/creator/rshblank.html?"+B}else{window.location.href="#"+B}}},addEventListener:function(C,B,A){if(C.addEventListener){C.addEventListener(B,A,false)}else{if(C.attachEvent){C.attachEvent("on"+B,function(){A(window.event)})}}},isFirstLoad:function(){return this.firstLoad},getVersion:function(){return"0.6"},getCurrentHash:function(){var B=window.location.href;var A=B.indexOf("#");return(A>=0?B.substr(A+1):"")},listener:null,waitTime:100,currentLocation:null,ignoreLocationChange:null,iframe:null,firstLoad:null,fireHistoryEvent:function(A){ZCUtil.changeURL(A)},checkLocation:function(){if(!this.isIE&&this.ignoreLocationChange){this.ignoreLocationChange=false;return }var B=this.getCurrentHash();if(B==this.currentLocation){return }if(this.isIE&&this.getIframeHash()!=B){var A=(document.location.protocol=="https:")?"https":"http";this.iframe.src=A+"://"+documentdomain+"/creator/rshblank.html?"+B}else{if(this.isIE){return }}this.currentLocation=B;this.fireHistoryEvent(B)},iframeLoaded:function(A){if(this.ignoreLocationChange){this.ignoreLocationChange=false;return }var B=String(A.search);if(B.length==1&&B.charAt(0)=="?"){B=""}else{if(B.length>=2&&B.charAt(0)=="?"){B=B.substring(1)}}if(B==""||B=="#"){window.location.href=""}else{if(B.indexOf("Script:")==-1){window.location.hash=B}}if(this.currentLocation==B){return }this.currentLocation=B;this.fireHistoryEvent(B)}};var mobileDeviceOS=window.navigator.userAgent.toUpperCase();var currentBrowserUrl=window.location.href;var isNativeAppPromo=false;var isExcludedList=false;var mobileDeviceList=["ANDROID","IPHONE"];for(var i=0;i<mobileDeviceList.length;i++){if(mobileDeviceOS.indexOf(mobileDeviceList[i])!=-1){isNativeAppPromo=true}}var nativeMblHdrExcludeList=["zohopublic","creator-intranet","skydesk","creatorexport"];for(var j=0;j<nativeMblHdrExcludeList.length;j++){if(currentBrowserUrl.indexOf(nativeMblHdrExcludeList[j])!=-1){isExcludedList=true}}var ExternalFieldName=null;var imgCounter=0;var totalImgCount=0;var ZCConstants=new function(){this.publicAccessRequestUrl="/zoho1/enable-public/form-perma/Request/zc_Header=false";this.APPLICATION=1;this.FORM=2;this.VIEW=3;this.HTML_PAGE=4;this.REPORT=5;this.PAGE=6;this.SCRIPT=7;this.EMBED_SECTION=1;this.POP_UP=2;this.GRID_TYPE=3;this.SUB_FORM_INLINE=97;this.SUB_FORM_POPUP=98;this.SUB_FORM_GRID=99;this.SINGLE_SELECT=12;this.MULTI_SELECT=13;this.PROFESSIONAL_PANE_LEFT=1;this.PROFESSIONAL_TAB=2;this.PROFESSIONAL_PANE_RIGHT=3;this.PROFESSIONAL_TABBED_MENU=4;this.PROFESSIONAL_TABBED_PANE_LEFT=5;this.PROFESSIONAL_TABBED_PANE_RIGHT=6;this.PROFESSIONAL_PANE_LEFT_MENU=7;this.PROFESSIONAL_PANE_RIGHT_MENU=8;this.FORM_EVENT_ON_LOAD=3;this.FORM_COMPONENT_ON_CHANGE=11;this.EDIT_FORM_EVENT_ON_LOAD=14;this.FORM_ALONE=1;this.VIEW_ADD_FORM=2;this.VIEW_EDIT_FORM=3;this.VIEW_BULK_EDIT_FORM=4;this.FORM_LOOKUP_ADD_FORM=5;this.DATE_TIME=22;this.DATE=10;this.TIME_FORMAT="%H:%M:%S";this.RICH_TEXT_AREA=24;this.VIEW_TABLE=1;this.VIEW_CALENDAR=2;this.VIEW_FLAT=3;this.VIEW_SHEET=4;this.VIEW_CHART=5;this.VIEW_NEWSHEET=6;this.FORM_TYPE_INZC=1;this.FORM_TYPE_OUTZC=2;this.BETWEEN=58;this.CURRENT_NEXT_WEEK=63;this.LAST_N_DAYS=64;this.NEXT_N_YEARS=71;this.LESS_EQUAL=22;this.GREATER_EQUAL=23;this.EMPTY=29;this.CURRENT_NEXT_YEAR=57;this.FILE_UPLOAD=18;this.IMAGE=20;this.URL=21;this.PLAIN_TEXT=14;this.SCRIPT=15;this.MULTI_SELECT=13;this.CHECK_BOX=9;this.DATE=10;this.DATE_TIME=22;this.NUMBER=5;this.CURRENCY=6;this.PERCENTAGE=7;this.EMAIL=4;this.INLINE_SINGLE_SELECT=29;this.SYSTEM_LOOKUP=30;this.AUTO_NUMBER=31;this.TEXT=1;this.TEXT_AREA=3;this.SIGNATURE=36;this.RECORD_STATUS=38;this.RELOAD=1;this.CLEAR=9;this.HIDE=10;this.SHOW=11;this.SET_VALUE=12;this.ENABLE=14;this.DISABLE=15;this.PRINT_TASK=71;this.OPEN_URL=280;this.SELECT=1001;this.DESELECT=1002;this.SELECTALL=1003;this.DESELECTALL=1004;this.APPEND_VALUE=1005;this.RESET_LOAD_LOOKUP_TASK=1006;this.ERROR_TASK=1007;this.ALERT=1302;this.BUTTON_WFLOW_TYPE=51;this.REPLACE_NL_CHAR="@@@NL@@@";this.REPLACE_DQ_CHAR="@@@DQ@@@";this.REPLACE_SQ_CHAR="@@@SQ@@@";this.REPLACE_DS_CHAR="@@@DS@@@";this.FILTER_AMPERSAND_CONSTANT=":zoho-ampersand:";this.EXTERNAL_SERVICE_ZOHO_CRM=1;this.EXTERNAL_SERVICE_SDP_OD=3;this.ZOHO_CRM_LEADS=1;this.ZOHO_CRM_ACCOUNTS=2;this.ZOHO_CRM_POTENTIALS=3;this.ZOHO_CRM_CONTACTS=4;this.ZOHO_CRM_CAMPAIGNS=5;this.ZOHO_CRM_TASKS=6;this.ZOHO_CRM_EVENTS=7;this.ZOHO_CRM_CASES=8;this.ZOHO_CRM_SOLUTIONS=9;this.ZOHO_CRM_PRODUCTS=10;this.ZOHO_CRM_PRICEBOOKS=11;this.ZOHO_CRM_QUOTES=12;this.ZOHO_CRM_VENDORS=13;this.ZOHO_CRM_PURCHASEORDERS=14;this.ZOHO_CRM_SALESORDERS=15;this.ZOHO_CRM_INVOICES=16;this.ZOHO_CRM_NOTES=17;this.ZOHO_CRM_USERS=18;this.SDP_OD_TECHNICIANS=1;this.SDP_OD_CATEGORY=2;this.SDP_OD_STATUS=3;this.SDP_OD_LEVEL=4;this.SDP_OD_PRIORITY=5;this.SDP_OD_REQUEST_TYPE=6;this.SDP_OD_SITES=7;this.SDP_OD_DEPARTMENTS=8;this.SDP_OD_ASSETS=9;this.SDP_OD_USERS=10;this.ZOHO_CRM_LEADS_LINK_NAME="Leads";this.ZOHO_CRM_ACCOUNTS_LINK_NAME="Accounts";this.ZOHO_CRM_POTENTIALS_LINK_NAME="Potentials";this.ZOHO_CRM_CONTACTS_LINK_NAME="Contacts";this.ZOHO_CRM_CAMPAIGNS_LINK_NAME="Campaigns";this.ZOHO_CRM_TASKS_LINK_NAME="Tasks";this.ZOHO_CRM_EVENTS_LINK_NAME="Events";this.ZOHO_CRM_CASES_LINK_NAME="Cases";this.ZOHO_CRM_SOLUTIONS_LINK_NAME="Solutions";this.ZOHO_CRM_PRODUCTS_LINK_NAME="Products";this.ZOHO_CRM_PRICEBOOKS_LINK_NAME="PriceBooks";this.ZOHO_CRM_QUOTES_LINK_NAME="Quotes";this.ZOHO_CRM_VENDORS_LINK_NAME="Vendors";this.ZOHO_CRM_PURCHASEORDERS_LINK_NAME="PurchaseOrders";this.ZOHO_CRM_SALESORDERS_LINK_NAME="SalesOrders";this.ZOHO_CRM_INVOICES_LINK_NAME="Invoices";this.ZOHO_CRM_NOTES_LINK_NAME="Notes";this.ZOHO_CRM_USERS_LINK_NAME="Users";this.SDP_OD_TECHNICIANS_LINK_NAME="Technicians";this.SDP_OD_CATEGORY_LINK_NAME="Category";this.SDP_OD_STATUS_LINK_NAME="Status";this.SDP_OD_LEVEL_LINK_NAME="Level";this.SDP_OD_PRIORITY_LINK_NAME="Priority";this.SDP_OD_REQUEST_TYPE_LINK_NAME="RequestType";this.SDP_OD_SITES_LINK_NAME="Sites";this.SDP_OD_DEPARTMENTS_LINK_NAME="Departments";this.SDP_OD_ASSETS_LINK_NAME="Assets";this.SDP_OD_USERS_LINK_NAME="Users";this.NUMBERPAD_ZERO=96;this.NUMBERPAD_NINE=105;this.NUMBERPAD_MULTIPLY=106;this.NUMBERPAD_ADD=107;this.NUMBERPAD_SUBSTRACT=108;this.NUMBERPAD_DIVIDE=109;this.NUMBERPAD_DECIMAL=110;this.KEYPAD_SEMICOLON=186;this.KEYPAD_EQUAL=187;this.KEYPAD_COMMA=188;this.KEYPAD_DASH=189;this.KEYPAD_COLON=190;this.KEYPAD_FORWARDSLASH=191;this.KEYPAD_GRAVEACCENT=192;this.KEYPAD_OPENBRACE=219;this.KEYPAD_BACKSLASH=220;this.KEYPAD_CLOSEBRACE=221;this.KEYPAD_SINGLEQUOTE=222;this.KEYPAD_KEYPRESS_ANDROID=229;this.KEYPAD_ZERO=48;this.KEYPAD_NINE=57;this.APLPHABET_A=65;this.APLPHABET_Z=90;this.BACKSPACE=8;this.ENTER=13;this.SPACE=32;this.LEFT=37;this.UP=38;this.PAGEUP=33;this.PAGEDOWN=34;this.RIGHT=39;this.DOWN=40;this.DELETE=46;this.ESCAPE=27;this.TAB=9;this.REL_OPR_LT=11;this.REL_OPR_GT=12;this.REL_OPR_LE=13;this.REL_OPR_GE=14;this.REL_OPR_EQ=15;this.REL_OPR_NE=16;this.REL_OPR_CONTAINS=18;this.REL_OPR_NOTCONTAINS=19;this.REL_OPR_STARTS_WITH=21;this.REL_OPR_ENDS_WITH=22;this.REL_OPR_EQUALS_IGNORE_CASE=23;this.REG_MATCHES=24;this.REG_FIND=25;this.YESTERDAY=31;this.TODAY=32;this.TOMORROW=33;this.LAST_7_DAYS=34;this.LAST_30_DAYS=35;this.LAST_60_DAYS=36;this.LAST_90_DAYS=37;this.LAST_120_DAYS=38;this.NEXT_7_DAYS=39;this.NEXT_30_DAYS=40;this.NEXT_60_DAYS=41;this.NEXT_90_DAYS=42;this.NEXT_120_DAYS=43;this.LAST_MONTH=44;this.THIS_MONTH=45;this.NEXT_MONTH=46;this.CURR_PREV_MONTH=47;this.CURR_NEXT_MONTH=48;this.LAST_YEAR=51;this.CURRENT_YEAR=52;this.NEXT_YEAR=53;this.PREVIOUS_2_YEAR=54;this.NEXT_2_YEAR=55;this.CURRENT_PREVIOUS_YEAR=56;this.CURRENT_NEXT_YEAR=57;this.THIS_WEEK=59;this.LAST_WEEK=60;this.NEXT_WEEK=61;this.UNLOCKED=79;this.ADMIN_ONLY=80;this.SUPERIOR_ONLY=81;this.getLockValue=function(A){if(A==ZCConstants.UNLOCKED){return"0"}if(A==ZCConstants.ADMIN_ONLY){return"1"}if(A==ZCConstants.SUPERIOR_ONLY){return"2"}}};var ZCUtil=new function(){this.isNull=function(A){if(!A||A=="undefined"||typeof (A)=="undefined"||A=="NULL"||A=="null"||A.length==0||A==""){return true}return false};this.evalJS=function(B){var C=B;if($.browser.msie){C=window.execScript(B,"javascript")}else{var A=new Function(B);C=A()}return C};this.evalImportJS=function(B){var A=new Function(B);return A()};this.evalJSONObject=function(A){return JSON.parse(A)};this.evalJSONArray=function(A){return JSON.parse(A)};this.escapeXml=function(A){A=A.replace(/&lt+/g,"<");A=A.replace(/&gt+/g,">");A=A.replace(/&quot;+/g,'"');A=A.replace(/&+/g,"&amp;");return A};this.getCompNameFromURL=function(D){var A=window.location.hash;if(A.indexOf("#")!=-1){var C=1;var B=5;if(A.indexOf(":")!=-1){B=A.indexOf(":")}D=A.substring(C,B)}return D};this.getURLParams=function(){var C=window.location.search;var D=window.location.hash;var B=(C.indexOf("?")!=-1)?C.substring(C.indexOf("?")+1)+"&":"";var A=(D.indexOf("?")!=-1)?D.substring(D.indexOf("?")+1):"";B=B+A;return B};this.getParams=function(A){return((A.indexOf("?")!=-1)?A.substring(A.indexOf("?")+1):"")};this.getLinkNameFromURL=function(A){return ZCUtil.getLinkName(window.location.hash)};this.getLinkName=function(A){var E="";var B=A.indexOf("#");if(B!=-1){var D=A.indexOf(":");if(D!=-1){var C=D+1;E=$.trim(A.substr(C));if(A.indexOf("?")!=-1&&A.indexOf("#Script:")!=0){E=$.trim(E.substr(0,E.indexOf("?")))}}}return E};this.setLinkNameInURL=function(A,C,B){if(B&&B!=""){window.location.hash="#"+A+":"+C+"?"+B}else{window.location.hash="#"+A+":"+C}};this.getWindowObject=function(A){var B=window;if(A=="parent"||A=="parent window"){var C=window.opener;if(C==null){B=window.parent}if(C!=null){B=C}}return B};this.setURLInLocationBar=function(C,A,B){var D=ZCUtil.getWindowObject(A);if(B&&B>0){setTimeout(D.location.href=C,B)}else{D.location.href=C}};this.changeURL=function(B){if(!ZCApp.useRSH){return }var A="";if(B.indexOf("Script:")!=0){ZCApp.prevURL=ZCApp.currURL;ZCApp.currURL="#"+B}dhtmlHistory.addHistory(B);if(ZCApp.prevURL!=ZCApp.currURL){A="true"}if(ZCApp.loadPage!="false"){ZCApp.scrollToTop="true";ZCTemplate.loadPage(ZCUtil.getLinkName("#"+B),A)}ZCApp.loadPage="true"};this.getAttrsAsArr=function(G,I){var V=[];var R=G.replace(/'/g,'"');var T=R.toLowerCase();if(I=="image"){if(T.indexOf("<a")==0){if(T.indexOf("href")!=-1){var X=T.indexOf("href",0);var P=R.substring(X+1);var O=P.indexOf('"',0);var L=P.indexOf('"',O+1);var C=P.substring(O+1,L);V["zcfieldlink-"]=C;V.target="same"}if(T.indexOf("title")!=-1){var X=T.indexOf("title",0);var P=R.substring(X+1);var J=P.indexOf('"',0);var H=P.indexOf('"',J+1);var W=P.substring(J+1,H);V["zctitle-"]=W}if(T.indexOf("target")!=-1){var X=T.indexOf("target",0);var P=R.substring(X+1);var S=P.indexOf('"',0);var Q=P.indexOf('"',S+1);var N=P.substring(S+1,Q);V.target=(N.toLowerCase().indexOf("blank")!=-1)?"new":"same"}if(T.indexOf("src")!=-1){var X=T.indexOf("src",0);var P=R.substring(X+1);var c=P.indexOf('"',0);var a=P.indexOf('"',c+1);var B=P.substring(c+1,a);V["zcsource-"]=B}if(T.indexOf("alt")!=-1){var X=T.indexOf("alt",0);var P=R.substring(X+1);var c=P.indexOf('"',0);var a=P.indexOf('"',c+1);var U=P.substring(c+1,a);V["zcalttext-"]=U}}else{if(T.indexOf("<img")==0){if(T.indexOf("src")!=-1){var X=T.indexOf("src",0);var P=R.substring(X+1);var c=P.indexOf('"',0);var a=P.indexOf('"',c+1);var B=P.substring(c+1,a);V["zcsource-"]=B}if(T.indexOf("alt")!=-1){var X=T.indexOf("alt",0);var P=R.substring(X+1);var c=P.indexOf('"',0);var a=P.indexOf('"',c+1);var U=P.substring(c+1,a);V["zcalttext-"]=U}}}}else{if(T.indexOf("href")!=-1){var X=T.indexOf("href",0);var P=R.substring(X+1);var F=P.indexOf('"',0);var D=P.indexOf('"',F+1);var M=P.substring(F+1,D);V["zcurl-"]=M;V.target="same"}if(T.indexOf("title")!=-1){var X=T.indexOf("title",0);var P=R.substring(X+1);var b=P.indexOf('"',0);var J=P.indexOf('"',b+1);var E=P.substring(b+1,J);V["zctitle-"]=E}if(T.indexOf("target")!=-1){var X=T.indexOf("target",0);var P=R.substring(X+1);var S=P.indexOf('"',0);var Q=P.indexOf('"',S+1);var A=P.substring(S+1,Q);V.target=(A.toLowerCase().indexOf("blank")!=-1)?"new":"same"}var Z=R.indexOf(">",0);var Y=R.indexOf("<",Z);var K=G.substring(Z+1,Y);V["zclnkname-"]=K}return V};this.getParamsAsArray=function(E,B,C){var A=new Array();E=$.trim(E);if(E==""){return A}B=ZCUtil.isNull(B)?"&":B;C=ZCUtil.isNull(C)?"=":C;var D=E.split(B);$.each(D,function(F,H){var G=H.indexOf(C);if(G!=-1){H=H.substr(G+1)}A[F]=$.trim(H)});return A};this.getParamsAsMap=function(F,A,E){F=$.trim(F);if(F==""){return new Object()}A=ZCUtil.isNull(A)?"&":A;E=ZCUtil.isNull(E)?"=":E;var B=F.split(A);var C=new Object();for(var I=0;I<B.length;I++){var K=B[I];var L=$.trim(K.substring(0,K.indexOf(E)));var G=$.trim(K.substring((K.indexOf(E)+1),K.length));if(G.indexOf(";")!=-1&&F.indexOf(L+"_op")==-1&&L!="sortBy"&&L!="renameColumns"&&L!="groupBy"&&L!="showColumns"&&L!="hideColumns"&&L!="filterVal"&&L!="summationColumns"&&L!="linkviewColumns"){var H=G;G="";var J=H.split(";");$.each(J,function(M,N){G=(M==J.length-1)?G+$.trim(N):G+$.trim(N)+","})}if(C[L]==null){C[L]=new Array()}var D=C[L];while(G.indexOf("#zc_amp#")!=-1){G=G.replace("#zc_amp#","&")}D[D.length]=G}return C};this.getParamsFromArray=function(A,B){var C="";$.each(A,function(E,F){var D=(C.length>0)?"&"+B+"="+F:B+"="+F;C=C+D});return C};this.setParamsInMap=function(D,E,B,C){B=ZCUtil.isNull(B)?"&":B;C=ZCUtil.isNull(C)?"=":C;var A=E.split(B);$.each(A,function(F,I){var G=$.trim(I.substring(0,I.indexOf(C)));var H=$.trim(I.substring((I.indexOf(C)+1),I.length));if(!ZCUtil.isNull(H)){ZCUtil.setInMap(D,G,H)}});return D};this.getParamsFromMap=function(A){var B="";$.each(A,function(D,E){if(!ZCUtil.isNull(E)){var C=(B.length>0)?"&"+D+"="+E:D+"="+E;B=B+C}});return B};this.getFromMap=function(C,A){try{return C[A][C[A].length-1]}catch(B){return""}};this.checkMapForKeyValue=function(E,B,D){var A=false;if(E[B]!=null){var C=ZCUtil.getFromMap(E,B);A=(D==C)}return A};this.setInMap=function(C,A,B){if(C[A]==null){var D=new Array();D[D.length]=B;C[A]=D}else{C[A][C[A].length-1]=B}return C};this.removeFromMap=function(B,A){B[A]=null};this.replaceInParam=function(D,C,B,A){var E="";$.each(D.split(";"),function(F,H){var G=(H.indexOf(":")!=-1)?H.substring(0,H.indexOf(":")):H;H=(G==C)?A?"":C+":"+B:H;if(H!=""){E=E+H+";"}});return E};this.removeFromArray=function(B,A){$.each(B,function(C,D){if(!D){return }if(A==D||D.indexOf(A)!=-1){B.splice(C,1)}});return B};this.contains=function(B,C){var A=false;$.each(B,function(D,E){A=($.trim(String(E))==$.trim(String(C)))?true:A});return A};this.createElem=function(D,C,B){var A=ZCUtil.getParamsAsMap(C,",","=");var E=document.createElement(D);$.each(A,function(F,G){if(F.length>1){$(E).attr(F,G)}});$(E).html(B);return $(E)};this.createInputElem=function(A,C){var B=document.createElement("input");$(B).attr("name",A);$(B).attr("value",C);return $(B)};this.findPosX=function(A){var B=0;if(document.getElementById||document.all){B+=document.body.offsetLeft;while(A.offsetParent){B+=A.offsetLeft;A=A.offsetParent}B+=A.offsetLeft}else{if(document.layers){B+=A.x}}return B};this.findPosY=function(B){var A=0;if(document.getElementById||document.all){A+=document.body.offsetTop;while(B.offsetParent){A+=B.offsetTop;B=B.offsetParent}A+=B.offsetTop}else{if(document.layers){A+=B.y}}return A};this.setPositionToCenter=function(B){var A=0,C=0;if($.browser.msie){A=getIEScrollLeft()+(getIEClientWidth()/2)-(B.clientWidth/2);C=getIEScrollTop()+(getIEClientHeight()/2)-(B.clientHeight/2)}else{A=window.pageXOffset+(window.innerWidth/2)-B.clientWidth/2;C=window.pageYOffset+(window.innerHeight/2)-B.clientHeight/2}B.style.left=(A)+"px";B.style.top=(C)+"px"};this.setPositionToTop=function(B,D){var A=0,C=0;if(!D){D=0}if($.browser.msie){A=getIEScrollLeft()+(document.body.clientWidth/2)-(B.clientWidth/2);C=getIEScrollTop()}else{A=window.pageXOffset+(window.innerWidth/2)-B.clientWidth/2;C=window.pageYOffset}B.style.left=(A)+"px";B.style.top=(C+D)+"px"};this.showMenu=function(A,F,B,D){var C=getWindowWidth();var E=$(window)["scrollLeft"]();A.style.left=F+"px";A.style.top=B+"px";$(A).show();$($(A).find("td[elName=zc-viewOptionsHeight]")[0]).height($(A).height()-20);$(A.parentNode).find("span[elName=rightArr]").show();$(A.parentNode).find("span[elName=leftArr]").hide();if(F+A.clientWidth>=C+E){A.style.left=(C-A.clientWidth+E)+"px";$(A.parentNode).find("span[elName=rightArr]").hide();$(A.parentNode).find("span[elName=leftArr]").show()}};this.showDropDownMenu=function(A,B,D){var E=ZCUtil.findPosX(A);var C=ZCUtil.findPosY(A)+A.offsetHeight;ZCUtil.showMenu(B,E,C,D)};this.showMenuRight=function(A,B){var D=ZCUtil.findPosX(A)+A.offsetWidth;var C=ZCUtil.findPosY(A);ZCUtil.showMenu(B,D,C)};this.showMenuLeft=function(A,B){B.style.display="block";var D=ZCUtil.findPosX(A)-B.offsetWidth;var C=ZCUtil.findPosY(A);ZCUtil.showMenu(B,D,C)};this.hideMenu=function(A,B){if(B){B.style.display="none"}};this.showSubMenu=function(D,I,C){if(ZCUtil.checkFromSameElem(D,C)){return }var G=ZCUtil.findPosX(D);var F=$(window)["scrollLeft"]();var A=G+D.clientWidth;var B=getWindowWidth();if(G+F>B){F=0}var H=1;if($.browser.msie){H=20}I.style.left=(D.offsetWidth-H)+"px";var J=ZCUtil.findPosY(D);$(I).show();$($(I).find("td[elName=zc-viewSubOptionsHeight]")[0]).height($(I).height()-20);var E=getWindowHeight()-J-20;if(E<$(I).height()){I.style.height=E+"px"}$(I).width($($(I).children()[0]).width()+16);if((A+I.clientWidth)>B+F){H=22;if($.browser.msie){H=16}I.style.left=(1-D.offsetWidth-($(I).width()-$(D).width()-H))+"px";$(D.parentNode).find("span[elName=leftArr]").show();$(D.parentNode).find("span[elName=rightArr]").hide()}else{$(D.parentNode).find("span[elName=rightArr]").show();$(D.parentNode).find("span[elName=leftArr]").hide()}};this.hideSubMenu=function(A,B,C){if(ZCUtil.checkFromSameElem(A,C)){return }B.style.display="none"};this.checkFromSameElem=function(B,C){if(!C){var C=window.event}var A=C.relatedTarget||C.fromElement;if($.browser.msie){switch(C.type){case"mouseover":case"mouseenter":A=C.fromElement;break;case"mouseout":case"mouseleave":A=C.toElement;break}}if(ZCUtil.isParent(A,B,20)){return true}return false};this.getParent=function(A,D){if(ZCUtil.isNull(D)){D=""}for(var B=0;$(A).parent()[0];B++){var C=$(A).parent(D);if(C[0]){return C}A=$(A).parent();if(B>10){return }}};this.isParent=function(D,A,B){if(ZCUtil.isNull(B)){B=10}for(var C=0;$(D).parent()[0];C++){var D=$(D).parent();if(D[0]==A){return true}if(C>B){return false}}return false};this.sendRequest=function(A,B,G,K,I,C,M){if(!ZCUtil.isNull(C)){ZCApp.setLoadingMsg($("#zc-loading"),C+" ...")}var D=$("#zc-loading");var H=D.find("[loading=true]");if(H.length==0){H=D.find("[loading=false]")}if(!M){H.attr("loading","true")}else{H.attr("loading","false")}if(!M){ZCApp.showLoading("zc-loading")}var E=((B.indexOf("sharedBy=")==-1)?"sharedBy="+ZCApp.sharedByDisp+"&":"")+((B.indexOf("appLinkName=")==-1)?"appLinkName="+ZCApp.appLinkName+"&":"");if((ZCUtil.contains(ZCApp.csrfArray,A)||B.indexOf(getCsrfParamName())==-1)&&(A.indexOf(ZCApp.compProps["actionURL-2"])==-1)&&(A.indexOf(ZCApp.compProps.showImportDialog)==-1)){E=E+getCsrfParamName()+"="+getCsrfParamValue()+"&"}if(isSafariBrowser()&&((typeof zcOldLivePublicDomain!=="undefined"&&zcOldLivePublicDomain===window.location.host)||(typeof ZCGlobal!=="undefined"&&ZCGlobal.loginZuid=="-100"))&&(A==="/addNewRecord.do"||A==="/triggerWorkflow.do")&&(getCsrfParamValue()===""||getCsrfParamValue()===undefined)){switch(A){case"/addNewRecord.do":A="/addRecordValidateNew.do";break;case"/triggerWorkflow.do":A="/newGenerateJS.do";break}}E=E+B;var J=ZCUtil.getEmptyIDX(ZCApp.paramsArr);ZCApp.paramsArr[J]=ZCUtil.getParamsAsMap(E);var F=ZCUtil.getEmptyIDX(ZCApp.paramsArr);ZCApp.paramsArr[F]=I;var L=function(P,O){if(O=="success"){var N=ZCUtil.getEmptyIDX(ZCApp.respArr);ZCApp.respArr[N]=P;ZCApp.hideLoading("zc-loading");callbackFunc=new Function(K+"(ZCApp.respArr["+N+"], ZCApp.paramsArr["+J+"], ZCApp.paramsArr["+F+"])");callbackFunc();if(ZCApp.isMobileSite&&I.compType=="3"&&B.indexOf("solarSearchTerm")!=-1){$("html, body").animate({scrollTop:0},200)}}else{ZCApp.hideLoading("zc-loading");alert(i18n.failedreq)}};if(A.indexOf(ZCApp.compProps["actionURL-2"])!=-1||A.indexOf(ZCApp.compProps.showImportDialog)!=-1){jQuery.get(A,encodeParamValue(E),L,G)}else{jQuery.post(A,E,L,G)}return false};this.getEmptyIDX=function(B){var A=B.length;$.each(B,function(C,D){if(ZCUtil.isNull(D)){A=C;return }});return A};this.toggleRadio=function(E,B,A){var C=ZCUtil.getParent(B);var D=C.find("input[elName='"+E+"']");if(!D[0]){D=C.find("input[name='"+E+"']")}if(!$(D).attr("disabled")&&$(D).attr("disabled")!="disabled"){$(D).prop("checked",($(D).attr("type")=="radio")?true:!$(D).is(":checked"));if(ZCUtil.isTrue(A)){$(D).click()}else{$(D).change()}}};this.getFieldsAsParams=function(C,B){B+="[name!=srchInput]";var D="";var A=false;$.each($(C).find(B),function(E,I){var F=false;$.each($(I).parents("div[formType=SubForm]"),function(L,K){F=true});if($(I).parents("div[type=composite][elName=subformComposite]").length>0){A=true;return true}if(F&&$(C).attr("elName")!="subFormContainer"){return true}if($(I).attr("elName")=="subforminput"){var H=$(I).parents("div[elName=subformdiv]");var G=$(H).attr("dispType");if(parseInt(G)==ZCConstants.GRID_TYPE){return true}return true}if(I.type=="select-multiple"||I.type=="multiselect"){$.each(ZCUtil.getFieldValue(I),function(K,L){if(!ZCUtil.isNull(L)){D=D+$(I).attr("name")+"="+encodeURIComponent(L)+"&"}})}else{var J=ZCUtil.getFieldValue(I);if(ZCUtil.isNull(J)){J=""}if($(I).attr("fieldtype")==24&&J.length==4&&J=="<br>"){J=""}if(($(I).attr("type")!="radio"&&$(I).attr("type")!="checkbox")||!ZCUtil.isNull(J)){if($(I).attr("name")!=undefined){D=D+$(I).attr("name")+"="+encodeURIComponent(J)+"&"}}}});if(A){$(C).find("div[elName=subformdiv]").each(function(){$(this).find("tr[elName=dataRow]").each(function(){$(this).find("td[elName=zc-fieldtd]").each(function(){var E=$(this).find("div[elName=subformComposite][type=composite]");if(E.length>0){var F={};$(E).find(":input").each(function(){F[$(this).attr("name")]=encodeURIComponent($(this).val())});D=D+E.attr("compositeName")+"="+JSON.stringify(F)+"&"}})})})}D=(D!="")?D.substring(0,D.length-1):D;return D};this.parseJSONResponse=function(B){var A=[];$.each(B,function(C,D){$.each(D,function(E,F){A[E]=F})});return A};this.changeHref=function(B,A){A=!A?ZCApp.compProps["compName-"+ZCUtil.getFromMap(ZCApp.compNameVsTypeMap,B)]:A;var C="/"+ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/#"+A+":"+B;window.location.href=C;return C};this.css=function(B,C){var A=parseInt($(B).css(C),10);return(isNaN(A)?0:A)};this.width=function(A){return $(A).width()+this.css($(A),"paddingLeft")+this.css($(A),"paddingRight")};this.removeInfoHdr=function(){var A=$("#"+_DIALOG_LAYER_VAR).find(".DialogBox");A.find("tr:first").remove();A.find("tr:last").remove()};this.showDialog=function(D,C,B){if(C=="true"){D=ZCApp.dialogAbove+D+ZCApp.dialogBelow}var A="closeButton=no";if(!ZCUtil.isNull(B)){A+=", "+B}ZCUtil.showInDialog(D,A);ZCUtil.removeInfoHdr()};this.showdialogInIframe=function(J,D,C,K,F){ZCDialogLayer.showDialog(J,D,C,K,F);if(typeof (ZCForm.windowScrollTop)!="undefined"&&typeof (ZCForm.offsetTop)!="undefined"){var E=getWindowWidth();var G=getWindowHeight();var H=E/2;var B=ZCForm.windowScrollTop-ZCForm.offsetTop;if((G-B)>300){B=B+300}var I=$("#"+_DIALOG_LAYER_VAR).height();var A=$("#"+_DIALOG_LAYER_VAR).width();$("#"+_DIALOG_LAYER_VAR).css("top",B-(I/2));$("#"+_DIALOG_LAYER_VAR).css("left",H-(A/2))}};this.showInDialog=function(D,C,E,B,A){if(ZCForm.isEmbeddedForm=="true"){ZCForm.getParamsFromIfrme();ZCUtil.showdialogInIframe(D,C,E,B,A)}else{ZCDialogLayer.showDialog(D,C,E,B,A)}};this.replaceCls=function(D,B,C){var A=$(D).attr("class");$(D).attr("class",A.replace(B,C))};this.getFieldValue=function(D){switch($(D).attr("type")){case"select-multiple":case"multiselect":var A=[];$.each($(D).find("option"),function(F,G){if($(G).prop("selected")||$(G).prop("selected")=="true"){A.push($(G).val())}});return A;case"radio":case"checkbox":if($(D).attr("fieldtype")==ZCConstants.CHECK_BOX){if($(D).is(":checked")){return"zc_checked"}else{return"zc_unchecked"}}else{if($(D).is(":checked")){return $(D).val()}}break;default:if($(D).hasClass("zc-grid-lookup-input")){var B=$(D).attr("origVal");if(B!=""){return B.split(",")}else{return $(D).attr("fieldtype")==ZCConstants.MULTI_SELECT?null:"-Select-"}}else{if($(D).hasClass("zc-grid-inline-multiselect")){var E=$(D).parent();var C=$(E).next();var A=[];$(C).find("ul li.selected").each(function(){A.push($(this).attr("filter"))});return A.length==0?null:A}else{return $(D).val()}}}};this.getWidthForText=function(A){var C=document.createElement("table");var B=document.createElement("tbody");var D=document.createElement("tr");var F=document.createElement("td");C.appendChild(B);B.appendChild(D);D.appendChild(F);F.innerHTML=A;F.style.width="1px";C.style.width="1px";F.style.whiteSpace="normal";document.body.appendChild(C);var E=$(F).width();document.body.removeChild(C);return E};this.appendStrIfNotExist=function(B,A,C){if(!C){C=A}if(B.indexOf(C)==-1){B+=A}return B};this.goToTop=function(A){if(A){$("html,body").animate({scrollTop:0},1000)}else{$(window).scrollTop(0)}};this.isHidden=function(A){return $(A).is(":hidden")};this.isTrue=function(A){return(A&&A.toString()=="true")};this.isValueKeyPressed=function(B){var A=B.keyCode;if((A>=ZCConstants.KEYPAD_ZERO&&A<=ZCConstants.KEYPAD_NINE)||(A>=ZCConstants.APLPHABET_A&&A<=ZCConstants.APLPHABET_Z)||(A>=ZCConstants.NUMBERPAD_ZERO&&A<=ZCConstants.NUMBERPAD_DECIMAL)||(A>=ZCConstants.KEYPAD_SEMICOLON&&A<=ZCConstants.KEYPAD_GRAVEACCENT)||(A>=ZCConstants.KEYPAD_OPENBRACE&&A<=ZCConstants.KEYPAD_SINGLEQUOTE)||A===ZCConstants.BACKSPACE||A===ZCConstants.DELETE||A===ZCConstants.SPACE){return true}return false}}();var BetaFeature=new function(){this.featureUpdate=function(B){var C;if($(B).text().trim()==="Enable"){$(B).removeClass("bg_green").addClass("bg_default");C=1;$(B).text("Disable")}else{$(B).removeClass("bg_default").addClass("bg_green");C=0;$(B).text("Enable")}$.post("/featureUpdate.do",{sharedBy:ZCApp.sharedByDisp,featureId:$(B).attr("featureId"),mode:C,zccpn:ZCApp.csrfParamValue},function(){});var A=parseInt($("#notifyCount").text());if(C===1){A=A-1}else{A=A+1}$("#notifyCount").text(A);if(A===0){$("#notifyCount").hide()}if(A>0){$("#notifyCount").show()}};this.setCookie=function(){var B=new Date();B.setTime(B.getTime()+(24*60*60*1000));var A="expires="+B.toString();document.cookie="BetaFeature=1; "+A+";path=/"};this.getCookie=function(){var B="BetaFeature=";var A=document.cookie.split(";");for(var C=0;C<A.length;C++){var D=A[C].trim();if(D.indexOf(B)===0){return D.substring(B.length,D.length)}}return""}}();var ZCApp=new function(){this.cacheArr=[];this.respArr=[];this.htmlArr=[];this.currURL="#";this.compProps=[];this.paramsArr=[];this.pageVsHideMap=new Object();this.pageVsCompNameMap=new Object();this.compNameVsTypeMap=new Object();this.compNameVsPageMap=new Object();this.compNameVsLinkIDMap=new Object();this.compNameVsCompDispName=new Object();this.formCompIDVsDispName=new Object();this.formCompIDVsPageID=new Object();this.InZCformsIDs=[];this.compProps["compName-"+ZCConstants.PAGE]="Page";this.compProps["compName-"+ZCConstants.FORM]="Form";this.compProps["compName-"+ZCConstants.VIEW]="View";this.compProps["compName-"+ZCConstants.REPORT]="Report";this.compProps["compName-"+ZCConstants.SCRIPT]="Script";this.compProps["compName-"+ZCConstants.HTML_PAGE]="View";this.compProps["paramName-"+ZCConstants.FORM]="formLinkName";this.compProps["paramName-"+ZCConstants.VIEW]="viewLinkName";this.compProps["paramName-"+ZCConstants.REPORT]="reportLinkName";this.compProps["paramName-"+ZCConstants.HTML_PAGE]="viewLinkName";this.compProps["actionURL-"+ZCConstants.FORM]="/liveFormHeader.do";this.compProps["actionURL-"+ZCConstants.VIEW]="/liveViewHeader.do";this.compProps["actionURL-"+ZCConstants.REPORT]="/liveReportHeader.do";this.compProps["actionURL-"+ZCConstants.HTML_PAGE]="/liveViewHeader.do";this.compProps.showImportDialog="/showImportDialog.do";this.csrfArray=new Array("/getPrivateLink.do","/copyApp.do","/addRecordValidateNew.do","/addNewRecord.do","/addRecordValidate.do","/addrecord.do","/editrecord.do","/editbulkrecord.do","/duplicaterecordaction.do","/gridRecordAction.do","/deleterecordaction.do","/uploadFile.do","/saveNewView.do","/generateJS.do","/home/rateApp","/home/addReviews","/ccvalidation.do","/validateSubForm.do","/importFormData.do","/formpaymentprocess.do","/setCriteria.do","/colupdate.do","/setFilters.do","/updateCalEvent.do");this.dialogAbove='<div elname=\'zc-dialogheader\' class="zc-dialogheader" onmousedown="captureDialog(event)" ><table cellspacing="0"><tr><td class="zc-dialog-left"></td><td class="zc-dialog-right" onclick="ZCApp.closeDialog();" onmouseover="this.className=\'zc-dialog-right-hover\';" onmouseout="this.className=\'zc-dialog-right\';">Close</td></tr></table></div><div class="zc-dialogdiv">';this.dialogBelow="</div>";this.loadPage="true";this.scrollToTop="false";this.printCurComp=false;this.embededCompLen=0;this.curEmbededCompCnt=0;this.contextPath="";this.viewEditElements=new Array("zc-viewedit-columns","zc-viewedit-criteria","zc-viewedit-filters","zc-viewedit-sort","zc-viewedit-group","zc-viewedit-permissions","zc-viewedit-custombuttons");this.useRSH=true;this.isMobileSite=false;this.isDefaultTemplate=false;this.addToAppPageMap=function(L,D,J,F,M,B,C,E,G){ZCUtil.setInMap(ZCApp.pageVsHideMap,L,C);ZCUtil.setInMap(ZCApp.pageVsCompNameMap,L,ZCUtil.getParamsAsArray(J.substring(1,J.length-1),","));ZCApp.InZCformsIDs=ZCUtil.getParamsAsArray(G.substring(1,G.length-1),",");var I=ZCUtil.getParamsAsArray(J.substring(1,J.length-1),",");var K=ZCUtil.getParamsAsArray(F.substring(1,F.length-1),",");var H=ZCUtil.getParamsAsArray(B.substring(1,B.length-1),",");var N=ZCUtil.getParamsAsArray(M.substring(1,M.length-1),",");var O=ZCUtil.getParamsAsArray(E.substring(1,E.length-1),",");$.each(I,function(P,Q){ZCUtil.setInMap(ZCApp.compNameVsLinkIDMap,Q,H[P]);ZCUtil.setInMap(ZCApp.compNameVsCompDispName,Q,K[P]);ZCUtil.setInMap(ZCApp.compNameVsTypeMap,Q,N[P]);if(N[P]==ZCConstants.FORM){ZCUtil.setInMap(ZCApp.formCompIDVsDispName,O[P],K[P]);ZCUtil.setInMap(ZCApp.formCompIDVsPageID,O[P],D)}ZCUtil.setInMap(ZCApp.compNameVsPageMap,Q,L)})};this.regGlobalEvents=function(){};this.hideLoading=function(B){$("#"+B).hide();hideMobileFreezer()};this.showLoading=function(G){var E=$("#"+G);var C=E.find("[loading=true]");if(C.length==0){return }var D=$("<div/>").text(E.attr("msg")).html();$(C[0]).html(D);$(E).show();var F=getWindowWidth();var I=getWindowHeight();var B=$(window)["scrollLeft"]();var H=$(window)["scrollTop"]();$(E)[0].style.left=(B+F/2-$(E).width()/2)+"px";$(E)[0].style.top=(H+I/2-$(E).height()/2)+"px";E.attr("msg",i18n.loadingmsg);showMobileFreezer()};this.setLoadingMsg=function(B,C){$(B).attr("msg",C)};this.showFading=function(){var D=$("#zc-fadding");var C=$("<div/>").text(D.attr("msg")).html();C=C.replace(/\n/g,"<br />");D.find("[loading=true]").html(C);var E=getWindowWidth();var I=getWindowHeight();var B=$(window)["scrollLeft"]();var H=$(window)["scrollTop"]();var F=B+E/2;var G=H+I/2;if(ZCForm.isEmbeddedForm=="true"){ZCForm.getParamsFromIfrme();if(typeof (ZCForm.windowScrollTop)!="undefined"&&typeof (ZCForm.offsetTop)!="undefined"){G=ZCForm.windowScrollTop-ZCForm.offsetTop}if((I-G)>200){G=G+200}}if($(D)[0]!=undefined){$(D)[0].style.left=(F-$(D).width()/2)+"px";$(D)[0].style.top=(G-$(D).height()/2)+"px"}D.attr("msg",i18n.loadingmsg);$(D).show()};this.showFadingMsg=function(D,C,B){if(ZCUtil.isNull(D)||D=="zc_success"){return }ZCApp.hideLoading("zc-loading");ZCApp.setLoadingMsg($("#zc-fadding"),D);if(C==0){ZCApp.showFading()}else{setTimeout(function(){ZCApp.showFading()},C)}setTimeout(function(){ZCApp.hideLoading("zc-fadding")},B)};this.setGlobals=function(J,M,E,G,D,I,L,B,H,F,K,N,C){this.isAdmin=K;this.isOrg=N;this.inZC=F;this.sharedBy=J;this.sharedByDisp=M;this.appLinkName=E;this.appID=G;this.appOwner=I;this.loginUser=D;this.editsupport=C;this.layoutType=L;this.compLinkNames=ZCUtil.getParamsAsArray(H.substring(1,H.length-1),",");this.pageLinkNames=ZCUtil.getParamsAsArray(B.substring(1,B.length-1),",");$.ajaxSetup({contentType:"application/x-www-form-urlencoded;charset=UTF-8"})};this.setCSRFParams=function(B,C){this.csrfParamName=B;this.csrfParamValue=C};this.showLanguageDropDown=function(C,B,D){ZCApp.hideAndStopPropogation(D);if(B){ZCUtil.showDropDownMenu(C,$("#zc-langdropdown")[0])}else{ZCUtil.hideMenu(C,$("#zc-langdropdown")[0])}};this.showHomeDropDown=function(C,B,D){ZCApp.hideAndStopPropogation(D);if(B){ZCUtil.showDropDownMenu(C,$("#zc-homedropdown")[0])}else{ZCUtil.hideMenu(C,$("#zc-homedropdown")[0])}};this.showHideCopyApp=function(C,B,D){ZCApp.hideAndStopPropogation(D);document.getElementById("zc-homedropdown").style.display="none";if(B){ZCUtil.showDropDownMenu(C,$("#zc-copyappdiv")[0])}else{ZCUtil.hideMenu(C,$("#zc-copyappdiv")[0])}};this.showHideHelpMenu=function(C,B,D){ZCApp.hideAndStopPropogation(D);if(B){ZCUtil.showDropDownMenu(C,$("#zc-helpmenudiv")[0])}else{ZCUtil.hideMenu(C,$("#zc-helpmenudiv")[0])}};function A(){offset=+5.5;userDate=new Date();utc=userDate.getTime()+(userDate.getTimezoneOffset()*60000);ISTDate=new Date(utc+(3600000*offset));return ISTDate}this.loadChat=function(){day=A();if(day.getDay()==0||(day.getDay()==1&&day.getHours()<6)||(day.getDay()==6&&day.getHours()>=5)){dummyViewBeta=false;if(isViewBeta==false){dummyViewBeta=true;isViewBeta=true}ZCApp.showErrorDialog("",i18n["zc.support.chatsupport.weekends"]);if(dummyViewBeta==true){isViewBeta=false}return false}ZCLiveChat.load()};this.copyApp=function(){ZCUtil.sendRequest("/copyApp.do","isLiveMode=true&appname="+ZCApp.appLinkName,"json","ZCApp.copyAppResp")};this.exportDS=function(B){ZCApp.setLoadingMsg($("#zc-loading"),i18n.pleasewait+" ...");ZCApp.showLoading("zc-loading");setTimeout(function(){ZCApp.hideLoading("zc-loading")},300);window.open(B,"_self")};this.showFeatureNotification=function(C,B,D){ZCApp.hideAndStopPropogation(D);if(B){$("#notification_container").show();if($(window).width()<($("#notification_container").offset().left+$("#notification_container").width())){$("#notification_container").css("right","15px")}}else{$("#notification_container").hide()}};this.copyAppResp=function(B,C,D){$.each(B,function(E,F){$.each(F,function(G,H){if(G=="success"){location.href=H}else{if(G=="failure"){ZCUtil.showDialog(H,"true")}}})})};this.resetPrivateLink=function(B,E,D,C){if(!C){C="perma"}ZCUtil.sendRequest("/getPrivateLink.do","pageCompID="+E+"&enable="+B,"text","ZCApp.updatePrivateLink",ZCUtil.getParamsAsMap("compLinkName="+D+"&dialogName="+C))};this.requestForPublicAccess=function(){window.open(ZCConstants.publicAccessRequestUrl,"RequestPublicAccess","width=500,height=550,left=400,top=70")};this.showErrorDialog=function(G,H,D){var C=$("#zc_error_dialog");C.find("[elName='zc_dialog_header']").html(G);C.find("div[elName='zc_dialog_content']").html(H);var I="<div id='zc_error_dialog_clone'>"+C.html()+"</div>";var B="closeButton=no,modal=yes";if(!ZCUtil.isNull(D)&&D!="undefined"){B=B+","+D}ZCUtil.showInDialog(I,B);var F=document.getElementById("zc_error_dialog_clone").getElementsByTagName("input");var E=F.length;if(E>=1){if(F[0].getAttribute("elName")=="error_dialog_ok_button"){F[0].focus()}}};this.showUpgradeDialog=function(D){var C=$("#zc_upgrade_error_dialog");C.find("span[elName='upgradeMsg']").html(D);var E=C.html();var B="closeButton=no,modal=yes";showDialog(E,B)};this.updatePrivateLink=function(D,H,O){if(D=="ZC_ERROR"){alert(i18n.errormsg)}else{if(D=="ZC_UNCONFIRMEDUSERSHARE"){alert(i18n.unconfirmeduserpublish)}else{if(D=="ZC_PUBLIC_REQUESTED"){var N=replaceParams(i18n.publicaccessupgrademsg1);var L=replaceParams(i18n.publicaccessupgrademsg2);var F=N+"<br><center>"+L+"</center>";ZCApp.showErrorDialog("",F)}else{if(D=="ZC_PUBLISH_REACHED_ENTERPRISE_EXPRESS"){var P=replaceParams(i18n.publishmaxplanmaxlimitreached);ZCApp.showErrorDialog("",P)}else{if(D=="ZC_DISABLE_PUBLIC"){var I=replaceParams(i18n.publishmaxlimitreachedmsg1);var G=replaceParams(i18n.publishmaxlimitreachedmsg2);var K=I+"<br><center>"+G+"</center>";ZCApp.showErrorDialog("",K)}else{var J=ZCUtil.getFromMap(O,"dialogName");var M=$("div[elName=zc-"+J+"-dialog-div]");var B=ZCUtil.getFromMap(O,"compLinkName");var E=ZCUtil.getFromMap(ZCApp.compNameVsTypeMap,B);var C=ZCForm.getFormCont(B);if(E==ZCConstants.VIEW){C=ZCView.getViewCont(B)}else{if(E==ZCConstants.REPORT){C=ZCReport.getReportCont(B)}}$(C).find("div[elName=zc-linkinfo-div]").attr("privateLink",D);ZCApp.toggleLoginPrompt(C,M,B);if(J=="perma"){ZCApp.setPermaLink(C,M,B)}else{if(J=="embed"){ZCApp.resetEmbedParams(B)}else{if(J=="ical"){ZCApp.setIcalUrl(C,M,B)}else{ZCApp.setExportLinks(C,M,B)}}}}}}}}};this.setIcalUrl=function(B,G,F){var D=$(G).find("textarea[elName='zc-ical-ta']");var C=$(B).find("div[elName=zc-linkinfo-div]");var E=$(C).attr("privateLink");$(D).val($(C).attr("scheme")+"://"+$(C).attr("exportServerPrefix")+"/"+ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/"+$(D).attr("comptype")+"/"+F+"/"+E)};this.resetEmbedParams=function(E){var D=ZCUtil.getFromMap(ZCApp.compNameVsTypeMap,E);var B=ZCForm.getFormCont(E);if(D==ZCConstants.VIEW){B=ZCView.getViewCont(E)}else{if(D==ZCConstants.REPORT){B=ZCReport.getReportCont(E)}}var C="";if(D==ZCConstants.FORM){C=ZCForm.getEmbedParams(E)}else{if(D==ZCConstants.VIEW){C=ZCView.getEmbedParams(E)}}ZCApp.setEmbedLink(B,$("div[elName=zc-embed-dialog-div]"),C)};this.toggleLoginPrompt=function(B,E,D){var C=$(B).find("div[elName=zc-linkinfo-div]").attr("privateLink");$(E).find("div[comElName=zc-logininfo-div]").hide();if(ZCUtil.isNull(C)){$(E).find("div[elName=zc-nologin-div]").show()}else{$(E).find("div[elName=zc-promptlogin-div]").show()}};this.setPermaLink=function(B,I,H){var F=$(I).find("textarea[elName='zc-perma-ta']");var D=$(B).find("div[elName=zc-linkinfo-div]");var G=$(D).attr("privateLink");var C=$(D).attr("scheme");var E=$(D).attr("publicserver");$(F).val((ZCUtil.isNull(G)?$(D).attr("serverprefix"):(C+"://"+E))+"/"+ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/"+$(F).attr("comptype")+"/"+H+"/"+G)};this.setExportLinks=function(C,B,D){$.each($(B).find("textarea[comElName='zc-export-ta']"),function(G,H){var F=$(C).find("div[elName=zc-linkinfo-div]");var I=$(F).attr("privateLink");I=ZCUtil.isNull(I)?"":I+"/";var E=false;if($(B).attr("includecrit")=="true"||$(B).attr("includecrit")==true){E=true}var J=(E)?$(F).attr("critStr"):"";$(H).val($(F).attr("scheme")+"://"+$(F).attr("exportServerPrefix")+"/"+ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/"+$(H).attr("exportype")+"/"+D+"/"+I+J)})};this.setEmbedLink=function(D,J,H){H=ZCUtil.isNull(H)?"":H;var M=$(D).find("div[elName=zc-linkinfo-div]").attr("privateLink");var K=$(D).find("div[elName=zc-linkinfo-div]").attr("publicserver");var E=$(D).find("div[elName=zc-linkinfo-div]").attr("scheme");var F=$(J).attr("embedurl");var G=$(J).attr("embedjsurl");var I=$(J).attr("embedEndUrl");var B=F.substring(F.indexOf("src=")+5).replace("-embed/","-perma/");var C=B.substring(B.indexOf("://")+3);C=C.substring(C.indexOf("/"));if(ZCUtil.isNull(M)){M="";$(J).find("[elName='zc-formembedsnippet']").hide()}else{B=E+"://"+K+C;var L=B.replace("-perma/","-embed/");G="<script src='"+L;F="<iframe height='500px' width='100%' name='formEmbed-Test_Form' frameborder='0' allowTransparency='true' scrolling='auto' src='"+L;G=G+"&privateLink="+M;M=M+"/";$(J).find("[elName='zc-formembedsnippet']").show()}$(J).find('textarea[elName="zc-embed-ta"]').val(F+M+H+I);$(J).find('textarea[elName="zc-perma-ta"]').val(B+M+H);$(J).find('textarea[elName="zc-embed-js-ta"]').val(G+"'><\/script>")};this.clearZCComponent=function(){var C=$("#zc-component").find("div[comElName=zc-component]");for(var B=0;B<C.length;B++){$(C[B]).get(0).innerHTML="";$(C[B]).hide()}};this.loadZCComponent=function(J,I,N){var X=ZCUtil.getFromMap(I,"zc_LoadIn");ZCForm.onUserInputElem=new Array();if(X=="html"){ZCApp.setZCCompInHTML(J,I,N);return false}else{if(X=="dialog"){ZCUtil.setInMap(N,"include","true");try{var P=ZCUtil.getFromMap(N,"compLinkName");var O=ZCUtil.getFromMap(ZCApp.compNameVsTypeMap,P);I.compType=[parseInt(O)]}catch(D){}ZCApp.loadZCCompInDialog(J,I,N);return false}}ZCApp.clearZCComponent();var K=ZCUtil.getFromMap(N,"compName");ZCApp.currZCComp=ZCUtil.getFromMap(N,"compLinkName");var R=ZCUtil.getFromMap(I,"ZC_REC_ID");if(R!=""){closeDialog();ZCApp.currZCComp=ZCUtil.getFromMap(I,"linkedViewLinkName")}var G=$("#zc-component").find("div[elName=zc-component-"+ZCApp.currZCComp+"]");if(ZCApp.scrollToTop=="true"){if(ZCApp.inZC){ZCUtil.goToTop(false)}}ZCApp.scrollToTop="false";imgCounter=0;totalImgCount=0;G[0].innerHTML=J;if($("#pmtCallbackDiv").length>0){G[0].innerHTML=$("#pmtCallbackDiv").html();G.show();$("#pmtCallbackDiv").remove();return }G.show();if(typeof ZCTemplate!="undefined"){ZCTemplate.setPaddingFixForHtmlView()}$(G).find("script").each(function(){ZCUtil.evalJS($(this).html())});if(ZCApp.inZC){reloadCurrView=true;relodCurrentForm="true";var W=ZCUtil.getFromMap(I,"linkedView");if(ZCUtil.isNull(W)){ZCTemplate.doLayoutActions()}ZCTemplate.adjustHeightWidth();var E="";var T="";var O=ZCUtil.getFromMap(ZCApp.compNameVsTypeMap,ZCApp.currZCComp);var Q="";var C="";var H=0;try{H=parseInt(O)}catch(D){}switch(H){case ZCConstants.FORM:Q="form";C="#Form:";break;case ZCConstants.HTML_PAGE:Q="page";C="#Page:";break;case ZCConstants.REPORT:Q="report";C="#Report:";break;case ZCConstants.VIEW:Q="report";C="#Report:";break}E="/appbuilder/"+ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/"+Q+"/"+ZCApp.currZCComp+"/edit";T="/"+ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/"+C+ZCApp.currZCComp;if(O==ZCConstants.HTML_PAGE){ZCApp.loadZCCompsInHTML()}E=$("#zc-editThisAppEl").attr("scheme")+"://"+$("#zc-editThisAppEl").attr("servername")+E;T=$("#zc-tryNewLivEl").attr("scheme")+"://"+$("#zc-tryNewLivEl").attr("liveservername")+T;$("#zc-editThisAppEl").attr("href",E);$("#zc-tryNewLivEl").attr("slink",T);$("[elname=zc-EditThisComp]").attr("href",E);var U=window.location.href;var M=ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/"+K.toLowerCase()+"-login/"+ZCApp.currZCComp;var B="/logoutpage.jsp?sharedBy="+ZCApp.sharedByDisp+"&appID="+ZCApp.appID+"&appLinkName="+ZCApp.appLinkName+"&signOutUrl="+M;var S="";if(U.indexOf("?")!=-1){var L=U.substring(U.indexOf("?")+1);S=S+"/"+L}B=B+encodeURIComponent(S);$("#zc-signOutEl").attr("href",B);var F="/"+M;$("#zc-signInEl").attr("href",F)}if(ZCUtil.getFromMap(N,"setURL")=="true"){var V="";if(!ZCUtil.isNull(ZCUtil.getFromMap(N,"nextUrlParams"))){V=ZCUtil.getFromMap(N,"nextUrlParams")}ZCUtil.setLinkNameInURL(K,ZCApp.currZCComp,V)}searchFactory.clearCache(null);if(ZCApp.isMobileSite){ZCApp.fixMobileHeader()}};this.reloadZCComp=function(G,H){G=ZCUtil.isNull(G)?ZCApp.currZCComp:G;var D=ZCUtil.getFromMap(ZCApp.compNameVsTypeMap,G);var C=ZCApp.compProps["compName-"+D];var B=ZCApp.compProps["actionURL-"+D];var F=ZCApp.compProps["paramName-"+D];var E=(D==ZCConstants.FORM)?ZCForm.formArr[G]:ZCView.viewArr[G];if(ZCUtil.isNull(E)){E=ZCUtil.getParamsAsMap(F+"="+G)}if(!ZCUtil.isNull(H)){E=ZCUtil.setParamsInMap(E,H)}ZCUtil.sendRequest(B,ZCUtil.getParamsFromMap(E),"html","ZCApp.loadZCComponent",ZCUtil.getParamsAsMap("compLinkName="+G+"&compName="+C+"&setURL=true&nextUrlParams="+H),i18n.loading+" "+C)};this.loadZCCompsInHTML=function(B){if(B){var C=$("#"+_DIALOG_LAYER_VAR).find("[elName=zc-maincontent]")}else{var C=$("#zc-component").find("div[elName=zc-component-"+ZCApp.currZCComp+"]")}var D=C.find("div[elName=zc-component]");ZCApp.embededCompLen=D.length;if(ZCApp.printCurComp&&ZCApp.embededCompLen==0){ZCApp.printComp()}$.each(D,function(L,K){var E=ZCConstants.FORM;var I=$(K).attr("params");var M=$(K).attr("sharedBy");var G=$(K).attr("appLinkName");var H=$(K).attr("viewLinkName");var J=$(K).attr("formLinkName");var F=$(K).attr("reportLinkName");if(!ZCUtil.isNull(M)){I=I+"&sharedBy="+M}if(!ZCUtil.isNull(G)){I=I+"&appLinkName="+G}if(!ZCUtil.isNull(J)){I=I+"&formLinkName="+J}else{if(!ZCUtil.isNull(H)){E=ZCConstants.VIEW;I=I+"&viewLinkName="+H}else{E=ZCConstants.REPORT;I=I+"&reportLinkName="+F}}I=I+"&zc_LoadIn=html";ZCUtil.sendRequest(ZCApp.compProps["actionURL-"+E],I,"html","ZCApp.setZCCompInHTML",ZCUtil.getParamsAsMap("compType="+E),i18n.loadingdot)})};this.setZCCompInHTML=function(I,D,K){if(layerCount>1){var L=$("#"+_DIALOG_LAYER_VAR).find("[elName=zc-maincontent]")}else{var L=$("#zc-component").find("div[elName=zc-component-"+ZCApp.currZCComp+"]")}var C=ZCUtil.getFromMap(K,"compType");var H=ZCApp.compProps["paramName-"+C];var B=ZCUtil.getFromMap(D,H);var E=L.find("div["+H+"="+B+"]");E[0].innerHTML=I;ZCUtil.evalJS($(E).find("script").html());if($(".zcAccountslogin").length){$(".zcAccountslogin").each(function(O){ZCUtil.evalJS($(this).html())})}if($(".zclogincheck").length){$(".zclogincheck").each(function(O){ZCUtil.evalJS($(this).html())})}ZCApp.curEmbededCompCnt++;if(ZCApp.printCurComp&&ZCApp.embededCompLen==ZCApp.curEmbededCompCnt){ZCApp.printComp()}if(layerCount>1){var N=$("#"+_DIALOG_LAYER_VAR);var M=N.find("#_DIALOG_CONTENT");var G=M.find("[elname=zc-maincontent]");M.width(G.width()+20);var J=(window.innerHeight-N[0].offsetHeight)/2;var F=(window.innerWidth-N[0].offsetWidth)/2;J=(J<0)?0:J;N.css("top",J+pageYOffset);N.css("left",F+pageXOffset)}};this.printComp=function(){window.print();ZCApp.printCurComp=false;ZCApp.curEmbededCompCnt=0};this.closeDialog=function(){closeDialog();if(ZCApp.currURL.indexOf("zc_LoadIn=dialog")!=-1){window.location.href=ZCApp.prevURL;ZCApp.loadPage="false"}if(isViewBeta){ZCTemplate.correctViewHeader()}};this.correctDialog=function(){var I=$("#"+_DIALOG_LAYER_VAR);var L=$("#FreezeLayer_"+layerCount);if(I){var M=I.height();var B=I.width();var E=getWindowWidth();var G=getWindowHeight();var K=false;var J=I.find("div[zcDialog=mainCont]");if(B>E-100){J.width(E-100);L.width(E-100)}if(M>G-100){J.height(G-100);L.height(G-100);K=true}var D=I.find("div[zcDialog=outerCont]");B=I.width();var H=D.attr("zcWidth");if(B<=E-20&&K){var C=D.width()+30;D.width(C);D.attr("zcWidth",C)}M=I.height();B=I.width();var F=$(window)["scrollLeft"]();var N=$(window)["scrollTop"]();I.css("left",(E-B)/2+F);I.css("top",(G-M)/2+N)}};this.loadZCCompInDialog=function(I,G,M){if(ZCUtil.getFromMap(M,"closeDialog")=="true"){closeDialog()}var B="closeButton=no, modal=yes";var T=ZCUtil.getFromMap(M,"openURLWindowOpts");if(!ZCUtil.isNull(T)){}var O=ZCUtil.getFromMap(G,"compType");ZCForm.onUserInputElem=new Array();if(ZCUtil.getFromMap(M,"include")=="true"){var E=ZCApp.dialogAbove;var L=ZCApp.dialogBelow;if(ZCUtil.getFromMap(G,"zc_LoadIn")=="dialog"){B+=", closeOnEscKey=no"}I=E+I+L}if(ZCUtil.getFromMap(M,"formAccessType")==ZCConstants.FORM_LOOKUP_ADD_FORM){if(ZCUtil.getFromMap(M,"closedialog")=="true"){closeDialog()}B+=", position=absolute, closeParent=false"}else{B+=", position=relative"}ZCUtil.showInDialog(I,B,G);var Q=$(window)["scrollLeft"]();var N=$(window)["scrollTop"]();var D=getWindowWidth()/2+Q;var C=getWindowHeight()/2+N;var S=$("#"+_DIALOG_LAYER_VAR).height();var H=$("#"+_DIALOG_LAYER_VAR).width();if(getWindowHeight()>S+50){$("#"+_DIALOG_LAYER_VAR).css("top",C-S/2)}else{$("#"+_DIALOG_LAYER_VAR).css("top",N+30)}if(getWindowWidth()>H+50){$("#"+_DIALOG_LAYER_VAR).css("left",D-H/2)}else{var J=30;if(ZCApp.isMobileSite){J=12}$("#"+_DIALOG_LAYER_VAR).css("left",Q+J)}if(O==ZCConstants.FORM){var F=ZCUtil.getFromMap(G,"formLinkName");var K=ZCConstants.FORM_ALONE;if(!ZCUtil.isNull(ZCUtil.getFromMap(G,"formAccessType"))){K=ZCUtil.getFromMap(G,"formAccessType")}$.each(G,function(V,W){for(var U=0;U<W.length;U++){W[U]=decodeURIComponent(W[U])}ZCForm.isAddToParentLookup=true;ZCForm.setFieldValue(F,V,K,W)})}if(O==ZCConstants.VIEW){var R=ZCUtil.getFromMap(G,"viewLinkName");O=ZCUtil.getFromMap(ZCApp.compNameVsTypeMap,R);if(O==ZCConstants.HTML_PAGE){ZCApp.loadZCCompsInHTML(R)}}var P=$("#"+_DIALOG_LAYER_VAR).find("div[id=_DIALOG_CONTENT]");$(P).scroll(function(U){var V=$(P).scrollLeft();$(P).find("div[elName=zc-dialogheader]").css("position","relative");$(P).find("div[elName=zc-dialogheader]").css("left",V)});searchFactory.clearCache(null);ZCView.popupopend=false};this.openUrlInDialog=function(G,O){var M="zc_LoadIn=dialog&";if(G.indexOf("/")==0){var I=G.indexOf("/");var L=G.substr(I+1);I=L.indexOf("/");var K=L.substring(0,I);L=L.substr(I+1);I=L.indexOf("/");var D=L.substring(0,I);G=L.substr(I+1);M=M+"sharedBy="+K+"&appLinkName="+D+"&"}if(G.indexOf("#")==0||G.indexOf("/#")==0){var N=G.indexOf("#");var E=G.indexOf("?");var F=(E==-1)?"":G.substr(E+1);var J=G.substring(N+1,N+5);var C=(J=="Form")?ZCConstants.FORM:ZCConstants.VIEW;var B=(E==-1)?G.substr(N+6):G.substring(N+6,E);var H=ZCApp.compProps["paramName-"+C]}ZCUtil.sendRequest(ZCApp.compProps["actionURL-"+C],M+H+"="+B+"&"+F+"&compType="+C,"html","ZCApp.loadZCCompInDialog",ZCUtil.getParamsAsMap("include=true&isOpenUrl=true&openURLWindowOpts="+O),i18n.loadingdot)};this.reloadSameURL=function(C,B){var D=ZCUtil.getWindowObject(B);if(C.indexOf("#")==0||C.indexOf("/#")==0||D.location.href==C){var E=ZCUtil.getLinkNameFromURL(C);if(E==ZCApp.currZCComp){ZCTemplate.loadPage(E,"true")}}};this.hideAppMenus=function(){$("[elName=zcDDPagination]").hide();ZCApp.hideLookUpSearch();ZCUtil.hideMenu(null,$("#zc-copyappdiv")[0]);ZCUtil.hideMenu(null,$("#zc-helpmenudiv")[0]);ZCUtil.hideMenu(null,$("#zc-homedropdown")[0]);ZCUtil.hideMenu(null,$("#zc-langdropdown")[0]);$("#notification_container").hide();ZCUtil.hideMenu(null,$("#zc-toggleAgentAvailability")[0]);ZCAppSearch.hideSearchList();ZCForm.hideFormMenus(ZCForm.getFormCont(ZCApp.currZCComp));ZCView.hideViewMenus(ZCView.getViewContainers(ZCApp.currZCComp),ZCApp.currZCComp);ZCReport.hideReportMenus(ZCReport.getReportCont(ZCApp.currZCComp))};this.hideFormPermaContent=function(){ZCApp.hideLookUpSearch();ZCForm.hideFormMenus(ZCForm.getFormCont(ZCApp.currZCComp))};this.hideViewPermaContent=function(){ZCApp.hideLookUpSearch()};this.hideFormEmbedContent=function(){ZCApp.hideLookUpSearch()};this.hideViewEmbedContent=function(){ZCApp.hideLookUpSearch()};this.hideLookUpSearch=function(){$("[elName=srchDivEl]").hide()};this.stopPropogation=function(B){if($.browser.msie){window.event.cancelBubble=true}else{if(browser_nn6){B.stopPropagation()}}};this.hideAndStopPropogation=function(B){if($.browser.msie){if(window.event!=undefined){window.event.cancelBubble=true}}else{if(browser_nn6){B.stopPropagation()}}ZCUtil.hideMenu(null,$("#zc-copyappdiv")[0]);ZCUtil.hideMenu(null,$("#zc-helpmenudiv")[0]);ZCUtil.hideMenu(null,$("#zc-homedropdown")[0]);ZCUtil.hideMenu(null,$("#zc-langdropdown")[0]);$("#notification_container").hide()};this.toggleRatingsDiv=function(D){if(authenticate()){var C=docid(D);var B=C.style;if(B.display=="block"){B.display="none"}else{C.style.display="block";docid("ratemsg").innerHTML=getA(docid("ratemsg"),"origMsg");docid("rateimgs").style.display="block"}}else{alert(i18n.apprating)}};this.showAppRating=function(D){var C=Math.round(D);var B=0;B=D;for(var E=1;E<=5;E++){if(E<=B){docid("star"+E).src="/zohocreator/platform/images/star-gold.gif"}else{if(C>D){B=C-1;docid("star"+C).src="/zohocreator/platform/images/star-halfrated.gif"}else{docid("star"+E).src="/zohocreator/platform/images/star-notrated.gif"}}}};this.setAppRating=function(D,B){this.showAppRating(D);var C="/home/rateApp";var E="rating="+D+"&canvasurl="+B;ZCUtil.sendRequest(C,E,"text","ZCApp.handleAppRatingResp","",i18n.updratings)};this.handleAppRatingResp=function(){var B={FADE_INTERVAL:10};docid("rateimgs").style.display="none";docid("ratemsg").innerHTML=getA(docid("ratemsg"),"successMsg");$("#rateThisApp").fadeOut(5000)};this.toggleReviewDiv=function(B){if(authenticate()){ZCUtil.showInDialog(docid(B).innerHTML,"closeButton=no, modal=yes, width=745")}else{alert(i18n.appreview)}};this.addReview=function(B){var C=B.reviewTitle.value;var D=B.reviewComment.value;if(C==""&&D==""){alert(i18n.reviewtitleandcontent);B.reviewTitle.focus()}else{if(C==""){alert(i18n.reviewtitle);B.reviewTitle.focus()}else{if(D==""){alert(i18n.reviewcontent);B.reviewComment.focus()}else{ZCUtil.sendRequest($(B).attr("action"),ZCUtil.getFieldsAsParams(B,":input[type!=reset][type!=submit][type!=button][type!=file]"),"text","ZCApp.handleAddReviewResp",ZCUtil.setInMap(new Object(),"formObj",B),i18n.addreview)}}}return false};this.handleAddReviewResp=function(B,D,E){var C=ZCUtil.getFromMap(E,"formObj");if(B.toLowerCase().indexOf("success")!=-1){closeDialog();ZCApp.showFadingMsg(i18n.reviewadded,0,2000);C.reviewTitle.value="";C.reviewComment.value=""}};this.getRespArr=function(C){var F=C;var B=new Array();for(var E in F){var G=F[E];for(var D in G){B[D]=G[D]}}return B};this.scrollToPageTop=function(B){if(typeof (B)=="undefined"){B=1}window.scrollTo(0,B)};this.hideAddressBar=function(B,C){setTimeout(function(){ZCApp.scrollToPageTop(B)},C)};this.fixMobileHeader=function(){docid("zc-component").style.minHeight=getWindowHeight()+60;if(docid("cont").style.display=="none"){docid("mobile-title-hdr").style.position="fixed"}else{docid("mobile-title-hdr").style.position="relative"}docid("mobile-title-hdr").style.top="0";if(isNativeAppPromo){if(docid("mobile-form-header")!=undefined&&docid("cont").style.display!="none"){docid("mobile-form-header").style.minHeight="118px"}if(docid("mobile-view-header")!=undefined&&docid("cont").style.display!="none"){docid("mobile-view-header").style.minHeight="118px";ZCApp.adjustFixedHeader()}}};this.hideMobileBackBtnInIframe=function(){if(window.top!=window.self){docid("back-btn").style.display="none"}};this.scroll=function(){ZCAppSearch.adjustFixedBar();ZCApp.adjustFixedHeader();if(ZCApp.isMobileSite&&docid("sum_search").style.display!="none"){ZCApp.scrollToPageTop()}};this.adjustFixedHeader=function(){if(_DIALOG_LAYER_VAR=="_DIALOG_LAYER"||_DIALOG_LAYER_VAR=="_DIALOG_LAYER_0"){var B=$(window).scrollTop();if(B>50){$("#zc-header-right").hide()}else{$("#zc-header-right").show()}if(ZCView.fixedHeaderNeeded){if(ZCApp.isMobileSite){var E=$("#mobile-view-header");var D=E.height();ZCView.pageHeaderHeight=D}if(B>ZCView.pageHeaderHeight||ZCApp.isMobileSite){var C=0;var F="none";if(docid("sum_search")!=null){F=docid("sum_search").style.display}if(ZCApp.isMobileSite&&F=="none"){C=$("#mobile-view-header").height()}if(typeof isApiDeprecation!="undefined"){C=(typeof ZCBannerTop!="undefined")?C+ZCBannerTop.height:C}if(typeof isAccountMarkedForDeletion!="undefined"){C=(typeof ZCBannerTop!="undefined")?C+ZCBannerTop.height:C}if(typeof isPlanDeprecated!="undefined"){C=(typeof ZCBannerTop!="undefined")?C+ZCBannerTop.height:C}ZCView.setWidthInView(C,B)}else{ZCView.resetWidthInView(B)}}if(isViewBeta&&($(document).width()>getWindowWidth())){ZCView.handleHorizontalScroll()}}};this.adjustForView=function(B){var C=ZCApp.currZCComp;if(ZCView.viewContFixed!=null&&ZCView.fixedHeaderNeeded&&ZCView.viewContFixed.html()!=""){ZCView.handleScreenResize(C,B);this.scroll()}if(ZCApp.isMobileSite&&$("#"+FreezeLayer_VAR)!=null){$("#"+FreezeLayer_VAR).width(getWindowWidth())}};this.adjustDialogInCenter=function(){var C=$(window)["scrollLeft"]();var F=$(window)["scrollTop"]();var H=getWindowWidth()/2+C;var B=getWindowHeight()/2+F;var E=$("#"+_DIALOG_LAYER_VAR).height();var G=$("#"+_DIALOG_LAYER_VAR).width();if(getWindowHeight()>E+50){$("#"+_DIALOG_LAYER_VAR).css("top",B-E/2)}else{$("#"+_DIALOG_LAYER_VAR).css("top",F+30)}if(getWindowWidth()>G+50){$("#"+_DIALOG_LAYER_VAR).css("left",H-G/2)}else{var D=30+C;if(ZCApp.isMobileSite){D=12}$("#"+_DIALOG_LAYER_VAR).css("left",D)}};this.resize=function(){this.adjustForView(getWindowWidth());this.adjustForForm();var C=$("#zc-viewbeta-preview").find("div[elname=beta-preview-span]");if(C){var B=getWindowWidth();C.css("left",(B-C.width())/2)}};this.adjustForForm=function(){var C=ZCApp.currZCComp;if(ZCUtil.getFromMap(ZCApp.compNameVsTypeMap,C)==ZCConstants.FORM){var B=ZCForm.getForm(C,ZCConstants.FORM_ALONE);ZCForm.handleScreenResize(B)}};this.setCookie=function(D,G,C,F){var E=new Date();if(C){E.setTime(E.getTime()+(C*24*3600*1000))}else{E.setTime(E.getTime()+(365*24*3600*1000))}var B=D+"="+escape(G)+";expires="+E.toGMTString()+";path=/;";if(F){B=B+"domain="+escape(F)}document.cookie=B};this.goToMobileSite=function(F,D,G){var E=document.domain;var C=E.substring(0,E.lastIndexOf("."));var B=E.substring(C.lastIndexOf("."),E.length);ZCApp.setCookie(F+"_isalwaysfullsite","false",null,B);window.location.href="/mobile/"+D+"/"+G+"/"};this.showCustomerProfile=function(){var B="/showCustomerProfile.do";var C="sharedBy="+ZCApp.sharedByDisp;ZCUtil.sendRequest(B,C,"html","ZCApp.showCustomerProfile_return")};this.showCustomerProfile_return=function(C,D){var B="position=absmiddle, closeButton=no, modal=yes, position=absolute, closeParent=false, width=745";showDialog(C,B)};this.spreadSheetReportCnfm=function(C,D){var B=$("span[elname=zc-saveViewRecsEl]").attr("status");if(B==="enable"){ZCView.showConfirmPopUp(i18n.spreadsheetcnfm1,function(){ZCView.toggleViewMenu(D,"show","disable");window.location.href="#"+C+":"+D});return false}else{window.location.href="#"+C+":"+D}};this.triggerNewLiveSwitch=function(){$("#zc-tryNewLivEl").click()};this.switchnewlive=function(B){$.ajax({beforeSend:function(){this.data=this.data+"&"+ZCApp.csrfParamName+"="+ZCApp.csrfParamValue},method:"POST",data:"newlive=true&sharedBy="+ZCApp.sharedByDisp,url:"/switchnewlive.do",success:function(){window.location=$("#zc-tryNewLivEl").attr("slink")}})}};function findFullDocDim(){return{width:$(document).width(),height:$(document).height()}}function trim(A){return(A.replace(/\s+$/,""))}function openPluginField(B,A){window.open("https://crm.zoho.com/crm/Search.do?searchmodule="+B,"_blank","left=420,top=50,resizable=1,width=500,height=360")}function clearPluginField(A,B){$(A.parentNode).find("input[formCompID="+B+"]").attr("value","")}var ZCEvalApp=new function(){this.validateLicAgreeCheck=function(G){if(G.agree.checked){G.create.disabled=false}else{G.create.disabled=true}};this.validateCCForm=function(K){try{docid("errorrow").style.display="none";var G=document.getElementById("signup_status");var H=/^[a-z0-9]([a-z0-9_\-\.\+]*)@([a-z0-9_\-\.]*)(\.[a-z]{2,15}(\.[a-z]{2}){0,2})$/i;var M=K.cardnum.value;var J=K.cardvernum.value;var I=true;var N="";if(trim(K.streetaddress.value).length==0){N=N+i18Arr["zc.ccinfo.validstreetaddress"]+"<br>";K.streetaddress.focus();I=false}if(trim(K.zipcode.value).length==0){N=N+i18Arr["zc.ccinfo.validzipcode"]+"<br>";K.zipcode.focus();I=false}if(trim(K.cardnum.value).length==0){N=N+i18Arr["zc.ccinfo.validcardnum"]+"<br>";K.cardnum.focus();I=false}if(M.indexOf(" ")!=-1){N=N+i18Arr["zc.ccinfo.nospaces"]+"<br>";K.cardnum.focus();I=false}if(trim(K.cardvernum.value).length==0){N=N+i18Arr["zc.ccinfo.validcardvernum"]+"<br>";K.cardvernum.focus();I=false}if(J.indexOf(" ")!=-1){N=N+i18Arr["zc.ccinfo.nospacesincardvernum"]+"<br>";K.cardvernum.focus();I=false}if(N!=""){setError(N)}if(I==true){ZCUtil.sendRequest($(K).attr("action"),ZCUtil.getFieldsAsParams(K,":input[type!=reset][type!=submit][type!=button][type!=file]"),"text","ZCEvalApp.handleResponse","",i18Arr.loading)}}catch(L){alert("Please report this error to support@zohocreator.com <br>"+L)}return false};this.toggleUpgradeDiv=function(G){docid("evalAppUpgradeCCDetails").style.display="none";docid("evalAppUpgradeFrmContent").style.display="block";ZCUtil.showInDialog(docid(G).innerHTML,"closeButton=no, modal=yes");this.calculateAmt()};this.upgrade=function(O,Q){var G=this.getDuration();if(Q){var R=this.docid("planselected");var H=R.options[R.selectedIndex].getAttribute("users");var N=R.options[R.selectedIndex].getAttribute("plan");var J=parseInt(this.docid("addonrecords").value);var P=parseInt(this.docid("addonfiles").value);var S=parseInt(this.docid("addonemails").value);J=J*5000;P=P*0.5;S=S*500;O.plan.value=N;O.usercnt.value=H;O.duration.value=G;O.addrecords.value=J;O.addfiles.value=P;O.addemails.value=S}else{O.duration.value=G}closeDialog();var M="evalAppPopUp";var L="750";var K="615";var I="width="+L+",height="+K+",location=yes,resizable=yes,left="+((window.screen.width-L)/2)+",top="+((window.screen.height-K)/2);O.target=M;_win=window.open("",M,I);_win.focus();return true};this.handleResponse=function(G,I,J){if(G=="success"){window.opener.location.reload(false);window.close();return }if(window.opener&&!window.opener.closed){alert(i18Arr["zc.ccvalidation.failure"]);return }var H=docid("evalAppUpgradeCCDetails");H.innerHTML=G;H.style.display="block";docid("evalAppUpgradeFrmContent").style.display="none";ZCUtil.showInDialog(docid("evalAppUpgradeFrmCon").innerHTML,"closeButton=no, modal=yes")};this.calculateAmt=function(H){var N=parseInt(this.docid("planselected").value);var L=parseInt(this.docid("addonrecords").value);var Q=parseInt(this.docid("addonfiles").value);var T=parseInt(this.docid("addonemails").value);var W=parseInt(this.docid("planselected").getAttribute("appcost"));var P=N;var V=L*10;var O=Q*10;var K=T*20;var U=W;var I=(typeof (this.docid("planselected").options)!="undefined");var R=1;var G=this.getDuration();var J=this.docid("occurance");J.innerHTML="MONTH";if(G==1){R=3;J.innerHTML="QUARTER"}else{if(G==2){R=6*0.95;J.innerHTML="6 MONTHS"}else{if(G==3){R=12*0.9;J.innerHTML="YEAR"}}}P=N*R;V=V*R;O=O*R;K=K*R;U=U*R;var S=V+O+K+U;if(I){S+=P;this.docid("plancharges").innerHTML="$"+this.formatNumb(P+U,2)}this.docid("recordscharges").innerHTML="$"+this.formatNumb(V,2);this.docid("filescharges").innerHTML="$"+this.formatNumb(O,2);this.docid("emailcharges").innerHTML="$"+this.formatNumb(K,2);this.docid("totalcharges").innerHTML="$"+this.formatNumb(S,2);if(H){var M=new Array(this.docid(H),this.docid("totalcharges"));if(H=="plancharges"){M=new Array(this.docid("plancharges"),this.docid("recordscharges"),this.docid("filescharges"),this.docid("emailcharges"),this.docid("totalcharges"),this.docid("occurance"))}}};this.docid=function(H){var G="#"+_DIALOG_LAYER_VAR;return $(G).find("#"+H).get(0)};this.getDuration=function(){var G=this.docid("planradiotd").getElementsByTagName("input");for(var H=0;H<G.length;H++){var I=G.item(H);if(I.checked==true){return I.value}}return 0};this.formatNumb=function(H,I){var G=1;for(i=1;i<=I;i++){G=G*10}return(Math.round(H*G)/G).toFixed(I)};this.clearField=function(H,J,K){var G=$("#"+H).attr("disabled");var I=$(K).attr("labelname");if(I!==undefined){H=H+"_"+I;G=$("input[id='"+H+"']").attr("disabled")}if(G!=="disabled"){document.getElementById(H).value="";if(J!="undefined"&&J!=""){document.getElementById(J).value=""}ExternalFieldName=H;if(ExternalFieldName){ZCForm.triggerExternalOnUser(H);ExternalFieldName=""}}};this.clearExtField=function(I,H,M){var G=$("#"+I).attr("disabled");var K=$(M).attr("labelname");if(K!==undefined){I=I+"_"+K;G=$("input[id='"+I+"']").attr("disabled")}if(G!=="disabled"){document.getElementById(I).value="";if(H=="grid"){document.getElementById(I).setAttribute("extValue","")}else{var L=document.getElementById("ext_fields_"+H);if(L!=undefined){for(var J=0;J<L.childNodes.length;J++){var N=L.childNodes[J];if(N.value!=undefined&&N.value!="undefined"){N.value=""}}ExternalFieldName=I;if(ExternalFieldName){ZCForm.triggerExternalOnUser(I);ExternalFieldName=""}}}}};this.constructExternalURL=function(K,H,M,G,I,L){var J;switch(K){case ZCConstants.EXTERNAL_SERVICE_ZOHO_CRM:switch(H){case ZCConstants.ZOHO_CRM_LEADS:J=I+"searchmodule="+ZCConstants.ZOHO_CRM_LEADS_LINK_NAME;break;case ZCConstants.ZOHO_CRM_ACCOUNTS:J=I+"searchmodule="+ZCConstants.ZOHO_CRM_ACCOUNTS_LINK_NAME;break;case ZCConstants.ZOHO_CRM_CONTACTS:J=I+"searchmodule="+ZCConstants.ZOHO_CRM_CONTACTS_LINK_NAME;break;case ZCConstants.ZOHO_CRM_POTENTIALS:J=I+"searchmodule="+ZCConstants.ZOHO_CRM_POTENTIALS_LINK_NAME;break;case ZCConstants.ZOHO_CRM_CAMPAIGNS:J=I+"searchmodule="+ZCConstants.ZOHO_CRM_CAMPAIGNS_LINK_NAME;break;case ZCConstants.ZOHO_CRM_NOTES:J=I+"searchmodule="+ZCConstants.ZOHO_CRM_NOTES_LINK_NAME;break;case ZCConstants.ZOHO_CRM_SALESORDERS:J=I+"searchmodule="+ZCConstants.ZOHO_CRM_SALESORDERS_LINK_NAME;break;case ZCConstants.ZOHO_CRM_PURCHASEORDERS:J=I+"searchmodule="+ZCConstants.ZOHO_CRM_PURCHASEORDERS_LINK_NAME;break;case ZCConstants.ZOHO_CRM_INVOICES:J=I+"searchmodule="+ZCConstants.ZOHO_CRM_INVOICES_LINK_NAME;break;case ZCConstants.ZOHO_CRM_CASES:J=I+"searchmodule="+ZCConstants.ZOHO_CRM_CASES_LINK_NAME;break;case ZCConstants.ZOHO_CRM_TASKS:J=I+"searchmodule="+ZCConstants.ZOHO_CRM_TASKS_LINK_NAME;break;case ZCConstants.ZOHO_CRM_EVENTS:J=I+"searchmodule="+ZCConstants.ZOHO_CRM_EVENTS_LINK_NAME;break;case ZCConstants.ZOHO_CRM_QUOTES:J=I+"searchmodule="+ZCConstants.ZOHO_CRM_QUOTES_LINK_NAME;break;case ZCConstants.ZOHO_CRM_VENDORS:J=I+"searchmodule="+ZCConstants.ZOHO_CRM_VENDORS_LINK_NAME;break;case ZCConstants.ZOHO_CRM_PRODUCTS:J=I+"searchmodule="+ZCConstants.ZOHO_CRM_PRODUCTS_LINK_NAME;break;case ZCConstants.ZOHO_CRM_PRICEBOOKS:J=I+"searchmodule="+ZCConstants.ZOHO_CRM_PRICEBOOKS_LINK_NAME;break;case ZCConstants.ZOHO_CRM_SOLUTIONS:J=I+"searchmodule="+ZCConstants.ZOHO_CRM_SOLUTIONS_LINK_NAME;break;case ZCConstants.ZOHO_CRM_USERS:J=I+"searchmodule="+ZCConstants.ZOHO_CRM_USERS_LINK_NAME;break;default:J=I}return J+"&fldName="+M+"&fldId="+G+"&frmzc=true";case ZCConstants.EXTERNAL_SERVICE_SDP_OD:switch(H){case ZCConstants.SDP_OD_TECHNICIANS:J=I+"actionToCall=searchGlobal&searchModule="+ZCConstants.SDP_OD_TECHNICIANS_LINK_NAME;break;case ZCConstants.SDP_OD_CATEGORY:J=I+"actionToCall=searchGlobal&searchModule="+ZCConstants.SDP_OD_CATEGORY_LINK_NAME;break;case ZCConstants.SDP_OD_STATUS:J=I+"actionToCall=searchGlobal&searchModule="+ZCConstants.SDP_OD_STATUS_LINK_NAME;break;case ZCConstants.SDP_OD_LEVEL:J=I+"actionToCall=searchGlobal&searchModule="+ZCConstants.SDP_OD_LEVEL_LINK_NAME;break;case ZCConstants.SDP_OD_PRIORITY:J=I+"actionToCall=searchGlobal&searchModule="+ZCConstants.SDP_OD_PRIORITY_LINK_NAME;break;case ZCConstants.SDP_OD_REQUEST_TYPE:J=I+"actionToCall=searchGlobal&searchModule="+ZCConstants.SDP_OD_REQUEST_TYPE_LINK_NAME;break;case ZCConstants.SDP_OD_SITES:J=I+"actionToCall=searchGlobal&searchModule="+ZCConstants.SDP_OD_SITES_LINK_NAME;break;case ZCConstants.SDP_OD_DEPARTMENTS:J=I+"actionToCall=searchGlobal&searchModule="+ZCConstants.SDP_OD_DEPARTMENTS_LINK_NAME;break;case ZCConstants.SDP_OD_ASSETS:J=I+"actionToCall=searchGlobal&searchModule="+ZCConstants.SDP_OD_ASSETS_LINK_NAME;break;case ZCConstants.SDP_OD_USERS:J=I+"actionToCall=searchGlobal&searchModule="+ZCConstants.SDP_OD_USERS_LINK_NAME;break;default:J=I}return J+"&fldName="+M+"&fldId="+G+L;default:return I}};this.showExternalGridPopup=function(J,K,M,Q,P,N,O){var R=J.getAttribute("labelName");var G=Q+"_"+R;var L=P+"_"+R;var I=$("input[id='"+G+"']").attr("disabled");if(I!=="disabled"){var H=ZCEvalApp.constructExternalURL(K,M,G,L,N,O);if(K==ZCConstants.EXTERNAL_SERVICE_SDP_OD){ZCEvalApp.showExternalLookupInIframe(H,Q)}else{ZCEvalApp.showExternalPopup(H,G)}}};this.postMessageCallback=function(H,G,J){var I=JSON.parse(H.data);if(I.pbname!=null&&I.pbname!="null"&&I.pbname!=undefined&&I.pbname!="undefined"&&I.pbname!=""){docid(G).value=I.pbname;docid(J).value=I.fldId}else{if(I.fldName!=null&&I.fldName!=undefined&&I.fldName!="null"&&I.fldName!="undefined"&&I.fldName!=""){docid(G).value=I.fldName;docid(J).value=I.fldId}}closeDialog();CRMLookupCallBack();A=undefined;F=undefined};this.getParameterByName=function(H,G){var I=null;if(G.indexOf(H+"=")!=-1){H=H+"=";I=G.substring(G.indexOf(H)+H.length);if(I.indexOf("&")!=-1){I=I.substring(0,I.indexOf("&"))}}return I};var A,F;var C=false;var B=null;this.showExternalPopup=function(J,H){B=$("input[id='"+H+"']");var G=B.attr("disabled");if(G!=="disabled"){ExternalFieldName=H;var I=ZCEvalApp.getParameterByName("searchmodule",J);if(docid("CRMPopupIframe")!=null){closeDialog()}ZCApp.setLoadingMsg($("#zc-loading"),i18n.pleasewait+" ...");ZCApp.showLoading("zc-loading");J=J+"&service=zcreator";ZCUtil.showInDialog("<div class='zc-imgpreview_outerdiv'><center id='iframeTitle'>"+i18n.ZohoCRM+" - "+I+" "+i18n.NameLookup+"</center></div><br/><div class='zc-imgpreview_src'><iframe id='CRMPopupIframe' src="+J+" width='700' height='560' style='border:none;'></iframe></div>");$(oDialog).hide();$(oDialog).find("#iframeTitle").css("margin","17px");$(oDialog).find(".zc-dialog-close").css("margin-top","17px");$(oDialog).find(".zc-dialog-close-old span").css("color","black");$(oDialog).find(".zc-imgpreview_src").css("margin-top","-25px");A=H;F=J;if(!C){C=true;if(window.addEventListener){window.addEventListener("message",function(K){ZCEvalApp.messageListener(K)},false)}else{window.attachEvent("onmessage",function(K){ZCEvalApp.messageListener(K)})}}$("#CRMPopupIframe").on("load",function(){ZCApp.hideLoading("zc-loading");$(oDialog).show();var K=window.location.href;K=K.substring(0,K.indexOf("//")+2)+location.host;docid("CRMPopupIframe").contentWindow.postMessage(K,integrationCRMUrl)})}};this.messageListener=function(G){if(A!=undefined&&F!=undefined&&G.origin==integrationCRMUrl){CRMID=ZCEvalApp.getParameterByName("fldId",F);ZCEvalApp.postMessageCallback(G,A,CRMID)}};var E=false;var D;this.showExternalLookupInIframe=function(J,L){D=L;var H=document.createElement("a");H.href=document.referrer;var I=H.port!=""?":"+H.port:"";var G="/externalLookupInIframe.do";var K="sharedBy="+ZCApp.sharedByDisp;K=K+"&externalUrl="+J;K=K+"&appLinkName="+ZCApp.appLinkName;K=K+"&referrerUrl="+H.protocol+"//"+H.hostname+I;ZCUtil.sendRequest(G,K,"html","ZCEvalApp.showExternalLookupInIframe_return")};this.postMessageCallBackForSDP=function(G){docid(G.parentFld).value=G.parentFldValue;docid(G.parentFldName).value=G.parentFldNameValue;D=undefined;closeDialog();SDPODLookupCallBack()};this.messageListenerForSDP=function(G){var I=JSON.parse(G.data);var H=window.location.href;H=H.substring(0,H.indexOf("//")+2)+location.host;if(D!=undefined&&G.origin==H&&I.serviceType==ZCConstants.EXTERNAL_SERVICE_SDP_OD){ZCEvalApp.postMessageCallBackForSDP(I)}};this.showExternalLookupInIframe_return=function(H,I){var G="position=absmiddle, closeButton=no, modal=yes, position=absolute, closeParent=false";showDialog(H,G);if(!E){E=true;if(window.addEventListener){window.addEventListener("message",function(J){ZCEvalApp.messageListenerForSDP(J)},false)}else{window.attachEvent("onmessage",function(J){ZCEvalApp.messageListenerForSDP(J)})}}};this.showExternalModuleLookup=function(J,O,P,H,M,N){var I=$("#"+P).attr("disabled");if(I!=="disabled"){var L=docid(P).getAttribute("formLinkName");var G="/externalModuleLookup.do";var K="sharedBy="+ZCApp.sharedByDisp;K=K+"&serviceType="+J;K=K+"&moduleType="+O;K=K+"&fieldName="+P;K=K+"&fsField="+H;K=K+"&fcID="+M;K=K+"&formLinkName="+L;K=K+"&zccpn="+getCookie("zccpn");if(!N){N=""}K=K+"&extType="+N;ZCUtil.sendRequest(G,K,"html","ZCEvalApp.showExternalModuleLookup_return")}};this.showExternalModuleLookup_return=function(H,I){var G="position=absmiddle, closeButton=no, modal=yes, position=absolute, closeParent=false";showDialog(H,G)};this.showExternalModuleLookupSubform=function(M,N,Q,R,K){var S=M.getAttribute("labelName");var H=M.getAttribute("subLabelName");var G=R+"_"+S;var J=$("input[id='"+G+"']").attr("disabled");if(J!=="disabled"){var P=docid(R+"_"+S).getAttribute("formLinkName");var L=docid(R+"_"+S).getAttribute("appLinkName");var I="/externalModuleLookup.do";var O="sharedBy="+ZCApp.sharedByDisp;O=O+"&serviceType="+N;O=O+"&moduleType="+Q;O=O+"&fieldName="+R;O=O+"&fsField="+K;O=O+"&fcID="+S;O=O+"&formLinkName="+P;O=O+"&appLinkName="+L;O=O+"&subLabelName="+H;O=O+"&extType=subform";O=O+"&zccpn="+getCookie("zccpn");ZCUtil.sendRequest(I,O,"html","ZCEvalApp.showExternalModuleLookup_return")}};this.showIntegrationLookup=function(K,G){var I=docid(K).getAttribute("formLinkName");var J="sharedBy="+ZCApp.sharedByDisp+"&fcID="+G+"&appLinkName="+ZCApp.appLinkName+"&formLinkName="+I+"&fieldName="+K;var H="/integrationLookup.do";ZCUtil.sendRequest(H,J,"html","ZCEvalApp.showIntegrationLookup_return")};this.showIntegrationLookup_return=function(H,I){var G="position=absmiddle, closeButton=no, modal=yes, position=absolute, closeParent=false";showDialog(H,G)};this.searchIntegrationLookup=function(H,M,L,N){var N=docid("fieldName").value;var K=docid("formLinkName").value;var O=docid("integ-search-str").value;var J="sharedBy="+ZCApp.sharedByDisp+"&appLinkName="+ZCApp.appLinkName+"&formLinkName="+K+"&fieldName="+N+"&searchString="+O;if(H){var K=docid("formLinkName").value;var I=M+9;if(M<0||H=="first"){M=0;I=9}else{if(H=="last"){M=L-9;I=L}else{if(H=="next"&&M>L){M=M+9;I=M+9}}}J=J+"&from="+M+"&to="+I}var G="/integrationLookup.do";ZCUtil.sendRequest(G,J,"html","ZCEvalApp.searchIntegrationLookup_return")};this.searchIntegrationLookup_return=function(H,I){closeDialog();var G="position=absmiddle, closeButton=no, modal=yes, position=absolute, closeParent=false";showDialog(H,G)};this.setIntegrationFieldValue=function(H,G,I){docid(I).value=(H.innerHTML).trim();docid(I+"_integPrimaryID").value=G;closeDialog()};this.searchExternalModuleLookup=function(I,R,N){var M=docid("ext-formLinkName").value;var T=docid("ext-search-str").value;var J=docid("ext-serType").value;var Q=docid("ext-modType").value;var S=docid("ext-fieldName").value;var H=docid("ext-fsField").value;var O=docid("ext-fcID").value;var P=docid("ext-Type").value;var L="sharedBy="+ZCApp.sharedByDisp;L=L+"&serviceType="+J;L=L+"&moduleType="+Q;L=L+"&fieldName="+S;L=L+"&fsField="+H;L=L+"&fcID="+O;L=L+"&formLinkName="+M;L=L+"&extType="+P;var K=R+9;if(I){if(R<0||I=="first"){R=0;K=9}else{if(I=="last"){R=N-(N%10);K=R+9}else{if(I=="next"&&R>N){R=R-10;K=R+9}}}L=L+"&searchString="+T+"&from="+R+"&to="+K}else{L=L+"&searchString="+T}L=L+"&zccpn="+getCookie("zccpn");var G="/externalModuleLookup.do";ZCUtil.sendRequest(G,L,"html","ZCEvalApp.searchExternalModuleLookup_return")};this.searchExternalModuleLookup_return=function(H,I){closeDialog();var G="position=absmiddle, closeButton=no, modal=yes, position=absolute, closeParent=false";showDialog(H,G)};this.setExtFieldValue=function(H,P,M){var N=docid("ext-Type").value;closeDialog();if(N=="grid"){var J=H.parentNode;var O=J.getElementsByTagName("td");var I=O[O.length-1];docid(P).value=(H.innerHTML).trim();docid(P).setAttribute("extValue",(I.innerHTML).trim())}else{if(N==="sheet"){var J=H.parentNode;var O=J.getElementsByTagName("td");var I=O[O.length-1];docid(P).value=(H.innerHTML).trim();docid(P).setAttribute("extValue",(I.innerHTML).trim());ZCSheetView.updateZohoCrmUserVal(P)}else{if(N=="subform"){var J=H.parentNode;var O=J.getElementsByTagName("td");var I=O[O.length-1];var L=H.getAttribute("fName");var G=H.getAttribute("subLabelName");docid(P+"_"+M).value=(I.innerHTML).trim();docid(G+"_"+L+"_"+M).value=(H.innerHTML.trim())}else{var J=H.parentNode;var O=J.getElementsByTagName("td");for(var K=0;K<O.length;K++){var I=O[K];var L=I.getAttribute("fName");docid(L+"_"+M).value=(I.innerHTML).trim()}docid(P).value=(H.innerHTML).trim();ExternalFieldName=P;if(ExternalFieldName){ZCForm.triggerExternalOnUser(P);ExternalFieldName=""}}}}}};var ZCAppSearch=new function(){this.showHideSearchList=function(){var A=$("#app_search_option_list");A.toggle();if(A.css("display")=="none"){$("#app_search_box").removeClass("moreSearch")}else{$("#app_search_box").addClass("moreSearch")}AppAdvancedSearch.closeAdvSearch(true);$("#liveSearch").removeAttr("readonly")};this.hideSearchList=function(){var A=$("#app_search_option_list");A.css("display","none");$("#app_search_box").removeClass("moreSearch")};this.searchFormList=function(B){var A=$(B).val();var C=$("#app_search_box_container").find('li[elname="formNameList"]');if(A){$(C).find("label:not(:contains("+A+"))").closest("li").slideUp();$(C).find("label:contains("+A+")").closest("li").slideDown()}else{$(C).slideDown()}};this.resetElementSelect=function(B){var A=$("#app_search_box_container").find('li[elname="formNameList"]').find("input");if($(B).is(":checked")){A.prop("checked",true)}else{A.removeAttr("checked")}};this.uncheckALL_Form=function(){$("#All_Form").removeAttr("checked")};this.MAX_LAYOUT_SIZE=4;this.layoutDetails;this.searchTerm;this.searchableLayouts;this.loadedLayouts;this.searchCriteriaArray;this.isAdvancedSearch;this.clearAndLoadLayouts=function(C,D){var B=$(C).attr("searchType");if(B==="basic"){if(D.keyCode==13){if(!this.isSearchTermBlank(C)){this.searchTerm=$(C).val();this.layoutDetails={};this.isAdvancedSearch=false;this.searchableLayouts=null;this.loadedLayouts=new Array();this.loadLayouts();$(".searchList").hide();$("#advSearch").hide()}}}else{if(B==="withCriteria"){this.isAdvancedSearch=true;this.layoutDetails={};this.searchableLayouts=new Array(AppAdvancedSearch.formLinkName);this.loadedLayouts=new Array();this.searchCriteriaArray=new Array();var A=new Array();var G=false;var E=AppAdvancedSearch.formLinkName+"{";$("#expandableList").children().each(function(){var H=$(this).find("#advFieldUl").find("li.selected").find("a");var I=$(this).find("#advSearchText").val().trim();if(I.length===0){G=true;AppAdvancedSearch.emptyFieldIndication($(this).find("#advSearchText"))}var J=I.charAt(0);if(J==="<"||J===">"){var K=I.slice(1,I.length).trim();if(K.length===0){G=true;AppAdvancedSearch.emptyFieldIndication($(this).find("#advSearchText"))}I=J+" "+K}A.push({formCompId:$(H).attr("value"),searchTerm:I});E=E+$(H).text()+": "+I+", "});if(G){return false}E=E.slice(0,-2)+"}";var F=$("#liveSearch");$(F).val(E);$(F).attr("onclick","AppAdvancedSearch.advSearchPopup();");$(F).attr("readonly","readonly");this.searchCriteriaArray=A;this.loadLayouts();$(".searchList").hide();$("#advSearch").hide()}}};this.isSearchTermBlank=function(B){var A=$(B).val();return(A.length===0||!A.trim())};this.removeFromArray=function(C,B){var A=C.indexOf(B);if(A!=-1){C.splice(A,1)}};this.enDisPreAndNextlink=function(){var A=$('div[elname="searchResultsContainer"]');if(this.searchableLayouts.length==this.loadedLayouts.length){A.find('div[elname="searchlayoutNextlink"]').css("display","none")}else{A.find('div[elname="searchlayoutNextlink"]').css("display","")}if(this.loadedLayouts.length<=this.MAX_LAYOUT_SIZE){A.find('div[elname="searchlayoutPreviouslink"]').css("display","none")}else{A.find('div[elname="searchlayoutPreviouslink"]').css("display","")}if(A.find('div[elname="layoutDiv"]').length==0){A.prepend('<div class="outerlayer"><div class="searchNoResults" align="center">No matching record(s) found </div><div>')}};this.loadPrevious=function(){for(var A=0;A<this.MAX_LAYOUT_SIZE+$('div[elname="layoutDiv"]').length;A++){this.loadedLayouts.pop()}this.loadLayouts()};this.loadNext=function(){this.loadLayouts()};this.loadLayouts=function(){var A={};A.searchTerm=this.searchTerm;A.appLinkName=ZCApp.appLinkName;A[ZCApp.csrfParamName]=ZCApp.csrfParamValue;A.sharedBy=ZCApp.sharedBy;A.selectedLayouts=JSON.stringify(this.getSearchableLayouts());A.isAdvancedSearch=this.isAdvancedSearch;if(this.isAdvancedSearch){A.searchCriteriaArray=JSON.stringify(this.searchCriteriaArray)}ZCApp.setLoadingMsg($("#zc-loading"),i18n.pleasewait+" ...");ZCApp.showLoading("zc-loading");$.post("/appDataSearch.do",A,function(D,E,C){if(D){var B=$("#zc-component").find("div[elname='zc-component-searchlayout']");ZCApp.clearZCComponent();B.append(D);B.css("display","")}else{$("#statusMessage").text("Error Occured").fadeIn().delay(2000).fadeOut()}ZCApp.hideLoading("zc-loading")},"html")};this.getSearchableLayouts=function(){var A=new Array();if(!this.searchableLayouts){var D=$("#app_search_box_container").find('input[elname="searchoption"]:checked');this.searchableLayouts=new Array();for(var C=0;C<D.size();C++){this.searchableLayouts[C]=$(D[C]).attr("id").substring(17)}}for(var B=0;B<this.searchableLayouts.length;B++){if(this.loadedLayouts.indexOf(this.searchableLayouts[B])==-1){A.push(this.searchableLayouts[B])}}return A};this.setLayoutDetails=function(C,E){var D=$("div[layoutName='"+C+"']");D.find("span[elname='fromIndex']").text(E.fromIndex);D.find("span[elname='lastIndex']").text(E.lastIndex);var B=D.find('div[elname="previouslink"]');var A=D.find('div[elname="nextlink"]');if(E.hasPreviousElements){B.removeClass("searchlayoutprelink_disabled searchlayoutprelink_enabled").addClass("searchlayoutprelink_enabled");B.click(function(){ZCAppSearch.loadLayoutData(C,"previous")})}else{B.removeClass("searchlayoutprelink_disabled searchlayoutprelink_enabled").addClass("searchlayoutprelink_disabled");B.off("click")}if(E.hasMoreElements){A.removeClass("searchlayoutnextlink_disabled searchlayoutnextlink_enabled").addClass("searchlayoutnextlink_enabled");A.click(function(){ZCAppSearch.loadLayoutData(C,"next")})}else{A.removeClass("searchlayoutnextlink_disabled searchlayoutnextlink_enabled").addClass("searchlayoutnextlink_disabled");A.off("click")}};this.loadLayoutData=function(E,B){var A=$("#zc-component").find("div[elname='zc-component-searchlayout']");var H=A.find("[layoutname='"+E+"']");var G=H.find("div[elname='dataDiv']");var D=G.find("table");var F=this.layoutDetails[E];if(!F.loadingtriggerd){F.loadingtriggerd=true;var C={};C.searchTerm=this.searchTerm;C.isAdvancedSearch=this.isAdvancedSearch;if(this.isAdvancedSearch){C.searchCriteriaArray=JSON.stringify(this.searchCriteriaArray)}C[ZCApp.csrfParamName]=ZCApp.csrfParamValue;C.layout=E;C.appLinkName=ZCApp.appLinkName;C.fromIndex=F.fromIndex;C.lastIndex=F.lastIndex;C.searchState=JSON.stringify(F.searchState);C.navigation=B;C.sharedBy=ZCApp.sharedBy;ZCApp.setLoadingMsg($("#zc-loading"),i18n.pleasewait+" ...");ZCApp.showLoading("zc-loading");$.post("/loadLayoutData.do",C,function(J,L,I){if(J){var K=D.find("tbody");K.find("tr").remove();K.append(J);F.loadingtriggerd=false}else{$("#statusMessage").text("Error Occured").fadeIn().delay(2000).fadeOut()}ZCApp.hideLoading("zc-loading")},"html")}};this.showEditForm=function(C){var D=$(C).closest("tr");var B=D.closest('div[elname="layoutDiv"]').attr("layoutname");var A=D.attr("reclinkid");var E="compType="+ZCConstants.FORM+"&formLinkName="+B+"&formAccessType="+ZCConstants.VIEW_EDIT_FORM+"&recLinkID="+A;E=E+"&formBasedOperation=true&isNewAppearance=true&zc_EditType=default";ZCUtil.sendRequest(ZCApp.compProps["actionURL-"+ZCConstants.FORM],E,"html","ZCApp.loadZCCompInDialog",ZCUtil.getParamsAsMap("include=false&closeDialog=true"),i18n.pleasewait)};this.deleteRecord=function(D){var F=$(D).closest("tr");var C=F.closest('div[elname="layoutDiv"]').attr("layoutname");var B=F.attr("reclinkid");var E="/deleteformrecord.do";var A="sharedBy="+ZCApp.sharedByDisp+"&appLinkName="+ZCApp.appLinkName+"&formLinkName="+C+"&deletegroup="+B;A=A+"&"+ZCApp.csrfParamName+"="+ZCApp.csrfParamValue;A=A+"&formBasedOperation=true";ZCView.showConfirmPopUp(i18n.deleterecord,function(){ZCUtil.sendRequest(E,A,"json","ZCAppSearch.handleDelRecAction","duplicate",i18n.duplicateinfomsg)})};this.viewRecord=function(D){var E=$(D).closest("tr");var C=E.closest('div[elname="layoutDiv"]').attr("layoutname");var B=E.attr("reclinkid");var F="/viewformrecord.do";var A={};A.sharedBy=ZCApp.sharedByDisp;A.appLinkName=ZCApp.appLinkName;A.formLinkName=C;A.recordlinkID=B;A[ZCApp.csrfParamName]=ZCApp.csrfParamValue;A.formBasedOperation=true;$.post(F,A,function(I,J,H){var G="closeButton=no";ZCUtil.showInDialog(I,"position=absolute, "+G+",closeOnBodyClick=yes, modal=yes, dialog_closeOutside=true");ZCApp.correctDialog()},"html")};this.handleDelRecAction=function(A,B,J){var F=null;var D=ZCForm.getMsgFromResponse(A,"");var C=ZCUtil.isNull(D.succMsg)?"":D.succMsg;var H=D.successMsgDuration;var G=D.successList;var K=D.errorList;var I=(G)?G.length+" "+i18n.delsuccmsg:"";var E=(K)?K.length+" "+i18n.delfailmsg:"";if(!ZCUtil.isNull(K)||!ZCUtil.isNull(G)){}ZCAppSearch.loadLayoutData(B.formLinkName[0],"current");return false};this.adjustFixedBar=function(){if($("#searchResultsContainerDiv")[0]){var A=$(document).width();var H=$(window).scrollLeft();var E=$(window).width();var D=$('div[elname="searchlayoutfooter"]');D.css("right",15+A-(E+H));var G=$('div[elname="searchlayoutsNavBar"]');var F=G.find('div[elname="searchlayoutPreviouslink"]').css("display");var C=G.find('div[elname="searchlayoutNextlink"]').css("display");var B=F!=="none"?94:0;B+=C!=="none"?94:0;B+=F!=="none"&&C!=="none"?10:0;G.css("left",H+(E-B)/2)}}};jQuery.uaMatch=function(B){B=B.toLowerCase();var A=/(chrome)[ \/]([\w.]+)/.exec(B)||/(webkit)[ \/]([\w.]+)/.exec(B)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(B)||/(msie) ([\w.]+)/.exec(B)||B.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(B)||[];return{browser:A[1]||"",version:A[2]||"0"}};if(!jQuery.browser){matched=jQuery.uaMatch(navigator.userAgent);browser={chrome:false,webkit:false,safari:false,msie:false,mozilla:false,opera:false};if(matched.browser){browser[matched.browser]=true;browser.version=matched.version}if(browser.chrome){browser.webkit=true}else{if(browser.webkit){browser.safari=true}}jQuery.browser=browser}function getWindowHeight(){var A=0;if(typeof (window.innerWidth)=="number"){A=window.innerHeight}else{if(document.documentElement&&(document.documentElement.clientHeight)){A=document.documentElement.clientHeight}else{if(document.body&&(document.body.clientHeight)){A=document.body.clientHeight}}}return A}function getWindowWidth(){var A=0;if(typeof (window.innerWidth)=="number"){A=window.innerWidth}else{if(document.documentElement&&(document.documentElement.clientWidth)){A=document.documentElement.clientWidth}else{if(document.body&&(document.body.clientWidth)){A=document.body.clientWidth}}}return A}function setLanguageCookie(B){var D=$(B).attr("langvalue");var C=$(B).attr("appid");var A=$(B).attr("dispname");ZCApp.setCookie("zc_"+C+"_"+A+"_language",D);window.location.reload()}function showLiveDeskPane(){$("#chatContainer").slideDown(500);$("#liveChatFloat").fadeOut();var B=$("#liveChatFloat").attr("appLinkName");var A=$("#liveChatFloat").attr("dispname");ZCApp.setCookie("zc_"+B+"_"+A+"_ChatFrameVisible","true")}function hideLiveDeskPane(){$("#chatContainer").slideUp(500);$("#liveChatFloat").fadeIn();var B=$("#chatContainer").attr("appLinkName");var A=$("#chatContainer").attr("dispname");ZCApp.setCookie("zc_"+B+"_"+A+"_ChatFrameVisible","")}var AppAdvancedSearch=new function(){this.formLinkName;this.displayName;this.showAdvSearchLink=function(A){$(A).find(".searchLink").show()};this.hideAdvSearchLink=function(A){$(A).find(".searchLink").hide()};this.advSearchPopup=function(){$(".searchList").hide();$("#advSearch").show()};this.submitOnEnter=function(A,B){if(B.keyCode==13){ZCAppSearch.clearAndLoadLayouts(A)}};this.resetPopup=function(){var A=$("#liveSearch");$(A).val("");$(A).removeAttr("onclick");$(A).removeAttr("readonly");var B=$("#expandableList");$(B).html($(B).children().slice(0,1));$(B).find(".plus").show();$(B).find(".cross").show();$("#advFieldButton").attr("title","");this.showAdvancedSearch(this.formLinkName,this.displayName)};this.showAdvancedSearch=function(C,A){this.formLinkName=C;this.displayName=A;var D=$("#advSearchHeader");$(D).attr("title",A);$(D).text("Advanced Search - "+(A.length>25?A.substring(0,25)+"...":A));var B=$("#advFieldUl");$(B).hide();$(B).html("");$.ajax({url:"/getSearchableFields.do",data:"appLinkName="+ZCApp.appLinkName+"&sharedBy="+ZCApp.sharedBy+"&formLinkName="+C,type:"GET",success:function(G){if(G.length>0){var H=$("#advFieldText");var I=$("#advSearchText");var E=document.createElement("li");var F=document.createElement("a");$(H).text("All");$(I).attr("placeholder","e.g. john, john@xxx.com, 50");$(I).attr("searchType","withCriteria");$(I).attr("onkeyup","AppAdvancedSearch.submitOnEnter(this,event)");$(I).val("");$(E).attr("id",0);$(E).attr("class","selected");$(F).text("All");$(F).attr("href","javascript:void(0);");$(F).attr("value",0);$(F).attr("onclick","AppAdvancedSearch.selectedAdvField(this)");$(E).append($(F));$(B).append($(E));$("#advFieldButton").attr("title","All");$.each(G,function(L,M){var N=M.formCompId;var J=document.createElement("li");var K=document.createElement("a");$(J).attr("id",N);$(K).text(M.displayName);$(K).attr("href","javascript:void(0);");$(K).attr("type",M.componentType);$(K).attr("value",N);$(K).attr("onclick","AppAdvancedSearch.selectedAdvField(this)");$(J).append($(K));$(B).append($(J))})}$(".searchList").hide();$("#advSearch").show()}})};this.setPlaceholder=function(E){var D=$(E).attr("type");var C=$(E).closest("div");var G=$(C).parent("div");var A=$(G).find("#advSearchText");var F;$(A).val("");switch(D){case 5:case 8:case 31:F="e.g. 50, <50, >50";break;case 6:case 7:case 19:F="e.g. 50.00, <50.00, >50.00";break;case 4:F="e.g. john, john@xxx.com";break;case 9:F="e.g. true, false";break;case 10:var B=new Date();F="e.g. "+$.datepicker.formatDate("dd-M-yy",new Date());break;case 22:var B=new Date();F="e.g. "+$.datepicker.formatDate("dd-M-yy",B)+" "+B.getHours()+":"+B.getMinutes()+":"+B.getSeconds();break;default:F="e.g. john, john@xxx.com, 50"}$(A).attr("placeholder",F)};this.closeAdvSearch=function(A){var B=$("#liveSearch");$(B).val("");$(B).removeAttr("onclick");$(B).removeAttr("readonly");var C=$("#expandableList");$("#advSearch").hide();if(!A){$(".searchList").show()}$(C).html($(C).children().slice(0,1));$(C).find(".plus").show();$("#advFieldText").text("All");$("#advFieldButton").attr("title","All")};this.showAdvFieldList=function(B){var A=$(B).closest("div").find("ul");$(A).css("display")==="none"?$(A).show():$(A).hide()};this.selectedAdvField=function(D){var F=$(D).closest(".expandableList");var C=$(F).find("ul");var G=$(C).find("li.selected");var B=$(D).parent("li");var E=$(D).text();var A=$(F).attr("listIndex");$(C).hide();$(F).find("#advFieldButton").attr("title",E);E=E.length>12?E.substr(0,12)+"...":E;$(F).find("#advFieldText").text(E);$(G).removeClass("selected");$(B).addClass("selected");this.setPlaceholder(D);this.addFieldToFieldsUl($(G),A);this.removeFieldLiFromFieldUl($(B).attr("id"),A)};this.addParamField=function(E){var G=$("#expandableList").children().length;var D=$(E).closest(".expandableList");var C=$(D).clone();var B=$(C).find("#advFieldUl");var A=$(B).find("li.selected");$(A).removeClass("selected");$(A).hide();var H=$(B).find("li").filter(function(){return $(this).css("display")!="none"}).first();if($(H).size()>0){var F=$(H).text();$(C).find("#advFieldButton").attr("title",F);F=F.length>12?F.substr(0,12)+"...":F;$(C).find("#advFieldText").text(F);this.setPlaceholder($(H).find("a"));$(C).attr("listIndex",parseInt($(D).attr("listIndex"))+1);$(C).find("#advSearchText").val("");$(C).find(".cross").show();$(D).find(".plus").hide();$(D).find(".cross").css("margin-left","10px");if(G!=1){$(D).find(".cross").show()}$(H).addClass("selected");$(D).parent("div").append($(C));this.removeFieldLiFromFieldUl((H).attr("id"),$(C).attr("listIndex"))}};this.removeParamField=function(E){var D=$("#expandableList").children();var F=D.length;var H=$(E).closest(".expandableList");var A=$(H).find("ul").find("li.selected");var C=$(H).attr("listIndex");if(C==1&&F==1){return }if(C==F){var B=D.get(C-2);$(B).find(".plus").show();$(B).find(".cross").css("margin-left","10px");$(H).remove()}else{if(C==1){var G=D.get(C);if(F==2){$(G).find(".plus").show();$(G).find(".cross").css("margin-left","10px")}$(H).remove()}else{$(H).remove()}}this.addFieldToFieldsUl($(A))};this.addFieldToFieldsUl=function(A,B){B=(B==undefined)?0:B;$("#expandableList").children().each(function(D){if((D+1)!=B){var E=$(this).find("#advFieldUl");var F=A.children().get(0).getAttribute("value");var C=$(E).find("#"+F);if($(C)!=undefined){$(C).show()}}$(this).attr("listIndex",D+1)})};this.removeFieldLiFromFieldUl=function(B,A){$("#expandableList").children().each(function(D){if((D+1)!=A){var C=$(this).find("#advFieldUl").find("li#"+B);if(C!=undefined){$(C).hide()}}})};this.emptyFieldIndication=function(A){$(A).css("border-color","red");setTimeout(function(){$(A).css("border-color","")},1000)}};function setCookieForOpenApp(F){var E=document.domain;var D=E.substring(0,E.lastIndexOf("."));var B=E.substring(D.lastIndexOf("."),E.length);var G=F;var A=new Date();A.setDate(A.getDate()+7);var C="expires="+A.toUTCString();document.cookie="LandingPage="+G+";"+C+";domain="+escape(B)+";path="+escape("/")+";"}function bannerDisplay(G,B){var C=document.domain;var I=C.substring(0,C.lastIndexOf("."));var H=C.substring(I.lastIndexOf("."),C.length);var E=G;var D=new Date();D.setDate(D.getDate()+7);var A="expires="+D.toUTCString();document.cookie="MobSiteBanner="+E+";"+A+";domain="+escape(H)+";path="+escape("/")+";";$(".contclass").css("display","none");$("#zc-viewcontainer_"+B).find("table").css("margin-top","42px");var F=window.location.href;if(F.lastIndexOf("/mobilehome.do")!=-1||F.lastIndexOf("/mobile/shared")!=-1||F.lastIndexOf("/home")!=-1||F.indexOf("/mobile")+7==F.length||F.indexOf("/m")+2==F.length){$(".listdivclass").css("margin-top","72px")}else{$(".listdivclass").css("margin-top","42px")}if(docid("mobile-view-header")!=undefined){docid("mobile-view-header").style.minHeight="42px";$("#zc-listviewheader").css("top","42px");$(".zc-summary-table").css("margin-top","42px")}if(docid("mobile-form-header")!=undefined){docid("mobile-form-header").style.minHeight="42px"}if(docid("mobile-report-header")!=undefined){docid("mobile-report-header").style.minHeight="42px"}}function openAppBannerTimeOut(A){var B=window.navigator.userAgent.toUpperCase();if(B.indexOf("ANDROID")!=-1){setTimeout(function(){window.location="https://play.google.com/store/apps/details?id=com.zoho.creator.a"},6000)}else{if(B.indexOf("IPHONE")!=-1){setTimeout(function(){window.location="https://itunes.apple.com/us/app/zoho-creator/id692005267?mt=8"},6000)}}window.location="OpenAppUrl"}function callTimeOut(G,F){var E=document.domain;var D=E.substring(0,E.lastIndexOf("."));var B=E.substring(D.lastIndexOf("."),E.length);var A=new Date();var C="expires="+A.toUTCString();setTimeout(function(){document.cookie="LandingPage=null;"+C+";domain="+escape(B)+";path="+escape("/")+";";window.location=G},6000);window.location=F}function isIframeCheck(){var A=window.frameElement;if(A!=null){$("#cont").css("display","none");if(docid("mobile-view-header")!=undefined){docid("mobile-view-header").style.minHeight="42px";$("#zc-listviewheader").css("top","42px");$(".zc-summary-table").css("margin-top","42px")}if(docid("mobile-form-header")!=undefined){docid("mobile-form-header").style.minHeight="42px"}if(docid("mobile-report-header")!=undefined){docid("mobile-report-header").style.minHeight="42px"}}}function getBannerCookie(){if(isNativeAppPromo&&!isExcludedList){var D=window.location.href;var A=D;var B=document.cookie.split(";");for(var C=0;C<B.length;C++){name=B[C].split("=")[0];value=B[C].split("=")[1];if(name.trim()=="MobSiteBanner"&&value.trim()=="HideBanner"){$(".contclass").css("display","none");if(D.lastIndexOf("/mobilehome.do")!=-1||D.lastIndexOf("/mobile/shared")!=-1||D.lastIndexOf("/home")!=-1||D.indexOf("/mobile")+7==D.length||D.indexOf("/m")+2==D.length){$(".listdivclass").css("margin-top","72px")}else{$(".listdivclass").css("margin-top","42px")}if(D.indexOf("view-mobile")!=-1||D.indexOf("viewLinkName")!=-1){docid("mobile-view-header").style.minHeight="42px";$("#zc-listviewheader").css("top","42px");$(".zc-summary-table").css("margin-top","42px")}if(D.indexOf("form-mobile")!=-1||D.indexOf("formLinkName")!=-1){docid("mobile-form-header").style.minHeight="42px"}if(D.indexOf("report-mobile")!=-1||D.indexOf("reportLinkName")!=-1){docid("mobile-report-header").style.minHeight="42px"}}if(name==" LandingPage"&&value=="NativeApp"){D=D.replace("https:","ZohoCreator:");if(D.indexOf("form-mobile")!=-1){D=D.replace("form-mobile/","#Form:")}else{if(D.indexOf("report-mobile")!=-1){D=D.replace("report-mobile/","#Report:")}else{if(D.indexOf("view-mobile")!=-1){D=D.replace("view-mobile/","#View:")}else{if(D.indexOf("/mobile")!=-1){D=D.replace("/mobile/","/")}}}}callTimeOut(A,D)}}}else{$(".contclass").css("display","none");var D=window.location.href;if(D.lastIndexOf("/mobilehome.do")!=-1||D.lastIndexOf("/mobile/shared")!=-1||D.lastIndexOf("/home")!=-1||D.indexOf("/mobile")+7==D.length||D.indexOf("/m")+2==D.length){$(".listdivclass").css("margin-top","72px")}else{$(".listdivclass").css("margin-top","42px")}if(D.indexOf("view-mobile")!=-1||D.indexOf("viewLinkName")!=-1){docid("mobile-view-header").style.minHeight="42px";$("#zc-listviewheader").css("top","42px");$(".zc-summary-table").css("margin-top","42px")}if(D.indexOf("form-mobile")!=-1||D.indexOf("formLinkName")!=-1){docid("mobile-form-header").style.minHeight="42px"}if(D.indexOf("report-mobile")!=-1||D.indexOf("reportLinkName")!=-1){docid("mobile-report-header").style.minHeight="42px"}}}function getCookie(B){var D=document.cookie.split(";");var A;var E;for(var C=0;C<D.length;C++){A=D[C].substr(0,D[C].indexOf("="));E=D[C].substr(D[C].indexOf("=")+1);A=A.replace(/^\s+|\s+$/g,"");if(A===B){return unescape(E)}}}function showMobileFreezer(){isMobileBrowser()&&$(".zc-mobile-frz-layer").length&&$(".zc-mobile-frz-layer").css("display","block")}function hideMobileFreezer(){isMobileBrowser()&&$(".zc-mobile-frz-layer").length&&$(".zc-mobile-frz-layer").css("display","none")}function isMobileBrowser(A){if(!A){A=navigator.userAgent}return(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(A))}function oldDashboardTracking(A){url="/userhome/"+A+"/oldDashboardTacking";$.ajax({url:url,success:function(C,B,D){}})}function getCsrfParamName(){if(ZCApp.csrfParamName===undefined){return"zccpn"}return ZCApp.csrfParamName}function getCsrfParamValue(){if(ZCApp.csrfParamValue===undefined){return getCookie(getCsrfParamName())}return ZCApp.csrfParamValue}function encodeParamValue(H){var G=[];var D=H.split("&");for(var C in D){var F=D[C];if(F&&F.trim().length>0){var B=F.indexOf("=");var A=F.substring(0,B);var E=F.substring(B+1);G.push(A+"="+encodeURIComponent(E))}}return G.join("&")}function isSafariBrowser(){return(navigator.userAgent.indexOf("Safari")!=-1&&navigator.userAgent.indexOf("Chrome")==-1)}isViewBeta=true;var ZCView=new function(){this.reloadCurrView=true;this.zc_RecPrintCal=true;this.uniqueID=null;this.viewArr=[];this.month=new Date().getMonth();this.year=new Date().getFullYear();this.viewEditElem="columns";this.viewEditOpened=false;this.isnewFilter=false;this.editcustomid="";this.editcustomhtml="";this.custcrithtml=null;this.custfilterhtml=null;this.FILTER_COMMA_CONSTANT="@#zoho-comma#@";this.FILTER_COLON_CONSTANT="@#zohocolon#@";this.FILTER_SEMICOLON_CONSTANT="@#zohosemicolon#@";this.FILTER_QUOTS_CONSTANT="@#zohoquots#@";this.FILTER_SLASH_CONSTANT="zohooslash";this.zc_calendar=null;this.calendarViewName=null;this.allowEdit=false;this.allowDelete=false;this.showCalSummary=false;this.daysArray=new Array("fc-sun","fc-mon","fc-tue","fc-wed","fc-thu","fc-fri","fc-sat");this.disableDays="";this.disabledDaysList=new Array();this.wstartTime="0";this.wendTime="48";this.popupopend=false;this.pageHeaderHeight=null;this.fixedColumnHeader=null;this.fixedItems=new Array();this.fixedItemsElems=new Array();this.windowWidth=null;this.fixedItemsStatus=false;this.fixedHeaderNeeded=false;this.scrollFeature=true;this.isOptionsLeftAligned=false;this.lastClickedViewEditSection=null;this.theadFixedElems=null;this.theadElems=null;this.searchOpened=false;this.isGroupSel=false;this.viewContainers=null;this.viewCont=null;this.viewContFixed=null;this.cache=new Array();this.viewContFixedMenus=new Array();this.viewContMenus=new Array();this.currentMenu=new Array();this.currentMenuFixed=new Array();this.recSummaryIdxRefresh=null;var C=new Array();C.viewheaderoptionsdiv="div[elName=zc-viewheaderoptionsdiv]";C.viewsearchoptionsdiv="div[elName=zc-viewsearchoptionsdiv]";C.viewOptionsDIV="div[elName=zc-viewOptionsDIV]";C.viewactionsdiv="div[elName=zc-viewactionsdiv]";C.viewaddcoldiv="div[elName=zc-viewaddcoldiv]";C.viewsavediv="div[elName=zc-viewsavediv]";C.customactionitems="div[elName=zc-customactionitems]";C.recordPerPageCont="div[elName=zc-recordPerPageCont]";C.ShowHideColCont="div[elName=zcShowHideColCont]";C.moreRecActionFloat="div[elName=zc-moreRecActionFloat]";C.PrintOptions="div[elName=zc-PrintOptions]";C.viewheaderitemsspan="span[elName=zc-viewheaderitemsspan]";C.colheaderrow="tr[elName=zc-colheaderrow]";C.zcActionTypeBulk="a[zcActionType=bulk]";C.zcHideMenu="a[zcHideMenu=true]";C.saveViewRecsEl="[elName=zc-saveViewRecsEl]";C["a-saveViewRecsEl"]="a[elName=zc-saveViewRecsEl]";C.viewtable="table[elname=zc-viewtable]";C.recordperpageEl="a[elName=zc-recordperpageEl]";C.customactionmore="a[elName=zc-customactionmore]";C.viewactionmore="a[elName=zc-viewactionmore]";C.moreactionsel="a[elName=zc-moreactionsel]";C.showPrintDialog="a[elName=zc-showPrintDialog]";C.filterselectdd="div[elName=zc-filterselectdd]";C.viewactionsoptions="div[eltype=zc-viewactions-options]";C.formOptionsDIV="div[elName=zc-formOptionsDIV]";C.selectAllRecsEl="input[elName=zc-selectAllRecsEl]";C.recSelectionEl="input[elName=zc-recSelectionEl]";C.recAndGroupSelectionEl="input[elName=zc-recSelectionEl],input[elName=zc-groupSelectionEl]";C.viewrowEl="tr[elName=zc-viewrowEl]";C.rowActionsTdEl="td[elname=zc-rowActionsTdEl]";C.filteradvItem="a[elName=zc-filteradvItem]";C.filteradvbar="div[elName=zc-filteradvbar]";C.filteradvItem="a[elName=zc-filteradvItem]";C.viewsearchrow="tr[elName^=zc-viewsearchrow]";C.moreRecActionCont="div[elName=zc-moreRecActionCont]";C.viewrecactionsheader="div[elname=zc-viewrecactionsheader]";C.viewactionmorehide="img[elname=zc-viewactionmorehide]";C.viewactionmoreshow="img[elname=zc-viewactionmoreshow]";C.filterbarContEl="div[elname=zc-filterbarContEl]";this.preLoadElements=function(E){for(var F in C){ZCView.getElementOrValue(F,E)}};this.getElementOrValue=function(J,H,L){var F=ZCView.cache[H+"_"+J];if(F!=undefined){return F}var I=C[J];if(I!=undefined){var M;if(L!=undefined){M=L}else{M=ZCView.getViewContainers(H)}F=$(M).find(I);ZCView.cache[H+"_"+J]=F;return F}else{if(J.indexOf("FloatMenu_")==0){var K=ZCView.getElementOrValue("moreRecActionFloat",H);F=$(K).find("[zcRecActtype="+J+"]");ZCView.cache[H+"_"+J]=F;return F}else{if(J=="windowWidth"){var G=getWindowWidth();ZCView.cache[J]=G;return G}else{if(J=="windowHeight"){var E=getWindowHeight();ZCView.cache[J]=E;return E}else{if(J=="documentWidth"){var N=$(document).width();ZCView.cache[J]=N;return N}else{if(J=="documentHeight"){var O=$(document).height();ZCView.cache[J]=O;return O}}}}}}return null};this.getElFromViewCont=function(H,E){var G=ZCView.cache[E+"_"+H];if(G==undefined){var F=ZCView.getViewCont(E);G=$(F).find(H);ZCView.cache[E+"_"+H]=G}return G};this.getElFromViewContainers=function(H,E){var G=ZCView.cache[E+"_"+H];if(G==undefined){var F=ZCView.getViewContainers(E);G=$(F).find(H);ZCView.cache[E+"_"+H]=G}return G};this.addToViewArr=function(F,E,G,H){F=F.substring(1,F.length-1);F=ZCUtil.getParamsAsMap(F,",","=");ZCUtil.setInMap(F,"filterVal",encodeURIComponent(H));ZCUtil.setInMap(F,"parentComp",ZCApp.currZCComp);this.viewArr[E]=F;isViewBeta=ZCUtil.getFromMap(F,"isViewBeta")=="true";ZCView.scrollFeature=ZCUtil.getFromMap(F,"scrollFeature")=="true";ZCView.isOptionsLeftAligned=ZCUtil.getFromMap(F,"isOptionsLeftAligned")=="true";if(isViewBeta){ZCApp.dialogAbove='<div class="zc-dialog-heading zc-dialog-noheading" elname="zc-dialogheader"><h1 elname="zc_dialog_header">&nbsp;</h1></div><div class="zc-dialogdiv zc-noappearance">'}};this.getViewCont=function(E){var F=ZCView.cache["zc-viewcontainer_"+E];if(F==undefined){F=$("#zc-viewcontainer_"+E);ZCView.cache["zc-viewcontainer_"+E]=F}return F};this.getViewContainers=function(E){var F=ZCView.cache["zc-viewcontainer_fixed_"+E];if(F==undefined){F=$("#zc-viewcontainer_"+E+", #zc-listviewheader");ZCView.cache["zc-viewcontainer_fixed_"+E]=F}return F};this.showSubMenu=function(E,F){if(isViewBeta){$(E).find("td:first").addClass("zc-viewoptionstable-texthover")}ZCUtil.showSubMenu(E.parentNode,$(E.parentNode).find("div[elName="+$(E.parentNode).attr("subMenuName")+"]")[0],F)};this.hideSubMenu=function(E,F){if(isViewBeta){$(E).find("td:first").removeClass("zc-viewoptionstable-texthover")}ZCUtil.hideSubMenu(E.parentNode,$(E.parentNode).find("div[elName="+$(E.parentNode).attr("subMenuName")+"]")[0],F)};this.imgView=function(J,F){if(!F){var K=$(J).attr("src");var G=K.lastIndexOf("image-download/");var E=K;var H=E;if(G!=-1){var I=K.substring(G+14);E=I.substring(I.indexOf("_")+1);H=E}if(E.length>30){H=E.substring(0,30)+".."}if($(".zc-dialog-close-old").css("display")=="block"){ZCUtil.showInDialog("<div id='imgpreview' class='zc-imgpreview_outerdiv' title='"+E+"' ><span id='span' >"+H+"</span><a href='"+K+"' id='imgpreview_inner' class='zc-imgpreview_innerdiv' download='"+K+"'>"+i18n["zc.viewlive.download"]+"</a></div><br/><div class='zc-imgpreview_src'><img src="+K+" style='margin-top: 1px'></div>","maxwidth=500px,closeOnBodyClick=yes,modal=yes");$("#imgpreview").css({height:"32px","margin-top":"0px","margin-bottom":"5px",padding:"3px 5px 2px 0px","background-color":"white",width:"initial"});$("#imgpreview_inner").css({padding:"3px 6px 2px 3px",top:"0px","margin-top":"4px","margin-right":"46px"});$("#span").css({position:"absolute","margin-top":"5px","margin-left":"7px",color:"black"});$("#_DIALOG_CONTENT br").remove();$("#_DIALOG_CONTENT").find("div[class=zc-dialog-close-old]").find("span").css({color:"black",display:"inline-block",padding:"2px"})}else{ZCUtil.showInDialog("<div class='zc-imgpreview_outerdiv' title='"+E+"' >"+H+"<a href='"+K+"' class='zc-imgpreview_innerdiv' download='"+K+"'>"+i18n["zc.viewlive.download"]+"</a></div><br/><div class='zc-imgpreview_src'><img src="+K+"></div>","maxwidth=500px,closeOnBodyClick=yes,modal=yes")}}};this.imgCount=function(){ZCApp.resize()};this.regViewEvents=function(G,V){if(isViewBeta){var W=$("div#"+V+"_zcFixedDiv");$(W).html($("div#"+V+"_zcViewDiv").html());$(W).find("a[elName=zcCalHeaderSpan]").attr("id","calHeaderSpan")}ZCView.cache=new Array();this.viewCont=null;this.viewContFixed=null;var O=ZCView.getViewCont(V);var X=ZCView.getViewContainers(V);ZCView.searchOpened=ZCUtil.getFromMap(ZCView.viewArr[V],"openSearch")=="true";var M=$(X).find("div[elname=zc-viewOptionsDIV]")[0];var Q=$(M).find("table[class=zc-viewoptionstable]")[0];if(Q!=undefined&&Q.childElementCount==0){$(X).find("a[elname=zc-moreactionsel]").hide();$(X).find("a[elname=zc-recordperpageEl]").css("border-top-right-radius","3px");$(X).find("a[elname=zc-recordperpageEl]").css("border-bottom-right-radius","3px")}$(X).dblclick(function(d){var c=$(d.target);ZCView.uniqueID=G;return ZCView.processDblClickEvent(c,V,d)});$(X).click(function(e){var d=$(e.target);var c=$(d).parent().attr("elName");if(c!=undefined&&c=="zc-linkViewDataEl"&&e.target.tagName!=undefined&&e.target.tagName=="IMG"){d=$(d).parent()}ZCView.uniqueID=G;return ZCView.processEvent(d,V,e)});if(!isViewBeta){var H=ZCView.getElFromViewCont("div[elName=zc-viewheader-actions]",V);var U=ZCView.getElFromViewCont("div[elName=zc-viewheaderleft]",V);var a=$(H).width();var P=$(H).position().left;var Y=ZCView.getElementOrValue("windowWidth");var b=$(O);var S=$(b).width();ZCView.cache.viewContLeft=$(b).position().left;var K=ZCView.cache.viewContLeft;var I=K+S;if(I<Y){Y=I}var L=Y-a-P-10;if(L<0||($(U).width()+L+a)>S){L=S-a-$(U).width();if(L<0){L=10}}L=L-10;H.css("left",(L)+"px");if(I-Y!=0){L=I-Y+10;if(L>S){L=0}ZCView.getElFromViewCont("div[elName=zc-viewactionscontainer]",V).css("margin-right",L+"px");ZCView.getElFromViewCont("span[elName=zc-viewpagingstrip]",V).css("margin-right",L+"px")}}else{var F=$("#zc-viewresetbar");if($("#zc-viewresetbar").length>0){var J=ZCView.getElementOrValue("windowWidth");F.css("left",((J-F.width())/2)-$(F).offset().left)}}var T=ZCUtil.getFromMap(ZCView.viewArr[V],"viewType");if(ZCView.scrollFeature){var N=$(O).find("div[elName=zc-viewheader-div]");ZCView.pageHeaderHeight=0;if(N.length>0){ZCView.pageHeaderHeight=N.position().top}ZCView.viewContainers=X;ZCView.viewCont=O;ZCView.viewContFixed=$("#zc-listviewheader");ZCView.cache.zindex=ZCView.viewCont.find("div[elname=zc-customactionitems], div[elname=zc-filterbarContEl], div[elname=zc-viewrecactionsheader], div[elname=zc-filterselectdd], div[elname=zc-viewheaderoptionsdiv], div[elname=zc-PrintOptions], div[elname=zc-recordPerPageCont], div[elname=zc-viewOptionsDIV], div[elname=zc-viewheader-div], div[elName=zcShowHideColCont], div[elName=zc-viewsearchoptionsdiv]");if(ZCView.isOptionsLeftAligned){ZCView.cache.leftDivs=ZCView.viewContainers.find("div[elName=zc-viewrecordactionsleft], div[elName=zc-viewheaderleft], div[elName=zc-filterbarContEl], span[elname=zc-searchButtons], div[elName=zc-viewrecordactionsright], div[elName=zc-viewheader-actions]");ZCView.cache.rightDivs=$([])}else{ZCView.cache.leftDivs=ZCView.viewContainers.find("div[elName=zc-viewrecordactionsleft], div[elName=zc-viewheaderleft], div[elName=zc-filterbarContEl], span[elname=zc-searchButtons]");ZCView.cache.rightDivs=ZCView.viewContainers.find("div[elName=zc-viewrecordactionsright], div[elName=zc-viewheader-actions]")}ZCView.cache.paddingLeftDivs=ZCView.viewContainers.find("table[elName=zc-viewtable] tr[elName=zc-grouprow] td span[elname=zc-groupBySpan]");ZCView.cache.centerDivs=ZCView.viewContainers.find("span[elname=zc-view-nodata]");ZCView.viewContFixedMenus["zc-customactionmore"]=new Array(ZCView.viewContFixed.find("a[elname=zc-customactionmore]"),ZCView.viewContFixed.find("div[elname=zc-customactionitems]"),"left","");ZCView.viewContFixedMenus["zc-addFilterEl"]=new Array(ZCView.viewContFixed.find("a[elname=zc-addFilterEl]"),ZCView.viewContFixed.find("div[elname=zc-filterselectdd]"),"left","delugename");ZCView.viewContFixedMenus["zc-showPrintDialog"]=new Array(ZCView.viewContFixed.find("a[elname=zc-showPrintDialog]"),ZCView.viewContFixed.find("div[elname=zc-PrintOptions]"),"right","");ZCView.viewContFixedMenus["zc-recordperpageEl"]=new Array(ZCView.viewContFixed.find("a[elname=zc-recordperpageEl]"),ZCView.viewContFixed.find("div[elname=zc-recordPerPageCont]"),"right","");ZCView.viewContFixedMenus["zc-moreactionsel"]=new Array(ZCView.viewContFixed.find("a[elname=zc-moreactionsel]"),ZCView.viewContFixed.find("div[elname=zc-viewOptionsDIV]"),"right","");ZCView.viewContMenus["zc-customactionmore"]=new Array(ZCView.viewCont.find("a[elname=zc-customactionmore]"),ZCView.viewCont.find("div[elname=zc-customactionitems]"),"left","");ZCView.viewContMenus["zc-addFilterEl"]=new Array(ZCView.viewCont.find("a[elname=zc-addFilterEl]"),ZCView.viewCont.find("div[elname=zc-filterselectdd]"),"left","delugename");ZCView.viewContMenus["zc-showPrintDialog"]=new Array(ZCView.viewCont.find("a[elname=zc-showPrintDialog]"),ZCView.viewCont.find("div[elname=zc-PrintOptions]"),"right","");ZCView.viewContMenus["zc-recordperpageEl"]=new Array(ZCView.viewCont.find("a[elname=zc-recordperpageEl]"),ZCView.viewCont.find("div[elname=zc-recordPerPageCont]"),"right","");ZCView.viewContMenus["zc-moreactionsel"]=new Array(ZCView.viewCont.find("a[elname=zc-moreactionsel]"),ZCView.viewCont.find("div[elname=zc-viewOptionsDIV]"),"right","");ZCView.cache.viewContWidth=ZCView.viewCont.width();var E=ZCView.viewCont.find("table[elName=zc-viewtable]");var R=ZCView.viewContFixed.find("table[elName=zc-viewtable]");ZCView.theadElems=$(E).find("thead:first").find("th");ZCView.theadFixedElems=$(R).find("thead:first").find("th");ZCView.setWidthForFixedColHeaders();ZCView.viewContFixed.css({position:"fixed",top:"0px",overflow:"visible",width:ZCView.cache.viewContWidth+"px"});ZCView.fixedHeaderNeeded=true;ZCView.cache.viewGroupRows=$(E).find("tr[elName=zc-grouprow]");ZCView.cache.viewGroupRowsFixed=$(R).find("tr[elName=zc-grouprow]");ZCView.cache.sampleGroupRowHeight=ZCView.cache.viewGroupRows.filter("tr:first").height();ZCView.getElementOrValue("filterbarContEl",V).width(ZCView.cache.viewContWidth-5);ZCView.cache.viewGroupRows.click(function(h){var d=ZCView.getOriginalTarget(h);var m=$(d).attr("elName");if(m==="zc-linkViewDataEl"){return ZCView.showLinkedView(d,V)}if(m==="zc-groupSelectionEl"){return ZCView.checkRecSelection(d,V)}var f=ZCView.getElementOrValue("colheaderrow",V);var l=null;var c=$(window).scrollTop();if(ZCView.fixedItemsStatus==true){l=$(f[0]);headerDiff=l.position().top+l.height()}else{l=$(f[1]);headerDiff=l.position().top+l.height()-c}var e=$(d).position().top-headerDiff;if(ZCView.fixedItemsStatus==false&&e>ZCView.pageHeaderHeight){e=e+ZCView.pageHeaderHeight}$("html,body").animate({scrollTop:(e)},1000);ZCApp.hideAndStopPropogation(h)})}if(ZCUtil.getFromMap(ZCView.viewArr[V],"viewType")==ZCConstants.VIEW_SHEET){$(O).find("table[elName=zc-viewtable]").find(":input[fieldType="+ZCConstants.DATE+"], :input[fieldType="+ZCConstants.DATE_TIME+"]").each(function(){ZCView.showCalendar(this)});$(O).find("table[elName=zc-viewtable]").find(":input[fieldType="+ZCConstants.SINGLE_SELECT+"], :input[fieldType="+ZCConstants.MULTI_SELECT+"], :input[fieldType="+ZCConstants.INLINE_SINGLE_SELECT+"]").each(function(){var f=$(this);var d=$(this).attr("fieldType")==ZCConstants.MULTI_SELECT?"multiSelOption":"singleSelOption";$(f).dblclick(function(){var l=$(f).attr("name");var m=$(f).attr("reclinkid");var n="#"+d+"_"+l+"_"+m;$(n).show();$(n).scrollTop(0);ZCView.initVariablesForOptionFetch();ZCView.noOfRecordsAvailable=$(this).attr("fieldType")==ZCConstants.MULTI_SELECT?$(n).find("ul li").length:$(n).find("ul li").length-1;ZCView.hasMoreRecords=ZCView.noOfRecordsAvailable>=200});var c=$(f).attr("name");var e=$(f).attr("reclinkid");var h=$(f).parent(".zc-grid-live-lookup").next();$(document).mouseup(function(l){if(l.target!="li"&&!h.is(l.target.closest("div"))){$(h).hide()}});$(h).find("ul li").unbind("mousedown").bind("mousedown",function(l){ZCView.setValueForLookupOption(this,f,h,V)})})}if(ZCView.viewEditOpened==true){ZCView.showViewEditor(V)}ZCView.viewHeaderEvents(V);var Z=ZCUtil.getFromMap(ZCView.viewArr[V],"openSearch");if(Z=="true"){ZCView.handleSearchOption(V)}};this.handleScreenResize=function(E,F){if(ZCView.scrollFeature){this.cache.viewContWidth=this.viewCont.width();ZCView.setWidthForFixedColHeaders();if(F&&E){ZCView.getElementOrValue("filterbarContEl",E).width(F)}}};this.showCorrectGroupRow=function(E,H){var F=this.cache.viewGroupRows;var G=false;$.each(F,function(K,M){var J=$(M).attr("groupIndex");currRowTop=$(M).position().top;var L=E+H;if(currRowTop>(L)){var I=parseInt(J)-1;ZCView.showNextGroupRow(I);G=true;return false}});if(G==false){ZCView.showNextGroupRow(F.length-1)}};this.setWidthInView=function(F,E){if(isViewBeta){this.viewContFixed.show();ZCView.fixedItemsStatus=true;this.viewContFixed.css("top",F+"px");this.cache.zindex.css("z-index","-1");this.handleGroupScrolling(E);ZCView.handleSearchInput()}};this.handleGroupScrolling=function(I){var R=ZCView.cache.viewGroupRows;var Q=ZCView.cache.sampleGroupRowHeight;var P=this.viewContFixed.height();var T=ZCView.cache.viewGroupRowsFixed;var J=T.filter("tr:visible");var S;if(J.length>0){var S=$(J[0]);var N=S.attr("groupIndex");var E=parseInt(N);var G=R.filter("tr[groupIndex="+E+"]");var U=$(G).position().top;var L=parseInt(N)+1;if(L!=R.length){var O=R.filter("tr[groupIndex="+L+"]");var M=$(O).position().top;if((I+P)>M){if(S.css("position")=="absolute"){ZCView.showNextGroupRow(L);return }if((I+P-M)>Q){ZCView.showCorrectGroupRow(I,P);return }}if((S.css("position")=="absolute")||((P+I)>M)){if(S.css("position")!="absolute"){var K=new Array();$.each(S.find("td"),function(V,W){K[V]=$(W).width()});S.css("position","absolute");S.css("z-index","-2");$.each(S.find("td"),function(V,W){$(W).width(K[V])})}else{if(M-P-Q>I){S.css("position","");S.css("top","");S.css("z-index","");return }}S.css("top",(M-Q-I)+"px");return }}if((S.css("position")!="absolute")&&((U+Q-P)>I)){if(U-P-I>0){ZCView.showCorrectGroupRow(I,P);return }var H=E-1;ZCView.showNextGroupRow(H);var F=ZCView.viewContFixed.find("table[elName=zc-viewtable]").find("tbody").find("tr[elName=zc-grouprow][groupIndex="+H+"]");var K=new Array();$.each(F.find("td"),function(V,W){K[V]=$(W).width()});F.css("position","absolute");F.css("z-index","-2");$.each(F.find("td"),function(V,W){$(W).width(K[V])});F.css("top",(U-Q-I)+"px");return }}else{$.each(R,function(X,Z){var W=$(Z).attr("groupIndex");U=$(Z).position().top;var Y=I+P;if(U>(Y)){var V=parseInt(W)-1;ZCView.showNextGroupRow(V);return false}})}};this.showNextGroupRow=function(E){var F=ZCView.cache.viewGroupRowsFixed;F.css("position","");F.css("top","");F.css("z-index","");F.hide();ZCView.viewContFixed.find("table[elName=zc-viewtable]").find("tbody").find("tr[elName=zc-grouprow][groupIndex="+E+"]").show()};this.resetWidthInView=function(E){if(isViewBeta){if((/msie/.test(navigator.userAgent.toLowerCase())||/chrome/.test(navigator.userAgent.toLowerCase()))&&E>-1){this.setWidthInView(ZCView.pageHeaderHeight-E,E)}else{this.viewContFixed.hide();ZCView.fixedItemsStatus=false;this.cache.zindex.css("z-index","");ZCView.handleSearchInput()}}};this.setWidthForFixedColHeaders=function(){this.viewContFixed.width(this.cache.viewContWidth+"px");var E=new Array();$.each(this.theadElems,function(F,G){E[F]=$(G).width()+"px"});$.each(this.theadFixedElems,function(F,G){$(G).width(E[F])});this.handleHorizontalScroll()};this.handleHorizontalScroll=function(){if(ZCView.viewCont!=null&&ZCView.viewCont.html()!=""){ZCView.cache.viewContLeft=ZCView.viewCont.position().left;var I=ZCView.cache.viewContLeft;var G=getWindowWidth();var F=$(document).width();var J=$(document).scrollLeft();if(J<0){J=0}if(J>0&&(J>F-G)){J=F-G}var H=J-I;if(H<0){H=0}this.cache.leftDivs.css("left",H+"px");this.cache.paddingLeftDivs.css("padding-left",H+"px");ZCView.calPopUpCorrection();var E=(this.cache.viewContWidth+I-G-J);if(E<0){E=0}this.cache.rightDivs.css("right",E+"px");if(!ZCApp.isMobileSite){this.cache.centerDivs.css("padding-left",function(K){return(H+G/2-$(this).width())+"px"})}ZCView.viewContFixed.css("left",(I-J)+"px");ZCView.cache.viewContFixedLeft=(I-J);if(ZCView.currentMenu.length>0&&ZCView.currentMenuFixed.length>0){if(ZCView.fixedItemsStatus==true){this.handleDropDownForFixed(I,ZCView.currentMenuFixed[0],ZCView.currentMenuFixed[1],ZCView.currentMenuFixed[2],ZCView.currentMenuFixed[3])}else{this.handleDropDownForFixed(I,ZCView.currentMenu[0],ZCView.currentMenu[1],ZCView.currentMenu[2],ZCView.currentMenu[3])}}}};this.handleDropDownForFixed=function(H,E,G,I,F){$(E).each(function(K){var J=$(this);$(G).each(function(P){var N=$(this);var L=true;if(F){L=false;if($(J).attr(F)==$(N).attr(F)){L=true}}if(L==true){var O=0;if(I=="right"){O=$(J).outerWidth(false)-$(N).outerWidth(false)}var M=J.offset().left;if(ZCView.fixedItemsStatus==true){M=M-H}$(N).css("left",(M+O)+"px");return false}})})};this.viewHeaderEvents=function(F){if(isViewBeta){ZCView.viewHeaderNewEvents(F)}else{var G=this.viewArr[F];var E=ZCUtil.getFromMap(G,"viewType");if(E==2){ZCView.calViewHeaderEvents(F)}ZCView.viewHeaderOldEvents(F)}};this.showViewHeaderLeftEl=function(E){$(E).find("[elname=zc-viewheader-viewlinks]").css("visibility","visible")};this.hideViewHeaderLeftEl=function(E){$(E).find("[elname=zc-viewheader-viewlinks]").css("visibility","hidden")};this.calViewHeaderEvents=function(E){var F=ZCView.getViewContainers(E);$(F).find("[elname=zc-viewPaginationEl], [grpElName=zc-calpagination]").mouseenter(function(I){$(this).removeClass("zc-viewpaging-new").addClass("zc-viewpaging-new-hover");$(this).find("[zcPaginationType=normal]").hide();var H=$(this).find("span[zc-nav=oldTheme]");var G=$(H).attr("zc-hoverClass");$(H).removeClass(G);$(H).addClass(G+"-hover");$(this).find("[zcPaginationType=hover]").show()}).mouseleave(function(I){$(this).removeClass("zc-viewpaging-new-hover").addClass("zc-viewpaging-new");$(this).find("[zcPaginationType=normal]").show();var H=$(this).find("span[zc-nav=oldTheme]");var G=$(H).attr("zc-hoverClass");$(H).removeClass(G+"-hover");$(H).addClass(G);$(this).find("[zcPaginationType=hover]").hide()})};this.viewHeaderOldEvents=function(E){var H=ZCView.getViewCont(E);var G=ZCView.getElFromViewCont("[elName=zc-colheaderrow]",E);var F=$(G).find("th:first").attr("lastcls");if(F!=undefined){$(G).find("th:last").addClass(F)}$(H).find("[elname=zc-viewlogitems-Div]").mouseenter(function(K){var J=$(this).find("a:first");var I=$(J).attr("elname");$(J).attr("class","zc-viewchangelog-items-open");ZCUtil.showDropDownMenu($(this).find("[elname="+I+"]")[0],$(this).find("[eltype=zc-viewactions-options]")[0]);var L=$(this).find("[elname="+I+"-options]").position();$(this).find("[elname="+I+"-options]").css("top",L.top-2)}).mouseleave(function(K){var L=$(this).parents("[elname=zc-viewlogitems-Div]");if(L.length<1){var J=$(this).find("a:first");var I=$(J).attr("elname");$(J).attr("class","zc-viewchangelog-items");$(this).find("[eltype=zc-viewactions-options]").hide()}});$(H).find("[elName=zc-viewrowEl]").mouseenter(function(I){$(this).addClass("zc-viewrow-hover")}).mouseleave(function(J){var I=$(this).find("[elname=zc-recSelectionEl]").is(":checked");if(!I){$(this).removeClass("zc-viewrow-hover")}});$(H).find("[grpElName=zc-calpagination], .zc-viewheader-menus-group").mouseenter(function(I){$(this).prevAll().filter("a:visible:first,span:visible:first").addClass("zc-view-noleftborder")}).mouseleave(function(I){$(this).prevAll().filter("a:visible:first,span:visible:first").removeClass("zc-view-noleftborder")})};this.viewRowHandler=function(K,I,F){var H=null;var E=null;var E=null;var G=$(I).find("[elname=zc-recSelectionEl]").is(":checked");var J=ZCView.cache[F+"_rowClicked"];if(K=="mouseenter"&&!G){H=true}else{if(K=="mouseleave"){H=false}}if(H){$(I).addClass("zc-viewrow-hover");$(I).find("a[grpElName=zc-showMoreRecordActionEl]").css("visibility","visible")}if(!H){$(I).find("a[grpElName=zc-showMoreRecordActionEl]").css("visibility","hidden");ZCView.getElementOrValue("moreRecActionCont",F).hide();if(J!=I){$(I).removeClass("zc-viewrow-hover")}}};this.viewFloatMenuEvent=function(G,F,I){var H=ZCView.getElementOrValue("viewrowEl",I);$(H).removeClass("zc-view-row-selection-top zc-view-row-selection-bottom zc-view-row-selection-leftRight zc-view-row-selection zc-row-bottomborder-transparent");if(F=="mouseenter"){var N=$(G).attr("recLinkId");var M=$(H).filter("tr[recLinkId="+N+"]");$(M).addClass("zc-view-row-selection");$(M).prev().addClass("zc-row-bottomborder-transparent")}else{if(F=="mouseleave"){var J=$(H).filter(function(){return $(this).find("input[elname=zc-recSelectionEl]").is(":checked")});var E=null;for(var L=0;L<H.length;L++){var K=$(H[L]).find("input[elname=zc-recSelectionEl]").is(":checked");if(K){$(H[L]).addClass("zc-view-row-selection-leftRight")}if(K&&E==null){$(H[L]).addClass("zc-view-row-selection-top");$(H[L]).prev().addClass("zc-row-bottomborder-transparent")}if(!K){$(E).addClass("zc-view-row-selection-bottom");E=null}else{E=H[L]}}if(E!=null){$(E).addClass("zc-view-row-selection-bottom")}}}};this.viewRowMenuEvents=function(G,I,E){var F=$(I).find("a[grpElName=zc-showMoreRecordActionEl]:first");if(G=="mouseenter"&&I!=null){var H=$(I).parents("tr:first");if(!$(H).find("[elname=zc-recSelectionEl]").is(":checked")){ZCView.getElementOrValue("moreRecActionFloat",E).hide();$(ZCView.cache[E+"_rowClicked"]).removeClass("zc-viewrow-hover zc-view-row-selection zc-row-bottomborder-transparent");$(F).css("visibility","visible");var K=ZCView.getElementOrValue("moreRecActionCont",E);ZCView.showDropDownDialog($(F),K,E,"left");$(K).find("a[elname=zc-showEditFormEl]").attr("href",$(H).attr("recEditLink"));$(K).find("a[elname=zc-printViewEl]").attr("href",$(H).attr("recPrintLink"));$(K).find("a[elname=zc-showRecordEl]").attr("href",$(H).attr("recSummaryLink"));$(K).find("a[recLinkID]").attr("recLinkID",$(H).attr("recLinkID"));var J=$(H).attr("recLinkID");$(K).find("a[elname=zc-custaction-el]").each(function(L,N){var M=$(N).attr("customactionrecidlist");if(M.indexOf(J)===-1){$(N).parent("li").css("display","none")}else{$(N).parent("li").css("display","")}})}}else{if(G=="mouseleave"){ZCView.getElementOrValue("moreRecActionCont",E).hide()}}};this.viewHeaderNewEvents=function(I){var N=ZCView.getViewCont(I);var O=ZCView.getViewContainers(I);var H=ZCView.getElementOrValue("viewrowEl",I,N);var G=ZCView.getElementOrValue("filteradvItem",I);var E=ZCView.getElementOrValue("filteradvbar",I);var Q=ZCView.getElementOrValue("selectAllRecsEl",I);var J=ZCView.getElementOrValue("moreactionsel",I);var F=ZCView.getElementOrValue("viewsearchrow",I);var M=ZCView.getElementOrValue("rowActionsTdEl",I,N);var P=ZCView.getElementOrValue("moreRecActionFloat",I);var L=ZCView.getElementOrValue("moreRecActionCont",I);$(H).bind("mouseenter mouseleave",function(R){ZCView.viewRowHandler(R.type,this,I)});$(N).bind("contextmenu",function(R){return ZCView.checkForLinkOrSelection(R,I)});$(H).mousedown(function(u){ZCView.getElementOrValue("moreRecActionFloat",I).hide();var AB=ZCView.getOriginalTarget(u);var Y=($(AB).attr("elName")=="zc-recSelectionEl");var AB=ZCView.getOriginalTarget(u);var T=$(AB).prop("tagName").toLowerCase();if(((!(navigator.userAgent.indexOf("Mac")!=-1&&u.ctrlKey)&&u.metaKey)||Y)&&(T!="option"&&T!="li")){u.preventDefault();ZCView.checkRecordShortCutEvent(this,u,I);return true}if(u.which==3||(navigator.userAgent.indexOf("Mac")!=-1&&u.ctrlKey&&u.which==1)){if(ZCView.checkForLinkOrSelection(u,I)){return true}u.preventDefault();ZCView.hideViewMenus(O,I);var y=ZCView.getElementOrValue("moreRecActionFloat",I);$(y).show();var n=u.pageX;var S=u.pageY;var h=$(y).width();var z=$(y).height();var c=ZCView.getElementOrValue("documentHeight");var X=ZCView.getElementOrValue("documentWidth");if(X<(u.pageX+h)){n=u.pageX-h}if(c<(u.pageY+z)){S=c-z}var b=ZCView.getElementOrValue("windowHeight");var AD=ZCView.getElementOrValue("windowWidth");var U=$(window).scrollTop();var s=$(window).scrollLeft();var AE=b-(S-U+z);if(AE<0){S=S+AE}var V=AD-(n-s+h);if(V<0){n=n+V}if(layerCount!=undefined&&layerCount>1){n=n-($(y).offset().left-$(y).position().left);S=S-($(y).offset().top-$(y).position().top)}$(y).css({left:n,top:S});var p=ZCView.getElementOrValue("FloatMenu_Single",I);var AC=ZCView.getElementOrValue("FloatMenu_Bulk",I);var R=ZCView.getElementOrValue("FloatMenu_Both",I);var d=ZCView.getElementOrValue("FloatMenu_selectMenu",I);var o=ZCView.getElementOrValue("FloatMenu_deselectMenu",I);var m=ZCView.getElementOrValue("FloatMenu_select",I);var f=ZCView.getElementOrValue("FloatMenu_deselect",I);var AA=ZCView.getElementOrValue("FloatMenu_selectAll",I);var q=ZCView.getElementOrValue("FloatMenu_deselectall",I);$(p).hide();$(AC).hide();$(R).hide();$(d).hide();$(o).hide();$(m).hide();$(f).hide();$(AA).hide();$(q).hide();var w=$(this).find("[elname=zc-recSelectionEl]").is(":checked");if(!w){ZCView.cache[I+"_rowClicked"]=this;ZCView.cache[I+"_rowHover"]=null;$(this).addClass("zc-viewrow-hover").addClass("zc-view-row-selection");$(this).prev().addClass("zc-row-bottomborder-transparent")}var v=ZCView.getElementOrValue("recSelectionEl",I);var W=$(v).filter(":checked").length;var l=$(y).find("[recordsSelText]");$(l).each(function(){if(W==1){$(this).html(i18n["zc.viewlive.1recordsel"])}else{$(this).html(($(this).attr("recordsSelText")).replace("#Count",W))}});var a=$(v).length;if(W>0){if(w){$(AC).show();$(AC).filter("span").css("display","block");$(f).show();$(q).show();ZCView.viewFloatMenuEvent(f,"mouseleave",I);$(p).find("a[seltype='FloatMenu_Single_CustomAc']").css("display","none")}else{$(m).show();$(AA).show();$(p).show();$(p).find("a[seltype='FloatMenu_Single_CustomAc']").css("display","block")}}else{$(m).show();$(f).hide();$(AA).show();$(q).hide();$(p).show();$(p).find("a[seltype='FloatMenu_Single_CustomAc']").css("display","block")}$(y).find("[elname=zc-showEditFormEl]").attr("href",$(this).attr("recEditLink"));$(y).find("[elname=zc-printViewEl]").attr("href",$(this).attr("recPrintLink"));$(y).find("[elname=zc-showRecordEl]").attr("href",$(this).attr("recSummaryLink"));$(y).find("[recLinkID]").attr("recLinkID",$(this).attr("recLinkID"));var e=$(this).attr("recLinkID");$(y).find("a[elname=zc-custaction-el]").each(function(AF,AH){var AG=$(AH).attr("customactionrecidlist");if(AG.indexOf(e)===-1){$(AH).parent("li").css("display","none")}else{$(AH).parent("li").css("display","")}});var Z=$(H).filter(function(){return $(this).find("[elname=zc-recSelectionEl]").is(":checked")});return false}});$(G).mouseenter(function(R){$(this).find("[elname=zc-deselectFilterEl]").removeClass("zc-filterremoveicon").addClass("zc-filterremoveicon-hover")}).mouseleave(function(R){$(this).find("[elname=zc-deselectFilterEl]").removeClass("zc-filterremoveicon-hover").addClass("zc-filterremoveicon")});$(E).mouseenter(function(R){$(this).find("[elname=zc-addFilterEl]").addClass("zc-filteradvbar-hover")}).mouseleave(function(R){$(this).find("[elname=zc-addFilterEl]").removeClass("zc-filteradvbar-hover")});$(O).find("a[elname=zc-viewPaginationEl], a[grpElName=zc-calpagination]").mouseenter(function(T){$(this).removeClass("zc-viewpaging-new").addClass("zc-viewpaging-new-hover");$(this).find("img[zcPaginationType=normal]").hide();var S=$(this).find("span[zc-nav=oldTheme]");var R=$(S).attr("zc-hoverClass");$(S).removeClass(R);$(S).addClass(R+"-hover");$(this).find("img[zcPaginationType=hover]").show()}).mouseleave(function(T){$(this).removeClass("zc-viewpaging-new-hover").addClass("zc-viewpaging-new");$(this).find("img[zcPaginationType=normal]").show();var S=$(this).find("span[zc-nav=oldTheme]");var R=$(S).attr("zc-hoverClass");$(S).removeClass(R+"-hover");$(S).addClass(R);$(this).find("img[zcPaginationType=hover]").hide()});$(O).find("a[elname=zc-showPrintDialog],a[elname=zc-recordperpageEl],a[elname=zc-moreactionsel]").mouseenter(function(R){$(this).find("[zcImageType=normal]").hide();$(this).find("[zcImageType=hover]").show()}).mouseleave(function(R){$(this).find("[zcImageType=normal]").show();$(this).find("[zcImageType=hover]").hide()});$(M).mouseenter(function(R){ZCView.cache[I+"_rowHover"]=this;ZCView.viewRowMenuEvents(R.type,ZCView.cache[I+"_rowHover"],I)}).mouseleave(function(R){ZCView.viewRowMenuEvents(R.type,ZCView.cache[I+"_rowHover"],I)});$(L).mouseenter(function(R){ZCView.viewRowMenuEvents(R.type,ZCView.cache[I+"_rowHover"],I)}).mouseleave(function(R){ZCView.viewRowMenuEvents(R.type,ZCView.cache[I+"_rowHover"],I);$(M).find("a[grpElName=zc-showMoreRecordActionEl]:first").css("visibility","hidden")});$(P).find("a[elname=zc-deSelectRecordEl]").bind("mouseenter mouseleave",function(R){if(!$(P).is(":visible")&&R.type=="mouseleave"){return false}ZCView.viewFloatMenuEvent(this,R.type,I)});$(O).find("span.zc-viewheader-menus-group-header, a.zc-viewheader-menus-group, a.zc-viewheader-menus-group-header, a[elname=zc-viewPaginationEl], a[grpElName=zc-calpagination]").mouseenter(function(R){$(this).prevAll().filter("a:visible:first,span:visible:first").addClass("zc-view-noleftborder")}).mouseleave(function(R){$(this).prevAll().filter("a:visible:first,span:visible:first").removeClass("zc-view-noleftborder")});$(Q).change(function(){var R=$(this).is(":checked");$(O).find("input[elname=zc-selectAllRecsEl]").prop("checked",R)});if(ZCView.fixedHeaderNeeded){$(F).find("select, input").change(function(){ZCView.syncBothSearchBoxes(this,O)});$(F).find("input").keyup(function(){ZCView.syncBothSearchBoxes(this,O)});$(F).find("input[id^=viewSearchEl_]").click(function(){ZCView.calPopUpCorrection(true);var R=$(this).attr("id");if(R.indexOf("_Fixed")!=-1){R=R.substring(0,R.indexOf("_Fixed"))}ZCView.cache.datePicker=$(F).find("input[id^="+R+"]")});$(F).find("select, input").focus(function(){var R=$(this).attr("delugename");ZCView.cache.Search_lastFocus=$(F).find("[delugename='"+R+"']")}).blur(function(){ZCView.cache.Search_lastFocus=undefined})}var K=N.find("div[elName=zcShowHideColCont]");O.find("input[elName=zc-hidcol-all-input]").click(function(R){K.find("input[elName=zc-hidcol-input]").prop("checked",$(this).is(":checked"));$(this).closest("div[elName=zcShowHideColCont]").find("input[elName=zc-hidcol-input]").prop("checked",$(this).is(":checked"));stopPropogation(R)});O.find("div[elName=zcShowHideColCont]").find("input[elName=zc-hidcol-input]").change(function(){var S=$(this).closest("div[elName=zcShowHideColCont]").find("input[elName=zc-hidcol-all-input]");S.prop("checked",false);var R=$(this).closest("ul");if(R.find("input[elName=zc-hidcol-input]:checked").length==R.find("input[elName=zc-hidcol-input]").length){S.prop("checked",true)}});if(K.find("input[elName=zc-hidcol-input]:checked").length==K.find("input[elName=zc-hidcol-input]").length){O.find("input[elName=zc-hidcol-all-input]").prop("checked",true)}};this.showViewMenu=function(G,E,I){var F=ZCView.getViewContainers(E);ZCView.hideViewMenus(F,E);if(I=="more"){$(F).find("a[elName=zc-moreactionsel]").addClass("zc-viewheader-menus-moreicon");ZCView.showDropDownDlg($(F),"a[elName=zc-moreactionsel]","div[elName=zc-viewOptionsDIV]",E,"right",-1,0);ZCView.currentMenu=ZCView.viewContMenus["zc-moreactionsel"];ZCView.currentMenuFixed=ZCView.viewContFixedMenus["zc-moreactionsel"];ZCApp.hideAndStopPropogation(G)}else{if(I=="perpage"){$(F).find("a[elName=zc-recordperpageEl]").addClass("zc-viewheader-menus-moreicon");ZCView.showDropDownDlg($(F),"a[elName=zc-recordperpageEl]","div[elName=zc-recordPerPageCont]",E,"right",-1,0);ZCView.currentMenu=ZCView.viewContMenus["zc-recordperpageEl"];ZCView.currentMenuFixed=ZCView.viewContFixedMenus["zc-recordperpageEl"];ZCApp.hideAndStopPropogation(G)}else{if(I=="showhide"){ZCView.showDropDownDlg($(F),"th[elName=zcShowHideCol]","div[elName=zcShowHideColCont]",E,"left",-1,0);ZCApp.hideAndStopPropogation(G);var H=ZCView.getElementOrValue("ShowHideColCont",E);$(H).css({"z-index":2})}else{if(I=="print"){$(F).find("a[elName=zc-showPrintDialog]").addClass("zc-viewheader-menus-moreicon");ZCView.showDropDownDlg($(F),"a[elName=zc-showPrintDialog]","div[elName=zc-PrintOptions]",E,"right",-1,0);ZCView.currentMenu=ZCView.viewContMenus["zc-showPrintDialog"];ZCView.currentMenuFixed=ZCView.viewContFixedMenus["zc-showPrintDialog"];ZCApp.hideAndStopPropogation(G)}}}}};this.showHideDlgEvent=function(I,E){var F=ZCView.getViewContainers(E);var G=ZCView.getOriginalTarget(I);var K=$(G).attr("elName");if($(G).is(":input")||$(G).attr("fieldName")!=undefined){if($(G).attr("fieldName")!=undefined){G=$(G).prev()}var H=$(G).is(":checked");var J=$(G).attr("value");if(J!=""){$(F).find("input[value='"+J+"']").prop("checked",H)}}if(K=="zc-showHideColumns"){ZCView.showHideColumns(G,E)}else{if(K=="zc-cancelshowHide"){ZCView.cancelShowHide(E)}}stopPropogation(I)};this.callShowRecord=function(F,E){var G=ZCView.getElementOrValue("viewrowEl",E).filter("[reclinkid="+$(F).attr("reclinkid")+"]").find("td:first");if((this.viewArr[E].isDefaultTemplate)!="true"){ZCView.showRecordInTemplate(G,E)}else{ZCView.showRecord(G,E)}return false};this.syncBothSearchBoxes=function(J,E){var K=$(J).attr("elName");var G=$(J).attr("name");var I=$(J).val();var F=[];if(K!=""&&K!=undefined){F=$(E).find("[elName='"+K+"']")}if(G!=""&&G!=undefined){F=$(E).find("[name='"+G+"']")}for(var H=0;H<F.length;H++){if(F[H]!=J){$(F[H]).val(I)}}};this.calPopUpCorrection=function(E){if(E){if(_dynarch_popupCalendar==null||!$(_dynarch_popupCalendar.element).is(":visible")){setTimeout(function(){ZCView.calPopUpCorrection(true)},50)}}if(_dynarch_popupCalendar!=null){if(ZCView.cache.datePicker!=null){var F=$(ZCView.cache.datePicker).filter(":visible");var G=$(F).offset();$(_dynarch_popupCalendar.element).css({left:G.left,top:G.top+$(F).outerHeight(false)})}}};this.handleSearchInput=function(){var G=ZCView.cache.Search_lastFocus;if(G!=undefined){var E=$(G).filter(":visible").filter(":first");var F=$(E).val();$(E).focus().val("");$(E).val(F)}};this.checkRecordShortCutEvent=function(K,H,J){var I=ZCView.getOriginalTarget(H);var E=$(I).attr("elName");var N=$(I).is(":checked");if(E!="zc-recSelectionEl"&&!(navigator.userAgent.indexOf("Mac")!=-1&&H.ctrlKey)&&H.metaKey){I=$(K).find("[elName=zc-recSelectionEl]");N=$(I).is(":checked");N=!N}else{if(E=="zc-recSelectionEl"){N=!N}}if(H.shiftKey&&ZCView.cache[J+"_lastSelectedRow"]!=null){var O=ZCView.getElFromViewCont("[elname=zc-viewrowEl]",J);var F=ZCView.cache[J+"_lastSelectedRow"];var P=$(K);var L=$(O).index(F);var G=$(O).index(P);var M;if(L<G){M=$(O).slice(L,G)}else{M=$(O).slice(G,L+1)}$(M).each(function(){var Q=$(M).find("[elName=zc-recSelectionEl]");$(Q).prop("checked",N);ZCView.checkRecord($(Q),J)})}$(I).prop("checked",N);ZCView.checkRecord(I,J);if(!N){$(K).mouseenter()}else{$(K).mouseleave()}if(E=="zc-recSelectionEl"){$(I).prop("checked",!N)}};this.getOriginalTarget=function(F){var E=F.target;return E};this.checkForLinkOrSelection=function(F,K){var E=ZCView.viewArr[K];if(ZCUtil.getFromMap(E,"viewType")!=ZCConstants.VIEW_TABLE){return true}var G=ZCView.getOriginalTarget(F);var Q=false;var P=$(G).parents("td:first");var I=$(P).find("a, img").length;if(I>0){var N=$(G).prop("tagName").toLowerCase();if(N=="a"||N=="img"){Q=true}else{var O=false;var J=$(G);while(!O&&!Q){J=$(J).parent();var L=$(J).prop("tagName").toLowerCase();if(L=="a"||L=="img"){Q=true}else{if(L=="td"){O=true}}}}if(I==1&&$(G).find("a").length>0){var M=$(G).parents("a:first")}}var H="";if(navigator.userAgent.toLowerCase().indexOf("msie")>-1){H=document.selection.createRange().text}else{H=window.getSelection()}if(H!=""||Q){return true}return false};this.cancelShowHide=function(E){var F=ZCView.getViewContainers(E);$(F).find("div[elName=zcShowHideColCont]").hide()};this.cancelSave=function(E){var F=ZCView.getViewCont(E);$(F).find("[elname=zc-view-save-dialog]").hide();$(F).find("[elname=zc-viewChangeLogDiv]").css("visibility","")};this.showCalendar=function(G){var E=$(G).attr("id");var F="dateButtonEl_"+E.substr(E.indexOf("_")+1);var I=($(G).attr("fieldType")==ZCConstants.DATE_TIME)?true:false;var H=I?ZCApp.dateFormat+" "+ZCConstants.TIME_FORMAT:ZCApp.dateFormat;ZCForm.setUpCalendar(E,F,H,I)};this.processDblClickEvent=function(H,F,J){var E=true;var K=$(H).attr("elName");var I=ZCView.getViewCont(F);var G=ZCView.getViewContainers(F);ZCView.hideViewMenus(G,F);if(K=="zc_EditableEl"){E=ZCView.showSingleFieldValue(H,F)}ZCApp.hideAndStopPropogation(J);return E};this.printRecordSummary=function(J,F){var I=ZCView.getViewCont(F);var G="";var H=1;var E=0;$.each($(I).find("input[elName=zc-recSelectionEl]"),function(K,L){if($(L).is(":checked")){E=1;G=G+ZCView.checkAndGetAttribute(L,"recLinkID")+",";H++;if(H>100){ZCView.print(F,G);G="";H=1}}});if(G.length){ZCView.print(F,G)}else{if(E==0){ZCView.showAlertPopUp(i18n["zc.viewlive.selectatleastone"])}}};this.print=function(G,E){var J=this.viewArr[G];var F=ZCUtil.getFromMap(J,"privateLink");F=ZCUtil.isNull(F)?"":"privateLink="+F;var I="/"+ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/record-summary-print/"+G+"/"+F;var H=$("<form target='_blank' method='POST' action='"+I+"' ><input type='text' name='zc_SelectedRecId' value='"+E+"' ></input> </form>");$("body").append(H);$(H).submit().remove()};this.setSolarSearchTerm=function(E,G){var H=ZCView.viewArr[E];var F={};if(G){F.searchvalue=G.value;F.issolarsearchnavigation=false}else{F.searchvalue=ZCUtil.getFromMap(H,"solarSearchValue");F.issolarsearchnavigation=true}ZCUtil.setInMap(H,"solarSearchTerm",JSON.stringify(F))};this.processEvent=function(J,K,H){if($(J).attr("id")=="encrAsterisk"){J=$(J).parent()}var U=true;var F=$(J).attr("elName");var S=ZCView.getViewCont(K);var T=ZCView.getViewContainers(K);var G="";ZCView.currentMenu=new Array();ZCView.currentMenuFixed=new Array();ZCView.hideViewMenus(T,K);if(!isViewBeta){if(F=="zc-viewPaginationEl"){ZCView.paginateView(J,K)}else{if(F=="zc-showAddFormEl"){ZCView.showAddForm(J,K)}else{if(F=="zc-showEditFormEl"||F=="zc-showEditFormHeadEl"){U=ZCView.showEditForm(J,K)}else{if(F=="zc-deleteRecordEl"){ZCView.deleteRecord(J,K)}else{if(F=="zc-duplicateRecordEl"){ZCView.duplicateRecord(J,K)}else{if(F=="zc-bulkEditRecordEl"){ZCView.bulkEditRecord(J,K)}else{if(F=="zc-showRecordEl"){U=ZCView.showRecord(J,K)}else{if(F=="zc-moreactionsel"||F=="zc-moreactionselArr"){ZCView.showMoreActions($(T).find("[elName=zc-moreactionsel]:first"),K)}else{if(F=="zc-recSelectionEl"){ZCView.checkRecord(J,K)}else{if(F=="zc-showPrintDialog"){ZCView.printView(K,G,J)}}}}}}}}}}}if(F=="zc-cancelfieldsearch"){ZCView.getElementOrValue("viewsearchoptionsdiv",K).hide()}else{if(F=="zc-linkViewDataEl"){U=ZCView.showLinkedView(J,K)}else{if(F=="zc-changeviewtype"){ZCView.changeViewType(J,K)}else{if(F=="zc-showCustFuncsEl"){ZCView.showCustFuncs(K)}else{if(F=="zc-custaction-el"||F=="zc-customActRecordEl"){ZCView.doCustAction(J,K)}else{if(F=="zc-showViewSearchEl"){ZCView.showSearch(K)}else{if(F=="zc-hideViewSearchEl"){ZCView.cancelSearch(J,K)}else{if(F=="zc-selectAllRecsEl"){ZCView.checkRecSelection(J,K)}else{if(F=="zc-selectRecordEl"){var P=ZCView.getElementOrValue("viewrowEl",K).filter("[reclinkid="+$(J).attr("reclinkid")+"]").find("[elname=zc-recSelectionEl]");$(P).prop("checked",true);ZCView.checkRecord(P,K)}else{if(F=="zc-deSelectRecordEl"){var P=ZCView.getElementOrValue("viewrowEl",K).filter("[reclinkid="+$(J).attr("reclinkid")+"]").find("[elname=zc-recSelectionEl]");$(P).prop("checked",false);ZCView.checkRecord(P,K)}else{if(F=="zc-selecAllRecordEl"){var P=ZCView.getElementOrValue("selectAllRecsEl",K);$(P).prop("checked",true);ZCView.checkRecSelection(P,K)}else{if(F=="zc-deselectAllRecordEl"){var P=ZCView.getElementOrValue("selectAllRecsEl",K);$(P).prop("checked",false);ZCView.checkRecSelection(P,K)}else{if(F=="zc-showData"){ZCView.showData(J,K,false)}else{if(F=="zc-showYearEl"){ZCView.showData(J,K,true)}else{if(F=="zc-saveViewRecsEl"){var M=$(J).parents("span[status]").attr("status");var O=parseInt(ZCUtil.getFromMap(ZCView.viewArr[K],"viewType"));if(O===ZCConstants.VIEW_NEWSHEET){if(M===undefined||M==="enable"){ZCSheetView.saveRecord()}}else{if(M===undefined||M==="enable"){ZCView.saveViewRecords(J,K)}}}else{if(F=="zc-showViewDialog"){ZCView.showViewDialog(J,K)}else{if(F=="zc-searchBoxEl"){if(H.keyCode==13){this.setSolarSearchTerm(K,J);var E=ZCView.viewArr[K];ZCView.showView(E)}}else{if(F=="zc-searchViewEl"){ZCView.searchView(J,K)}else{if(F=="zc-mobileSearchViewEl"){ZCView.summarySearchView(K)}else{if(F=="zc-filterViewEl"){ZCView.filterView($(J).attr("filterVal"),K)}else{if(F=="zc-getRecordCountEl"){ZCView.showRecordCount(J,K)}else{if(F=="zc-sortViewEl"){ZCView.sortView($(S).find("div[elName=zc-viewheaderoptionsdiv]").attr("delugeName"),$(J).attr("isAsc"),K)}else{if(F==="zc-changeSortOrder"){var N=$(J).parent()[0];var Q=$(N).attr("isAsc");Q=(Q==="true")?false:true;ZCView.sortView($(N).attr("delugeName"),Q,K)}else{if(F=="zc-groupViewEl"){ZCView.groupView($(S).find("div[elName=zc-viewheaderoptionsdiv]").attr("delugeName"),$(J).attr("isAsc"),K)}else{if(F==="zc-changeGroupOrder"){var N=$(J).parent()[0];var Q=$(N).attr("isAsc");Q=(Q==="true")?false:true;ZCView.groupView($(N).attr("delugeName"),Q,K)}else{if(F=="zc-removegroupingel"){ZCView.removeOrderBy("groupBy",$(S).find("div[elName=zc-viewheaderoptionsdiv]").attr("delugeName"),K)}else{if(F==="zc-removeGroupEl"){var N=$(J).parent()[0];ZCView.removeOrderBy("groupBy",$(N).attr("delugeName"),K)}else{if(F=="zc-removesortingel"){ZCView.removeOrderBy("sortBy",$(S).find("div[elName=zc-viewheaderoptionsdiv]").attr("delugeName"),K)}else{if(F==="zc-removeSortEl"){var N=$(J).parent()[0];ZCView.removeOrderBy("sortBy",$(N).attr("delugeName"),K)}else{if(F=="zc-searchcolEl"){ZCView.showSearch(K,$(S).find("div[elName=zc-viewheaderoptionsdiv]").attr("delugeName"),J)}else{if(F=="zc-hideViewColEl"){ZCView.hideColumn(K,$(S).find("div[elName=zc-viewheaderoptionsdiv]").attr("delugeName"))}else{if(F=="zc-lockViewColEl"){var R=$(S).find("div[elName=zc-viewheaderoptionsdiv]");ZCView.lockColumn(K,$(R).attr("delugeName"),$(R).attr("inpGridType"))}else{if(F=="zc-lockallViewColEl"){ZCView.lockAllColumn(K,$(S).find("div[elName=zc-viewheaderoptionsdiv]").attr("delugeName"))}else{if(F=="zc-savedviewel"){ZCView.showSavedView($(J).attr("viewLinkName"),K)}else{if(F=="zc-showparentviewel"){ZCView.showParentView($(J).attr("viewLinkName"),K)}else{if(F=="zc-showPdfDialog"){ZCView.pdfView(K,G)}else{if(F=="zc-viewrowheader"||F=="zc-viewheaderarrow"||F=="zc-viewrowheaderdiv"){ZCView.showColHdrMenu(J,K)}else{if(F=="zc-vieweditlink"){ZCView.showViewEditor(K)}else{if(F!=null&&F.indexOf("zc-viewedit-")==0){if(F.indexOf("-button")>0){ZCView.editButtonClick(F,K)}else{ZCView.showEditElements(F)}}else{if(F=="zc-renamecol"||F=="zc-pagesize"||F=="zc-viewtype"||F=="zc-groupedby"||F=="zc-sortedby"||F=="zc-searchedby"||F=="zc-filteredby"||F=="zc-otheroptions"){ZCView.viewActionsOptions(F,K)}else{if(F=="zc-sortByEl"){var L=$(J).attr("orderVal");if(L=="Remove"){ZCView.removeOrderBy("sortBy",$(J).parents("[elname=zc-viewActionSubMenu]").attr("delugeName"),K)}else{ZCView.sortView($(J).parents("[elname=zc-viewActionSubMenu]").attr("delugeName"),("Asc"==L),K)}}else{if(F=="zc-viewTypeEl"){ZCView.changeViewType(J,K)}else{if(F=="zc-pageSizeEl"){ZCView.limitViewRecords(J,K,$(J).attr("pageSize"))}else{if(F=="zc-groupByEl"){var L=$(J).attr("orderVal");if(L=="Remove"){ZCView.removeOrderBy("groupBy",$(J).parents("[elname=zc-viewActionSubMenu]").attr("delugeName"),K)}else{ZCView.groupView($(J).parents("[elname=zc-viewActionSubMenu]").attr("delugeName"),("Asc"==L),K)}}else{if(F=="zc-summationEl"){ZCView.enableDiableSum($(S).find("div[elName=zc-viewheaderoptionsdiv]").attr("delugeName"),$(J).attr("isEnable"),K)}else{if(F=="zc-LinkViewEl"){ZCView.linkView($(S).find("div[elName=zc-viewheaderoptionsdiv]").attr("delugeName"),$(J).attr("linkviewID"),K)}else{if(F=="zc-removeViewActionEl"){ZCView.removeAnAction(J,K)}else{if(F=="zc-savedviews-div-arrow"){ZCView.showSavedViews(J,K)}else{if(F=="zc-vieweditlink"){ZCView.showViewEditor(K)}else{if(F!=null&&F.indexOf("zc-viewedit-")==0){if(F.indexOf("-button")>0){ZCView.editButtonClick(F,K)}else{ZCView.showEditElements(F)}}else{if(F=="zc-deselectFilterEl"||F=="zc-filterselectddItem"){ZCView.filterView($(J).attr("filterVal"),K)}else{if(F=="zc-filteradvItem"){ZCView.filterView($(J).find("[elname=zc-deselectFilterEl]").attr("filterVal"),K)}else{if(F=="zc-customactionmore"||F=="zc-customactionmorearrow"){$(T).find("[elName=zc-customactionmore]").addClass("zc-viewheader-menus-moreicon");ZCView.showDropDownDlg($(T),"[elName=zc-customactionmore]","[elName=zc-customactionitems]",K,"left",0,0);ZCView.currentMenu=ZCView.viewContMenus["zc-customactionmore"];ZCView.currentMenuFixed=ZCView.viewContFixedMenus["zc-customactionmore"]}else{if(F=="zc-addFilterEl"){var I=$(J).attr("delugeName");ZCView.showDropDownDlg($(T),"[elName=zc-addFilterEl][delugeName="+I+"]","[elName=zc-filterselectdd][delugeName="+I+"]",K,"left",8,-2);ZCView.currentMenu=ZCView.viewContMenus["zc-addFilterEl"];ZCView.currentMenuFixed=ZCView.viewContFixedMenus["zc-addFilterEl"]}else{if(F=="zc-ClearAllFilterOption"){ZCView.clearFilterOptions($(J).attr("delugeName"),K)}else{if(F=="zc-ClearAllfilterEl"){ZCView.clearAllFilters(K)}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}ZCApp.hideAndStopPropogation(H);return U};this.customViewSel=function(G,E){var H=$(G).find("option:selected");var F=$(H).attr("elName");if(F=="savedViews"){ZCView.showSavedView($(G).val(),E)}else{ZCView.filterView($(G).val(),E,$(G))}};this.toggleViewMenu=function(F,N,I){var L=ZCView.getElementOrValue("viewactionmorehide",F);if($(L).length>0){var M=ZCView.getElementOrValue("viewrecactionsheader",F);var E=ZCView.getElementOrValue("viewactionmoreshow",F);var K=ZCView.getElementOrValue("viewactionmore",F);var H=ZCView.getElementOrValue("zcHideMenu",F);if(N==undefined){N=($(E).is(":visible"))?"hide":"show"}if(N=="show"){$(H).show();$(L).hide();$(E).show()}else{$(H).hide();$(L).show();$(E).hide()}if(I=="enable"){$(K).hide();$(K).prev().addClass("zc-viewheader-menus-group-lastchild")}else{$(K).prev().removeClass("zc-viewheader-menus-group-lastchild");$(K).show()}if(isViewBeta&&ZCView.viewCont!=null){ZCView.cache.viewContWidth=ZCView.viewCont.width();ZCView.setWidthForFixedColHeaders()}}var J=ZCView.getElementOrValue("zcActionTypeBulk",F);var G=ZCView.getElementOrValue("saveViewRecsEl",F);if(I=="enable"){$(J).removeClass("zc-view-menu-group-disabled").attr("actionStatus","enable");$(G).removeClass("zc-view-menu-save-disabled").attr("status","enable")}else{$(J).addClass("zc-view-menu-group-disabled").attr("actionStatus","disable");$(G).addClass("zc-view-menu-save-disabled").attr("status","disable")}};this.showDropDownDlg=function(I,G,J,E,K,F,H){$(I).each(function(O){var N=0+H;var M=0+F;var Q=($(this).attr("id")=="zc-listviewheader");var P=false;if(Q){P=($(this).css("display")=="none");if(P){$(this).css({visibility:"hidden",display:""})}var L=$(this).offset();M=M-L.top;N=N-L.left}ZCView.showDropDownDialog($(this).find(G),$(this).find(J),E,K,M,N,Q);if(Q&&P){$(this).css({display:"none",visibility:""})}})};this.showAlertPopUp=function(E){if(!isViewBeta||ZCApp.isMobileSite){alert(E)}else{var F=$("#zc_error_dialog");$(F).find("[elname=zc_dialog_content]").html(E);ZCUtil.showInDialog($(F).html(),"closelink=yes, modal=yes")}};this.showConfirmPopUp=function(G,F,E){if(!isViewBeta){if(confirm(G)){if(F!=undefined){F()}}else{if(E!=undefined){noClBk()}}}else{var H=$("[elname=zc-confirm-popup]");$(H).find("[elname=zc-confirm-msg]").html(G);ZCUtil.showInDialog($(H).html(),"closelink=yes, modal=yes");$(H).hide();H=$("#"+_DIALOG_LAYER_VAR).find("div[elname=zc-confirm-popup-cont]");$(H).find("[elname=confirm_dialog_ok_button]").focus();$(H).find("[elname=confirm_dialog_ok_button]").bind("click",function(){if(F!=undefined){F()}closeDialog()});$(H).find("[elname=confirm_dialog_cancel_button]").bind("click",function(){if(E!=undefined){noClBk()}closeDialog()})}};this.tryNewViewDialog=function(E){var F=getCookie("newuialert_hide_"+E);if(!F||F==""){setCookie("newuialert_hide_"+E,true);ZCView.tryNewView("0")}};this.tryNewView=function(E,H){var G="";var F=isViewBeta;isViewBeta=true;if(E==1||E==0||(E==2&&H)||!H){G=$("#zc-viewbeta-popup").html()}ZCUtil.showInDialog(G,"modal=yes");var I=$("#"+_DIALOG_LAYER_VAR);if(H==false){$(I).find("[elname=zc-tryLike]").hide();if(E!=0){$(I).find("[elname=zc_dialog_header]").html(i18n["zc.viewlive.thanksfortryingui"])}}else{if(H){$(I).find("[elname=zc_dialog_header]").html(i18n["zc.viewlive.thanksfortryingui"])}$(I).find("[elname=zc-revertdialog]").hide()}isViewBeta=F};this.updateViewBetaStatus=function(F){var E="";if(F==2){var I=$("#"+_DIALOG_LAYER_VAR);var H=$(I).find("[elname=zc-viewbetatry-sharedusers]").is(":checked");var F=2;if(H){F=3}}if(F==0){var I=$("#"+_DIALOG_LAYER_VAR);E="&feedback="+$(I).find("[elname=zc-revertfeedback]").val()}if(F==1){var I=$("#"+_DIALOG_LAYER_VAR);E="&feedback="+$(I).find("[elname=zc-likefeedback]").val()}var G="viewBetaEnable="+F+E+"&sharedBy="+ZCApp.sharedBy;ZCUtil.sendRequest("/trynewsharetab.jsp",G,"html","ZCView.handleViewUpdate",ZCUtil.getParamsAsMap(G),i18n.pleasewait)};this.handleViewUpdate=function(E){if(($.trim(E)).indexOf("success")!=-1){location.reload()}};this.showDropDownDialog=function(J,c,d,a,H,f,R){$(c).show();var Z=$(J).offset();var W=0;var E=0;if(Z!=undefined){W=Z.left;E=Z.top}var T=$(J).outerHeight(false);var N=0;var G=E+T;var Q=$(c).outerWidth(false);var e=$(c).outerHeight(false);H=(H==undefined)?0:H;f=(f==undefined)?0:f;if(a=="left"){N=W}else{if(a=="right"){var X=$(J).outerWidth(false);N=(W+X-Q)}}if(layerCount!=undefined&&layerCount>1){var S=$(c).offset();var P=$(c).position();N=N-(S.left-P.left);G=G-(S.top-P.top)}G=G+H;N=N+f;var M=ZCView.cache.viewContLeft;var O=M+ZCView.cache.viewContWidth;if((N+Q)>O){N=(O-Q);if(R!=undefined&&R){N=N-15}}N=(N<0)?0:N;var Y=ZCView.getElementOrValue("documentHeight");if(($(J).parent()).attr("elname")=="zc-rowActionsTdEl"){var I=$(J).parents("[elname=zc-viewtable]").position();var V=$(document).height();var F="0 5px 10px rgba(0,0,0,0.3)";var K=$("#zc-pagefooter").outerHeight();var h=$(J).outerHeight();if(K==null){K=0}var b=V-(G+K);var U=G-I.top-h;var L="5px 0";if(e>b&&b<U){b=U;G=G-(e+h);if(b<e){G=G+(e-b-10);L="none"}F="0px 0px 10px rgba(0,0,0,0.3)"}$(c).css({left:N+"px",top:G+"px","z-index":99,"box-shadow":F,"max-height":b,padding:L});$(c).scrollTop(0)}else{$(c).css({left:N+"px",top:G+"px","z-index":1})}if((G+e)>Y){$("body").css("height",window.innerHeight)}};this.changeFilterSelEvent=function(F){var H=$(F).parents("[elname=zc-filterMoreContEl]");var J=$(H).find("[name=zc-filterColOptionsSel]");var N=$(F).val();var I=$(F).find("option:selected");var M=$(I).attr("fielddispname");var O=$(I).attr("coloptonlist");O=O.substring(1,O.length-1);var G=O.split(",");$(J).empty();$(J).append("<option value='-1'>--Select--</option>");for(var L=0;L<G.length;L++){var K=$.trim(G[L]);$(J).append("<option value='"+N+":"+K+"'>"+K+"</option>")}var E=$(H).find("[elname=zc-filterValOptionCont]");$(E).show();$(J).show();$(H).find("[elname=zc-FilteredCol]").html(M);$(F).hide()};this.removeAnAction=function(H,E){var I=$(H);var F=$(I).attr("viewactionname");var G=$(I).attr("delugeName");if(F=="searchCrit"){var J=this.viewArr[E];ZCUtil.removeFromMap(J,G);ZCUtil.removeFromMap(J,G+"_op");ZCView.showView(J)}else{ZCView.removeOrderBy(F,G,E)}};this.resetView=function(F,E){var G=this.viewArr[E];ZCUtil.setInMap(G,"isReset",true);ZCUtil.setInMap(G,"showResetBar",false);ZCView.showView(G)};this.hideResetBar=function(F,E){var G=this.viewArr[E];ZCUtil.setInMap(G,"showResetBar",false);this.viewArr[E]=G;$("[elname=zc-viewresetdiv]").hide();ZCTemplate.correctViewHeader()};this.toggleDuplicate=function(){if(docid("allowduplicatetd").style.display!="none"){docid("allowduplicatetd").style.display="none";docid("allowduplicate").checked=false}else{docid("allowduplicatetd").style.display=celldisp}if(docid("allowduplicatetd").style.display=="none"&&docid("allowbulkedittd").style.display=="none"){docid("allowdupbulk").style.display="none"}else{docid("allowdupbulk").style.display=rowdisp}docid("lasttd").style.display=celldisp};this.toggleBulkEdit=function(){if(docid("allowbulkedittd").style.display!="none"){docid("allowbulkedittd").style.display="none";docid("allowbulkedit").checked=false}else{docid("allowbulkedittd").style.display=celldisp}if(docid("allowduplicatetd").style.display=="none"&&docid("allowbulkedittd").style.display=="none"){docid("allowdupbulk").style.display="none"}else{docid("allowdupbulk").style.display=rowdisp}docid("lasttd").style.display=celldisp};this.showEditElements=function(F){var E=$("#zc-viewedit");$.each(ZCApp.viewEditElements,function(G,H){if(H==F){$("#"+H+"-area").show();$(E).find("li[elName="+H+"]").addClass("zc-viewedittab-selected")}else{$("#"+H+"-area").hide();$(E).find("li[elName="+H+"]").removeClass("zc-viewedittab-selected")}})};this.showViewEditor=function(E){};this.handleShowViewEditor=function(I,J,K){var E=ZCUtil.getFromMap(K,"compLinkName");var H=this.viewArr[E];var G=ZCView.getViewCont(E);var F=$("#zc-vieweditor");$(F).html(I);$(G).hide();$(F).show();this.viewEditOpened=true};this.showViewEditSection=function(F){var E=$(F);var G=$(E).find("table");if($(G).is(":visible")){$(G).hide();this.lastClickedViewEditSection=null}else{if(this.lastClickedViewEditSection!=null){$(this.lastClickedViewEditSection).hide()}$(G).show();this.lastClickedViewEditSection=G}};this.expandRows=function(E){var K=$("#showhidebody")[0];var I=K.rows;var M="/appcreator/images/edit/collapse_bullet.gif";for(var J=0;J<I.length;J++){var H=I.item(J);var F=H.id;var L=getA(H,"basefcid");var N=getA(H,"reffcid");if(F&&F.indexOf("shtr")!=-1&&L&&L!=null&&E==L){var G=H.style.display;if(G==rowdisp){H.style.display="none"}else{H.style.display=rowdisp;M="/appcreator/images/edit/expand_bullet.gif"}}if(F&&F.indexOf("shtr")!=-1&&N&&N!=null&&E==N){var G=H.style.display;if(G==rowdisp){H.style.display="none"}}}$("#expand"+E)[0].src=M};this.showCrit=function(I){var H=docid("setcrit");var G=H.rows.item(1);if(I==true){var E=docid("basecrit");if(E.rows.length==1){var F=docid("samplecritrow").cloneNode(true);F.id="";E.insertBefore(F,E.rows.item(0))}G.style.display=rowdisp}else{G.style.display="none"}};this.removeRow=function(G){var E=G.parentNode.parentNode;var H=E.parentNode;var F=H.rows;if(F.length==2){if(ZCView.editcustomid&&ZCView.editcustomid!=null&&ZCView.editcustomid!=""){ZCView.cancelcustom()}else{docid("allrecords").checked=true;var I=docid("setcrit");I.rows.item(1).style.display="none"}}else{if(F.length==3){F.item(2).style.display="none"}}H.removeChild(E)};this.addRow=function(I){var G=I.parentNode.parentNode;var K=G.parentNode;var J=K.insertBefore(G.cloneNode(true),G.nextSibling);var F=G.cells.item(0).getElementsByTagName("select").item(0).selectedIndex;var E=G.cells.item(1).getElementsByTagName("select").item(0).selectedIndex;J.cells.item(0).getElementsByTagName("select").item(0).selectedIndex=F;J.cells.item(1).getElementsByTagName("select").item(0).selectedIndex=E;J.cells.item(2).getElementsByTagName("input").item(0).value="";setA(J.cells.item(2).getElementsByTagName("input").item(0),"value","");var H=K.rows;H.item(H.length-1).style.display=rowdisp};this.critMode="normal";this.setCritMode=function(F){var E=this.getCritStr(docid("basecrit"));var G=docid("delCritStr").value;if(trim(F.innerHTML)==i18n["zc.viewedit.advcritlink"]){if(E==-1){return false}if(E!=G){docid("delCritStr").value=E}F.innerHTML=i18n["zc.viewedit.uicritlink"];docid("UICritDIV").style.display="none";docid("DelCritDIV").style.display="";docid("critEgDIV").innerHTML=i18n["zc.viewedit.setcritmsg"]+"<br>"+i18n["zc.viewedit.setcritmsg2"];this.critMode="advanced"}else{if(E!=G){if(!confirm(i18n["zc.viewedit.critmodealert1"]+"\n"+i18n["zc.viewedit.critmodealert2"])){return false}}F.innerHTML=i18n["zc.viewedit.advcritlink"];docid("DelCritDIV").style.display="none";docid("UICritDIV").style.display="";docid("critEgDIV").innerHTML=i18n["zc.viewedit.setcritmsg"]+"<br>"+i18n["zc.viewedit.setcritmsg1"];this.critMode="normal"}};this.getCritStr=function(T){var P="";var Q=T.rows;var d=Q.item(Q.length-1);var I=d.getElementsByTagName("input");var F="";for(var Z=0;Z<I.length;Z++){var G=I.item(Z);if(G.checked==true){F=G.value;break}}for(var Z=0;Z<Q.length-1;Z++){var U=Q.item(Z);var O=U.getElementsByTagName("select");var M="";var S="";var E="";var b="";var a="";var R="";for(var Y=0;Y<O.length;Y++){var X=O.item(Y);if(getA(X,"seltype")=="col"){M=X.value;var K=X.selectedIndex;var J=X.options.item(K);E=getA(J,"genType");b=getA(J,"fcType");a=getA(J,"baseFCType")}else{S=this.getDelType(X.value,M)}}var H=U.getElementsByTagName("input");var c=H.item(0).value;c=trimString(c);c=c.replace(/\"/g,'\\"');if(c!=""||E=="date"||E=="datetime"){if(equalsIgnoreCase(c,"null")==true){c="null"}else{if(E=="string"&&c!='""'){c='"'+c+'"'}else{if(E=="date"||E=="datetime"){var W=ZCView.getDelugeStringVal(X.value);if(W==-1){var L="The "+E+' value entered should be of the format "DD-MMM-YYYY';var V=(E=="datetime")?' HH:MM:SS"':'"';L=L+V;c="'"+c+"'"}else{c=W}if(E=="datetime"){R=getCurrentType(X.value,M);if(X.value==TODAY||X.value==YESTERDAY||X.value==TOMORROW){S=M+">=";R=M+"<="+c+"+'23H:59M:59S'"}if(X.value==NEXT_7_DAYS||X.value==NEXT_30_DAYS||X.value==NEXT_60_DAYS||X.value==NEXT_90_DAYS||X.value==NEXT_120_DAYS){R=R+"+'23H:59M:59S'"}P=P+"  ("+S+"  "+c+")  ";if(R!=-1){P=P+"&& ("+R+")"}P=P+F}if(E=="date"){if(X.value==LAST_7_DAYS||X.value==LAST_30_DAYS||X.value==LAST_60_DAYS||X.value==LAST_90_DAYS||X.value==LAST_120_DAYS||X.value==NEXT_7_DAYS||X.value==NEXT_30_DAYS||X.value==NEXT_60_DAYS||X.value==NEXT_90_DAYS||X.value==NEXT_120_DAYS||X.value==THIS_WEEK||X.value==LAST_WEEK||X.value==NEXT_WEEK){R=getCurrentType(X.value,M);P=P+"  ("+S+" "+c+")  && ("+R+")"+F}else{P=P+"  ("+S+"  "+c+")  "+F}}}}}if(E!="date"&&E!="datetime"){if(X.value==ZCConstants.REL_OPR_CONTAINS||X.value==ZCConstants.REL_OPR_NOTCONTAINS||X.value==ZCConstants.REL_OPR_STARTS_WITH||X.value==ZCConstants.REL_OPR_ENDS_WITH){P=P+"  ("+S+"("+c+"))  "+F}else{P=P+"  ("+S+"  "+c+")  "+F}}}}P=trimString(P);var N=P.length-F.length;if(P.lastIndexOf(F)==N){P=P.substring(0,N)}P=trimString(P);if(P!=""){P="("+P+")"}return P};this.getDelType=function(E,G){var F=parseInt(E);switch(F){case ZCConstants.REL_OPR_EQ:return G+" ==";break;case ZCConstants.REL_OPR_NE:return G+" !=";break;case ZCConstants.REL_OPR_GT:return G+" >";break;case ZCConstants.REL_OPR_LT:return G+" <";break;case ZCConstants.REL_OPR_LE:return G+" <=";break;case ZCConstants.REL_OPR_GE:return G+" >=";break;case ZCConstants.REL_OPR_CONTAINS:return G+".contains";break;case ZCConstants.REL_OPR_NOTCONTAINS:return"!"+G+".contains";break;case ZCConstants.REL_OPR_STARTS_WITH:return G+".startsWith";break;case ZCConstants.REL_OPR_ENDS_WITH:return G+".endsWith";break;case ZCConstants.TODAY:return G+"==";case ZCConstants.YESTERDAY:return G+"==";case ZCConstants.TOMORROW:return G+"==";case ZCConstants.LAST_7_DAYS:return G+">=";case ZCConstants.LAST_30_DAYS:return G+">=";case ZCConstants.LAST_60_DAYS:return G+">=";case ZCConstants.LAST_90_DAYS:return G+">=";case ZCConstants.LAST_120_DAYS:return G+">=";case ZCConstants.NEXT_7_DAYS:return G+"<=";case ZCConstants.NEXT_30_DAYS:return G+"<=";case ZCConstants.NEXT_60_DAYS:return G+"<=";case ZCConstants.NEXT_90_DAYS:return G+"<=";case ZCConstants.NEXT_120_DAYS:return G+"<=";case ZCConstants.THIS_WEEK:return G+" >=";case ZCConstants.LAST_WEEK:return G+" >=";case ZCConstants.NEXT_WEEK:return G+" >=";break}};this.getCurrentType=function(E,G){var F=parseInt(E);switch(F){case ZCConstants.LAST_7_DAYS:return G+"< zoho.currentdate";case ZCConstants.LAST_30_DAYS:return G+"< zoho.currentdate";case ZCConstants.LAST_60_DAYS:return G+"< zoho.currentdate";case ZCConstants.LAST_90_DAYS:return G+"< zoho.currentdate";case ZCConstants.LAST_120_DAYS:return G+"< zoho.currentdate";case ZCConstants.NEXT_7_DAYS:return G+"> zoho.currentdate";case ZCConstants.NEXT_30_DAYS:return G+"> zoho.currentdate";case ZCConstants.NEXT_60_DAYS:return G+"> zoho.currentdate";case ZCConstants.NEXT_90_DAYS:return G+"> zoho.currentdate";case ZCConstants.NEXT_120_DAYS:return G+"> zoho.currentdate";case ZCConstants.THIS_WEEK:return G+" <= zoho.currentdate.addday(7 - zoho.currentdate.getDayOfWeek())";case ZCConstants.LAST_WEEK:return G+" <= zoho.currentdate.subday(zoho.currentdate.getDayOfWeek())";case ZCConstants.NEXT_WEEK:return G+" <= zoho.currentdate.addday((7 - zoho.currentdate.getDayOfWeek()) + 7)";default:return -1;break}};this.getDelugeStringVal=function(E){var F=parseInt(E);switch(F){case ZCConstants.TODAY:return"zoho.currentdate";break;case ZCConstants.YESTERDAY:return"zoho.currentdate - '1D'";break;case ZCConstants.TOMORROW:return"zoho.currentdate + '1D'";break;case ZCConstants.LAST_7_DAYS:return"zoho.currentdate - '7D'";break;case ZCConstants.LAST_30_DAYS:return"zoho.currentdate - '30D'";break;case ZCConstants.LAST_60_DAYS:return"zoho.currentdate - '60D'";break;case ZCConstants.LAST_90_DAYS:return"zoho.currentdate - '90D'";break;case ZCConstants.LAST_120_DAYS:return"zoho.currentdate - '120D'";break;case ZCConstants.NEXT_7_DAYS:return"zoho.currentdate + '7D'";break;case ZCConstants.NEXT_30_DAYS:return"zoho.currentdate + '30D'";break;case ZCConstants.NEXT_60_DAYS:return"zoho.currentdate + '60D'";break;case ZCConstants.NEXT_90_DAYS:return"zoho.currentdate + '90D'";break;case ZCConstants.NEXT_120_DAYS:return"zoho.currentdate + '120D'";break;case ZCConstants.THIS_WEEK:return"zoho.currentdate.subday(zoho.currentdate.getDayOfWeek() - 1)";case ZCConstants.LAST_WEEK:return"zoho.currentdate.subday(zoho.currentdate.getDayOfWeek() + 6)";case ZCConstants.NEXT_WEEK:return"zoho.currentdate.addday((7 - zoho.currentdate.getDayOfWeek()) + 1)";default:return -1;break}};this.editButtonClick=function(G,E){if(G=="zc-viewedit-criteria-button"){this.setCriteria(E)}else{if(G=="zc-viewedit-close-button"){var F=ZCView.getViewCont(E);F.find("div[elName=zc-vieweditor]").hide();this.viewEditOpened=false}else{if(G=="zc-viewedit-columns-button"){this.colupdate(E)}else{if(G=="zc-viewedit-filters-button"){this.saveCheck(E)}}}}};this.setCriteria=function(E){var H="";if(this.critMode=="normal"){if(docid("allrecords").checked!=true){var F=docid("basecrit");H=this.getCritStr(F);if(H==-1){return false}}}else{H=docid("delCritStr").value}var G=this.viewArr[E];var I="criteria="+H+"&viewid="+ZCUtil.getFromMap(G,"viewID")+"&formid="+ZCUtil.getFromMap(G,"viewFormID");ZCUtil.sendRequest("/setCriteria.do",I,"html","ZCView.handleViewEdit",ZCUtil.getParamsAsMap("viewLinkName="+E+"&fromElem=criteria"),i18n.loadingmsg)};this.colchange=function(E){var I=E.options.item(E.selectedIndex);var G=getA(I,"sample");var H=E.parentNode.parentNode;var F=H.cells.item(1);F.innerHTML="";F.appendChild(docid(G).cloneNode(true))};this.handleViewEdit=function(F,H,I){if(F&&F!=null){ZCView.showAlertPopUp(F);return }else{var E=ZCUtil.getFromMap(I,"viewLinkName");this.viewEditElem=ZCUtil.getFromMap(I,"fromElem");var G=this.viewArr[E];ZCView.showView(G)}};this.colupdate=function(AC){var p=this.viewArr[AC];var M=$("#zc-vieweditvars").attr("subVid");var U=$("#zc-vieweditvars").attr("basesubvid");var n=$("#zc-vieweditvars").attr("noOfReports");var K=ZCUtil.getFromMap(p,"viewFormName");var E=ZCUtil.getFromMap(p,"viewID");var I=ZCApp.appID;var m=docid("showhidebody");var a=m.rows;var N="";var O=true;var T=new Array();var W=new Array();var q=new Array();W.push("vid");q.push(E);W.push("basesubvid");q.push(U);W.push("appid-modtime");q.push(I);for(var z=0;z<a.length;z++){var d=a.item(z);var l=d.id;if(l&&l.indexOf("shtr")!=-1){var Z="";var G=l.substring(4);if(getA(d,"subvid")==M){var S=(docid("shhref"+G).checked)?"show":"hide";if(S=="show"&&getA(d,"isSubform")=="false"){O=false}}var AD=docid("shtrinput"+G).value;while(AD.indexOf(":")!=-1){AD=AD.replace(":","@#zc_colon#@")}var V=getA(d,"subvcid");if(getA(d,"elname")=="linktoview"){var e=d.getElementsByTagName("tr");var v=new Array();for(var X=0;X<e.length;X++){var u=e.item(X);if(getA(u,"elName")!="linkCompsRow"){continue}var AB=u.getElementsByTagName("select");var h=AB[0].options;var H="disablelink";var c=getA(docid("shtrlink"+G),"linkstatus");if(c.indexOf("enable")!=-1){H="enablelink"}for(var w=0;w<h.length;w++){var P=h[w];var s="hide";Z="";if(w==AB[0].selectedIndex&&docid("shhref"+G).checked){s="show"}var o=P.value+"-"+G;if(s=="show"&&v.indexOf(o)!=-1){ZCView.showAlertPopUp("Please make sure that all the selected columns for the SubForm Field "+AD+" are different.");return false}Z=Z+o+":"+s+":"+AD+":"+getA(P,"subvcid")+":"+getA(P,"subvid")+":"+getA(P,"refformid")+":"+H+":merge: ";N=N+"col_"+o+",";W.push("col_"+o);q.push(Z);if(s=="show"){v.push(o)}var J=docid("lookuplinkview"+G);if(H=="enablelink"&&J!=null&&typeof J!=undefined){var Y=J.options[J.selectedIndex].value;if(Y==""){ZCView.showAlertPopUp(i18n["zc.viewedit.selectviewtolink"]);J.focus();return false}if(Y!=null&&Y!=""){W.push("lookuplinkview"+P.value);q.push(Y)}}}}}else{var H="disablelink";var L=(docid("shhref"+G).checked)?"show":"hide";if(docid("shtrsum"+G)){var y=docid("shtrsum"+G).className;var b="disablesum";if(y.indexOf("enable")!=-1){b="enablesum"}Z=Z+G+":"+L+":"+AD+":"+V+":"+getA(d,"subvid")+":"+getA(d,"refformid")+":"+b}else{if(docid("shtrlink"+G)){var y=docid("shtrlink"+G).className;if(y.indexOf("enable")!=-1){H="enablelink"}Z=Z+G+":"+L+":"+AD+":"+V+":"+getA(d,"subvid")+":"+getA(d,"refformid")+":"+H}else{Z=Z+G+":"+L+":"+AD+":"+V+":"+getA(d,"subvid")+":"+getA(d,"refformid")}}if(L=="hide"&&getA(d,"elname")!="subFormView"){if(V!="null"){T.push(AD)}}var J=docid("lookuplinkview"+G);if(H=="enablelink"&&J!=null&&typeof J!=undefined){var Y=J.options[J.selectedIndex].value;if(Y==""){ZCView.showAlertPopUp(i18n["zc.viewedit.selectviewtolink"]);J.focus();return false}if(Y!=null&&Y!=""){W.push("lookuplinkview"+G);q.push(Y)}}N=N+"col_"+G+",";W.push("col_"+G);q.push(Z)}}}var R=T.length;if(O){var Q=replaceParams(i18n["zc.viewedit.viewshouldhaveatleasetonefield"],new Array(K));ZCView.showAlertPopUp(Q);return }else{if(R>0&&n>0){var f=i18n["zc.viewedit.delcoldetails"]+"\n";for(var AA=0;AA<R;AA++){f+="\n"+(AA+1)+". "+T[AA]}f+="\n\n"+i18n["zc.viewedit.delcolwarning"];f+="\n"+i18n["zc.viewedit.doyouwanttoproceed"];if(!confirm(f)){return }}}W.push("cols");q.push(N);var F="";append="";$.each($(W),function(AE,AF){append="";if(AE!=0){append="&"}F=F+append+AF+"="+q[AE]});ZCUtil.sendRequest("/colupdate.do",F,"html","ZCView.handleViewEdit",ZCUtil.getParamsAsMap("viewLinkName="+AC+"&fromElem=columns"),i18n.loadingmsg)};this.editcustom=function(E){var F=E.id.substring(7);ZCView.cancelcustom();ZCView.editcustomid="custcrit"+F;var G=docid(ZCView.editcustomid);ZCView.editcustomhtml=G.innerHTML;G.style.display="";docid("newfiltertr").style.display="none"};this.savecustom=function(){var G="";var L=docid(ZCView.editcustomid);var E=ZCView.editcustomid.substring(8);var K=L.getElementsByTagName("input");var J=K.item(0).value;for(var I=0;I<K.length;I++){var M=K.item(I);if(M.type=="text"){if(getA(M,"name")=="filterName"){G=M.value;if(M.value==""||trim(M.value).length==0){ZCView.showAlertPopUp(i18Arr["zc.viewedit.pleaseprovideanameforthefilter"]);return false}}setA(M,"value",M.value)}else{if(M.type=="radio"){if(M.checked==true){setA(M,"checked","checked")}if(M.id=="sampleallmatch"){M.id="allmatch"+J+E;M.name="matching"+J+E;M.parentNode.getElementsByTagName("label").item(0).htmlFor=M.id}else{if(M.id=="sampleanymatch"){M.id="anymatch"+J+E;M.name="matching"+J+E;M.parentNode.getElementsByTagName("label").item(1).htmlFor=M.id}}}}}if(ZCView.isnewFilter==true){var H=L.getElementsByTagName("select");for(var I=0;I<H.length;I++){var M=H.item(I);var F=M.options[M.selectedIndex];setA(F,"selected","selected")}var N=docid("autofilters");N.innerHTML=N.innerHTML+ZCView.custfilterhtml+docid("newfiltertd").innerHTML;ZCView.cancelcustom();docid("samplecustfilter").id="custfilter"+E;docid("crit"+E).id="";docid("custfilter"+E).getElementsByTagName("a").item(0).id="ecustom"+E;docid("custfilter"+E).getElementsByTagName("a").item(1).id="rcustom"+E;docid("custfilter"+E).style.display="";docid("custcrit"+E).style.display="none"}docid("custfilter"+E).getElementsByTagName("span").item(0).innerHTML=G;L.style.display="none";ZCView.editcustomhtml="";ZCView.editcustomid="";L=null;docid("newfiltertr").style.display=rowdisp;return true};this.cancelcustom=function(){if(ZCView.isnewFilter==true){docid("newfiltertd").innerHTML="";ZCView.isnewFilter=false;docid("newfiltertr").style.display=rowdisp}else{if(ZCView.editcustomid!=""){var E=docid(ZCView.editcustomid);if(E){E.innerHTML=ZCView.editcustomhtml;E.style.display="none";ZCView.editcustomhtml="";ZCView.editcustomid="";E=null}}}docid("newfiltertr").style.display=rowdisp;ZCView.editcustomid=""};this.shauto=function(I){I.parentNode.className=(I.parentNode.className=="filter-show")?"filter-hide":"filter-show";var H=I.parentNode.parentNode;var G=H.getElementsByTagName("div");for(var F=0;F<G.length;F++){var E=G.item(F);if(E.className.indexOf("auto-filter-")!=-1){E.className=(E.className=="auto-filter-hide")?"auto-filter-show":"auto-filter-hide"}}};this.saveCheck=function(E){if(ZCView.editcustomid==""){ZCView.savefilters(E)}else{if(confirm(i18Arr["zc.viewedit.yourfilterisnotsaved"])){if(ZCView.savecustom()){ZCView.savefilters(E)}}else{return false}}};this.savefilters=function(X){var G=this.viewArr[X];var Z=ZCUtil.getFromMap(G,"viewID");var E=ZCUtil.getFromMap(G,"viewFormID");var F=ZCApp.appID;var W=docid("autofilters");var M=W.getElementsByTagName("div");var Q="";for(var T=0;T<M.length;T++){var c=M.item(T);if(c.className=="filter-show"){var N=c.id.substring(4);Q=Q+N+":"}}var V=Q.length;if(V>0&&Q.lastIndexOf(":")==V-1){Q=Q.substring(0,V-1)}var J=0;var R=W.getElementsByTagName("div");var b="";for(var S=0;S<R.length;S++){var U=R.item(S);advdid=U.id;if(advdid.indexOf("advfilter")!=-1){var e=advdid.substring(9);b=b+e+":"}}var L=new Array("auto","viewid","formid","advancefilter");var K=new Array(Q,Z,E,b);var H="";for(var T=0;T<R.length;T++){var f=R.item(T);did=f.id;if(did.indexOf("custfilter")!=-1){var P=did.substring(10);var O=docid("custcrit"+P);var I="customfilter:"+encodeURIComponent(O.getElementsByTagName("input").item(0).value);L[L.length]=I;H=ZCView.validateCritStr(O.getElementsByTagName("table").item(0).getElementsByTagName("table").item(0));if(H!=""){break}var d=ZCView.getCritStr(O.getElementsByTagName("table").item(0).getElementsByTagName("table").item(0));if(d==-1){return false}K[K.length]=d}}if(H!=""){ZCView.showAlertPopUp(H);return false}L[L.length]="appid-modtime";K[K.length]=F;var Y="";append="";$.each($(L),function(a,h){append="";if(a!=0){append="&"}Y=Y+append+h+"="+K[a]});ZCUtil.sendRequest("/setFilters.do",Y,"html","ZCView.handleViewEdit",ZCUtil.getParamsAsMap("viewLinkName="+X+"&fromElem=filters"),i18n.loadingmsg)};this.removecustom=function(E){var G=E.id.substring(7);if(docid("custcrit"+G)){var I=docid("custcrit"+G);var H=docid("custfilter"+G);I.parentNode.removeChild(I);H.parentNode.removeChild(H)}else{if(docid("advfilter"+G)){var F=docid("advfilter"+G);F.parentNode.removeChild(F)}}};this.getNewCustId=function(){var E=docid("autofilters");var H=E.getElementsByTagName("div");var J=-1;for(var F=0;F<H.length;F++){var I=H.item(F);did=I.id;if(did.indexOf("custcrit")!=-1){var G=did.substring(8);if(J<parseInt(G)){J=G}}}return parseInt(J)+1};this.newfilter=function(){ZCView.cancelcustom();var G=ZCView.getNewCustId();docid("newfiltertd").innerHTML="";docid("newfiltertd").innerHTML=ZCView.custcrithtml;docid("samplecustcrit").id="custcrit"+G;var F=docid("samplecrit");F.id="crit"+G;ZCView.editcustomid="custcrit"+G;var E=docid("samplecritrow").cloneNode(true);E.id="";F.insertBefore(E,F.rows.item(0));ZCView.isnewFilter=true;F.rows.item(1).style.display="none";docid("newfiltertr").style.display="none";docid("custcrit"+G).style.display=""};this.validateCritStr=function(L){var J=L.rows;var P="";for(var N=0;N<J.length-1;N++){var E=J.item(N);var M=E.getElementsByTagName("select");var I="";var R="";for(var K=0;K<M.length;K++){var G=M.item(K);if(getA(G,"seltype")=="col"){I=G.value;var O=G.selectedIndex;var F=G.options.item(O);genType=getA(F,"genType");R=getA(F,"fcType")}}var Q=E.getElementsByTagName("input");var H=Q.item(0).value;H=trimString(H);P=ZCView.validateFilVal(R,H,F.innerHTML,G.value);if(P!=""){break}}return P};this.validateFilVal=function(H,I,F,G){var E="";if(H==ZCConstants.NUMBER||H==ZCConstants.CURRENCY||H==ZCConstants.PERCENTAGE){E=ZCView.validNumber(I,F)}if(H==ZCConstants.DATE&&ZCView.getDelugeStringVal(G)==-1){E=ZCView.dateValidate(F,I)}return E};this.validNumber=function(G,H){var L="";var J=/^[0-9]*$/;var K=/^\d+(\.\d+)?$/;var I=0;if(I>0){if(G!=null&&G!=""&&!J.test(G)&&!K.test(G)){L="Please enter a valid number in the "+H+" field"}else{if(G.indexOf(".")!=-1){var F=G.substring(G.indexOf("."));var E=F.length-1;if(E>I){L="Please round off the "+H+" field value to "+I+" decimal places."}}}}else{if(G!=null&&G!=""&&!J.test(G)){L="Please enter a valid number in the "+H+" field"}}return L};this.dateValidate=function(F,J){var G="";G=ZCView.patternValidate(F,J);if(G!=""){return G}dateval=J.replace(/^\s+/g,"").replace(/\s+$/g,"");var L=J.split("-");var E=L[0];var H=L[1];var K=L[2];var I=ZCView.getMonthStr(H);if(I==""){G="Please enter a valid Month for "+F;return G}if(E<1||E>31||I<1||I>12||K<1||K<1000){G="Please enter a valid Date for "+F;return G}if((I==2)&&(E>29)){G="Please enter a valid Date for "+F;return G}if((I==2)&&(E>28)&&((K%4)!=0)){G="Please enter a valid Date for "+F;return G}switch(parseInt(I)){case 2:case 4:case 6:case 9:case 11:if(E>30){G="Please enter a valid Date for "+F;return G}}return G};this.patternValidate=function(E,H){var I="";var F="dd-mmm-yyyy";switch(F.toLowerCase()){case"dd-mm-yyyy":var G=/^\d{1,2}(\-)\d{1,2}\1\d{4}$/;break;case"dd-mmm-yyyy":var G=/^\d{1,2}(\-)(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\1\d{4}$/;break}if(!G.test(H)){I="The "+E+" should be in the format of dd-mmm-yyyy. For eg: 10-Apr-2007 "}return I};this.getMonthStr=function(E){switch(E){case"Jan":return"01";break;case"Feb":return"02";break;case"Mar":return"03";break;case"Apr":return"04";break;case"May":return"05";break;case"Jun":return"06";break;case"Jul":return"07";break;case"Aug":return"08";break;case"Sep":return"09";break;case"Oct":return"10";break;case"Nov":return"11";break;case"Dec":return"12";break;default:return"";break}};this.toggleHdrArrow=function(F){var E=$(F).find("span[elName=zc-viewheaderarrow]")[0];var G=(E.style.visibility=="hidden")?"visible":"hidden";E.style.visibility=G};this.showSearchOption=function(E,H){var G=$(F).find("div[elName=zc-viewsearchoptionsdiv]");var F=ZCView.getViewContainers(E);G.find("div[elName=zc-searchfieldoption]").hide();G.find("div[elName=zc-searchfieldoption][delugename='"+H+"']").show();ZCView.showDropDownDlg($(F),"[elName=zc-viewrowheader][delugename="+H+"]","[elName=zc-viewsearchoptionsdiv]",E,"left",-1,0)};this.showColHdrMenu=function(E,T){var F=this.viewArr[T];var R=ZCView.getViewCont(T);var X=ZCView.getViewContainers(T);if($(E).attr("elName")=="zc-viewheaderarrow"){E=ZCUtil.getParent(E,"th[elName=zc-viewrowheader]")}if($(E).attr("elName")=="zc-viewrowheaderdiv"){E=ZCUtil.getParent(E,"th[elName=zc-viewrowheader]")}var P=$(E).attr("isEncrypted");if(P=="true"){$(X).find("tr[submenuname='zc-sortSubMenu']").hide();$(X).find("tr[submenuname='zc-groupSubMenu']").hide();$(X).find("td[elname='zc-searchcolEl']").hide()}else{$(X).find("tr[submenuname='zc-sortSubMenu']").show();$(X).find("tr[submenuname='zc-groupSubMenu']").show();$(X).find("td[elname='zc-searchcolEl']").show()}var M=$(E).attr("delugeName");var V=$(X).find("div[elName=zc-viewsearchoptionsdiv]");if(V.is(":visible")){V.find("div[elName=zc-searchfieldoption][delugename='"+M+"']").hide();if(!V.find("div[elName=zc-searchfieldoption]").is(":visible")){ZCView.getElementOrValue("viewsearchoptionsdiv",T).hide()}}var O=$(X).find("tr[elName1=zc-lockViewSubMenuEl]");var Y=$(X).find("div[elName=zc-viewheaderoptionsdiv]");$(Y).attr("inpgridtype","");if(O.length>0){$(O).hide();if($(E).attr("inpgridtype").length>0){$(O).show();$(Y).attr("inpgridtype",$(E).attr("inpgridtype"))}}var Z=$(X).find("tr[elName1=zc-filterSubMenuEl]");if($(E).attr("showAutoFilter")=="true"){$(Z).show()}else{$(Z).hide()}$(Z).attr("subMenuName","zc-fiterSubMenu-"+$(E).attr("labelName"));if($(E).attr("showSumProps")=="true"){var S=$(X).find("tr[elName1=zc-summationSubMenu]");$(S).show();var L=$(E).attr("isSumReq");$(S).find("[elname=zc-summationEl]:isEnable").css("font-weight","");$(S).find("[elname=zc-summationEl][isEnable="+L+"]").css("font-weight","bold")}else{$(X).find("tr[elName1=zc-summationSubMenu]").hide()}if($(E).attr("showLinkView")=="true"){var Q=$(R).find("tr[elName1=zc-LinkViewSubMenuEl]");$(Q).show();var H=$(E).attr("linkViewID");if(H==""){H="-1"}$(Q).attr("subMenuName","zc-LinkViewSubMenu-"+$(E).attr("labelName"));$(Q).find("[elName=zc-LinkViewEl][linkViewID="+H+"]").css("font-weight","bold")}else{$(X).find("tr[elName1=zc-LinkViewSubMenuEl]").hide()}$(Y).attr("delugeName",M);var U=ZCUtil.getFromMap(F,"filterVal");var N=U.indexOf(":");if(N!=-1){var J=U.substring(0,N);var W=U.substr(N+1);if(J==M){var K=$(Y).find("div[elName=zc-fiterSubMenu-"+$(E).attr("labelName")+"]");$(K).find("td[filterVal="+U+"]").html("<B>"+$(K).find("td[filterVal="+U+"]").html()+"</B>")}}ZCView.resetHdrOptions(Y);ZCView.markOrderBy(F,Y,M,"group");ZCView.markOrderBy(F,Y,M,"sort");if(!isViewBeta){ZCUtil.showDropDownMenu(E[0],$(Y)[0])}else{var G=$(E).attr("elName");var I=$(E).attr("delugename");ZCView.showDropDownDlg($(X),"[elName=zc-viewrowheader][delugename='"+I+"']","[elName=zc-viewheaderoptionsdiv]",T,"left",-1,0)}};this.showSavedViews=function(H,E){var I=ZCView.getViewCont(E);var F=ZCUtil.getParent(H,"div");var G=$(F).width();ZCUtil.showDropDownMenu(F[0],$(I).find("div[elName=zc-savedviewssubmenu]")[0]);$(I).find("div[elName=zc-savedviewssubmenu]").find("table").css("width",G)};this.showMoreActions=function(H,E){var F=ZCView.getViewContainers(E);var G=ZCUtil.getParent(H,"div");G=$(G).attr("elName")=="zc-moreactionsel"?G:H;ZCUtil.showDropDownMenu(G[0],$(F).find("div[elName=zc-viewOptionsDIV]")[0])};this.exportData=function(R,Z,L,N,Q){var X=ZCView.getViewCont(Z);var P="";var H=$("input[name=download-type]:checked").val();var J=$(ZCView.getViewCont(Z)).find("div[elName=zc-linkinfo-div]").attr("critStr");var W=$(ZCView.getViewCont(Z)).find("div[elName=zc-linkinfo-div]").attr("searchedCrit");var Y=$(ZCView.getViewCont(Z)).find("div[elName=zc-linkinfo-div]").attr("zc_Criteria");$.each($(X).find("input[elName=zc-recSelectionEl]"),function(a,b){if($(b).is(":checked")){P=P+ZCView.checkAndGetAttribute(b,"recLinkID")+","}});if(isViewBeta){H="zcallrecords";if(P!=""){H="zcselectedrecords"}else{if(J!=""){H="zcfilteredrecords"}}}var U=$(X).find("div[elName=zc-linkinfo-div]");var K=this.viewArr[Z];var E=ZCUtil.getFromMap(K,"privateLink");E=ZCUtil.isNull(E)?"":E;var M="";var O=false;switch(R){case"xls":case"pdf":case"csv":case"tsv":M="downloadExportData.do";break;case"html":O=(ZCUtil.getFromMap(K,"viewType")==ZCConstants.VIEW_CALENDAR);M="downloadPermaViewHeader.do";break;case"rss":M="downloadRss.do";break;case"json":M="downloadJson.do";break}var T=$(U).attr("scheme")+"://"+$(U).attr("exportServerPrefix")+"/"+M+"?";replacedStr=J.replace(W.replace(/:zoho-ampersand:/g,"&"),"");J=replacedStr.indexOf("&")==0?replacedStr.replace("&",""):replacedStr;if($("[elName=zc-export-dialog-div]").attr("includecrit")=="true"){T=T+J}if(Y!==null&&Y!==""&&Y!=="undefined"){var S="&zc_Criteria="+encodeURIComponent(Y);T=T+S}var G=document.createElement("form");G.setAttribute("method","post");G.setAttribute("action",T);G.setAttribute("target","_blank");reckey="";recvalue="";if(H!="zcallrecords"&&H!="zcfilteredrecords"&&P!=""&&P!=null){reckey=reckey+"zc_SelectedRecId";recvalue=recvalue+P}if(H=="zcallrecords"){reckey=reckey+"zc_RemoveCrit";recvalue=recvalue+"true"}var I=[{key:"isFullDownload",value:Q},{key:"fileType",value:R},{key:"sharedBy",value:ZCApp.sharedByDisp},{key:"viewLinkName",value:Z},{key:"noOfRecords",value:N},{key:"startIndex",value:L},{key:"appLinkName",value:ZCApp.appLinkName},{key:reckey,value:recvalue},{key:"calHtmlExport",value:O},{key:"privateLink",value:E}];if($("[elName=zc-export-dialog-div]").attr("includecrit")=="true"&&H!="zcallrecords"&&H!="zcselectedrecords"&&W!=""){critParams=W.split(":zoho-ampersand:");for(cp in critParams){singleParamObj=critParams[cp];key=singleParamObj.substring(0,singleParamObj.indexOf("="));value=singleParamObj.substring(singleParamObj.indexOf("=")+1,singleParamObj.length);paramArr={key:key,value:value};if(paramArr.key!=""){I.push(paramArr)}}}var V;for(V in I){var F=I[V];G.appendChild(getInp(F.key,F.value))}document.body.appendChild(G);G.submit()};this.resetHdrOptions=function(E){$.each($(E).find("div[elName=zc-groupSubMenu],div[elName=zc-sortSubMenu]"),function(F,G){$.each($(G).find("table[elName=zc-subtable]").find("td"),function(I,J){var H=$(J).attr("isAsc");$(J).find("span[elname=zc-tick-sel-Img]").css("visibility","hidden");if(H){$(J).css("font-weight","normal")}else{ZCUtil.getParent(J,"tr")[0].style.display="none"}})})};this.markOrderBy=function(H,F,G,E){var I=ZCUtil.getFromMap(H,E+"By");$.each(I.split(";"),function(K,N){var L=N.substring(0,N.indexOf(":"));var J=N.substr(N.indexOf(":")+1);if(L==G){var O=$(F).find("div[elName=zc-"+E+"SubMenu]");var M=$(O).find("td[isAsc="+J+"]");$(M).css("font-weight","bold");$(M).find("span[elname=zc-tick-sel-Img]").css("visibility","visible");$(O).find("td[elName=zc-remove"+E+"ingel]").parent().show()}})};this.changeViewType=function(G,E){var H=this.viewArr[E];var F=ZCView.showSheetViewConfirmPopup(H,function(){ZCView.toggleViewMenu(E,"show","disable");ZCView.changeViewType(G,E)});if(F){return false}ZCUtil.setInMap(H,"viewType",G.attr("viewtype"));ZCUtil.setInMap(H,"month",this.month);ZCUtil.setInMap(H,"year",this.year);ZCView.showView(H)};this.hideSubFormViewsCol=function(E){$("tr[reclinkid="+E+"]").next("tr[elname=subformviews]").remove();var F=$("a[elname=subformviewlink_"+E+"]");$(F).attr("onClick","ZCView.showSubFormViews(this)")};this.showSubFormViews=function(I){var F=$(I).attr("viewname");var H=$(I).attr("svcid");var G=$(I).attr("recLinkID");var J=$(I).attr("formID");var E="t_"+J;var K="viewLinkName="+F+"&subviewCompID="+H+"&compType="+ZCConstants.VIEW+"&recLinkID="+G+"&refTableName="+E;ZCUtil.sendRequest("/showSubFormViews.do",K,"html","ZCView.handleSubFormViews","",i18n.loadingmsg)};this.handleSubFormViews=function(H,I,J){var F=ZCUtil.getFromMap(I,"recLinkID");$.each($("tr[elname=subformviews]"),function(L,M){var K=$(M).attr("viewsforrec");ZCView.hideSubFormViewsCol(K);$(M).remove()});var G=$("td[elname=subformviewdiv]").clone();var E=$('<tr elname="subformviews" viewsforrec="'+F+'"/>');$(G).html(H);$(E).append(G);$("tr[reclinkid="+F+"]").after(E);$("a[elname=subformviewlink_"+F+"]").attr("onClick","ZCView.hideSubFormViewsCol('"+F+"')")};this.loadSubFormViews=function(F,H,E,I){var G="/liveViewHeader.do";var J="viewLinkName="+F+"&";if(I!=null){ZCUtil.removeFromMap(I,"viewLinkName");J+=ZCUtil.getParamsFromMap(I)}J+="&refTableName="+E+"&recLinkID="+H+"&isSubFormView=true";ZCUtil.sendRequest(G,J,"html","ZCView.handleSubFormViewsResp",ZCUtil.getParamsAsMap("compLinkName="+F+"&compName=View&compType="+ZCConstants.VIEW),i18n.pleasewait)};this.showLinkedView=function(G,H){var I=$(G).attr("linkedViewLinkName");var M=$(G).attr("linkedRecordID");var N=$(G).attr("linkSubViewCompID");var O=$(G).attr("linkedViewAppLinkName");var L=$(G).attr("parentAppLinkName");var J=$(G).attr("isSubFormLink");var K=ZCUtil.getParamsAsMap("appLinkName="+O+"&viewLinkName="+I+"&ZC_REC_ID="+M+"&linkSubViewCompId="+N+"&linkedViewAppLinkName="+L+"&linkedViewLinkName="+H+"&isSubFormLink="+J);if(!$("#zc-component").find("div[elName=zc-component-"+I+"]")[0]){$("#zc-component").append($('<div comElName="zc-component" elName="zc-component-'+I+'"><div id="zc-viewcontainer_'+I+'" viewURL="'+ZCView.getViewCont(H).attr("viewURL")+'"></div>'))}var E=this.viewArr[H];var F=ZCUtil.getFromMap(E,"privateLink");if(!ZCUtil.isNull(F)){ZCUtil.setInMap(K,"privateLink",F)}ZCUtil.sendRequest("/showViewRecord.do",ZCUtil.getParamsFromMap(K),"html","ZCView.showLinkedViewRecord",ZCUtil.getParamsAsMap("viewLinkName="+H),i18n.loadingdot);return false};this.showLinkedViewRecord=function(F,G,H){if(ZCUtil.getFromMap(G,"viewType")==ZCConstants.VIEW_CALENDAR){ZCView.currRecSumry=F}ZCUtil.showInDialog(F,"position=relative, closeButton=no, closeOnBodyClick=yes, modal=yes, closeParent=false");var E=ZCUtil.getFromMap(G,"viewLinkName");ZCView.bindClickEve(E)};this.bindClickEve=function(E){var F=$("#"+_DIALOG_LAYER_VAR);$(F).click(function(I){var H=$(I.target);var G=$(H).parent().attr("elName");if(G!=undefined&&G=="zc-linkViewDataEl"&&I.target.tagName!=undefined&&I.target.tagName=="IMG"){H=$(H).parent()}var J=$(H).attr("elName");if(J=="zc-linkViewDataEl"){result=ZCView.showLinkedView(H,E);return result}if(J=="zc-custaction-el"){ZCView.doCustAction(H,E)}})};this.handleSubFormViewsResp=function(G,H,I){var E=ZCUtil.getFromMap(H,"viewLinkName");var F=$("#zc-subform-viewcontainer_"+E);$(F).html(G)};this.hideViewMenus=function(F,E){if($("#zc-menu").css("display")=="block"){$("#zc-menu").css("display","none")}ZCView.getElementOrValue("viewheaderoptionsdiv",E).hide();ZCView.getElementOrValue("viewOptionsDIV",E).hide();ZCView.getElementOrValue("viewactionsdiv",E).hide();ZCView.getElementOrValue("viewaddcoldiv",E).hide();ZCView.getElementOrValue("viewsavediv",E).hide();ZCView.getElementOrValue("customactionitems",E).hide();ZCView.getElementOrValue("recordPerPageCont",E).hide();ZCView.getElementOrValue("ShowHideColCont",E).hide();ZCView.getElementOrValue("moreRecActionFloat",E).hide();ZCView.getElementOrValue("PrintOptions",E).hide();ZCView.getElementOrValue("filterselectdd",E).hide();ZCView.getElementOrValue("viewactionsoptions",E).hide();ZCView.getElementOrValue("recordperpageEl",E).removeClass("zc-viewheader-menus-moreicon");ZCView.getElementOrValue("customactionmore",E).removeClass("zc-viewheader-menus-moreicon");ZCView.getElementOrValue("viewactionmore",E).removeClass("zc-viewheader-menus-moreicon");ZCView.getElementOrValue("moreactionsel",E).removeClass("zc-viewheader-menus-moreicon");ZCView.getElementOrValue("showPrintDialog",E).removeClass("zc-viewheader-menus-moreicon");ZCView.viewFloatMenuEvent("","",E);$(ZCView.cache[E+"_rowClicked"]).removeClass("zc-viewrow-hover zc-view-row-selection zc-row-bottomborder-transparent");ZCView.getElementOrValue("moreRecActionFloat",E).hide();if(ZCUtil.getFromMap(ZCApp.compNameVsTypeMap,ZCApp.currZCComp)==ZCConstants.HTML_PAGE){ZCView.getElementOrValue("formOptionsDIV",E).hide()}};this.showViewDialog=function(G,V){var R=$(G).attr("dialogHTMLKey");var H=this.viewArr[V];var U=ZCView.getViewCont(V);var O=$(G).attr("dialogElName");if(ZCApp.htmlArr[V+"-"+R]==null||O=="zc-saveasview-dialog"){var J=$(U).find("div[elName="+O+"]");if(J.html()!=null){ZCApp.htmlArr[V+"-"+R]=$(J).html();$(J).remove()}}ZCUtil.showInDialog(ZCApp.htmlArr[V+"-"+R],"closeButton=no, modal=yes");if(O=="zc-perma-dialog"){var I=$("div[elName=zc-perma-dialog-div]");ZCApp.toggleLoginPrompt(U,I,V);ZCApp.setPermaLink(U,I,V)}else{if(O=="zc-embed-dialog"){var X=$("div[elName='zc-embed-dialog-div']");ZCApp.toggleLoginPrompt(U,X,V);ZCApp.setEmbedLink(U,X)}else{if(O=="zc-ical-dialog"){var K=$("div[elName=zc-ical-dialog-div]");ZCApp.toggleLoginPrompt(U,K,V);ZCApp.setIcalUrl(U,K,V);if($(U).find("div[elName=zc-linkinfo-div]").attr("isIcalFeedFeatureAllowed")=="true"&&$(U).find("div[elName=zc-linkinfo-div]").attr("isIcalEnable")=="true"){K.find("div[elName=zc-enable-ical]").attr("style","width:100%");K.find("div[elName=zc-icalinfocontiner-div]").show();K.find(":input[type=checkbox]").prop("checked","checked")}else{K.find("div[elName=zc-enable-ical]").attr("style","width:400px");K.find("div[elName=zc-icalinfocontiner-div]").hide();K.find(":input[type=checkbox]").removeAttr("checked")}}else{if(O=="zc-export-dialog"){var F=$("div[elName=zc-export-dialog-div]");if(!ZCUtil.isNull($(U).find("div[elName=zc-linkinfo-div]").attr("critStr"))){$(F).find("table[elName=zc-export-crit-table]").show()}if($("input[elName=zc-recSelectionEl]").is(":checked")){$(F).find("table[elName=zc-export-crit-table]").show();$(F).find("span[elName=zc-filtered-records-span]").hide();$(F).find("span[elName=zc-selected-records-span]").show();$(F).find("input[elName=zc-selected-records-radio]").prop("checked","checked")}ZCApp.toggleLoginPrompt(U,F,V);ZCApp.setExportLinks(U,F,V);$(F).find("div[elName=zc-feed-url]").hide();$(F).find("div[elName=zc-exportinfocontiner-div]").hide();$(F).find("div[comElName=zc-export-type-button-div]").attr("class","download_type_div_container");$(F).find("textarea[comElName=zc-export-ta]").hide()}else{if(O=="zc-createview-dialog"){var E=$("div[elName=zc-createview-dialog-div]").find("[name=formId]");$.each(ZCApp.InZCformsIDs,function(a,c){var b=ZCUtil.getFromMap(ZCApp.formCompIDVsDispName,c);$(E).append("<option value='"+c+"'>"+b+"</option>")});var H=ZCView.viewArr[V];var Q=ZCUtil.getFromMap(H,"viewFormID");$(E).val(Q)}else{if(O=="zc-rename-dialog"){var P=$(G).parents("[elname=zc-viewheaderoptionsdiv]").attr("delugeName");var N=$(U).find("[elname=zc-viewrowheader][delugeName='"+P+"']").find("[elname=zc-viewheaderarrow]").attr("colDispName");$("div[elName=zc-rename-dialog-div]").find("[name=delugeName]").attr("value",P);$("div[elName=zc-rename-dialog-div]").find("[name=colName]").attr("value",N)}else{if(O=="zc-saveasview-dialog"){var H=ZCView.viewArr[V];var W=ZCUtil.getFromMap(H,"filterVal");var L=0;if(W!=""){var Y=W.split(";");for(var S=0;S<Y.length;S++){var T=(Y[S]).split(":");if(T[0]!="CustomFilter"){L++}}}for(var Z in H){if(Z.lastIndexOf("_op")!=-1){L++}}var M=$("div[elName=zc-saveasview-dialog-div]");$(M).parents("#_DIALOG_CONTENT").css("width","");ZCView.toggleSaveChanges(G,true)}}}}}}}};this.showSaveDialog=function(F,E){ZCUtil.showInDialog($("[elname=zc-saveasview-dialog]").html(),"closeButton=no, modal=yes");ZCView.toggleSaveChanges(F,E)};this.toggleSaveChanges=function(J,G){var E=$("div[elName=zc-saveasview-dialog-div]");$(E).parents("#_DIALOG_CONTENT").css("width","");var I=$(J).attr("zc-SaveType");var F=$("#_DIALOG_CONTENT").find("div[elName=zc-saveasview-dialog-div]");$(F).css("width","");if(I=="newview"&&G&&$(F).find("[elname=zc-changesforview]").html()==null&&(ZCApp.loginUser==ZCApp.sharedBy||ZCApp.loginUser==ZCApp.appOwner)){I="filter"}$(F).find("[name=saveType]").val(I);$(F).find("[zc-SaveType=sameview]").removeClass("tab_sel_new");$(F).find("[zc-SaveType=newview]").removeClass("tab_sel_new");$(F).find("[zc-SaveType=filter]").removeClass("tab_sel_new");var H="tab_sel";if(isViewBeta){H="tab_sel_new"}$(F).find("[zc-SaveType="+I+"]").addClass(H);$(F).find("[elname=zc-specifyviewnameTr]").hide();$(F).find("[elname=zc-specifycusfilternameTr]").hide();$(F).find("[elname=zc-savehelpcurview]").hide();$(F).find("[elname=zc-savehelpnewview]").hide();$(F).find("[elname=zc-savehelpcusfilter]").hide();if(I=="sameview"){$(F).find("[elname=zc-changesforview]").show();$(F).find("[elname=zc-changesforcustomfilter]").show();$(F).find("[elname=zc-newviewnameDiv]").hide();$(F).find("[elname=zc-savehelpcurview]").show()}else{if(I=="newview"){$(F).find("[elname=zc-changesforview]").show();$(F).find("[elname=zc-changesforcustomfilter]").show();$(F).find("[elname=zc-newviewnameDiv]").show();$(F).find("[elname=zc-specifyviewnameTr]").show();$(F).find("[elname=zc-savehelpnewview]").show()}else{if(I=="filter"){$(F).find("[elname=zc-changesforview]").hide();$(F).find("[elname=zc-changesforcustomfilter]").show();$(F).find("[elname=zc-newviewnameDiv]").show();$(F).find("[elname=zc-specifycusfilternameTr]").show();$(F).find("[elname=zc-savehelpcusfilter]").show()}}}};this.enableIcalForThisView=function(F,I,E){if($(I).is(":checked")){var H="enable"}else{var H="disable"}var J="viewID="+F+"&viewLinkName="+E+"&sharedBy="+ZCApp.sharedByDisp+"&action="+H+"&zccpn="+ZCApp.csrfParamValue;var G=i18n.loadingmsg;ZCUtil.sendRequest("/enableIcalFeed.do",J,"json","ZCView.loadEnableIcalDialogue",ZCUtil.getParamsAsMap("viewLinkName="+E),G)};this.loadEnableIcalDialogue=function(G,J,K){var E=ZCUtil.getFromMap(K,"viewLinkName");var I=ZCView.getViewCont(E);var H=$("div[elName=zc-ical-dialog-div]");var F=ZCUtil.parseJSONResponse(G);if(F.status=="failure"){ZCView.showAlertPopUp("FAILURE: Error occurred while processing ICal request. \nKindly refresh the page and try again later")}else{if(F.responseAction=="enable"){$(I).find("div[elName=zc-linkinfo-div]").attr("isIcalEnable","true");H.find("div[elName=zc-icalinfocontiner-div]").show();H.find("div[elName=zc-enable-ical]").attr("style","width:100%")}else{if(F.responseAction=="disable"){$(I).find("div[elName=zc-linkinfo-div]").attr("isIcalEnable","false");H.find("div[elName=zc-icalinfocontiner-div]").hide();H.find("div[elName=zc-enable-ical]").attr("style","width:400px")}}}};this.enableExportForThisView=function(F,I,E){if($(I).is(":checked")){var H="enable"}else{var H="disable"}var J="viewID="+F+"&viewLinkName="+E+"&sharedBy="+ZCApp.sharedByDisp+"&action="+H;var G=i18n.loadingmsg;ZCUtil.sendRequest("/enableViewExport.do",J,"json","ZCView.loadEnableExportDialogue",ZCUtil.getParamsAsMap("viewLinkName="+E),G)};this.loadEnableExportDialogue=function(H,J,K){var F=ZCUtil.getFromMap(K,"viewLinkName");var I=ZCView.getViewCont(F);var E=$("div[elName=zc-export-dialog-div]");var G=ZCUtil.parseJSONResponse(H);if(G.status=="failure"){ZCView.showAlertPopUp("FAILURE: Error occurred while processing export request. \nKindly refresh the page and try again later")}else{if(G.responseAction=="enable"){$(I).find("div[elName=zc-linkinfo-div]").attr("isExportEnable","true");E.find("div[elName=zc-feed-url]").show();E.find("div[elName=zc-exportinfocontiner-div]").show()}else{if(G.responseAction=="disable"){$(I).find("div[elName=zc-linkinfo-div]").attr("isExportEnable","false");E.find("div[elName=zc-feed-url]").hide();E.find("div[elName=zc-exportinfocontiner-div]").hide()}}}};var A=false;this.saveView=function(G,E){var H=this.viewArr[E];var L=ZCUtil.getParamsFromMap(H);A=ZCUtil.getFromMap(H,"isAdmin");var I=$(G).parents("div[elName=zc-saveasview-dialog-div]");var K=$(I).find("[name=saveType]").val();var F=ZCUtil.getFromMap(H,"viewDispName");if(K=="newview"||K=="filter"){F=$(I).find("input[name=viewName]").val();if(F==""){var J=i18n["zc.viewedit.emptyreportname"];if(K!="newview"){J=i18n["zc.viewedit.emptyfiltername"]}ZCView.showAlertPopUp(J);return }if(F.length>50){var J=i18n["zc.viewedit.reportnameexceedchar"];if(K!="newview"){J=i18n["zc.viewedit.filternameexceedchar"]}ZCView.showAlertPopUp(J);return }L=L+"&isNewView=true&newViewName="+encodeURIComponent(F)+"&saveType="+K}ZCUtil.sendRequest("/saveNewView.do",L,"json","ZCView.handleSaveViewResponse","",i18n.saving+" "+F)};this.handleSaveViewResponse=function(G,I,K){var F=ZCUtil.parseJSONResponse(G);if(F.status=="failure"){ZCView.showAlertPopUp(F.statusMsg);return }else{closeDialog();var J=F.statusMsg.replace(/</g,"&lt").replace(/>/g,"&gt");if(!ZCUtil.getFromMap(I,"isNewView")){ZCView.showView(ZCUtil.getParamsAsMap("viewLinkName="+F.viewLinkName),J)}else{if(ZCApp.loginUser==ZCApp.sharedBy||ZCApp.loginUser==ZCApp.appOwner){var H=F.viewLinkName;if(A=="true"){ZCApp.showFadingMsg(J,0,2000);ZCApp.currZCComp=H;ZCUtil.setInMap(ZCApp.compNameVsTypeMap,ZCApp.currZCComp,ZCConstants.VIEW);var E=parseInt(ZCApp.compLinkNames.length);ZCApp.compLinkNames[E]=H;window.location.href="/"+ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/#View:"+H;setTimeout(function(){location.reload()},300)}else{ZCView.showSavedView(H,ZCUtil.getFromMap(I,"viewLinkName"))}}else{ZCApp.showFadingMsg(J,0,2000);ZCView.showConfirmPopUp("Do you want to navigate to this new view?",function(){ZCView.showSavedView(F.viewLinkName,ZCApp.currZCComp)})}}}};this.showSavedView=function(E,F){var G=ZCUtil.getParamsAsMap("viewLinkName="+E+"&sharedBy="+ZCApp.sharedByDisp);if(!$("#zc-component").find("div[elName=zc-component-"+E+"]")[0]){$("#zc-component").append($('<div comElName="zc-component" elName="zc-component-'+E+'"><div id="zc-viewcontainer_'+E+'" viewURL="'+ZCView.getViewCont(E).attr("viewURL")+'"></div>'))}ZCView.showView(G)};this.showParentView=function(F,E){var I=this.viewArr[F];var H=ZCUtil.getFromMap(I,"privateLink");var G=ZCUtil.getParamsAsMap("viewLinkName="+F);if(!ZCUtil.isNull(H)){ZCUtil.setInMap(G,"privateLink",H)}ZCUtil.setInMap(G,"viewURL",ZCView.getViewCont(E).attr("viewURL"));ZCUtil.setInMap(G,"urlParams","{}");ZCView.showView(G)};this.toggleSaveAs=function(H,E){var I=ZCUtil.getParent(H,"[elName=zc-view-save-dialog-div]");var F=$(I).find("[elName=zc-view-save-name-div]");var G=$(F).find("input[elName=zc-view-save-name-ip]");F.slideToggle("fast",function(){G.select()})};this.setCritStr=function(H,G,F){var E=$("div[elName=zc-export-dialog-div]");$(E).attr("includecrit",G);ZCApp.setExportLinks(ZCView.getViewCont(F),E,F)};this.toggleDownloadExportTab=function(G,F){var E=$("div[elName=zc-export-dialog-div]");$(E).find("td[comElName=zc-export-action-td]").attr("class","zc-dialog-viewtypes-normal-tab");$(G).attr("class","zc-dialog-viewtypes-selected-tab");if(F=="feed"){$(E).find("span[elName=download-txt]").hide();$(E).find("span[elName=feed-txt]").show();$(E).find("table[elName=zc-download-buttons-table]").hide();$(E).find("div[elName=zc-feed-url]").show();$(E).find("table[elName=export-type-tabs-table]").find("td").removeClass("selected").addClass("normal");$(E).find("table[elName=export-type-tabs-table]").find("td:last-child").removeClass("normal");$(E).find("table[elName=export-type-tabs-table]").find("td[exportype=xls]").removeClass("normal").addClass("selected");$(E).find("div[elName=zc-exportinfocontiner-div]").show();$(E).find("div[elName=zc-export-ta-msg]").show();$(E).find("textarea[comElName=zc-export-ta][exportype=xls]").show()}else{$(E).find("span[elName=feed-txt]").hide();$(E).find("span[elName=download-txt]").show();$(E).find("table[elName=zc-download-buttons-table]").show();$(E).find("textarea[comElName=zc-export-ta]").hide();$(E).find("div[elName=zc-export-ta-msg]").hide();$(E).find("div[elName=zc-feed-url]").hide();$(E).find("div[elName=zc-exportinfocontiner-div]").hide();$(E).find("div[comElName=zc-export-type-button-div]").attr("class","download_type_div_container")}};this.downloadExportMouseOver=function(E){var F=$(E).attr("comElName");F=ZCUtil.isNull(F)?"":F;if(F=="zc-export-type-button-div"){$(E).attr("class","download_type_div_container_hover");$(E).siblings("div[comElName=zc-export-type-label-div]").addClass("bold_text")}else{if(F=="zc-export-type-label-div"){$(E).siblings("div[comElName=zc-export-type-button-div]").attr("class","download_type_div_container_hover");$(E).addClass("bold_text")}else{return }}};this.downloadExportMouseOut=function(E){var F=$(E).attr("comElName");F=ZCUtil.isNull(F)?"":F;if(F=="zc-export-type-button-div"){$(E).attr("class","download_type_div_container");$(E).siblings("div[comElName=zc-export-type-label-div]").removeClass("bold_text")}else{if(F=="zc-export-type-label-div"){$(E).siblings("div[comElName=zc-export-type-button-div]").attr("class","download_type_div_container");$(E).removeClass("bold_text")}else{return }}};this.downloadExportType=function(I,F,H){var G=$(I).attr("actionType");G=ZCUtil.isNull(G)?"download":G;var E=$("div[elName=zc-export-dialog-div]");if(G=="download"){var J=H=="rss"?false:true;ZCView.exportData(H,F,1,0,J)}else{$(I).siblings("td").removeClass("selected").addClass("normal");$(I).siblings("td:last-child").removeClass("normal");$(I).removeClass("normal").addClass("selected");$(E).find("textarea[comElName=zc-export-ta]").hide();$(E).find("textarea[comElName=zc-export-ta][exportype="+H+"]").show();$(E).find("div[elName=zc-export-ta-msg]").hide()}};this.showExpType=function(G,F){var E=$("div[elName=zc-export-dialog-div]");$(E).find("td[comElName=zc-export-left-td]").attr("class","zc-dialog-viewtypes-normal");$(E).find("table[comElName=zc-export-table]").hide();$(G).attr("class","zc-dialog-viewtypes-selected");$(E).find("table[elName=zc-export-"+F+"-table]").show()};this.hideColumn=function(E,F){var G=this.viewArr[E];ZCUtil.setInMap(G,"showColumns",ZCUtil.replaceInParam(ZCUtil.getFromMap(G,"showColumns"),F,"",true));var H=ZCUtil.getFromMap(G,"hideColumns")+F+";";ZCUtil.setInMap(G,"hideColumns",H);ZCView.showView(G)};this.lockColumn=function(E,H,F){var I=$("#zc-viewcontainer_"+E);var G=$(I).find(F+"[name="+H+"]");$.each($(G),function(J,K){$(K).prop("disabled",true)})};this.duplicateView=function(F,G,K,L,O,I,H,M,S,E,P){var Q=ZCView.getViewCont(G);var N=$("div[elName=zc-dupview-dialog-div]");var R=$(N).find("[name=viewName]").val();if(R==""){ZCView.showAlertPopUp(i18n["zc.viewedit.nameforview"]);return }if(R.length>50){ZCView.showAlertPopUp(i18n["zc.viewedit.shortnameforview"]);return }var J=ZCApp.csrfParamName+"="+ZCApp.csrfParamValue;J=J+"&newViewName="+encodeURIComponent(R)+"&appID="+K+"&sharedBy="+ZCApp.sharedBy+"&isShowLive="+P+"&linkName="+L+"&pageID="+O+"&formID="+I+"&baseViewID="+H+"&baseViewType="+M+"&viewLinkID="+S+"&isAppPublic="+false;ZCUtil.sendRequest("/duplView.do",J,"html","ZCView.afterDuplicating",i18n.loadingdot)};this.afterDuplicating=function(E){if(E.substring(0,1)!="/"){ZCView.showAlertPopUp(E);return }else{if(E.indexOf("#View:")!=-1){var F=E.substring(E.indexOf("#View:")+6);ZCApp.useRSH=false;ZCUtil.changeHref(F,"View");window.location.href=E;location.reload()}else{window.location.href=E}}};this.createNewView=function(E,F,G,J){var K=ZCView.getViewCont(F);var I=$("div[elName=zc-createview-dialog-div]");var N=$(I).find("[name=formId]").val();var M=$(I).find("[name=viewName]").val();if(M==""){ZCView.showAlertPopUp(i18n["zc.viewedit.nameforview"]);return }if(M.length>50){ZCView.showAlertPopUp(i18n["zc.viewedit.shortnameforview"]);return }if(N==-1){ZCView.showAlertPopUp(i18n["zc.viewedit.formforview"]);return }var H=document.createElement("form");var L=document.createElement("input");L.name=ZCApp.csrfParamName;L.value=ZCApp.csrfParamValue;L.type="hidden";document.body.appendChild(H);H.appendChild(L);H.method="POST";H.action="/showNewView.do?viewName="+encodeURIComponent(M)+"&formId="+N+"&appId="+ZCApp.appID+"&allowadd="+false+"&allowedit=false&allowdelete=false&allowbulkedit=false&allowduplicate=false&viewType=list&selectedPageId="+ZCUtil.getFromMap(ZCApp.formCompIDVsPageID,N)+"&calFCID=-1&sharedBy="+ZCApp.sharedByDisp+"&isShowLive="+J;H.submit()};this.delView=function(I,F,H,E,G){ZCView.showConfirmPopUp(i18n["zc.viewedit.confirmdelete1msg"],function(){var K="/deleteview.do";var J=new Array();var L=ZCApp.csrfParamName+"="+ZCApp.csrfParamValue+"&viewid="+I+"&pageid="+F+"&sharedBy="+ZCApp.sharedBy+"&appid-modtime="+ZCApp.appID;if(H!=undefined){K="/deleteSavedView.do";L=L+"&isSavedView="+H+"&viewLinkName="+E;J.viewLinkName=G}ZCUtil.sendRequest(K,L,"html","ZCView.afterDelView",J,i18n.pleasewait)})};this.afterDelView=function(G,H,F){if(G=="success"){var E=ZCUtil.changeHref(ZCApp.compLinkNames[0],"View");if(F!=undefined&&F.viewLinkName!=null){E=ZCUtil.changeHref(F.viewLinkName,"View")}window.location.href=E;location.reload()}else{ZCView.showAlertPopUp(G);return false}};this.showHideColumns=function(G,F){var I=this.viewArr[F];var E;if(isViewBeta){E=ZCView.getViewCont(F).find("div[elName=zcShowHideColCont]")}else{var K=ZCUtil.getParent(G,"div[elName=zc-view-hidden-cols-dialog-div]");E=$(K).find("table[elName=zc-view-hidden-cols-table]")}var H="";var J="";$.each($(E).find(":input[type=checkbox]"),function(L,N){ZCUtil.removeFromMap(I,"hideColumns");ZCUtil.removeFromMap(I,"showColumns");var M=$(N).val();if($(N).is(":checked")){H=H+M+";"}else{J=J+M+";"}});ZCUtil.setInMap(I,"showColumns",H);ZCUtil.setInMap(I,"hideColumns",J);ZCView.showView(I);closeDialog()};this.printView=function(F,K,H){var J=$(H).attr("dialogHTMLKey");var I=ZCView.getViewCont(F);var E=$(H).attr("dialogElName");if(ZCApp.htmlArr[F+"-"+J]==null){var G=$(I).find("div[elName="+E+"]");if(G.html()!=null){ZCApp.htmlArr[F+"-"+J]=$(G).html();$(G).remove()}}ZCUtil.showInDialog(ZCApp.htmlArr[F+"-"+J],"closeButton=no, modal=yes");if($("input[elName=zc-recSelectionEl]").is(":checked")){$("input[elname=zc-selected-records]").prop("checked","checked");$("label[elname=zc-selected-records-label]").removeClass("zc-print-radiolabeldisable");$("label[elname=zc-selected-records-label]").addClass("zc-print-radiolabel");$("input[elname=zc-selected-records]").attr("disabled",false)}};this.showprintView=function(G,E){var H=$("input[name=records]:checked").val();var I=$("input[name=onerecordperpage]").is(":checked");var F=$("input[name=zcsmmary]").is(":checked");ZCView.openPrintView(H,I,F,G,E)};this.openPrintView=function(P,H,T,I,J,U){var K="html";if(U==undefined||U){K="print"}var G="";var F=this.viewArr[J];var N=ZCUtil.getFromMap(F,"privateLink");N=ZCUtil.isNull(N)?"":"privateLink="+N;var O=ZCView.getViewCont(J).find("div[elName=zc-linkinfo-div]");var E=$(O).attr("critStr");var M=$(O).attr("zc_Criteria");var R=ZCView.getViewCont(J);var S="";$.each($(R).find("input[elName=zc-recSelectionEl]"),function(V,W){if($(W).is(":checked")){S=S+ZCView.checkAndGetAttribute(W,"recLinkID")+","}});E=ZCUtil.isNull(E)?"":E+"&";if(H||T){E=E+"&zc_OneRecordPerPage=true"}if(!T){E=E+"&viewType=1"}if(P=="zcselectedrecords"&&S!=""&&S!=null){E=E+"&zc_SelectedRecId="+S}if(M!==null&&M!==""&&M!=="undefined"){var Q="&zc_Criteria="+encodeURIComponent(M);E=E+Q}var L=$(O).attr("scheme")+"://"+$(O).attr("exportServerPrefix")+"/"+ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/"+K+"/"+J+"?"+N+"&"+E+G;window.open(L,"_blank")};this.printViewAs=function(L,H,E,K,G){var F=false;if(L=="list"){F=false}else{if(L=="summary"){F=true}}var J=ZCView.getViewCont(E);var I=$(J).find("[elname=zc-recSelectionEl]:checked");if(K==undefined){K="zcallrecords";if(I.length>0){K="zcselectedrecords"}}ZCView.openPrintView(K,false,F,H,E,G)};this.pdfView=function(E,K){var I=ZCView.getViewCont(E).find("div[elName=zc-linkinfo-div]");var F=$(I).attr("privateLink");F=ZCUtil.isNull(F)?"":F+"/";var G=$(I).attr("critStr");G=ZCUtil.isNull(G)?"":G+"/";var J=(K.indexOf("privatelink=")!=-1)||(K.indexOf("privateLink=")!=-1)||(K.indexOf("viewPrivateLink=")!=-1)||(K.indexOf("viewprivatelink=")!=-1);var H;if(ZCUtil.isNull(F)||J){H=$(I).attr("scheme")+"://"+$(I).attr("exportServerPrefix")+"/"+ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/pdf/"+E+"?"+K}else{H=$(I).attr("scheme")+"://"+$(I).attr("exportServerPrefix")+"/"+ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/pdf/"+E+"/"+F+"?"+K}window.open(H,"_blank")};this.htmlprint_pdfView=function(E,K,G,H,I){var F;privStr=ZCUtil.isNull(H)?"":H;K=K.replace(/zc_doublequot/g,'"').replace(/zc_quot/g,"'");K=ZCUtil.isNull(K)?"":K;var J=(K.indexOf("privatelink=")!=-1)||(K.indexOf("privateLink=")!=-1)||(K.indexOf("viewPrivateLink=")!=-1)||(K.indexOf("viewprivatelink=")!=-1);if(G=="print"){if(ZCUtil.isNull(privStr)||J){F="http://"+I+"/"+ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/print/"+E+"?"+K}else{F="http://"+I+"/"+ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/print/"+E+"/"+privStr+"?"+K}}else{if(G=="pdf"){if(ZCUtil.isNull(privStr)||J){F="http://"+I+"/"+ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/pdf/"+E+"?"+K}else{F="http://"+I+"/"+ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/pdf/"+E+"/"+privStr+"?"+K}}}window.open(F,"_blank")};this.showRecordCount=function(F,E){var G=this.viewArr[E];ZCUtil.sendRequest("/getRecordCount.do",ZCUtil.getParamsFromMap(G),"json","ZCView.handleRecCountResp",i18n.fetchCount)};this.handleRecCountResp=function(E,G){var H=ZCUtil.getFromMap(G,"viewLinkName");var L=ZCView.getViewContainers(H);var I=$(L).find("[elName=zc-countHold]");var K=$(I).find("[elName=zc-getRecordCountEl]");var M=$(I).find("[elName=zc-countTargetEl]");var F=ZCUtil.parseJSONResponse(E);var N=F.totalRec;var J=F.errorMsg;if(ZCUtil.isNull(J)){ZCApp.compProps["ZCRECORDCNT_"+H]=N;$(K).hide();$(M).html(N);$(M).show();$(I).find("[elName=zc-countTargetHolderEl]").show()}else{ZCView.showAlertPopUp(i18n.errormsg)}};this.showSearch=function(F,H){if(!this.searchOpened){var E=ZCUtil.getFromMap(ZCView.viewArr[F],"viewType");if(ZCApp.isMobileSite&&E==ZCConstants.VIEW_FLAT){$("#sum_search").show();docid("mobile-title-hdr").style.display="none";$("#mobile-view-header").attr("style","z-index:90;");$("#mobileSearchVal").focus();ZCApp.scrollToPageTop()}else{var G=ZCView.getElementOrValue("viewsearchrow",F);$(G).show();var J=$(G).filter("tr[elName=zc-viewsearchrow2_"+F+"]");var I=$(J).find("input");$(I).each(function(K,M){var L=ZCUtil.getFieldValue(this);if(!ZCUtil.isNull(L)){$(M).attr("value","")}});if(H){$(J).find("input[delugeName='"+H+"']").focus()}}setTimeout(function(){ZCView.handleScreenResize()},0);this.searchOpened=true;ZCView.handleSearchOption(F)}else{ZCView.hideSearch(F)}};this.hideSearch=function(F){var E=ZCUtil.getFromMap(ZCView.viewArr[F],"viewType");if(ZCApp.isMobileSite){$("#sum_search").hide();docid("mobile-title-hdr").style.display="";if(mobileDeviceList!=undefined){if(isNativeAppPromo){$("#mobile-view-header").attr("style","min-height:118px")}else{$("#mobile-view-header").attr("style","min-height:42px")}}}var G=ZCView.getElementOrValue("viewsearchrow",F);$(G).hide();this.handleScreenResize();this.searchOpened=false};this.cancelSearch=function(G,E){var H=this.viewArr[E];var F=ZCUtil.getFromMap(H,"openSearch");if(F=="true"){if(ZCUtil.getFromMap(H,"zc_LoadIn")=="html"){location.reload()}else{ZCUtil.setInMap(H,"fromIDX",1);ZCUtil.setInMap(H,"searchCrit",false);ZCUtil.setInMap(H,"openSearch",false);ZCView.showView(H)}}else{ZCView.hideSearch(E)}};this.clearSearch=function(){docid("mobileSearchVal").value="";docid("mobileSearchVal").focus();ZCApp.scrollToPageTop();docid("clearSearch").style.display="none"};this.showAndHideClearSearch=function(){if(docid("mobileSearchVal").value.length>0){docid("clearSearch").style.display=""}else{docid("clearSearch").style.display="none"}};this.handleOper=function(F,H){var E=$(F).attr("elName");var G=E.substr(0,E.length-3);var I=$(F).val();var K=$(F).attr("fieldtype");var N=ZCView.getViewContainers(H).find("tr[elName=zc-viewsearchrow2_"+H+"]");if(I==ZCConstants.BETWEEN){N.find("div[elName=zc-regularSearch]").find(":input[delugeName='"+G+"']").hide();N.find("div[elName=zc-rangeSearch]").find("table[elName='"+G+"']").show();N.find(":input[delugeName='"+G+"']").prop("disabled",false)}else{var J=((I>=ZCConstants.EMPTY&&I<=ZCConstants.CURRENT_NEXT_WEEK)||I==-1||G=="Record_Status")?true:false;var M=((I>=ZCConstants.LAST_N_DAYS&&I<=ZCConstants.NEXT_N_YEARS))?true:false;N.find("div[elName=zc-regularSearch]").show();N.find("div[elName=zc-regularSearch]").find(":input[delugeName='"+G+"']").show();N.find("div[elName=zc-rangeSearch]").find("table[elName='"+G+"']").hide();var L=N.find(":input[delugeName='"+G+"']");$(L).prop("disabled",J);if(J){$(L).val("")}if(M==true){$(L).val(i18n.valueforn);$(L).select();$(L).attr("onClick","")}else{if(K==ZCConstants.DATE||K==ZCConstants.DATE_TIME){$(L).attr("onClick","ZCView.showCalendar(this)")}}}};this.handleSearchOption=function(E){if(!$("a[elname=zc-showViewSearchEl]").attr("isSaturated")&&$("select[searchcomponenttype=13]").length>0){$.ajax({beforeSend:function(){},url:"/getTableRecordCount.do",type:"POST",data:{sharedBy:ZCApp.sharedByDisp,viewLinkName:E,appLinkName:ZCApp.appLinkName},success:function(G,F,I){var H=G.searchOptions;$("a[elname=zc-showViewSearchEl]").attr("isSaturated",true);$("select[searchcomponenttype=13]").each(function(){var K=this;var L=$(K).val();var J=[];$(K).find("option").each(function(){J.push($(this).val())});$(K).find("option").remove();jQuery.each(H,function(M,P){if(J.indexOf(M)!=-1){var O=M==L?"selected='selected'":"";var N="<option "+O+"value="+M+">"+P+"</option>";$(K).append(N)}})})}})}};this.searchView=function(F,G){var E=this.viewArr[G];var K=ZCView.showSheetViewConfirmPopup(E,function(){ZCView.toggleViewMenu(G,"show","disable");ZCView.searchView(F,G)});if(K){return false}var J=false;var M=ZCView.getViewCont(G);var N=ZCConstants.BETWEEN;var O=$(F).attr("issubform");var H;$.each($(M).find("div[elName=zc-regularSearch] input"),function(X,Y){var Q=$(Y).attr("delugeName");var T=$(Y).attr("fieldtype");var W=$(Y).attr("isLookup");var U=$.trim($(Y).val());var S=$(Y).attr("decimalLength");var V=$(Y).attr("delugetype");U=U.replace(/</g,"&lt;").replace(/>/g,"&gt;");if(V.indexOf("BIGINT")>=0||V.indexOf("DOUBLE")>=0){T=ZCConstants.NUMBER}var R=$(M).find("select[elName='"+Q+"_op']").val();if(!ZCUtil.isNull(U)||(R>=ZCConstants.EMPTY&&R<=ZCConstants.CURRENT_NEXT_WEEK)||(R>=ZCConstants.UNLOCKED&&R<=ZCConstants.SUPERIOR_ONLY)){J=true}if(T==ZCConstants.RECORD_STATUS){U=ZCConstants.getLockValue(R)}if(!ZCUtil.isNull(U)&&R>=ZCConstants.LAST_N_DAYS&&R<=ZCConstants.NEXT_N_YEARS){var P=U.match("^[0-9]+");if(U==""||U==null||U!=P){ZCView.showAlertPopUp(i18n.correctvalueforn);$(Y).select();$(Y).focus();J=false;return false}}if(!ZCUtil.isNull(U)&&(T==ZCConstants.NUMBER||T==ZCConstants.PERCENTAGE||T==ZCConstants.CURRENCY||T==ZCConstants.AUTO_NUMBER)){var P=U.match(new RegExp("^-?[0-9]*\\.*[0-9]*"));if(T==ZCConstants.CURRENCY){P=U.match(new RegExp("^-?[0-9., ]*\\.*[0-9]*"))}else{if(T==ZCConstants.NUMBER&&W){P=U.match(new RegExp("^-?[0-9]*\\.*[0-9]*"))}else{if(T==ZCConstants.NUMBER&&S==0){P=U.match(new RegExp("^-?[0-9, ]*"))}}}U=(P==null||(P.length==1&&P=="-"))?null:U;if(U==""||U==null||U!=P){ZCView.showAlertPopUp(i18n.correctvaluetosearch);$(Y).select();$(Y).focus();J=false;return false}}U=encodeURIComponent(U);ZCView.setOrRemoveFromMap(E,Q,U,R)});$.each($(M).find("div[elName=zc-rangeSearch] table"),function(P,Q){var S=null;var T=$(Q).attr("elName");var R=$(M).find("select[elName='"+T+"_op']").val();if(R==ZCConstants.BETWEEN){$(Q).find("input").each(function(){var U=encodeURIComponent($.trim($(this).val()));if(ZCUtil.isNull(S)){if(!ZCUtil.isNull(U)){S=U}}else{S=S+";"+U}});if(!ZCUtil.isNull(S)){if(S.indexOf(";")==-1){S=S.substring(S.indexOf(";")+1);N=ZCConstants.LESS_EQUAL}else{if(ZCUtil.isNull(S.substring(S.indexOf(";")+1))){S=S.substring(0,S.indexOf(";"));N=ZCConstants.GREATER_EQUAL}}}if(!ZCUtil.isNull(S)){J=true;ZCView.setOrRemoveFromMap(E,T,S,N)}}});if(!J){return false}else{ZCUtil.setInMap(E,"fromIDX",1);ZCUtil.setInMap(E,"searchCrit",true);ZCUtil.setInMap(E,"openSearch",true);if(O=="true"){var L=$(F).attr("reclinkid");var I=$(F).attr("reftable");ZCView.loadSubFormViews(G,L,I,E)}else{ZCView.showView(E)}}};this.selectSearchField=function(E){$("#mobileSearchVal").focus();ZCApp.scrollToPageTop();var F=docid(E.id+"_checkbox");E.checked=!(E.checked);if(E.checked){$(F).removeClass("custom_check_off").addClass("custom_check_on")}else{$(F).removeClass("custom_check_on").addClass("custom_check_off")}};this.summarySearchView=function(F){var I=false;var E=this.viewArr[F];var N=$("#sum_search");var J=$(N).find("#search_fields");var O=$(N).find("input[name=searchValue]");var L=$(O).val();var H=$(N).find("input[name=delugename_op]").val();var G=$(J).find("input[name=search_fields]:checked").length;if(G<=0){ZCView.showAlertPopUp(i18n.selectfieldtosearch);return false}var M=false;var K=i18n.entervaluetosearch;if(!ZCUtil.isNull(L)){I=true;$.each($(J).find("input[name=search_fields]"),function(P,S){var R=false;if($(S).is(":checked")||$(S).is(":checked")=="true"){if($(S).attr("compType")==ZCConstants.CHECK_BOX){if(L.toLowerCase()=="true"){M=true;H=49}else{if(L.toLowerCase()=="false"){M=true;H=50}else{R=true;K=i18n.correctvaluetodecisioncheckbox}}L=""}else{if($(S).attr("compType")==ZCConstants.NUMBER||$(S).attr("compType")==ZCConstants.CURRENCY||$(S).attr("compType")==ZCConstants.PERCENTAGE){H=18;if(!isNaN(L)){M=true}else{R=true;K=i18n.correctvaluetosearch}}else{if($(S).attr("compType")==ZCConstants.EMAIL){var Q=trimString(L);if(B(Q)){M=true}else{R=true;K=i18n.entervalidemail}}else{if($(S).attr("compType")==ZCConstants.DATE||$(S).attr("compType")==ZCConstants.DATE_TIME){if(D(L,$(S).attr("compType"))){M=true}else{R=true;K=i18n.entervaliddateformat+" "+ZCApp.appDateFormat;if($(S).attr("compType")==ZCConstants.DATE_TIME){K=i18n.entervaliddatetimeformat+" "+ZCApp.appDateFormat+" HH:mm:ss"}}}else{M=true}}}}if(!R){ZCView.setOrRemoveFromMap(E,$(S).val(),L,H)}else{ZCUtil.removeFromMap(E,$(S).val());ZCUtil.removeFromMap(E,$(S).val()+"_op")}}else{ZCUtil.removeFromMap(E,$(S).val());ZCUtil.removeFromMap(E,$(S).val()+"_op");ZCUtil.removeFromMap(E,$(S).val()+"_display")}})}if(!M){ZCView.showAlertPopUp(K);$(O).focus();I=false;return false}if(!I){return false}else{ZCUtil.setInMap(E,"fromIDX",1);ZCUtil.setInMap(E,"openSearch",true);ZCView.showView(E);window.scrollTo(0,-83)}};function B(G){var F=/^.+@.+\..{2,15}$/;if(!(F.test(G))){return false}var E=/[\(\)\<\>\,\;\:\\\/\"\[\]]/;if(G.match(E)){return false}return true}function D(H,G){var F=/^.{1,4}(\-|\/|\s|\.|\,).{1,4}(\-|\/|\s|\.|\,)[0-9]{1,4}$/;var E=/^.{1,4}(\-|\/|\s|\.|\,).{1,4}(\-|\/|\s|\.|\,)[0-9]{1,4}\s.{1,2}\:.{1,2}\:.{1,2}$/;if(G==ZCConstants.DATE&&!(F.test(H))){return false}if(G==ZCConstants.DATE_TIME&&!(E.test(H))){return false}return true}this.setOrRemoveFromMap=function(H,G,F,E){if(!ZCUtil.isNull(F)||(E>=ZCConstants.EMPTY&&E<=ZCConstants.CURRENT_NEXT_WEEK)){if(!ZCUtil.isNull(F)){ZCUtil.setInMap(H,G,F)}ZCUtil.setInMap(H,G+"_op",E)}else{ZCUtil.removeFromMap(H,G);ZCUtil.removeFromMap(H,G+"_op")}};this.showCustFuncs=function(E){var F=ZCView.getViewCont(E);ZCUtil.showDropDownMenu(this,$(F).find("div[elName=zc-viewcustfunctionsdiv]")[0])};this.checkAndGetAttribute=function(F,G){var E=$(F).attr(G);if(ZCUtil.isNull(E)){E=ZCUtil.getParent(F,"["+G+"]").attr("recLinkID")}return E};this.showMenu=function(E,F){if($(E).attr("elName")=="zc-customactionmore"){$("#zc-menu").toggle();ZCApp.hideAndStopPropogation(F)}};this.myCustAction=function(F,E){reloadCurrView=false;this.doCustAction(F,E);$("#zc-menu").toggle()};this.doCustAction=function(G,E){var I=this.viewArr[E];var H=ZCView.getViewCont(E);var J="viewLinkName="+E+"&viewid="+ZCUtil.getFromMap(I,"viewID")+"&tablename="+ZCUtil.getFromMap(I,"tableName")+"&formid="+ZCUtil.getFromMap(I,"viewFormID");if(ZCUtil.getFromMap(I,"privateLink")!=null){J+="&privateLink="+ZCUtil.getFromMap(I,"privateLink")}if($(G).attr("elName")=="zc-custaction-el"){$(G).attr("style","pointer-events:none");J=J+"&buttonAction=true&functionid="+$(G).attr("functionID")+"&functiongroup="+ZCView.checkAndGetAttribute(G,"recLinkID")}else{J=J+"&functionid="+$(G).attr("functionID");var F=0;$.each($(H).find("input[elName=zc-recSelectionEl]"),function(K,N){if($(N).is(":checked")){var L=$(G).attr("customActionRecIdList");var M=ZCView.checkAndGetAttribute(N,"recLinkID");if(L.indexOf(M)!==-1){F++;J=J+"&functiongroup="+ZCView.checkAndGetAttribute(N,"recLinkID")}}});$.each($(".htCore tbody th"),function(L,K){if($(K).attr("reclinkid")){var M=$(G).attr("customActionRecIdList");var N=ZCView.checkAndGetAttribute(K,"reclinkid");if(M.indexOf(N)!==-1){F++;J=J+"&functiongroup="+ZCView.checkAndGetAttribute(K,"recLinkID")}}});if(F==0){ZCView.showAlertPopUp(i18n.custact);$(G).val(-1);return false}}if($(G).attr("showHTMLOnly")){J=J+"&showHTMLOnly=true"}if($(G).attr("isFileBased")==="true"){return ZCUtil.sendRequest("/livefunctionnew.do",J,"json","ZCView.handleCustActionResp",ZCUtil.getParamsAsMap("viewLinkName="+E),i18n.loadingdot)}else{return ZCUtil.sendRequest("/livefunction.do",J,"json","ZCView.handleCustActionResp",ZCUtil.getParamsAsMap("viewLinkName="+E),i18n.loadingdot)}};this.setActionRespInDiv=function(I,J,F,H,E){if(!ZCUtil.isNull(F)){var G=$(I).find("span[elName=zc-spanmsg-failure]");$(G).html(E);$(ZCUtil.getParent(G,"tr")).show();ZCView.showDelAction(I,F,"failure")}if(!ZCUtil.isNull(J)){var K=$(I).find("span[elName=zc-spanmsg-success]");$(K).html(H);$(ZCUtil.getParent(K,"tr")).show();ZCView.showDelAction(I,J,"success")}};this.handleCustActionResp=function(X,J,O){var W=null;var I="";var U=ZCUtil.getFromMap(J,"viewLinkName");var S=ZCView.getViewCont(U);var G=ZCView.viewArr[U];var E=ZCForm.getMsgFromResponse(X,"");var R=E.successMsgDuration;var M=E.successList;var V=E.errorList;var L=E.execType;var N=E.showHtmlOnly;var Q=(M)?i18n.custactsuccmsg+" "+M.length+" record(s)":"";var F=(V)?i18n.custactfailmsg+" "+V.length+" record(s)":"";var T=$(S).find("div[elName=zc-delactionsdiv]").clone(true);if(T.length===0){T=$("div[elName=zc-delactionsdiv]").clone(true)}if(E.successmsg){I=E.successmsg}if(ZCUtil.getFromMap(J,"buttonAction")=="true"||L=="1"){evaluateJs(E.generatedjs)}if(!ZCUtil.isNull(V)||!ZCUtil.isNull(M)){ZCView.setActionRespInDiv(T,M,V,Q,F);if($(T).attr("showDialog")){I="";$(T).find("a[elName=zc-showdetails-a]").hide();$(T).find("span[elName=zc-spanmsg-failure]").hide();$(T).find("span[elName=zc-spanmsg-success]").hide();$(T).find("div[comElName=zc-errdetailsdiv]").show();W=$(T).html()}}if(reloadCurrView){if(N==="true"){if(!ZCUtil.isNull(I)&&I!="zc_success"){if(!ZCUtil.isNull(R)){R=R*1000;ZCApp.showFadingMsg(I,0,R)}else{ZCApp.showFadingMsg(I,0,2000)}}ZCView.showInfo(W,"");location.reload()}else{ZCView.showView(G,I,W,R)}}else{if(E.errorList!==""&&E.errorList!==undefined){if(W!=null){ZCView.showInfo(W,E.errormsg)}else{var H=((E.errorList)[0]);var P="";for(var K in H){P+=(H[K][0]).msg}ZCView.showInfo(P,E.errormsg)}}else{if(E.successmsg!=""&&E.successmsg!==undefined){ZCApp.showFadingMsg(E.successmsg,0,1000)}}$("#viewBackButton").trigger("click")}reloadCurrView=true};this.refreshRecordSummaryView=function(E){var H=ZCView.viewArr[E];var F=ZCUtil.getFromMap(H,"totalRecount");var G=ZCUtil.getFromMap(H,"fromIDX");if(F==G||ZCView.recSummaryIdxRefresh=="decrease"){ZCUtil.setInMap(H,"fromIDX",G-1);ZCView.loadNextTemplate(E)}else{if(G==1||ZCView.recSummaryIdxRefresh=="increase"){ZCUtil.setInMap(H,"fromIDX",G+1);ZCView.loadPreviousTemplate(E)}else{ZCUtil.sendRequest("/newShowViewRecord.do",ZCUtil.getParamsFromMap(H),"html","ZCView.handleTemplateLoading",ZCUtil.getParamsAsMap("viewLinkName="+E),i18n.loadingdot)}}};this.callShowView=function(F,I,J){if(J=="duplicate"){ZCUtil.evalJS(F.substr(F.indexOf("-->")+3));F=""}var E=ZCUtil.getFromMap(I,"viewLinkName");var H=ZCView.viewArr[E];if(relodCurrentForm!="falseRS"){ZCView.showView(H,ZCApp.showDuplSuccMsg,F)}else{var G=ZCApp.showDuplSuccMsg;if(!ZCUtil.isNull(G)&&G!="zc_success"){ZCApp.showFadingMsg(G,0,2000);ZCUtil.setInMap(H,"fromIDX",ZCUtil.getFromMap(H,"fromIDX")+1);ZCUtil.setInMap(H,"totalRecount",ZCUtil.getFromMap(H,"totalRecount")+1);ZCView.refreshRecordSummaryView(E)}ZCView.showInfo(F,"");relodCurrentForm="true"}};this.clearAllFilters=function(E){var F=this.viewArr[E];ZCUtil.removeFromMap(F,"filterVal");ZCUtil.setInMap(F,"fromIDX",1);ZCView.showView(F)};this.clearFilterOptions=function(K,G){var E=this.viewArr[G];var J=decodeURIComponent(ZCUtil.getFromMap(E,"filterVal"));var F=J.split(";");var H="";for(var I=0;I<F.length;I++){if(F[I]!=""){var L=(F[I]).split(":");var M=L[0];if(M!=K){H=H+F[I]+";"}}}ZCUtil.setInMap(E,"filterVal",encodeURIComponent(H));ZCUtil.setInMap(E,"fromIDX",1);ZCView.showView(E)};this.filterView=function(X,W,G){var H=this.viewArr[W];var a=[];var K=X.indexOf(":");a[0]=X.substring(0,K);a[1]=X.substring(K+1);a[1]=a[1].replace(/:/g,ZCView.FILTER_COLON_CONSTANT);a[1]=a[1].replace(/;/g,ZCView.FILTER_SEMICOLON_CONSTANT);a[1]=a[1].replace(/"/g,ZCView.FILTER_QUOTS_CONSTANT);a[1]=a[1].replace(/\//g,ZCView.FILTER_SLASH_CONSTANT);X=a[0]+":"+a[1];if(isViewBeta&&(a[1]=="loadview"||a[0]=="CustomFilter")){if(X=="loadview"){ZCView.showParentView(W,$(G).attr("childLinkName"))}else{var Q=ZCUtil.getParamsAsMap("viewLinkName="+W);ZCUtil.setInMap(Q,"viewURL",ZCView.getViewCont(W).attr("viewURL"));ZCUtil.setInMap(Q,"urlParams","{}");ZCUtil.setInMap(Q,"filterVal",X);ZCUtil.setInMap(Q,"showResetBar",false);ZCUtil.setInMap(Q,"zc_Export",ZCUtil.getFromMap(H,"zc_Export"));ZCUtil.setInMap(Q,"zc_AddRec",ZCUtil.getFromMap(H,"zc_AddRec"));ZCUtil.setInMap(Q,"zc_EditRec",ZCUtil.getFromMap(H,"zc_EditRec"));ZCUtil.setInMap(Q,"zc_DuplRec",ZCUtil.getFromMap(H,"zc_DuplRec"));ZCUtil.setInMap(Q,"zc_DelRec",ZCUtil.getFromMap(H,"zc_DelRec"));ZCUtil.setInMap(Q,"zc_EditBulkRec",ZCUtil.getFromMap(H,"zc_EditBulkRec"));var F=ZCUtil.getFromMap(H,"privateLink");if(!ZCUtil.isNull(F)){ZCUtil.setInMap(Q,"privateLink",F)}var O=ZCUtil.getFromMap(H,"zc_LoadIn");if(O!=null){ZCUtil.setInMap(Q,"zc_LoadIn",O)}ZCView.showView(Q)}}else{if(X.indexOf(":")!=-1&&X.indexOf("-")!=-1){var J=$.trim(X.substring(X.indexOf(":")+1,X.indexOf("-")));var S=ZCView.getMonthNo(J);var V=/^([0-9]{4})$/;var M=V.test($.trim(X.substring(X.indexOf("-")+1)));if(S!=-1&&M){this.month=S;this.year=parseInt($.trim(X.substring(X.indexOf("-")+1)));ZCUtil.setInMap(H,"month",this.month);ZCUtil.setInMap(H,"year",this.year)}}var N=decodeURIComponent(ZCUtil.getFromMap(H,"filterVal"));N=N.replace("All","");var P=false;var I=N.split(";");var Y="";var E=false;for(var T=0;T<I.length;T++){if(I[T]!=""){if(isViewBeta){var P=false;var L=(I[T]).split(":");var U=L[0];var Z="";var R=(L[1]).split(ZCView.FILTER_COMMA_CONSTANT);for(var K=0;K<R.length;K++){if(U==a[0]&&a[1]==R[K]){P=true;E=true}else{Z=(Z=="")?R[K]:Z+ZCView.FILTER_COMMA_CONSTANT+R[K]}}if(!P&&a[0]==U){E=true;Z=(Z=="")?a[1]:Z+ZCView.FILTER_COMMA_CONSTANT+a[1]}if(Z!=""){Y=Y+U+":"+Z+";"}}else{var L=(I[T]).split(":");var U=L[0];if((I[T]==X)||(U==a[0]&&X=="CustomFilter:All")){E=true}else{if(U==a[0]){Y=Y+X+";";E=true}else{Y=Y+I[T]+";"}}}}}if(!E){Y=Y+a[0]+":"+a[1]+";"}ZCUtil.setInMap(H,"filterVal",encodeURIComponent(Y));ZCUtil.setInMap(H,"fromIDX",1);ZCView.showView(H)}};this.getMonthNo=function(E){if(E=="Jan"){return 0}else{if(E=="Feb"){return 1}else{if(E=="Mar"){return 2}else{if(E=="Apr"){return 3}else{if(E=="May"){return 4}else{if(E=="Jun"){return 5}else{if(E=="Jul"){return 6}else{if(E=="Aug"){return 7}else{if(E=="Sep"){return 8}else{if(E=="Oct"){return 9}else{if(E=="Nov"){return 10}else{if(E=="Dec"){return 11}else{return -1}}}}}}}}}}}}};this.sortView=function(H,F,E){var K=H+":"+F;var G=this.viewArr[E];var I=ZCUtil.getFromMap(G,"sortBy");var J=ZCUtil.getFromMap(G,"groupBy");if(J&&J.indexOf(H+":")!=-1){K=I;ZCUtil.setInMap(G,"groupBy",ZCUtil.replaceInParam(J,H,F))}else{if(I&&I.indexOf(H+":")!=-1){K=ZCUtil.replaceInParam(I,H,F)}else{if(I){I=(I.substr(I.length-1)!=";")?I+";":I;K=I+K}}}if(K!=""){ZCUtil.setInMap(G,"sortBy",K)}ZCUtil.setInMap(G,"fromIDX",1);ZCView.showView(G)};this.setColumnWidth=function(E){var I=this.viewArr[E];var H=$("div[elName=zc-setwidth-dialog-div]");var G=$(H).find("[name=delugeName]").val();var F=G+":"+$(H).find("[name=colName]").val()+";";ZCUtil.setInMap(I,"setwidthColumns",F);ZCView.showView(I)};this.enableDiableSum=function(H,F,E){var G=H+":"+F;var J=this.viewArr[E];var I=ZCUtil.getFromMap(J,"summationColumns");if(I&&I.indexOf(H)!=-1){G=ZCUtil.replaceInParam(I,H,F)}else{if(I){I=(I.substr(I.length-1)!=";")?I+";":I;G=I+G}}if(G!=""){ZCUtil.setInMap(J,"summationColumns",G)}ZCView.showView(J)};this.linkView=function(H,F,E){var G=H+":"+F;var J=this.viewArr[E];var I=ZCUtil.getFromMap(J,"linkviewColumns");if(I&&I.indexOf(H)!=-1){G=ZCUtil.replaceInParam(I,H,F)}else{if(I){I=(I.substr(I.length-1)!=";")?I+";":I;G=I+G}}if(G!=""){ZCUtil.setInMap(J,"linkviewColumns",G)}ZCView.showView(J)};this.renameColumn=function(F){var J=this.viewArr[F];var I=$("#_DIALOG_CONTENT").find("div[elName=zc-rename-dialog-div]");var H=$(I).find("[name=delugeName]").val();var K=$(I).find("[name=colName]").val();var E=H+":"+K+";";var G=ZCUtil.getFromMap(J,"renameColumns");if(G&&G.indexOf(H)!=-1){E=ZCUtil.replaceInParam(G,H,K)}else{if(G){G=(G.charAt(G.length-1)==";")?G:G+";";E=G+E}}ZCUtil.setInMap(J,"renameColumns",E);closeDialog();ZCView.showView(J)};this.groupView=function(K,F,E){var G=K+":"+F;var H=this.viewArr[E];var I=ZCUtil.getFromMap(H,"sortBy");var J=ZCUtil.getFromMap(H,"groupBy");if(I&&I.indexOf(K+":")!=-1){ZCUtil.setInMap(H,"sortBy",ZCUtil.replaceInParam(I,K,F,true));if(J!=""){G=J+";"+G}}else{if(J&&J.indexOf(K+":")!=-1){G=ZCUtil.replaceInParam(J,K,F)}else{if(J){J=(J.charAt(J.length-1)==";")?J:J+";";G=J+G}}}if(G!=""){ZCUtil.setInMap(H,"groupBy",G);ZCUtil.setInMap(H,"showColumns",ZCUtil.replaceInParam(ZCUtil.getFromMap(H,"showColumns"),K,"",true))}ZCUtil.setInMap(H,"fromIDX",1);ZCView.showView(H)};this.viewActionsOptions=function(G,E){var F=ZCView.getViewCont(E);ZCUtil.showDropDownMenu($(F).find("[elname="+G+"]")[0],$(F).find("[elname="+G+"-options]")[0])};this.removeOrderBy=function(H,F,E){var G=this.viewArr[E];G.isRemoveChange=true;ZCUtil.setInMap(G,H,ZCUtil.replaceInParam(ZCUtil.getFromMap(G,H),F,"",true));ZCView.showView(G)};this.paginateView=function(I,F){var K=this.viewArr[F];var H=ZCView.showSheetViewConfirmPopup(K,function(){ZCView.toggleViewMenu(F,"show","disable");ZCView.paginateView(I,F)});if(H){return false}if(ZCApp.isMobileSite){ZCUtil.setInMap(K,"searchCrit",true);ZCUtil.setInMap(K,"isOrComparator",true);ZCUtil.setInMap(K,"openSearch",false);this.searchOpened=false}ZCUtil.setInMap(K,"showPage",$(I).attr("showPage"));var J=ZCView.getViewCont(F);var L=$(J).find("[elname=zc-countTargetEl]");if($(L).length!=0&&$(L).html().trim()!=""){ZCUtil.setInMap(K,"viewRecordCount",$(L).html())}if($(I).attr("issubform")=="true"){var G=$(I).attr("reclinkid");var E=$(I).attr("reftable");ZCView.loadSubFormViews(F,G,E,K)}else{if(K.isSolarSearch){this.setSolarSearchTerm(F)}ZCView.showView(K)}};this.changeCalBasedOn=function(F,E){var G=this.viewArr[E];ZCUtil.setInMap(G,"zc_calBasedOn",F);ZCView.showView(G)};this.showSheetViewConfirmPopup=function(H,G){var F=false;if(parseInt(ZCUtil.getFromMap(H,"viewType"))===ZCConstants.VIEW_NEWSHEET){var E=$("span[elname=zc-saveViewRecsEl]").attr("status");if(E==="enable"){ZCView.showConfirmPopUp(i18n.spreadsheetcnfm1,G);F=true}}return F};this.limitViewRecords=function(F,G,K){var E=this.viewArr[G];var J=ZCView.showSheetViewConfirmPopup(E,function(){ZCView.toggleViewMenu(G,"show","disable");ZCView.limitViewRecords(F,G,K)});if(J){return false}if(K==undefined){K=$(F).val()}ZCUtil.setInMap(E,"pageSize",K);ZCUtil.setInMap(E,"fromIDX",1);var L=ZCView.getViewCont(G);var I=$(L).find("[elname=zc-countTargetEl]");if($(I).length!=0&&$(I).html().trim()!=""){ZCUtil.setInMap(E,"viewRecordCount",$(I).html())}if($(F).attr("issubform")=="true"){var M=$(F).attr("reclinkid");var H=$(F).attr("reftable");ZCView.loadSubFormViews(G,M,H,E)}else{ZCView.showView(E)}};this.getDataIndices=function(F){var E=[];$(F).find("th").each(function(G,H){if(!ZCUtil.isNull($(H).attr("delugename"))){E[E.length]=G}else{if(!ZCUtil.isNull($(H).attr("comptype"))){E[E.length]=G}}});return E};this.showRecord=function(G,E){var J=ZCView.getViewCont(E);var I=$(J).find("tr[elName=zc-colheaderrow]");var F=ZCView.getDataIndices(I);var H=0;if($(J).find("div[elName=zc-recsummarydiv]")[0]){var L=$(J).find("div[elName=zc-recsummarydiv]");$.each(ZCUtil.getParent(G,"tr").find("td"),function(M,N){if(ZCUtil.contains(F,M)){if($(this).attr("elName")=="viewdatatd"){if($(N).find("a").attr("elName")=="zc-custaction-el"){$(N).find("a").attr("onclick","ZCView.doCustAction(this,'"+E+"');return false")}$(L).find("td[elName=zc-viewdata]:eq("+H+")").html($(N).html());$(L).find("td[elName=zc-viewdata]:eq("+H+")").find("a[viewname="+E+"]").attr("onClick","");H++}}});ZCView.showRecordInDialog($(L).html(),E)}else{var K=this.viewArr[E];ZCUtil.setInMap(K,"recLinkID",ZCView.checkAndGetAttribute(G,"recLinkID"));ZCUtil.sendRequest("/showViewRecord.do",ZCUtil.getParamsFromMap(K),"html","ZCView.showViewRecord",ZCUtil.getParamsAsMap("viewLinkName="+E),i18n.loadingdot)}return false};this.showRecordInTemplate=function(G,E){var I=this.viewArr[E];ZCUtil.setInMap(I,"recLinkID",ZCView.checkAndGetAttribute(G,"recLinkID"));var F=ZCView.checkAndGetAttribute($(G).parent(),"fromindex");var H=ZCView.checkAndGetAttribute($(G).parent(),"recordindex");H=parseInt(H);if(F>1){var J=((F-1))+H;ZCUtil.setInMap(I,"fromIDX",J)}else{ZCUtil.setInMap(I,"fromIDX",H)}ZCUtil.sendRequest("/newShowViewRecord.do",ZCUtil.getParamsFromMap(I),"html","ZCView.handleTemplateLoading",ZCUtil.getParamsAsMap("viewLinkName="+E),i18n.loadingdot);ZCUtil.removeFromMap(I,"recLinkID");return false};this.handleTemplateLoading=function(F,E,G){ZCView.loadTemplate(F,E,G);ZCView.getRecordCount(E,function(J){var I=ZCUtil.getFromMap(J,"fromIDX");var H=ZCUtil.getFromMap(J,"totalRecount");if(I==1){ZCView.disableNavigationLink(true)}if(I==H){ZCView.disableNavigationLink(false)}});RecordComment.addComment();RecordComment.formId=ZCUtil.getFromMap(E,"viewFormID");RecordComment.viewLinkName=ZCUtil.getFromMap(E,"viewLinkName");RecordComment.privateLink=ZCUtil.getFromMap(E,"privateLink")};this.NaviagteRecordTemplate=function(E,G){var F=this.viewArr[E];ZCUtil.setInMap(F,"viewType",3);ZCUtil.setInMap(F,"pageSize",1);ZCView.navHandleFn=G;ZCUtil.sendRequest("/newShowViewRecord.do",ZCUtil.getParamsFromMap(F),"html","ZCView.handleNavTemplate",ZCUtil.getParamsAsMap("viewLinkName="+E),i18n.loadingdot);return false};this.handleNavTemplate=function(G,H,I){ZCView.loadTemplate(G,H,I);var E=ZCUtil.getFromMap(H,"viewLinkName");var F=this.viewArr[E];ZCView.navHandleFn(F);ZCView.navHandleFn="";RecordComment.addComment();RecordComment.formId=ZCUtil.getFromMap(F,"viewFormID");RecordComment.viewLinkName=ZCUtil.getFromMap(F,"viewLinkName");RecordComment.privateLink=ZCUtil.getFromMap(F,"privateLink")};this.loadPreviousTemplate=function(E){var G=this.viewArr[E];var F=ZCUtil.getFromMap(G,"fromIDX");if(F==1){return false}ZCUtil.setInMap(G,"fromIDX",F);ZCUtil.setInMap(G,"showPage","previous");this.NaviagteRecordTemplate(E,function(J){var I=ZCUtil.getFromMap(J,"fromIDX");var H=ZCUtil.getFromMap(J,"totalRecount");if(I==H){ZCView.enableLink(false)}I=parseInt(I)-1;ZCView.recSummaryIdxRefresh="increase";if(I==1){ZCView.disableNavigationLink(true)}ZCUtil.setInMap(J,"fromIDX",I)})};this.reloadCurrentTemplate=function(E){var H=this.viewArr[E];var G=ZCUtil.getFromMap(H,"fromIDX");var F=ZCUtil.getFromMap(H,"totalRecount");ZCUtil.setInMap(H,"fromIDX",G);if(G==F){return false}ZCUtil.setInMap(H,"fromIDX",G);this.NaviagteRecordTemplate(E,function(K){var J=ZCUtil.getFromMap(K,"fromIDX");var I=ZCUtil.getFromMap(K,"totalRecount");J=parseInt(J);ZCUtil.setInMap(K,"fromIDX",J)})};this.loadNextTemplate=function(E){var H=this.viewArr[E];var G=ZCUtil.getFromMap(H,"fromIDX");var F=ZCUtil.getFromMap(H,"totalRecount");if(G==F){return false}ZCUtil.setInMap(H,"fromIDX",G);ZCUtil.setInMap(H,"showPage","next");this.NaviagteRecordTemplate(E,function(K){var J=ZCUtil.getFromMap(K,"fromIDX");var I=ZCUtil.getFromMap(K,"totalRecount");if(J==1){ZCView.enableLink(true)}J=parseInt(J)+1;ZCView.recSummaryIdxRefresh="decrease";ZCUtil.setInMap(K,"fromIDX",J);if(J==I){ZCView.disableNavigationLink(false)}})};this.getRecordCount=function(F,E){ZCView.navigateHandle=E;ZCUtil.sendRequest("/getRecordCount.do",ZCUtil.getParamsFromMap(F),"json","ZCView.handleGetRecordCount",i18n.fetchCount)};this.handleGetRecordCount=function(G,J){var E=ZCUtil.getFromMap(J,"viewLinkName");var F=ZCUtil.parseJSONResponse(G);var H=F.totalRec;var I=this.viewArr[E];ZCUtil.setInMap(I,"totalRecount",H);ZCView.navigateHandle(I);ZCView.navigateHandle=""};this.disableNavigationLink=function(E){if(E){$("#preRecord").css("opacity","0.3")}else{$("#nextRecord").css("opacity","0.3")}};this.enableLink=function(E){if(E){$("#preRecord").css("opacity","1")}else{$("#nextRecord").css("opacity","1")}};this.loadTemplate=function(F,G,H){ZCApp.clearZCComponent();var E="<div elname='zc-component-template'  comelname='zc-component'>"+F+"</div>";if($(".zc-perma-pane-right").length){$(".zc-perma-pane-right").append(E)}else{$("#zc-component").append(E)}if(ZCUtil.getFromMap(G,"zc_calSummary")){$("#preRecord").hide();$("#nextRecord").hide()}};this.restoreRecSumry=function(){if(ZCView.currRecSumry){ZCUtil.showInDialog(ZCView.currRecSumry,"closeButton=no, closeOnBodyClick=yes, modal=yes")}};this.showRecordInDialog=function(F,E,H){if(!isViewBeta){ZCUtil.showInDialog(F,"position=relative, closeButton=no, closeOnBodyClick=yes, modal=yes, dialog_closeOutside=true");ZCView.bindClickEve(E);return false}var G="";if(H!=undefined&&H==false){G="closelink=no"}setTimeout(function(){var J=$("#_DIALOG_CONTENT").find("table[elname=zc-summary-data-table]").css("height");var I=$("#_DIALOG_CONTENT").find("table[elname=zc-summary-data-table]").css("width");if(H==undefined){I=parseInt(I.replace(/^\D+/g,""))+25;J=parseInt(J.replace(/^\D+/g,""))+25}$("#_DIALOG_CONTENT").find("div[elname=zc-dialog-container]").css("height",J);$("#_DIALOG_CONTENT").find("div[elname=zc-dialog-container]").css("width",I)},500);ZCUtil.showInDialog(F,"position=absolute, "+G+",closeOnBodyClick=yes, modal=yes, dialog_closeOutside=true");ZCApp.correctDialog();ZCView.bindClickEve(E)};this.showViewRecord=function(G,H,I){if(ZCUtil.getFromMap(H,"viewType")==ZCConstants.VIEW_CALENDAR){ZCView.currRecSumry=G;ZCUtil.removeFromMap(ZCView.viewArr[ZCUtil.getFromMap(I,"viewLinkName")],"zc_calSummary")}var F=ZCUtil.getFromMap(H,"viewLinkName");var E=ZCUtil.getFromMap(H,"zc_calSummary");ZCView.showRecordInDialog(G,F,(E!="true"));ZCUtil.removeFromMap(ZCView.viewArr[ZCUtil.getFromMap(I,"viewLinkName")],"recLinkID")};this.fromRecSumdeleteRecord=function(F,E){relodCurrentForm="falseRS";ZCView.deleteRecord(F,E)};this.showDecryptedValues=function(E){var G=$(event.target).parent();var H=$(G).attr("reclinkid");var F=$(G).attr("colname");$.ajax({beforeSend:function(){},url:"/getDecryptedFieldValue.do",type:"POST",data:"recLinkId="+H+"&viewLinkName="+E+"&appLinkName="+ZCApp.appLinkName+"&columnName="+F+"&"+ZCApp.csrfParamName+"="+ZCApp.csrfParamValue,success:function(K,J,M){var N=(K.value!=undefined?K.value:"");var I=$(G).parent();var L=$(G).parent().html();$(G).parent().html(N);setTimeout(function(){$(I).html(L)},10000);$(window).trigger("resize")}})};this.deleteRecord=function(G,E,I){var K=this.viewArr[E];if(ZCUtil.isNull(I)){I=ZCApp.appLinkName}var F="viewLinkName="+E+"&sharedBy="+ZCApp.sharedByDisp+"&appLinkName="+I+"&formID="+ZCUtil.getFromMap(K,"viewFormID")+"&privateLink="+ZCUtil.getFromMap(K,"privateLink");var H=ZCUtil.getFromMap(K,"linkedView");if(!ZCUtil.isNull(H)){F=F+"&linkedView="+H}var J="/deleterecordaction.do";if(ZCUtil.getFromMap(K,"viewType")==ZCConstants.VIEW_FLAT){F=F+"&deletegroup="+ZCView.checkAndGetAttribute(G,"recLinkID")}return ZCView.delDuplRecords(E,J,F,"delete",$(G).attr("recLinkID"))};this.summaryAction=function(E,F){};this.fromRecSumduplicateRecord=function(F,E){var G=this.viewArr[E];ZCUtil.setInMap(G,"viewType",1);relodCurrentForm="falseRS";ZCView.duplicateRecord(F,E)};this.duplicateRecord=function(G,E,I){if(ZCUtil.isNull(I)){I=ZCApp.appLinkName}var J=this.viewArr[E];var K="viewid="+ZCUtil.getFromMap(J,"viewID")+"&tableName="+ZCUtil.getFromMap(J,"tableName")+"&sharedBy="+ZCApp.sharedByDisp+"&formid="+ZCUtil.getFromMap(J,"viewFormID")+"&viewstatus=false&viewLinkName="+E+"&appLinkName="+I+"&privateLink="+ZCUtil.getFromMap(J,"privateLink");var H=ZCUtil.getFromMap(J,"linkedView");if(!ZCUtil.isNull(H)){K=K+"&linkedView="+H}var F="/duplicaterecordaction.do";return ZCView.delDuplRecords(E,F,K,"duplicate",$(G).attr("recLinkID"))};this.showSingleFieldValue=function(G,H){var F=$(G).parent();var M=$(G).attr("formCompId");var P=ZCView.checkAndGetAttribute(F,"recLinkID");var Q=docid("optiontd_"+M);if(Q!=null&&typeof Q!=undefined){$("div[elName=zc_viewRecOptionEl]").hide();$(Q).show();var N=$(G).offset();var J=N.left-100;var O=N.top+15;$(Q).css("left",J);$(Q).css("top",O);return }var R=$(G).attr("formId");var I=$(G).attr("columnName");var L=$(G).attr("labelName");var E=this.viewArr[H];var K="labelName="+L+"&formCompId="+M+"&recLinkId="+P+"&columnName="+I+"&formId="+R+"&compType="+ZCConstants.FORM+"&formLinkName="+ZCUtil.getFromMap(E,"viewFormName")+"&formAccessType="+ZCConstants.VIEW_EDIT_FORM+"&operation=read&viewLinkName="+H+"&viewID="+ZCUtil.getFromMap(E,"viewID");if(!ZCUtil.isNull(ZCUtil.getFromMap(E,"privateLink"))){K=K+"&viewPrivateLink="+ZCUtil.getFromMap(E,"privateLink")}ZCUtil.sendRequest("/getFieldOptions.do",K,"html","ZCView.showFileldOption",ZCUtil.getParamsAsMap("recLinkId="+P+"&formCompId="+M),i18n.loadingmsg)};this.showFileldOption=function(J,F,L){var M=ZCUtil.getFromMap(L,"recLinkId");var H=ZCUtil.getFromMap(L,"formCompId");var N=$("#editabletd_"+M+"_"+H);$("div[elName=zc_viewRecOptionEl]").hide();$(N).parent().append(J);var E=$("#optiontd_"+H);var I=$(N).offset();var G=I.left-100;var K=I.top+15;$(E).css("left",G);$(E).css("top",K)};this.hideOptionsPopup=function(E){$(E).closest(".subPopupOut").hide()};this.updateFieldOption=function(O){var F=$(O).find("label").attr("value");var G=$(O).closest(".subPopupOut").hide();$(G).hide();var L=$(G).attr("recLinkID");var K=$(G).attr("formCompId");var N=$("#editabletd_"+L+"_"+K).html(F);$(N).show();var H=$(G).attr("viewLinkName");var J=$(G).attr("labelName");var M=$(G).attr("formId");var E=this.viewArr[H];var I=J+"="+F+"&recLinkId="+L+"&labelname="+J+"&formCompId="+K+"&formId="+M+"&compType="+ZCConstants.FORM+"&formLinkName="+ZCUtil.getFromMap(E,"viewFormName")+"&formAccessType="+ZCConstants.VIEW_EDIT_FORM+"&operation=write&viewLinkName="+H+"&viewID="+ZCUtil.getFromMap(E,"viewID");if(!ZCUtil.isNull(ZCUtil.getFromMap(E,"privateLink"))){I=I+"&viewPrivateLink="+ZCUtil.getFromMap(E,"privateLink")}ZCUtil.sendRequest("/UpdateSingleFieldInRecord.do",I,"json","ZCView.handleUpdateSingleField",ZCUtil.getParamsAsMap("formId="+M+"&viewLinkName="+H),i18n.loadingmsg)};this.handleUpdateSingleField=function(K,F,L){var G=ZCUtil.getFromMap(L,"viewLinkName");var N=ZCUtil.getFromMap(L,"formId");var E=ZCView.viewArr[G];var I=ZCForm.getMsgFromResponse(K,N);var H=I.succMsg;var J=I.errMsg;var M=I.fieldErrObj;if(H==""||H==undefined){}else{ZCView.showView(E,H)}};this.bulkEditRecord=function(G,E){var J=this.viewArr[E];var I=ZCView.getViewCont(E);var F=0;var K="";$.each($(I).find("input[elName=zc-recSelectionEl]"),function(L,M){if($(M).is(":checked")){F++;K=K+ZCView.checkAndGetAttribute(M,"recLinkID")+","}});if(F==0){ZCView.showAlertPopUp(i18n.bulkeditinfo);return false}ZCUtil.setInMap(J,"updateIdList",K);this.viewArr[E]=J;var K="compType="+ZCConstants.FORM+"&formLinkName="+ZCUtil.getFromMap(J,"viewFormName")+"&formAccessType="+ZCConstants.VIEW_BULK_EDIT_FORM+"&viewLinkName="+E+"&viewID="+ZCUtil.getFromMap(J,"viewID");if(!ZCUtil.isNull(ZCUtil.getFromMap(J,"privateLink"))){K=K+"&viewPrivateLink="+ZCUtil.getFromMap(J,"privateLink")}var H=ZCUtil.getFromMap(J,"linkedView");if(!ZCUtil.isNull(H)){K=K+"&linkedView="+H}K=K+"&isViewBeta="+isViewBeta;if(isViewBeta){K=K+"&isNewAppearance=true"}ZCUtil.sendRequest("/showBulkEditForm.do",K,"html","ZCApp.loadZCCompInDialog",ZCUtil.getParamsAsMap("include=false"),i18n.loadingform)};this.delDuplRecords=function(G,M,J,K,F){var E=this.viewArr[G];var N=ZCView.getViewCont(G);var Q=0;var H=(K=="delete")?i18n.delete1:i18n.duplicate1;var I=(K=="delete")?i18n.deleteinfomsg:i18n.duplinfomsg;var L=(K=="delete")?i18n.delerrormsg:i18n.duplerrormsg;var P=i18n.deleterecord;if(ZCUtil.getFromMap(E,"viewType")==ZCConstants.VIEW_FLAT){Q=1}else{if(F!=undefined&&F!="undefined"&&F!=""){J=J+"&deletegroup="+F;Q=1;P=replaceParams(i18n.reallywanttorecord,new Array(H))}else{var O="";$.each($(N).find("input[elName=zc-recSelectionEl]"),function(R,S){if($(S).is(":checked")){Q++;O=O+ZCView.checkAndGetAttribute(S,"recLinkID")+","}});$.each($(".htCore tbody th"),function(S,R){if($(R).attr("reclinkid")){Q++;O=O+ZCView.checkAndGetAttribute(R,"reclinkid")+","}});J=J+"&deletegroup="+O;P=replaceParams(i18n.reallywantto,new Array(H,Q))}}if(Q>0){ZCView.showConfirmPopUp(P,function(){ZCView.commitDelDupl(M,K,J)})}else{ZCView.showAlertPopUp(L);return false}};this.commitDelDupl=function(G,F,H){closeDialog();var E=(F=="delete")?"json":"html";var I=(F=="delete")?"ZCView.handleDelRecAction":"ZCView.callShowView";ZCUtil.sendRequest(G,H,E,I,"duplicate",i18n.duplicateinfomsg)};this.handleDelRecAction=function(W,K,M){var V=null;var T=ZCUtil.getFromMap(K,"viewLinkName");var Q=ZCView.getViewCont(T);var G=this.viewArr[T];var E=ZCForm.getMsgFromResponse(W,"");var I=ZCUtil.isNull(E.succMsg)?"":E.succMsg;var P=E.successMsgDuration;var L=E.successList;var U=E.errorList;var N="permissionError";var H=E[N];if(!ZCUtil.isNull(H)){ZCView.showAlertPopUp(H)}var R=$(Q).find("div[elName=zc-delactionsdiv]").clone(true);var O=(L)?L.length+" "+i18n.delsuccmsg:"";var F=(U)?U.length+" "+i18n.delfailmsg:"";if(!ZCUtil.isNull(U)||!ZCUtil.isNull(L)){ZCView.setActionRespInDiv(R,L,U,O,F);if(!ZCUtil.isNull(U)){I=""}if($(R).attr("showDialog")){I="";V=$(R).html()}}if(ZCUtil.getFromMap(G,"viewType")==ZCConstants.VIEW_CALENDAR){var J=ZCView.zc_calendar.fullCalendar("getView");var S=ZCView.calDisplayType(J.name);ZCUtil.setInMap(G,"calViewType",S)}if(relodCurrentForm!="falseRS"){ZCView.showView(G,I,V,P)}else{if(!ZCUtil.isNull(I)&&I!="zc_success"){ZCApp.showFadingMsg(I,0,2000);$("#viewBackButton").trigger("click")}ZCView.showInfo(V,"");relodCurrentForm="true"}return false};this.showDelAction=function(H,G,F){var E=$(H).find("table[elName=zc-rectemplatetable]");$.each(G,function(I,J){$.each(J,function(O,M){var N=ZCForm.getMsgFromResponse(M,"");var R=$(H).find("div[elName=zc-recsdiv-"+F+"]");if(!ZCUtil.isNull(N.recordDetails)){var L=N.recordDetails;L=L.substring(1,L.length-1);var Q=$(E).find("tr[elName=zc-delrecrow]").clone(true);$.each(L.split(","),function(U,S){var T=$(Q).find("td[elName=zc-delreccell]:eq("+U+")");T.text(S)});$(R).find("table[elName=zc-recstable-"+F+"]").append(Q)}var K=!ZCUtil.isNull(N.errors)?N.errors:"";if(!ZCUtil.isNull(N.errMsg)){K+=N.errMsg}if(!ZCUtil.isNull(N.alertMsg)){K+=N.alertMsg}if(!ZCUtil.isNull(N.infoMsg)){K+=ZCForm.getInfoMsgHtml(N.infoMsg,"")}if(!ZCUtil.isNull(K)){$(H).attr("showDialog",true);var P=$(E).find("tr[elName=zc-dellogmsgrow]").clone(true);$(P).find("td").html(K);$(R).find("table[elName=zc-recstable-"+F+"]").append(P)}})})};this.showErrLogs=function(F){if($(F).attr("type")=="Show"){$(F).attr("type","Hide");var E=$(ZCUtil.getParent(F,"td")).find("div[comElName=zc-errdetailsdiv]");E.show("slow");$("#_DIALOG_CONTENT").find("div[elname='zc-dialogheader']").width("auto");$(F).html(i18n.hidedetails)}else{$(F).attr("type","Show");$(ZCUtil.getParent(F,"td")).find("div[comElName=zc-errdetailsdiv]").hide("slow");$("#_DIALOG_CONTENT").find("div[elname='zc-dialogheader']").width("auto");$(F).html(i18n.showdetails)}};this.showAddForm=function(G,H,O,F){if($("#wmstoolbar")!=null&&$("#wmstoolbar").attr("style")!=undefined){$("#wmstoolbar").css("z-index","")}if(this.popupopend==true){return false}var E=this.viewArr[H];var L=ZCView.showSheetViewConfirmPopup(E,function(){ZCView.toggleViewMenu(H,"show","disable");ZCView.showAddForm(G,H,O)});if(L){return false}if(ZCUtil.getFromMap(E,"viewType")==ZCConstants.VIEW_CALENDAR){if(ZCUtil.getFromMap(E,"allowAdd")=="false"){return }else{if(ZCUtil.getFromMap(E,"zc_AddRec")=="false"){return }}}if(ZCUtil.isNull(F)){F=ZCApp.appLinkName}var I="sharedBy="+ZCApp.sharedByDisp+"&appLinkName="+F+"&compType="+ZCConstants.FORM+"&formLinkName="+ZCUtil.getFromMap(E,"viewFormName")+"&formAccessType="+ZCConstants.VIEW_ADD_FORM+"&viewLinkName="+H+"&zc-mobile="+ZCApp.isMobileSite;if(!ZCUtil.isNull(ZCUtil.getFromMap(E,"privateLink"))){I=I+"&viewPrivateLink="+ZCUtil.getFromMap(E,"privateLink")}var J=ZCUtil.getFromMap(E,"linkedView");if(!ZCUtil.isNull(J)){I=I+"&linkedView="+J}if(ZCUtil.getFromMap(E,"viewType")==ZCConstants.VIEW_CALENDAR){var N=ZCUtil.getFromMap(E,"day");var K=ZCUtil.getFromMap(E,"month");var M=ZCUtil.getFromMap(E,"year");if(!ZCUtil.isNull(O)){I=I+"&dateJsonObject="+O}I=I+"&zc_calBasedOn="+ZCUtil.getFromMap(E,"zc_calBasedOn")+"&zc_endDateCompID="+ZCUtil.getFromMap(E,"zc_endDateCompID")}I=I+"&isViewBeta="+isViewBeta;if(isViewBeta){I=I+"&isNewAppearance=true"}ZCUtil.sendRequest(ZCApp.compProps["actionURL-"+ZCConstants.FORM],I,"html","ZCApp.loadZCCompInDialog",ZCUtil.getParamsAsMap("include=false"),i18n.pleasewait);this.popupopend=true};this.fromRecSumShowEditForm=function(G,E,F){relodCurrentForm="falseRS";ZCView.showEditForm(G,E,F)};this.showEditForm=function(I,J,G,H,F,M){if($("#wmstoolbar")!=null&&$("#wmstoolbar").attr("style")!=undefined){$("#wmstoolbar").css("z-index","")}var E=this.viewArr[J];if(F!=""&&F!=undefined){var K=ZCUtil.getFromMap(E,"dateJsonObject");if(ZCUtil.isNull(K)){var M=F;var K='{"startDate":{"day":'+F.getDate()+',"month":'+F.getMonth()+',"year":'+F.getFullYear()+',"hours":'+F.getHours()+',"minutes":'+F.getMinutes()+',"seconds":'+F.getSeconds()+"},";if(M!=null){K=K+'"endDate":{"day":'+M.getDate()+',"month":'+M.getMonth()+',"year":'+M.getFullYear()+',"hours":'+M.getHours()+',"minutes":'+M.getMinutes()+',"seconds":'+M.getSeconds()+"}};"}ZCUtil.setInMap(E,"dateJsonObject",K)}}var N=ZCUtil.getFromMap(E,"viewFormName");if(I!=null){G=ZCView.checkAndGetAttribute(I,"recLinkID")}var L="compType="+ZCConstants.FORM+"&formLinkName="+N+"&formAccessType="+ZCConstants.VIEW_EDIT_FORM+"&zc_EditType=default&viewLinkName="+J+"&recLinkID="+G+"&viewID="+ZCUtil.getFromMap(E,"viewID")+"&zc-mobile="+ZCApp.isMobileSite;if(!ZCUtil.isNull(ZCUtil.getFromMap(E,"privateLink"))){L=L+"&viewPrivateLink="+ZCUtil.getFromMap(E,"privateLink")}var O=ZCUtil.getFromMap(E,"linkedView");if(!ZCUtil.isNull(O)){L=L+"&linkedView="+O}L=L+"&isViewBeta="+isViewBeta;if(isViewBeta){L=L+"&isNewAppearance=true"}if(!ZCUtil.isNull(H)){L=L+"&appLinkName="+H}ZCUtil.sendRequest(ZCApp.compProps["actionURL-"+ZCConstants.FORM],L,"html","ZCApp.loadZCCompInDialog",ZCUtil.getParamsAsMap("include=false&closeDialog=true"),i18n.pleasewait);return false};this.calDelRecord=function(H,E,G){var J=this.viewArr[E];if(H!=null){G=ZCView.checkAndGetAttribute(H,"recLinkID")}var I="/deleterecordaction.do";var F="viewLinkName="+E+"&formID="+ZCUtil.getFromMap(J,"viewFormID")+"&deletegroup="+G+"&privateLink="+ZCUtil.getFromMap(J,"privateLink");ZCView.showConfirmPopUp(i18n.deleterecord,function(){ZCView.commitDelDupl(I,"delete",F)})};this.showTodayDate=function(){var G=this.viewArr[ZCView.calendarViewName];ZCUtil.removeFromMap(G,"year");ZCUtil.removeFromMap(G,"month");var F=ZCView.zc_calendar.fullCalendar("getView");var E=this.calDisplayType(F.name);ZCUtil.setInMap(G,"calViewType",E);ZCView.showView(G)};this.showData=function(F,G,I){var H=$(F).attr("lnkaction");var R=ZCView.zc_calendar.fullCalendar("getView");var K=R.name;var E=this.viewArr[G];var P=ZCView.calDisplayType(K);ZCUtil.setInMap(E,"calViewType",P);if(I){if(K!="month"){var T=ZCView.zc_calendar.fullCalendar("getDate");var L='{"startDate":{"day":'+T.getDate()+',"month":'+T.getMonth()+',"year":'+T.getFullYear()+',"hours":'+T.getHours()+',"minutes":'+T.getMinutes()+',"seconds":'+T.getSeconds()+"}}";ZCUtil.setInMap(E,"dateJsonObject",L)}var J=H=="prev"?"prevYear":"nextYear";var O=ZCUtil.getFromMap(E,J);ZCUtil.setInMap(E,"year",O);ZCView.showView(E);return }if(K=="month"){var S=H=="prev"?"prevMonth":"nextMonth";var N=ZCUtil.getFromMap(E,S);var O=ZCUtil.getFromMap(E,"year");if(H=="prev"&&N==11){O=O-1}else{if(H=="next"&&N==0){O=parseInt(O)+1}}ZCUtil.setInMap(E,"year",O);ZCUtil.setInMap(E,"month",N);ZCView.showView(E)}else{ZCView.zc_calendar.fullCalendar(H);var M=ZCView.zc_calendar.fullCalendar("getDate");if(M.getMonth()!=ZCUtil.getFromMap(E,"month")){var N=M.getMonth();var O=ZCUtil.getFromMap(E,"year");if(H=="prev"&&N==11){O=O-1}else{if(H=="next"&&N==0){O=parseInt(O)+1}}var Q=H=="prev"?true:false;ZCUtil.setInMap(E,"needDate",Q);ZCUtil.setInMap(E,"year",O);ZCUtil.setInMap(E,"month",N);ZCView.showView(E)}}if(K=="agendaDay"){ZCView.calWorkingDayConf(K)}};this.showCalEvent=function(P,O,Q){if(!ZCView.showCalSummary){return false}var G=P.id;var N=P.isEncrypted;var H=ZCView.calendarViewName;var E=ZCView.viewArr[H];var J=P.colName;var M="#encodedVal_"+J+"_"+G;$(M).click(function(R){if(N&&$(R.target).parent().attr("id")=="encodedVal_"+J+"_"+G){return false}});var L=ZCView.calDisplayType(Q.name);ZCUtil.setInMap(E,"calViewType",L);if(L!=1){var F=P.start;var K=F;if(F!="null"&&F!=undefined){var I='{"startDate":{"day":'+F.getDate()+',"month":'+F.getMonth()+',"year":'+F.getFullYear()+',"hours":'+F.getHours()+',"minutes":'+F.getMinutes()+',"seconds":'+F.getSeconds()+"},";if(K!=null){I=I+'"endDate":{"day":'+K.getDate()+',"month":'+K.getMonth()+',"year":'+K.getFullYear()+',"hours":'+K.getHours()+',"minutes":'+K.getMinutes()+',"seconds":'+K.getSeconds()+"}};"}ZCUtil.setInMap(E,"dateJsonObject",I);ZCUtil.setInMap(E,"startDate",F);ZCUtil.setInMap(E,"endDate",K)}}ZCUtil.setInMap(E,"recLinkID",P.id);ZCUtil.setInMap(E,"zc_calSummary",true);ZCUtil.setInMap(E,"zc_calSummaryPrint",ZCView.zc_RecPrintCal);if((ZCView.viewArr[H].isDefaultTemplate)=="true"){ZCUtil.sendRequest("/showViewRecord.do",ZCUtil.getParamsFromMap(E),"html","ZCView.showViewRecord",ZCUtil.getParamsAsMap("viewLinkName="+H),i18n.loadingdot)}else{ZCUtil.sendRequest("/newShowViewRecord.do",ZCUtil.getParamsFromMap(E),"html","ZCView.handleTemplateLoading",ZCUtil.getParamsAsMap("viewLinkName="+H),i18n.loadingdot)}};this.calDisplayType=function(F){var E=1;if(F=="agendaWeek"){E=2}else{if(F=="agendaDay"){E=3}}return E};this.calViewDisplay=function(E){$("#calHeaderSpan").html(E.title);var L="94px";var K=i18n["zc.calendar.previousmonth"];var I=i18n["zc.calendar.nextmonth"];if(E.name=="agendaWeek"){L="186px";K=i18n["zc.calendar.previousweek"];I=i18n["zc.calendar.nextweek"]}else{if(E.name=="agendaDay"){L="171px";K=i18n["zc.calendar.previousday"];I=i18n["zc.calendar.nextday"]}}$("#calHeaderSpan").width(L);var J=$("#calHeaderSpan").prev();J.attr("title",K);var F=$("#calHeaderSpan").next();F.attr("title",I);$("#calHeaderSpan1").html(E.title);$("#calHeaderSpan1").width(L);var G=$("#calHeaderSpan1").prev();G.attr("title",K);var H=$("#calHeaderSpan1").next();H.attr("title",I)};this.calEventMouseOver=function(G,E){var F=$(G).find("div.fc-icondiv")[0];if(E){$(F).show();$(F).css("background-color",$(F).parent().css("background-color"))}else{$(F).hide()}};this.calEventEditOrDel=function(J,H){var G=J.id;var I=J.start;var F=J.end;var E=ZCView.calendarViewName;if(H){ZCView.calDelRecord(null,E,G)}else{ZCView.showEditForm(null,E,G,"",I,F)}};this.renderEventFun=function(L,J,E){if(E.name=="month"||E.name=="agendaWeek"){J.find("span.fc-event-title").html(J.find("span.fc-event-title").text());if(!L.isEncrypted){J.find("span.fc-event-title").attr("title",L.description)}txthtml=J.find("span.fc-event-title").html();txt=J.find("span.fc-event-title").text();if(txt!=undefined&&txthtml!=undefined&&txthtml.length==txt.length){elwidth=J.find("div.fc-event-inner").css("width").replace("px","");if(txt.length>33&&elwidth<200){txt=txt.substring(0,33).replace(" ","&nbsp")}J.find("span.fc-event-title").html(txt)}$("span.fc-event-time").remove();J.find("span.fc-event-title").css({"padding-left":"3px","float":"left",height:"14px"});$(J).css("margin-top","1px");if(ZCView.allowEdit==true||ZCView.allowDelete==true){var K=$(J[0]);K.unbind("mouseover");K.bind("mouseover",function(){ZCView.calEventMouseOver(this,true)});K.unbind("mouseout");K.bind("mouseout",function(){ZCView.calEventMouseOver(this,false)});var I=$('<div class="fc-icondiv" ></div>');if(ZCView.allowEdit==true){var H=$('<a href="javascript:void(0);" class="fc-edit-icon"></a>');H.unbind("click");H.bind("click",function(M){M.stopPropagation();ZCView.calEventEditOrDel(L,false)});I.append(H)}if(ZCView.allowDelete==true){var G=$('<a href="javascript:void(0)" class="fc-delete-icon"></a>');G.unbind("click");G.bind("click",function(M){M.stopPropagation();ZCView.calEventEditOrDel(L,true)});I.append(G)}var F=J.children()[0];$(F).append(I)}}};this.afterRenderEventFun=function(H,F,I){if(I.name=="month"){var K=F.css("width");var E=3;var G=$(F).find("div.fc-event-inner");var M=($(G).css("width")).replace("px","");if(!F.hasClass("fc-event-start")){M=(parseInt(M)-15);var L=$('<div class="fc-triangleLeft"></div>');$(G).before(L);$(G).addClass("fc-parent-triangleLeft");var J=(F.css("left")).replace("px","");F.css("left",parseInt(J)+E);K=K.replace("px","");K=(parseInt(K)-E)+"px";F.css("width",K);F.css("border-left","none");var N=H.backgroundColor;if(N!==undefined){$(L).css("border-color",N+" transparent");$(G).css("background-color",N);$(G).css("border-color",N)}}if(!F.hasClass("fc-event-end")){M=(parseInt(M)-15);var L=$('<div class="fc-triangleRight"></div>');$(G).after(L);$(G).addClass("fc-parent-triangleRight");if($(G).hasClass("fc-parent-triangleLeft")){$(G).css("border-left","none");M=M+2}K=K.replace("px","");K=(parseInt(K)-E)+"px";F.css("width",K);F.css("border","none");var N=H.backgroundColor;if(N!==undefined){$(L).css("border-color","transparent "+N);$(G).css("background-color",N);$(G).css("border-color",N)}}if(F.hasClass("fc-event-start")&&F.hasClass("fc-event-end")){var G=$(F).find("div.fc-event-inner");var M=($(G).css("width")).replace("px","");var N=H.backgroundColor;if(N!==undefined){$(G).css("background-color",N);$(G).css("border-color",N)}}F.css("background-color","transparent");$(G).css("width",M+"px")}else{if(I.name=="agendaWeek"||I.name=="agendaDay"){F.find("span.fc-event-title").html(F.find("span.fc-event-title").text());F.find("div.fc-event-title").html(F.find("div.fc-event-title").text());txthtml=F.find("span.fc-event-title").html();txt=F.find("span.fc-event-title").text();if(txt!=undefined&&txthtml!=undefined&&txthtml.length==txt.length){elwidth=F.find("div.fc-event-inner").css("width").replace("px","");if(txt.length>33&&elwidth<176){txt=txt.substring(0,33).replace(" ","&nbsp;")}F.find("span.fc-event-title").html(txt)}txt=F.find("div.fc-event-title").text();txthtml=F.find("div.fc-event-title").html();if(txt!=undefined&&txthtml!=undefined&&txthtml.length==txt.length){elwidth=F.find("div.fc-event-inner").css("width").replace("px","");if(txt.length>33&&elwidth<70){txt=txt.substring(0,33).replace(" ","&nbsp;")}F.find("div.fc-event-title").html(txt)}F.find("span.fc-event-title").css({"padding-left":"6px"});if(!H.isEncrypted){F.find("div.fc-event-time").attr("title",H.description)}F.find("div.fc-event-time").html(F.find("div.fc-event-time").text());var G=$(F).find("div.fc-event-inner");var N=H.backgroundColor;if(N!==undefined){$(G).css("background-color",N);$(G).css("border-color",N)}else{$(G).parent().css("border","1px solid #cecece")}}}};this.addCalEvent=function(F,G,M,J,L){var K=L.name;if(!ZCView.validDayAndHour(F,G,K)){ZCView.zc_calendar.fullCalendar("unselect");return }var I='{"startDate":{"day":'+F.getDate()+',"month":'+F.getMonth()+',"year":'+F.getFullYear()+',"hours":'+F.getHours()+',"minutes":'+F.getMinutes()+',"seconds":'+F.getSeconds()+"},";I=I+'"endDate":{"day":'+G.getDate()+',"month":'+G.getMonth()+',"year":'+G.getFullYear()+',"hours":'+G.getHours()+',"minutes":'+G.getMinutes()+',"seconds":'+G.getSeconds()+"}}";var E=ZCView.viewArr[ZCView.calendarViewName];var H=ZCView.calDisplayType(K);ZCUtil.setInMap(E,"calViewType",H);ZCView.showAddForm(null,ZCView.calendarViewName,I)};this.dragCalEvent=function(K,I,M,Q,L,N,O,P){if(!ZCView.validDayAndHour(K.start,K.end,P.name)){L();return }var E=ZCView.viewArr[ZCView.calendarViewName];var J=ZCView.calDisplayType(P.name);var F=K.start;var H=F;ZCUtil.setInMap(E,"startDate",F);ZCUtil.setInMap(E,"endDate",H);var G="recordlinkID="+K.id+"&formid="+ZCUtil.getFromMap(E,"viewFormID")+"&appid="+ZCUtil.getFromMap(E,"appID")+"&startDateCompID="+ZCUtil.getFromMap(E,"zc_calBasedOn")+"&noOfDays="+I+"&minutes="+M+"&viewlinkId="+ZCUtil.getFromMap(E,"viewLinkID")+"&calViewType="+J+"&viewLinkName="+ZCUtil.getFromMap(E,"viewLinkName");if(ZCUtil.getFromMap(E,"privateLink")!=""){G=G+"&viewPrivateLink="+ZCUtil.getFromMap(E,"privateLink")}if(ZCUtil.getFromMap(E,"zc_endDateCompID")!=""){G=G+"&endDateCompID="+ZCUtil.getFromMap(E,"zc_endDateCompID")}ZCUtil.sendRequest("/updateCalEvent.do",G,"json","ZCView.afterUpdateCalEvent",E,i18n.pleasewait)};this.resizeCalEvent=function(K,I,M,L,N,O,P){if(!ZCView.validDayAndHour(K.start,K.end,P.name)){L();return }var E=ZCView.viewArr[ZCView.calendarViewName];var J=ZCView.calDisplayType(P.name);var F=K.start;var H=F;ZCUtil.setInMap(E,"startDate",F);ZCUtil.setInMap(E,"endDate",H);var G="recordlinkID="+K.id+"&formid="+ZCUtil.getFromMap(E,"viewFormID")+"&appid="+ZCUtil.getFromMap(E,"appID")+"&startDateCompID="+ZCUtil.getFromMap(E,"zc_calBasedOn")+"&noOfDays="+I+"&minutes="+M+"&eventAction=RESIZE&viewlinkId="+ZCUtil.getFromMap(E,"viewLinkID")+"&calViewType="+J+"&viewLinkName="+ZCUtil.getFromMap(E,"viewLinkName");if(ZCUtil.getFromMap(E,"privateLink")!=""){G=G+"&viewPrivateLink="+ZCUtil.getFromMap(E,"privateLink")}if(ZCUtil.getFromMap(E,"zc_endDateCompID")!=""){G=G+"&endDateCompID="+ZCUtil.getFromMap(E,"zc_endDateCompID")}ZCUtil.sendRequest("/updateCalEvent.do",G,"json","ZCView.afterUpdateCalEvent",E,i18n.pleasewait)};this.validDayAndHour=function(F,J,K){if(J==null){J=F}var H=ZCView.daysArray[F.getDay()];var E=ZCView.daysArray[J.getDay()];var I=F.getHours();var G=J.getHours();G=J.getMinutes()>10?G+1:G;if(isValueExist(ZCView.disabledDaysList,H)||isValueExist(ZCView.disabledDaysList,E)||((ZCView.wstartTime>I||ZCView.wendTime<I||ZCView.wendTime<G||ZCView.wstartTime>G)&&K!="month")){return false}return true};this.calWorkingDayConf=function(E){$(".fc-disableClass").removeClass("fc-disableClass");$(ZCView.disableDays).addClass("fc-disableClass");$(".fc-widget-header").removeClass("fc-disableClass");if(E=="agendaDay"||E=="agendaWeek"){var I="";for(var H=0;H<this.wstartTime*2;H++){I=I+".fc-slot"+H+","}for(var F=this.wendTime*2;F<48;F++){I=I+".fc-slot"+F+","}if(I!=""){I=I.replace(/,$/g,"");$(I).addClass("fc-disableClass");var G=$(".fc-agenda-allday").find(".fc-day-content");$(G).addClass("fc-disableClass")}}};this.changeCalViewType=function(E){this.zc_calendar.fullCalendar("changeView",E);this.calWorkingDayConf(E)};this.afterUpdateCalEvent=function(S,R,J){var T=ZCUtil.getFromMap(R,"calViewType");ZCUtil.setInMap(J,"calViewType",T);var U=ZCUtil.getFromMap(R,"formid");var F=ZCForm.getMsgFromResponse(S,U);var P=F.succMsg;var W=F.successMsgDuration;var M=F.errMsg;var O=F.infoMsg;var H=F.errorMsg;var Y=F.alertMsg;var V=F.captchaTxt;var E=F.generatedjs;var I=ZCUtil.getFromMap(J,"dateJsonObject");if(ZCUtil.isNull(I)){var N=ZCUtil.getFromMap(J,"startDate");var L=ZCUtil.getFromMap(J,"endDate");I='{"startDate":{"day":'+N.getDate()+',"month":'+N.getMonth()+',"year":'+N.getFullYear()+',"hours":'+N.getHours()+',"minutes":'+N.getMinutes()+',"seconds":'+N.getSeconds()+"},";if(L!=null){I=I+'"endDate":{"day":'+L.getDate()+',"month":'+L.getMonth()+',"year":'+L.getFullYear()+',"hours":'+L.getHours()+',"minutes":'+L.getMinutes()+',"seconds":'+L.getSeconds()+"}};"}ZCUtil.setInMap(J,"dateJsonObject",I);ZCUtil.removeFromMap(J,"startDate");ZCUtil.removeFromMap(J,"endDate")}if(!ZCUtil.isNull(P)){ZCView.showView(J,P,O,W,H)}else{var K="position=absolute, closeParent=false";var X=i18n.headererrormsg;if(Y==""||Y==undefined){Y=i18n.invalidmsg}if(typeof (Y)=="object"){Y=Y[0];for(var Q in Y){var G=Y[Q];G=G.replace(new RegExp("\n","g"),"<br>");G=G.replace(new RegExp("#zc_amp#","g"),"&");ZCApp.showErrorDialog(X,G,K)}}else{ZCApp.showErrorDialog(X,Y,K)}ZCView.showView(J)}return };this.clearViewDialogs=function(E){ZCApp.htmlArr[E+"-zc-view-save-dialog"]=null;ZCApp.htmlArr[E+"-zc-view-hidden-cols-dialog"]=null};this.showView=function(K,J,L,G,H){var E=ZCUtil.getFromMap(K,"viewLinkName");ZCView.clearViewDialogs(E);var F=ZCView.getViewCont(E).attr("viewURL");if(!F){var I=ZCUtil.getFromMap(K,"viewURL");if(!ZCUtil.isNull(I)){F=I}else{F="/liveViewHeader.do"}}ZCUtil.setInMap(K,"zc-mobile",ZCApp.isMobileSite);if(ZCApp.isMobileSite&&ZCUtil.getFromMap(K,"openSearch")){ZCUtil.setInMap(K,"searchCrit",true);ZCUtil.setInMap(K,"isOrComparator",true)}ZCUtil.sendRequest(F,ZCUtil.getParamsFromMap(K),"html","ZCApp.loadZCComponent",ZCUtil.getParamsAsMap("compLinkName="+E+"&compName=View&compType="+ZCConstants.VIEW),i18n.pleasewait);if(!ZCUtil.isNull(J)&&J!="zc_success"){if(!ZCUtil.isNull(G)){G=G*1000;ZCApp.showFadingMsg(J,0,G)}else{ZCApp.showFadingMsg(J,0,2000)}}ZCView.showInfo(L,H)};this.showInfo=function(G,F){if(!ZCUtil.isNull(G)||!ZCUtil.isNull(F)){var E=ZCForm.getInfoMsgHtml(G,F);if(E==""){return }ZCUtil.showInDialog(ZCApp.dialogAbove+E+ZCApp.dialogBelow,"closeButton=no");ZCUtil.removeInfoHdr()}};this.selectGroup=function(F,G){if(!ZCView.isGroupSel){var J=$(F).parents("tr[elName=zc-viewrowEl]").prevAll("tr[elName=zc-grouprow]");if(J.length>0){var E=J[0];var K=$(E).find("input[elName=zc-groupSelectionEl]");var I=$(F).is(":checked");var N=$(E).attr("groupIndex");var H=$("#"+G+"_group"+N).find("input[elName=zc-groupSelectionEl]");if(!I){$(K).prop("checked",I);$(H).prop("checked",I);return }var M=true;var L=$(E).nextAll("tr");$.each($(L),function(P){if($(this).attr("elName")==="zc-viewrowEl"){var O=$(this).find("input[elName=zc-recSelectionEl]");M=$(O).is(":checked");if(!M){return false}}else{return false}});$(K).prop("checked",M);$(H).prop("checked",M)}}};this.selectGroupRecord=function(F,L){var E=$(F).parents("tr[elName=zc-grouprow]");var M=$(E).attr("groupindex");var G=$(F).is(":checked");var J=L+"_group"+M;if($(E).attr("id")===J){var K=ZCView.getViewCont(L);E=$(K).find("tr[groupindex="+M+"]")[0];var H=$(E).find("input[elName=zc-groupSelectionEl]");$(H).prop("checked",G)}else{var H=$("#"+J).find("input[elName=zc-groupSelectionEl]");$(H).prop("checked",G)}var I=$(E).nextAll("tr");$.each(I,function(){if($(this).attr("elName")==="zc-viewrowEl"){var N=$(this).find("input[elName=zc-recSelectionEl]");$(N).prop("checked",G);ZCView.checkRecord(N,L)}else{return false}})};this.checkRecSelection=function(G,H){var I=ZCView.getElementOrValue("recSelectionEl",H);var E=$(G).attr("elName");if(E=="zc-selectAllRecsEl"){I=ZCView.getElementOrValue("recAndGroupSelectionEl",H);var L=$(G).is(":checked");$(I).prop("checked",L);ZCView.markRecord(G,H)}else{if(E=="zc-groupSelectionEl"){ZCView.selectGroupRecord(G,H)}else{if(E=="zc-recSelectionEl"){var J=true;if($(I).filter(":not(:checked)").length>0){J=false}ZCView.getElementOrValue("selectAllRecsEl",H).prop("checked",J)}}}if(!isViewBeta){var N=ZCView.getViewCont(H);var Q=ZCView.getElementOrValue("viewtable",H);var P=ZCView.getElementOrValue("colheaderrow",H);var M=$(P).find("th:first");var F=$(P).find("th:last");var S=$(Q).attr("bordercls");var K=$(M).attr("firstcls");var R=$(F).attr("lastcls");var O=$(N).find("[elname=zc-recSelectionEl]:checked");if(O.length>0){$(N).find("[elname=zc-viewRecordActionEl]").show();$(N).find("[elname=zc-viewchangelogEl]").hide();if($(Q).hasClass(S)){$(Q).removeClass(S)}if($(M).hasClass(K)){$(M).removeClass(K)}if($(F).hasClass(R)){$(F).removeClass(R)}}else{$(N).find("[elname=zc-viewRecordActionEl]").hide();$(N).find("[elname=zc-viewchangelogEl]").show();if(!$(Q).hasClass(S)){$(Q).addClass(S)}if(!$(M).hasClass(K)){$(M).addClass(K)}if(!$(F).hasClass(R)){$(F).addClass(R)}}}};this.markChange=function(H,E){var F=ZCUtil.getParent(H,"tr");var I=F.attr("reclinkid");showOthersOption(H);registerMaskEvents(H);var G=$(F).find("input[elName=zc-recSelectionEl]");if(!$(G).is(":checked")){$(F).attr("changed",true);$(G).prop("checked",true);ZCView.markRecord(G,E);ZCView.checkRecSelection(G,E)}};this.storeFieldVal=function(F,E){var G=ZCUtil.getFieldValue(F);if(ZCUtil.isNull($(F).attr("origval"))){if($(F).attr("type")=="select-multiple"||$(F).attr("type")=="multiselect"){$(F).attr("origval",G.join(","))}else{if($(F).attr("type")=="checkbox"){$(F).attr("origval",$(F).is(":checked"))}else{$(F).attr("origval",G)}}}};this.restoreFieldVal=function(E){var F=$(E).attr("origval");if(!ZCUtil.isNull(F)){if($(E).attr("type")=="select-multiple"||$(E).attr("type")=="multiselect"){$(E).val(F.split(","))}else{if($(E).attr("type")=="checkbox"){if(F=="true"){$(E).prop("checked","checked")}else{$(E).prop("checked",false)}}else{$(E).val(F)}}}};this.checkRecord=function(F,E){ZCView.markRecord(F,E);ZCView.selectGroup(F,E);ZCView.checkRecSelection(F,E)};this.markRecord=function(H,I){var J=ZCView.getElementOrValue("recSelectionEl",I);var F=$(H).attr("elName");var G=true;var M=$(H).is(":checked");if(!M){ZCView.isGroupSel=M}var O=(F=="zc-selectAllRecsEl");var K;if(O){K=ZCView.getElementOrValue("viewrowEl",I);if($(H).is(":checked")){G=true}else{G=false}}else{K=ZCUtil.getParent(H,"tr");G=($(J).filter(":checked").length>0);ZCView.cache[I+"_lastSelectedRow"]=$(K)}if(G){ZCView.toggleViewMenu(I,"show","enable");var E=this.viewArr[I];if(M){$(K).addClass("zc-row-sel")}else{$(K).removeClass("zc-row-sel")}}else{ZCView.toggleViewMenu(I,"hide","disable");var E=this.viewArr[I];if(O){var L=(ZCUtil.getFromMap(E,"viewType")==ZCConstants.VIEW_SHEET);$.each(K,function(){$(this).attr("class","zc-viewrow "+$(this).attr("cls"));if(L){ZCView.resetGridViewData(this,I)}})}else{K.attr("class","zc-viewrow "+K.attr("cls"));if(ZCUtil.getFromMap(E,"viewType")==ZCConstants.VIEW_SHEET){ZCView.resetGridViewData(K,I)}}}var E=this.viewArr[I];if(parseInt(ZCUtil.getFromMap(ZCView.viewArr[I],"viewType"))===ZCConstants.VIEW_NEWSHEET){var N=$("#sheetviewmaincont").handsontable("getInstance");if(G){$("input[elname=zc-recSelectionEl]").prop("checked",true);$(".htCore td").addClass("tdbgcolor")}else{$("input[elname=zc-recSelectionEl]").prop("checked",false);$(".htCore td").removeClass("tdbgcolor")}}};this.resetGridViewData=function(G,E){if($(G).attr("changed")=="true"){$(G).removeAttr("changed");var H=ZCView.getElementOrValue("colheaderrow",E);var F=ZCView.getDataIndices(H);$.each(G.find("td"),function(I,J){if(ZCUtil.contains(F,I)){ZCView.restoreFieldVal($(J).find(":input"))}})}};this.saveViewRecords=function(G,H,F){var E=this.viewArr[H];var P=ZCView.getViewCont(H);var Q=$(P).find("span[elName=zc-viewheaderitemsspan]");var K=$(Q).find("a[elName=zc-saveViewRecsEl]");if(K.attr("status")=="disable"){return }var R=$(P).find("tr[elName=zc-colheaderrow]");var O=ZCView.getDataIndices(R);var I=ZCUtil.getFromMap(E,"viewFormID");var L="formID="+I+"&viewID="+ZCUtil.getFromMap(E,"viewID")+"&";if(!ZCUtil.isNull(ZCUtil.getFromMap(E,"privateLink"))){L=L+"&privateLink="+ZCUtil.getFromMap(E,"privateLink")+"&"}var N=ZCUtil.getFromMap(E,"linkedView");if(!ZCUtil.isNull(N)){L=L+"&linkedView="+N}var M="<data>";$.each($(P).find("table[elName=zc-viewtable]").find("tr"),function(U,T){if($(T).find("input[elName=zc-recSelectionEl]").is(":checked")){var V=-1;var S="";V=ZCView.checkAndGetAttribute(T,"recLinkID");M=M+'<record Id="'+V+'">';$.each($(T).find("td"),function(X,Y){if(ZCUtil.contains(O,X)){if($(Y).find("div[elName=compositeField]").length>0){var b=$(Y).find("div[elName=compositeField]").attr("labelName");M=M+'<field label="'+b+'">';var a=$(Y).find(":input");$(a).each(function(){M=M+'<CF label="'+$(this).attr("name")+'">'+$(this).val()+"</CF>"});M=M+"</field>"}else{var a=$(Y).find(":input");if(a[1]){var Z=$(a[1]).attr("name");var W=ZCUtil.getFieldValue(a[1]);M=M+'<field label="'+Z+'"><value><![CDATA['+encodeURIComponent(W)+"]]></value></field>"}if(a[0]){S=$(a).attr("name");M=M+'<field label="'+S+'">';var c=ZCUtil.getFieldValue(a);if($(a).prop("type")=="select-multiple"||$(a).prop("type")=="multiselect"||$(a).attr("fieldtype")==ZCConstants.MULTI_SELECT){if(c!=null){$.each(c,function(d,e){M=M+"<value><![CDATA["+encodeURIComponent(e)+"]]></value>"})}}else{if($(a).prop("type")=="checkbox"){c=$(a).is(":checked")?"zc_checked":"zc_unchecked";M=M+"<value><![CDATA["+c+"]]></value>"}else{if($(a).attr("extField")){c=$(a).attr("extValue");M=M+"<value><![CDATA["+c+"]]></value>"}else{M=M+"<value><![CDATA["+encodeURIComponent(c)+"]]></value>"}}}M=M+"</field>";if($(a).attr("fieldtype")==25){if(a[1]){var Z=$(a[1]).attr("name");var W=ZCUtil.getFieldValue(a[1]);M=M+'<field label="'+Z+'"><value><![CDATA['+encodeURIComponent(W)+"]]></value></field>"}}}}}});M=M+"</record>"}});M=M+"</data>";L=L+"&data="+M+"&viewLinkName="+H+"&formLinkName="+ZCUtil.getFromMap(E,"viewFormName");if(!ZCUtil.isNull(F)){L=L+"&appLinkName="+F}var J="/gridRecordAction.do";ZCUtil.sendRequest(J,L,"json","ZCView.handleGridRecAction","",i18n.saverec)};this.handleGridRecAction=function(W,M,O){var T=ZCUtil.getFromMap(M,"viewLinkName");var H=ZCView.viewArr[T];var R=ZCView.getViewCont(T);var E=ZCForm.getMsgFromResponse(W,"");var K=E.succMsg;var I=E.successMsgDuration;ZCView.clearViewErrors(R);if(!ZCUtil.isNull(K)){if(!ZCUtil.isNull(I)){ZCView.showView(H,K,"",I)}else{ZCView.showView(H,K,"")}}else{var L=E.fieldErrObj;var N=E.successList;var U=E.errorList;var S=$(R).find("div[elName=zc-delactionsdiv]").clone(true);var P=(N)?N.length+" "+i18n.recsuccmsg:"";var G=(U)?U.length+" "+i18n.recfailmsg:"";ZCView.setActionRespInDiv(S,N,U,P,G);var V=(ZCUtil.isNull(U)&&ZCUtil.isNull(N))?null:$(S).html();if(!ZCUtil.isNull(L)){ZCView.showRecErrors(R,L);var J="position=absolute, closeParent=false";var Q=i18n.headererrormsg;var F=i18n.viewinvalidmsg;ZCApp.showErrorDialog(Q,F,J)}else{ZCView.showView(H,"",V)}}};this.clearViewErrors=function(F){var E=$(F).find("table[elName=zc-viewtable]");$(E).find("tr[elName=zc-rec-err]").remove()};this.showRecErrors=function(G,H){var E=$(G).find("table[elName=zc-viewtable]");var F=$(G).find("div[elName=zc-gridview-err-div]").find("tr[elName=zc-rec-err]");$.each(H,function(J,I){$.each(I,function(L,M){var K=$(E).find("tr[recLinkID="+L+"]");var N=$(F).clone();N.find("td").html(M);N.insertAfter(K)})})};this.getEmbedParams=function(F){var J=$('div[elName="zc-embed-dialog-div"]');var I=$(J).find('input[elName="zc-embed-header"]').is(":checked");var E=$(J).find('input[elName="zc-embed-paging"]').is(":checked");var M=$(J).find('input[elName="zc-embed-search"]').is(":checked");var K=$(J).find('input[elName="zc-embed-recsummary"]').is(":checked");var L=$(J).find('input[elName="zc-embed-export"]').is(":checked");var G=$(J).find('input[elName="zc-embed-print"]').is(":checked");var H=(E==true)?"":"zc_Paging=false";H=(M==true)?H:H+"&zc_Search=false";H=(K==true)?H:H+"&zc_Summary=false";H=(I==true)?H:H+"&zc_Header=false";H=(L==true)?H+"&zc_Export=true":H;H=(G==true)?H+"&zc_Print=true":H;return H};this.jsSnippetToggle=function(H){var F=$("div[elName=zc-embed-dialog-div]");var E=$(F).find("[elName=zc-embedSnippet-iframe]");var G=$(F).find("[elName=zc-embedSnippet-js]");if($(H).attr("snipState")=="Iframe"){$(E).hide();$(G).show();$(H).attr("snipState","JavaScript");$(H).html(i18n.iframeSnippet);$(F).find("[elName='zc-customize-view-items']").hide();$(F).find("[elName='zc-promptlogin-div']").hide()}else{$(G).hide();$(E).show();$(H).attr("snipState","Iframe");$(H).html(i18n.javascriptSnippet);$(F).find("[elName='zc-customize-view-items']").show();$(F).find("[elName='zc-promptlogin-div']").show()}};this.initVariablesForOptionFetch=function(){ZCView.hasActiveLookupOptionReq=false;ZCView.hasMoreRecords=false;ZCView.noOfRecordsAvailable;ZCView.lookupDropDownDiv};this.loadLookupOptions=function(I,G,H,L){var Q=$(I).scrollTop()+$(I).innerHeight()>=$(I)[0].scrollHeight;if(Q&&!ZCView.hasActiveLookupOptionReq&&ZCView.hasMoreRecords){ZCView.lookupDropDownDiv=I;ZCView.hasActiveLookupOptionReq=true;var N=$(I).parent(".multisel_outer_wrapper").attr("formcompid");var M=$(I).attr("fieldType");var F="/LoadLookupValues.do";var E=ZCView.viewArr[H];var P=ZCUtil.getFromMap(E,"viewFormID");var K=ZCUtil.getFromMap(E,"viewType");var J="sharedBy="+ZCApp.sharedByDisp+"&formCompId="+N+"&appnedRows="+true+"&noOfRecsInCache="+ZCView.noOfRecordsAvailable+"&formid="+P+"&viewType="+K;var O="viewLinkName="+H+"&recLinkID="+G+"&labelName="+L;ZCApp.showLoading("zc-loading");ZCUtil.sendRequest(F,J,null,"ZCView.appendOptions",O,i18n.pleasewait)}};this.appendOptions=function(M,I,R){ZCApp.hideLoading("zc-loading");var S=ZCUtil.getParamsAsMap(R);var J=S.viewLinkName;var G=S.recLinkID;var O=S.labelName;var T=$("#zc_input_"+O+"_"+G);var L=$(T).attr("origval").split(",");var E=JSON.parse(M);var K="";for(var N=0;N<E.length;N++){var F="";var Q=E[N].text;var H=E[N].value;if(L.includes(H)){F="class='selected'"}K=K+"<li "+F+"displayval='"+Q+"' filter='"+H+"'>"+Q+"</li>"}$(ZCView.lookupDropDownDiv).find("ul").append(K);var P=E.length;if(P<200){ZCView.hasMoreRecords=false}ZCView.hasActiveLookupOptionReq=false;ZCView.noOfRecordsAvailable+=P;$(ZCView.lookupDropDownDiv).find("ul li").unbind("mousedown").bind("mousedown",function(U){ZCView.setValueForLookupOption(this,T,ZCView.lookupDropDownDiv,J)})};this.setValueForLookupOption=function(L,O,F,G){$(L).prop("tabindex",0).focus();var K=$(F).attr("fieldtype");var E="";var I="";if(K==ZCConstants.MULTI_SELECT){var M=$(O).attr("value")!=""?$(O).attr("value").split(","):[];var N=$(O).attr("origval")!=""?$(O).attr("origval").split(","):[];if($(L).hasClass("selected")){$(L).removeClass("selected")}else{$(L).addClass("selected")}$(F).find("ul li.selected").each(function(){E=E+$(this).attr("displayval")+",";I=I+$(this).attr("filter")+","});if($(O).hasClass("zc-grid-lookup-input")){for(var H=0;H<N.length;H++){var J=$(F).find("ul li[filter='"+N[H]+"']").length!=0;if(!J){E=E+M[H]+",";I=I+N[H]+","}}}if(E!==""){E=E.substring(0,E.length-1);I=I.substring(0,I.length-1)}else{E=" -Select- "}$(O).val(E);$(O).attr("origval",I);$(O).attr("value",E);ZCView.markChange(O,G)}else{$(F).find("ul li.selected").removeClass("selected");$(L).addClass("selected");$(O).val($(L).attr("displayval"));$(O).attr("value",$(L).attr("displayval"));$(O).attr("origval",$(L).attr("filter"));ZCView.markChange(O,G)}}};var browser_opera=false;var browser_ie=false;var browser_nn6=false;var browser_nn4=false;var browser_chrome=false;if(document.all){if(window.navigator.appName.toUpperCase=="OPERA"){browser_opera=true}else{browser_ie=true}}else{if(document.layers||(!document.all&&document.getElementById)){browser_nn6=true}else{if(document.layers){browser_nn4=true}}}var browser_chrome=/chrome/.test(navigator.userAgent.toLowerCase());function findPosX(B){var C=0;if(document.getElementById||document.all){try{C+=document.body.offsetLeft;while(B.offsetParent){C+=B.offsetLeft;B=B.offsetParent}}catch(A){C+=B.x}}else{if(document.layers){C+=B.x}}return C}function isValueExist(C,B){for(var A=0;A<C.length;A++){if(B==C[A]){return true}}return false}function findPosY(C){var A=0;if(document.getElementById||document.all){try{A+=document.body.offsetTop;while(C.offsetParent){A+=C.offsetTop;C=C.offsetParent}}catch(B){A+=C.y}}else{if(document.layers){A+=C.y}}return A}function showOthersOption(B){var D=$(B).attr("formcompid");var A=$(B).val();var C;if($(B).attr("type")=="radio"){C=$("div[id=othersdiv"+D+"]")}else{C=$(B).siblings("div[elName=othersinput]")}if(A!="-otherVal-"){$(C).find(":input").val("");C.animate({opacity:0},200,function(){C.attr("isOthersSelected","false");$(C).slideUp(200)});return }C.css({opacity:0});C.slideDown(200,function(){$(this).animate({opacity:1},200,function(){C.attr("isOthersSelected","true");$(C).find(":input").focus()})})}function registerMaskEvents(A){return ;$.inputmask.defaults.definitions={};$.inputmask.defaults.showMaskOnHover=false;$.extend($.inputmask.defaults.definitions,{"#":{validator:"[0-9]",cardinality:1,}});if($(A).is("input[type=text]")){maskInput(A)}else{$(A).find(":input[elName=phoneMask]").each(function(B,C){maskInput(this)})}}function maskInput(A){var B=$(A).attr("phoneformat");var C=$(A).val();if(B!=="INTERNATIONAL"){B=(B==="US")?"###-###-####":B;if(C!==null&&C!==undefined&&C!==""){$(A).keyup(function(D){if(!$(A).inputmask("hasMaskedValue")&&(D.keyCode!==9&&!(D.shiftKey&&D.keyCode===9))){$(A).inputmask(B)}})}else{if(!$(A).inputmask("hasMaskedValue")){$(A).inputmask(B)}}}}function findDocDim(){if(browser_ie){return{width:document.body.offsetWidth+getIEScrollLeft(),height:document.body.offsetHeight+getIEScrollTop()}}else{if(browser_nn4||browser_nn6){return{width:window.innerWidth+getIEScrollLeft(),height:window.innerHeight+getIEScrollTop()}}}}function getCursorPos(B){if(browser_ie){var A=window.event.clientX+getIEScrollLeft();var C=window.event.clientY+getIEScrollTop()}else{if(browser_nn6){var A=B.pageX;var C=B.pageY}}return{x:A,y:C}}var scrollConst=0;var scrX=0,scrY=0,pgeX=0,pgeY=0,srcElement;if(browser_ie){document.attachEvent("onclick",popUpListener)}else{if(browser_nn4||browser_nn6){document.addEventListener("click",popUpListener,true)}}function popUpListener(A){if(browser_ie){srcElement=window.event.srcElement}else{if(browser_nn4||browser_nn6){srcElement=A.target;scrX=A.screenX;scrY=A.screenY;pgeX=A.pageX;pgeY=A.pageY}}}function getObj(E,D){var C,B,A;if(!D){D=document}if((C=E.indexOf("?"))>0&&parent.frames.length){D=parent.frames[E.substring(C+1)].document;E=E.substring(0,C)}if(!(A=D[E])&&D.all){A=D.all[E]}for(B=0;!A&&B<D.forms.length;B++){A=D.forms[B][E]}for(B=0;!A&&D.layers&&B<D.layers.length;B++){A=getObj(E,D.layers[B].document)}if(!A&&D.getElementById){A=D.getElementById(E)}return A}String.prototype.trim=function(){var A=this;A=A.replace(/^\s*(.*)/,"$1");A=A.replace(/(.*?)\s*$/,"$1");return A};function clearTextSelection(){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.getSelection){var A=document.getSelection();if(A.collapse){A.collapse(true)}if(A.removeAllRanges){A.removeAllRanges()}}else{if(document.selection){document.selection.empty()}}}}function docid(A){return document.getElementById(A)}function getA(B,A){return B.getAttribute(A)}function setA(B,A,C){return B.setAttribute(A,C)}function getBool(A){if(A=="true"){return true}return false}var celldisp="block";var rowdisp="block";var tabledisp="block";if(!document.all){celldisp="table-cell";rowdisp="table-row";tabledisp="table"}var samplef=null;function getForm(E,C,D){if(samplef==null){samplef=document.createElement("form");samplef.method="post";document.body.appendChild(samplef)}var A=samplef.elements;for(var B=A.length-1;B>=0;B--){samplef.removeChild(A.item(B))}samplef.action=E;for(var B=0;B<C.length;B++){samplef.appendChild(getInp(C[B],D[B]))}return samplef}function getInp(A,C){var B=document.createElement("input");B.type="hidden";B.setAttribute("name",A);B.setAttribute("value",C);return B}function trimString(A){if(A!=null){A=A.replace(/^\s+/g,"");A=A.replace(/\s+$/g,"")}return A}function makeSelect(B){if(!B){return }if(B.createTextRange){var A=B.createTextRange();A.collapse(true);A.select()}else{if(B.setSelectionRange){B.focus();B.setSelectionRange(0,0)}}}function freezeScriptBackground(B){var A;if(!document.getElementById("ScriptFreezeLayer")){var C=document.createElement("DIV");C.id="ScriptFreezeLayer";if(B){if(B=="1"){C.className="scriptfreezeLayer"}else{if(B=="2"){C.className="scriptfreezeLayer2"}else{if(B=="3"){C.className="scriptfreezeLayer3"}}}}else{C.className="scriptfreezeLayer"}C.style.zIndex="99";document.body.appendChild(C);if(browser_ie){if(B&&B=="2"){}else{A=document.createElement("IFRAME");A.scrolling="no";A.id="ScriptIEHackLayer";A.frameBorder=0;if(window.CONTEXT_PATH!=null){A.src=CONTEXT_PATH+"/framework/html/blank.html"}A.style.position="absolute";A.style.zIndex="98";A.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)";A.style.top="0px";A.style.left="0px";A.style.height="100%";A.style.width="100%";document.body.appendChild(A)}}}}function unFreezeScript(){if(document.getElementById("ScriptFreezeLayer")!=null){document.body.removeChild(docId("ScriptFreezeLayer"));if(browser_ie){try{document.body.removeChild(docId("ScriptIEHackLayer"))}catch(A){}}}}var diffTaskDefLeft=0;var diffTaskDefTop=0;var TaskDefDialog=null;function setCurrentTaskDef(A){TaskDefDialog=A}function captureTaskDef(A){TaskDefDialog.style.cursor="move";if(browser_ie){diffTaskDefLeft=window.event.clientX+getIEScrollLeft()-parseInt(findPosX(TaskDefDialog));diffTaskDefTop=window.event.clientY+getIEScrollTop()-parseInt(findPosY(TaskDefDialog))}else{if(browser_nn4||browser_nn6){diffTaskDefLeft=A.pageX-parseInt(findPosX(TaskDefDialog));diffTaskDefTop=A.pageY-parseInt(findPosY(TaskDefDialog))}}document.onmousemove=moveTaskDef;document.onmouseup=releaseTaskDef}function moveTaskDef(A){clearTextSelection();if(browser_ie){if(document.getElementById("FreezeLayer")!=null||browser_opera){TaskDefDialog.style.left=(window.event.clientX+getIEScrollLeft()-diffTaskDefLeft)+"px";TaskDefDialog.style.top=(window.event.clientY+getIEScrollTop()-diffTaskDefTop)+"px"}else{TaskDefDialog.style.left=(window.event.clientX+getIEScrollLeft()-diffTaskDefLeft)+"px";TaskDefDialog.style.top=(window.event.clientY+getIEScrollTop()-diffTaskDefTop)+"px"}}else{if(browser_nn4||browser_nn6){TaskDefDialog.style.left=(A.pageX-diffTaskDefLeft)+"px";TaskDefDialog.style.top=(A.pageY-diffTaskDefTop)+"px"}}}function releaseTaskDef(){TaskDefDialog.style.cursor="default";document.onmousemove=null;document.onmouseup=null}function openhtml(B){var A=null;if(B){A=window.open("http://zohocreator.wiki.zoho.com/"+B,"delugedoc")}else{A=window.open("http://zohocreator.wiki.zoho.com/Deluge-Reference---Overview.html","delugedoc")}A.moveTo(0,0);A.resizeTo(screen.width,screen.height);A.focus()}function getIEScrollTop(){var A=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop;return A}function getIEScrollLeft(){var A=document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft;return A}function getIEClientWidth(){if($.browser.msie){return document.documentElement.clientWidth}else{return document.body.clientWidth}}function getIEClientHeight(){if($.browser.msie){return document.documentElement.clientHeight}else{return document.body.clientHeight}}function positioncenter(B){var C=B.offsetWidth;var A=B.offsetHeight;var F=findDocDim();var E=(F.width/2)-(C/2)+getIEScrollLeft();var D=(F.height/2)-(A/2)+getIEScrollTop();B.style.left=parseInt(E)+"px";B.style.top=parseInt(D)+"px"}function swapImg(B,A){B.src=A}function reStoreImg(B,A){B.src=A}function removeAllChildNodes(A){while(A.hasChildNodes()){A.removeChild(A.firstChild)}}function createElem(K,F,I){var C=document.createElement(K);if(F){var J=F.split(" ");for(var G in J){var B=J[G];var D=B.split("=");var A=D[0];var H=D[1];if(A&&H){C.setAttribute(A,H);if(A=="class"){C.className=H}}else{if(A){C.setAttribute(A,"")}}}}if(I){var E=null;if(typeof I=="string"){E=document.createTextNode(I)}else{E=I}C.appendChild(E)}return C}function equalsIgnoreCase(B,A){if(A&&A){if(B.toLowerCase()==A.toLowerCase()){return true}}return false}function replaceParams(B,A){if(typeof A!="undefined"&&A.length>0){for(i=0;i<A.length;i++){B=replace(B,"["+i+"]",A[i])}}return B}function replace(A,G,E){var C=A.length,F=G.length;if((C==0)||(F==0)){return A}var B=A.indexOf(G);if((!B)&&(G!=A.substring(0,F))){return A}if(B==-1){return A}var D=A.substring(0,B)+E;if(B+F<C){D+=replace(A.substring(B+F,C),G,E)}return D}function intranetshowDialogDemo(A){var H=portal_list.response.result.portalInfo;var I=document.getElementById("borderdiv");I.setAttribute("style","background-color:white;width:510px;height:215px;font-size: 12px;");var D=document.getElementById("portalmaindiv");portalchilddiv=document.createElement("div");portalchilddiv.setAttribute("id","portalchilddiv");var E=document.createElement("select");E.setAttribute("id","selectPortal");var B=document.createElement("option");B.text=H.portalName;B.value=H.portalId;E.appendChild(B);var C=H.portalId;C=location.hash.replace(/^.*#/,"");if(H.subportalList!=undefined){if(H.subportalList.length!=undefined){for(var F=0;F<H.subportalList.length;F++){var B=document.createElement("option");B.text=H.subportalList[F].subportalName;B.value=H.subportalList[F].subportalId;if(C==H.subportalList[F].subportalId){B.setAttribute("selected",true)}E.appendChild(B)}}else{var B=document.createElement("option");B.text=H.subportalList.subportalName;B.value=H.subportalList.subportalId;if(C==H.subportalList.subportalId){B.setAttribute("selected",true)}E.appendChild(B)}}portalchilddiv.appendChild(E);D.appendChild(portalchilddiv);installbutton=document.getElementById("installapp");installmaindiv=document.createElement("div");installmaindiv.setAttribute("id","installmaindiv");installchilddiv=document.createElement("button");installchilddiv.setAttribute("id","installApp");installchilddiv.innerHTML="Install Now";installchilddiv.setAttribute("style","background-color: #4388CC;    border: 2px solid #1B3280;  width:100px; margin:0 auto;  color: white; cursor: pointer;");installchilddiv.setAttribute("onclick","installapp('"+A+"')");installmaindiv.appendChild(installchilddiv);installbutton.appendChild(installmaindiv);var G=document.getElementById("intranetmaincontant").innerHTML;showDialog(G,"position=absolute, top=300, left=450, closeButton=no, modal=yes ,width=510");D.removeChild(portalchilddiv);installbutton.removeChild(installmaindiv)}function installapp(A){loginDialog(A+"&sharedBy="+portal_list.response.result.portalInfo.soid+"&portalName="+portal_list.response.result.portalInfo.portalName+"&portalId="+document.getElementById("selectPortal").value,"installApplink")}function initializeGadget(){window.addEventListener("message",function(B){if(B.data!=undefined&&B.data.type=="CloudPicker"){fileListObject=B.data.doc;if(fileListObject!=undefined){zohodocs=fileListObject.zohodocs;gdrive=fileListObject.gdrive;dropbox=fileListObject.dropbox;skydrive=fileListObject.skydrive;box=fileListObject.box;var A={};var C=3;if(zohodocs!=undefined&&zohodocs.length>0){A=zohodocs[0];C=2}else{if(gdrive!=undefined&&gdrive.length>0){A=gdrive[0];C=3}else{if(dropbox!=undefined&&dropbox.length>0){A=dropbox[0];C=4}else{if(skydrive!=undefined&&skydrive.length>0){A=skydrive[0];C=5}else{if(box!=undefined&&box.length>0){A=box[0];C=6}}}}}if(A!=undefined){docId=A.docId;docType=A.docType;docName=A.docName;originalFileName=docName;if(docName.indexOf(".")<0){switch(docType){case"document":docName=docName+".doc";break;case"presentation":docName=docName+".ppt";break;case"spreadsheet":docName=docName+".xlsx";break;case"zohosheet":docName=docName+".xlsx";break;case"pdf":docName=docName+".pdf";break}}docName=decodeURIComponent(docName);docType=unescape(docType);docId=unescape(docId);originalFileName=unescape(originalFileName);docDetails=C+","+docId+","+docType+","+docName+","+originalFileName;$("#cloudPickVal").val(docDetails);$("#cloudFileName").text(docName);closeCloudPicDialog()}}}else{if(B.data!=undefined&&B.data=="closePicker"){parent.closeCloudPicDialog()}}},false)}function setCookie(B,D,A){var C=new Date();if(A){C.setTime(C.getTime()+(A*24*3600*1000))}else{C.setTime(C.getTime()+(365*24*3600*1000))}document.cookie=B+"="+escape(D)+";expires="+C+";"}function getCookie(A){if(document.cookie.length>0){cookieBegin=document.cookie.indexOf(A+"=");if(cookieBegin!=-1){cookieBegin=cookieBegin+A.length+1;cookieEnd=document.cookie.indexOf(";",cookieBegin);if(cookieEnd==-1){cookieEnd=document.cookie.length}return unescape(document.cookie.substring(cookieBegin,cookieEnd))}}return""}function CRMLookupCallBack(){ZCForm.triggerExternalOnUser(ExternalFieldName)}function SDPODLookupCallBack(){ZCForm.triggerExternalOnUser(ExternalFieldName)}function gDocImportFile(C,B){var A=$("#gFormName");if($(A).attr("importOpen")=="true"){$("[name=GDOC_ID]").val(B);$("#gFormName").html(C);closeDialog();$(A).attr("importOpen",false)}else{ZCForm.googleDocAttachEvent(C,B)}}function closeGDocDialog(){var A=$("#gFormName");if($(A).attr("importOpen")=="true"){closeDialog();$(A).attr("importOpen",false)}else{ZCForm.closeDocsAttachTemplate()}}function selectedDocDetails(A,B){ZCForm.cloudDocAttachEvent(A,B);closeCloudPicDialog()}function closeCloudPicDialog(){$("#zc-gadgets_cloudpicker_div").remove();$("[isAttachOpen=true]:first").removeAttr("isAttachOpen")}function msieversion(){var B=window.navigator.userAgent;var A=B.indexOf("MSIE ");var C=B.indexOf("Edge");if(A>0||C>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)){return true}else{return false}}isViewBeta=false;var ZCForm=new function(){this.formArr=[];this.showFormVar="true";this.custParams="";this.onUserInputElem=new Array();this.editorRef=new Array();this.isEmbeddedForm="false";this.isPermaForm="false";this.inZohoCreator=true;this.zcFormAttributes=new Array();this.zcFormAttributes.formParentDiv=true;this.zcFormAttributes.customCalendar=false;this.zcFormAttributes.browseralert=false;this.zcFormAttributes.ajaxreload=true;this.zcFormAttributes.fieldContainer="tr";this.zcFormAttributes.eleErrTemplate="<tr tag='eleErr'><td width='100%' height='100%' valign='top' colspan='insertColSpan' class='zc-form-errormsg' > insertMessage </td></tr>";this.isSubFormFileSubmit=false;this.focusElement="";this.formLabelWidth="auto";this.isRecursiveCall=false;this.addToFormArr=function(B,A){B=B.substring(1,B.length-1);B=ZCUtil.getParamsAsMap(B,",","=");isViewBeta=ZCUtil.getFromMap(B,"isViewBeta")=="true";this.formLabelWidth=ZCUtil.getFromMap(B,"formLabelWidth");this.formArr[A]=B;if(isViewBeta){ZCApp.dialogAbove='<div class="zc-dialog-heading zc-dialog-noheading" elname="zc-dialogheader"><h1 elname="zc_dialog_header">&nbsp;</h1></div><div class="zc-dialogdiv zc-noappearance">'}};this.addNextUrlToFormArr=function(D,B){if(D&&D!=""){var A=ZCForm.formArr[B];A.zc_NextUrl=new Array();var C=A.zc_NextUrl;C[C.length]=D;ZCForm.formArr[B]=A}};this.callFormOnLoad=function(D,F,C,B,G){ZCForm.showFormVar="true";var A=false;if(D.length>4){D=D.substring(1,D.length-1);D=ZCUtil.getParamsAsMap(D,",","=");try{A=(B==ZCConstants.FORM_LOOKUP_ADD_FORM||B==ZCConstants.FORM_ALONE||B==ZCConstants.VIEW_ADD_FORM)?ZCUtil.getFromMap(D,ZCConstants.FORM_EVENT_ON_LOAD):false;A=(B==ZCConstants.VIEW_EDIT_FORM)?ZCUtil.getFromMap(D,ZCConstants.EDIT_FORM_EVENT_ON_LOAD):A}catch(E){}if(A){doActionOnLoad(F,ZCForm.getForm(C,B)[0],G)}else{ZCForm.enableForm(C,B)}}else{ZCForm.enableForm(C,B)}};this.enableForm=function(C,A,B){var D=ZCForm.getForm(C,A,B);if($(D).attr("formType")=="SubForm"||!this.zcFormAttributes.formParentDiv){$(D).css("visibility","visible");return false}ZCUtil.getParent(D,"div").css("visibility","visible");if(ZCApp.inZC){ZCForm.setFocus(D)}this.handleScreenResize(D)};this.handleScreenResize=function(B){if(isViewBeta){var C=B.find("table[elName=zc-fieldsTable]");if(ZCForm.formLabelWidth=="auto"){C.each(function(){var G=0;var F=$(this).find("tbody tr td[class=zc-labelheader]");F.find("label").each(function(){var H=$(this).outerWidth();if(H>G){G=H}});F.css("width",(G+10)+"px")})}var A=0;C.each(function(){A=A+$(this).width()});var D=B.find("table[elName=zc-submitTable]").find("span[elName=zc-formsubmitspan]");var E=(A-D.width())/2;D.css("padding-left",(E>0)?E:0)}};this.setFocus=function(C){var B=ZCForm.getFirstVisibleElement(C);if(B!=undefined&&B.attr("fieldtype")!=24){ZE_Init.needEditorFocus=false}if(B){var A=window.scrollX,D=window.scrollY;$(B).focus();window.scrollTo(A,D)}};this.getFirstVisibleElement=function(B){var A;$(B).find("table[elname=zc-fieldsTable]").find("tr").each(function(){var D=$(this).css("display");var C=$(this).parents("tr").css("display");if(D!="none"&&C!="none"){A=$(this).find(":input[type!=hidden]:eq(0)");if($(A).attr("name")!=null){return false}}});return A};this.getNextLookupPage=function(A,D,E){var B=ZCUtil.getFromMap(E,"compName");var C=$("div[zcSearchDDFieldName="+B+"]:first");$(C).html(A);ZCForm.regCustomLookUpEvents(C)};this.regCustomLookUpEvents=function(A){$(A).find("[elName=zcSearchDDListing] tr").click(function(){ZCForm.selectExternalModule(this)});$(A).find("[elName=zcSearchDDListing] tr").mouseover(function(){$(this).removeClass().addClass("custom_dropdown_menu_selected")});$(A).find("[elName=zcSearchDDListing] tr").mouseleave(function(){$(this).removeClass("custom_dropdown_menu_selected")});$(A).find("[elName=zc-zcDDPaginationEl]").click(function(C){ZCApp.hideAndStopPropogation(C);var B=$(this).parents("div[elName=zcDDPagination]:first");var E=$(B).attr("zcFormID");var J=$(B).attr("zcFormCompId");var K=$(this).attr("showList");var I=$(B).find("[startIndex]").attr("startIndex");var F=$(B).find("[startIndex]").attr("endIndex");var G=$(B).attr("zcsearchddfieldname");var D="formID="+E+"&formCompID="+J+"&startIndex="+I+"&endIndex="+F+"&reqPage="+K+"&compName="+G;var H="compName="+G;ZCUtil.sendRequest("/live/common/jsp/form/fields/getnextpagelist.jsp",D,"html","ZCForm.getNextLookupPage",ZCUtil.getParamsAsMap(H),i18n.pleasewait)});$(A).find("[elName=zcDropDownSelVal],[elName=zcDropDownImg]").click(function(C){var B=$(this).parents("[elName=zc-fieldtd]:first").find("[elName=zcDDPagination]:first").is(":visible");ZCApp.hideAndStopPropogation(C);$("[elName=zcDDPagination]").hide();if(!B){$(this).parents("[elName=zc-fieldtd]:first").find("[elName=zcDDPagination]:first").show()}else{$(this).parents("[elName=zc-fieldtd]:first").find("[elName=zcDDPagination]:first").hide()}})};this.selectExternalModule=function(G){var E=$(G).parents("[elName=zc-fieldtd]:first");$(E).find(":input[type=text]").val($(G).attr("elValue"));$(E).find("div[elName=zcDropDownSelVal]").html($(G).attr("elDispVal"));$(E).find("div[elName=zcDDPagination]").hide();var B=$(E).parents("form");var H=$(B).attr("name");var C=ZCForm.formArr[H];var A=ZCUtil.getFromMap(C,"formAccessType");var F=ZCUtil.getFromMap(C,"formID");var D=ZCForm.getForm(H,A);ZCForm.invokeOnChange($(E).find(":input[type=text]"),B,A)};this.setFieldValsFromURL=function(C,A){var G=location.href;if(C==ZCApp.currZCComp){var F=G.substr(G.lastIndexOf("/")+1);var B=F.indexOf("#");var D=F.indexOf("?");if(B!=-1&&D!=-1){if(B==0&&D!=-1){F=F.substr(D+1)}else{F=F.substring(0,B)+"&"+F.substr(D+1)}}var E=ZCUtil.getParamsAsMap(F);$.each(E,function(K,L){if(K.indexOf(".do?")!=-1){K=K.substring(K.indexOf(".do?")+4)}if(K.indexOf("?")!=-1){K=K.substring(K.indexOf("?")+1)}if(K!="sharedBy"&&K!="appLinkName"){for(var I=0;I<L.length;I++){L[I]=decodeURIComponent(L[I])}var J=ZCForm.getField(C,K,A);var H=J.attr("type");if(H!="searchLookupSingle"&&H!="searchLookupMulti"){ZCForm.setFieldValue(C,K,A,L)}}})}};this.showHideField=function(B,C,G,A){var F=C+"-"+G+"-"+A;var E=$("#"+F);if(E.length==0){var D=ZCForm.getField(C,G,A);if(ZCUtil.isNull(D)){D=$(ZCForm.getForm(C,A)).find("div[name=parentOf-"+G+"],span[name=parentOf-"+G+"]")}if(ZCUtil.isNull(D)){D=$(ZCForm.getForm(C,A)).find("td[elName="+G+"_label]")}E=ZCUtil.getParent(D,"tr");if(E==undefined){E=ZCUtil.getParent(D,"li")}}if($(D).is(":button")||$(D).is(":submit")||$(D).is(":reset")){E=D}if(E!=undefined){E.css("display",B?"":"none")}};this.enDisableField=function(J,M,I,Q){var F=ZCForm.getField(M,I,Q);var K=F.attr("type");var W=(K=="image"||K=="url")?F.find(":input"):F;if(K=="image"&&Q=="3"){F.find("a[enable=enable]").each(function(c,d){(J)?$(d).css("visibility","hidden"):$(d).css("visibility","visible")})}$.each(W,function(c,d){$(d).attr("disabled",J)});if(K=="radio"||K=="checkbox"||K=="select-one"||K=="select-multiple"){var S=(K=="radio"||K=="checkbox")?ZCUtil.getParent(F).parent():ZCUtil.getParent(F);var C=S.find("span");$.each(C,function(c,d){if($(d).attr("elname")=="zc-show-parent"){if(J){$(d).css("visibility","hidden")}else{$(d).css("visibility","visible")}}})}var B=(K=="radio"||K=="checkbox")?$("span[name=parentOf-"+(F).attr("name")+"]").parent():$(F).parent("div:first").parent();B.find("span[elname=zc-show-parent]").removeAttr("disabled","disabled");if(J){B.find("span[elname=zc-show-parent]").attr("disabled","disabled")}var b=$("#"+I).attr("modtype");if((b!==undefined)&&(b===ZCConstants.ZOHO_CRM_USERS)){$("#"+I).attr("disabled",J)}if(F.attr("fieldtype")==ZCConstants.FILE_UPLOAD){var T=F.attr("formCompID");$("a[id=zc-toggleupload-"+T+"]").css("visibility",J?"hidden":"visible")}if(F.attr("fieldtype")==ZCConstants.RICH_TEXT_AREA&&!ZCApp.isMobileSite){var a=F.attr("formcompid");var U="freezdiv_"+a;var Y=$("div[textareaname="+a+"]");var A=Y.attr("id");var N=ZCForm.editorRef[A];try{if(N){if(N.mode=="plaintext"){$(N._textarea).attr("disabled",J)}else{var V=N.iframe;var Z=J?"off":"on";if(!($.browser.msie)){N.doc.designMode=Z}else{var E=J?"false":"true";N.doc.body.contentEditable=E}}}}catch(L){}if(Y.find("#"+U)[0]){var H=Y.find("#"+U);var D={zIndex:J?50:-50};ZE_Init.tabKeyHandling=true;H.css(D)}else{if(J){var O=document.createElement("div");O.className="freezeLayer";O.id=U;var D={left:"0",top:"0",height:"100%",width:"100%",zIndex:50,background:"#AAAAAA",border:"1px solid #AAAAAA"};$(O).css(D);Y[0].appendChild(O)}}}if((F.attr("type")=="radio")||(F.attr("type")=="checkbox"&&F.attr("fieldtype")!=9)){var R=docid("opt-table-"+F.attr("formCompID"));F=$(R);if(J){ZCUtil.getParent(F).attr("status","disable")}else{ZCUtil.getParent(F).attr("status","enable")}}else{if(F.attr("delugeType")=="TIMESTAMP"){if(J){ZCUtil.getParent(F).find("a").css("visibility","hidden")}else{ZCUtil.getParent(F).find("a").css("visibility","visible")}}else{if(F.attr("subType")=="file"){var P=ZCForm.getFileUploadField(M,I,Q);(P).attr("disabled",J)}else{if(F.attr("disptype")=="popup"){var X=$(F).parents("[elname=zc-fieldtd]:first").find("[elname=zcDisableDiv]");if(J){$(X).show()}else{$(X).hide()}}else{if(K=="searchLookupSingle"||K=="searchLookupMulti"){if(J){$(F).parent("div:first").find("div[elName=srchDivEl]").css("display","none");$(F).css("background-color","#ebebe4");$(F).unbind()}else{$(F).css("background-color","");$(F).click(function(c){searchFactory.setVariables(this,false);searchFactory.triggerClickEvent(c)})}}else{if(K=="picklist"){if(J){$(F).css("background-color","#ebebe4")}else{$(F).css("background-color","")}if($(F).val()=="-otherVal-"){var G=$(F).parent("td").find('div[elname = "othersinput"]').find("input");$(G).attr("disabled",J)}}}}}}}};this.hideShowAddEntry=function(E,F,G,B){var D=$("body").find("div[name="+G+"]");var C=D.find("div[id="+G+"_addNewLine]");var A=D.find("table").find("tr[elname="+G+"_norecordrow]").find("span[class=add_value_link]");if(E){$(C).hide();$(A).hide()}else{$(C).show();$(A).show()}};this.hideShowDeleteEntry=function(B,C,D,A){$("body").find("div[name="+D+"]").find("table").find("tr[elname=dataRow]").each(function(){if(B){$(this).find("td:first").find("a").hide()}else{$(this).find("td:first").find("a").show()}})};this.addButtonStatus=function(C){var B=$("body").find("div[name="+C+"]");var A=B.find("div[id="+C+"_addNewLine]");return $(A).is(":visible")};this.deleteButtonStatus=function(A){return $("body").find("div[name="+A+"]").find("table").find("tr[elname=dataRow]:last").find("td:first").find("a").is(":visible")};this.clearField=function(C,I,H){var B=ZCForm.getField(C,I,H);var E;var G;if(B.attr("type")=="radio"||B.attr("type")=="checkbox"){G=$(B);E=docid("opt-table-"+B.attr("formCompID"));B=$(E).parent()}if($(B).attr("disptype")=="popup"){var F="-Select-";$(B).val(F);var A=$(B).parents("[elname=zc-fieldtd]:first");var D=$(A).find("[elname=zcDDPagination]");$(A).find("[elname=zcDropDownSelVal]:first").html(F);$(D).find("tr").each(function(){if($(this).attr("elValue")!=F){$(this).remove()}});ZCForm.invokeOnChange($(B).find(":input[type=text]"),mainForm,H)}else{if($(B).attr("type")=="searchLookupSingle"||$(B).attr("type")=="searchLookupMulti"){$(B).data("immutable",true);searchFactory.clearCache(I);$(B).find("li").remove();$(B).parent("div:first").find("div[elName=srchValDiv]").find("table").attr("issaturated","true");$(B).parent("div:first").find("div[elName=srchValDiv]").find("table").find("tr[value!=-Select-]").remove();if($(B).attr("type")=="searchLookupSingle"){var J=searchFactory.formatValueToShow($(B).parent("div:first").find("table").find("tr[value=-Select-]"),$(B).attr("name"),$(B).attr("type"),$(B).width());$(B).append(J)}else{$(B).find("span[elName=selectEl]").show()}}else{if(B.attr("type")=="radio"||B.attr("type")=="checkbox"){$(E).empty()}else{B.empty()}}}return B[0]};this.setFieldValue=function(G,E,P,H,N,K,Y,V,I){I=I==undefined?true:I;var C;if(K){if(Y!=-1){var a=(N!=null)?"[subformlabelname='"+N+"']":""}var S=(N!=null)?$(ZCForm.getForm(G,P)).find("div[name="+N+"]").attr("autoWidth"):"";C=$(ZCForm.getForm(G,P)).find("div[name="+N+"]").find(":input[name='"+E+"'],div[elName=srchDiv][labelName='"+E+"'][subformrow='"+Y+"']"+a+",input[rowLabelName='"+S+"_"+E+"_"+Y+"'], span[name='"+E+"'], div[name='"+E+"'], table[name='"+E+"'], div[elName=srchDiv][name='"+E+"'],div[elName=subformComposite][compositeName='"+E+"'], select[lblname='"+E+"']").not(":input[isSubformLookup='true']")}else{C=ZCForm.getField(G,E,P,N)}var J=C.attr("type");var X=(J=="image"||J=="url")?C.find(":input"):C;if(!newGenerateJsCodeEnabled&&H.constructor.toString().indexOf("Array")==-1){H=H.replace(new RegExp(ZCConstants.REPLACE_DQ_CHAR,"g"),'"')}var c=new Array();if(V!=undefined){if(V.constructor.toString().indexOf("Array")==-1){c.push(V)}else{c=V}}var L=ZCForm.formArr[G];var T=ZCUtil.getFromMap(L,"formID");if(!ZCForm.isAddToParentLookup&&J=="searchLookupMulti"){$(C).find("li").remove()}if(J=="searchLookupSingle"||(J=="searchLookupMulti"&&typeof (H)=="string")){if(J=="searchLookupSingle"&&H==""){H="-Select-"}var O="";if(typeof (H)=="object"){O=H[0].replace("'","")}else{O=H.replace("'","")}if($(C).find("li[selValue='"+O+"']").length==0){var Q=$(C).parent("div").find("div[elName=srchValDiv]").find("table").find("tr[value='"+O+"']");var F=!ZCUtil.isNull(K)?$(C).attr("name"):E;var B=searchFactory.formatValueToShow(Q,F,J,$(C).width(),H,c[0]);$(C).find("span[elName=selectEl]").hide();$(C).find("li").remove();$(C).append(B)}var R=$(C).attr("onChangeExists");var Z=$(C).attr("formCompId");if(I&&R=="true"&&P!=ZCConstants.VIEW_BULK_EDIT_FORM){ZCForm.showHideCog(C,"visible");if(K&&ZCForm.isAddToParentLookup){var Z=$(C).attr("subformCompId");var b=$(C).attr("formCompId");var M=$(C).attr("name");onChangeSubFormScript(ZCForm.getForm(G,P),T,Z,b,M,P)}else{onChangeScript(ZCForm.getForm(G,P),T,Z,P,true)}}}else{if(J=="searchLookupMulti"&&typeof (H)=="object"){var F=!ZCUtil.isNull(K)?$(C).attr("name"):E;for(var W=0;W<H.length;W++){var O=H[W].replace("'","");if($(C).find("li[selValue='"+O+"']").length==0){var Q=$(C).parent("div").find("div[elName=srchValDiv]").find("table").find("tr[value='"+O+"']");var B=searchFactory.formatValueToShow(Q,F,J,$(C).width(),H[W],c[W]);$(C).find("span[elName=selectEl]").hide();$(C).append(B)}}var R=$(C).attr("onChangeExists");var Z=$(C).attr("formCompId");if(R=="true"&&P!=ZCConstants.VIEW_BULK_EDIT_FORM){ZCForm.showHideCog(C,"visible");if(K&&ZCForm.isAddToParentLookup){var Z=$(C).attr("subformCompId");var b=$(C).attr("formCompId");var M=$(C).attr("name");onChangeSubFormScript(ZCForm.getForm(G,P),T,Z,b,M,P)}else{onChangeScript(ZCForm.getForm(G,P),T,Z,P,true)}}}}var U=false;var D=true;var A=true;$.each(X,function(s,m){if((J=="radio"||J=="checkbox")&&!ZCForm.isAddToParentLookup){$(m).removeAttr("checked")}if(J=="radio"&&$(m).val()==H){$(m).prop("checked","checked");D=false}else{if(J=="checkbox"){if(C.attr("delugetype")=="BOOLEAN"){if(H=="true"){$(m).prop("checked","checked")}else{$(m).removeAttr("checked")}}else{for(var p=0;p<H.length;p++){if($(m).val()==H[p]){U=true;$(m).prop("checked","checked")}}if(!U&&H.length==1&&H[0].indexOf(",")>0){var q=H[0].split(",");for(var p=0;p<q.length;p++){if($(m).val()==q[p]||$(m).val()==q[p].trim()){$(m).prop("checked","checked")}}}}}else{if(J=="plaintext"){var z=new ZSEC.HTMLPurifier({ALLOWED_STYLE:"ALL",STYLE_VALIDATION:false,FORCE_BODY:true});H=H?H.toString():"";$(m).html(z.sanitize(H))}else{if(J=="hidden"||J=="text"||J=="picklist"||J=="select-one"||J=="textarea"||J=="number"||J=="email"){if(H==""&&(J=="picklist"||J=="select-one")){$(m).val("-Select-");A=false}else{if($(m).attr("fieldtype")==ZCConstants.RICH_TEXT_AREA&&J=="textarea"){var y=$(m).attr("name");var v=$("div[nameoftextarea='"+y+"'][formLinkName='"+G+"']");if(N!=null){v=$(ZCForm.getForm(G,P)).find("div[name="+N+"]").find("div[nameoftextarea='"+E+"']")}var l=$(v).attr("id");if(l!=""&&ZCForm.editorRef[l]!=null){if(ZCForm.editorRef[l].state!=undefined&&ZCForm.editorRef[l].state=="loading"){setTimeout(function(){ZCForm.editorRef[l].doc.body.innerHTML=H},1000)}else{ZCForm.editorRef[l].doc.body.innerHTML=H}}else{if(l==undefined){$("textarea[name='"+y+"']").val(H)}}}else{$(m).val(H)}}if($(m).attr("disptype")=="popup"){var d=$(m).parents("[elname=zc-fieldtd]:first");var o=$(d).find("[elname=zcDDPagination] tr[elvalue='"+H+"']");if(o!=null){$(d).find("[elname=zcDropDownSelVal]:first").html(H)}}try{if(J=="picklist"||J=="select-one"){if(typeof (H)=="object"){var w=H[0].replace("'","");if($(m).find("option[value='"+w+"']").length!=0){A=false}}else{var n=$(C).children();$.each(n,function(){if($(this).val()==H){A=false;return false}})}}}catch(u){}}else{if(J=="select-multiple"||J=="multiselect"){if(!ZCForm.isAddToParentLookup){$(C.find("option")).removeAttr("selected")}for(var p=0;p<H.length;p++){var h=$(C.find("option[value='"+H[p]+"']"));if(h.length>0){U=true;h.prop("selected","selected")}}if(!U&&H.length==1&&H[0].indexOf(",")>0){var q=H[0].split(",");for(var p=0;p<q.length;p++){var h=$(C.find("option[value='"+q[p]+"']"));if(h.length>0){h.prop("selected","selected")}else{$(C.find("option[value='"+q[p].trim()+"']")).prop("selected","selected")}}}}else{if(J=="image"||J=="url"){if(newGenerateJsCodeEnabled){H=H?H:""}H=H.toString();var f=ZCUtil.getAttrsAsArr(H,J);setImageUrlValue(G,E,f,P)}}}}}}});if(J=="radio"){if(D&&H!=""){$.each(X,function(d,e){if($(e).val()=="-otherVal-"){$(e).prop("checked","checked");$(e).closest("table").siblings("div").find("input").val(H);$(e).closest("table").siblings("div").show()}})}else{$.each(X,function(d,e){$(e).closest("table").siblings("div").hide();$(e).closest("table").siblings("div").find("input").val("")})}}if(J=="picklist"||J=="select-one"){if(A){$.each(X,function(d,e){if($(e).find("option[value='-otherVal-']").length==1){$(e).val("-otherVal-")}else{$(e).val("-Select-")}$(e).siblings("div").find("input").val(H);$(e).siblings("div").show()})}else{$.each(X,function(d,e){$(e).siblings("div").hide();$(e).siblings("div").find("input").val("")})}}return C[0]};this.setSubFormValue=function(D,I,H,B,E,F,C,A,G){if(E==ZCConstants.SUB_FORM_GRID){return ZCForm.setFieldValue(D,I,H,B,C,A,G,F,false)}else{}};this.doActionOnInit=function(B,D,A){var C=ZCForm.getForm(B,A);onInitScript(C,$(C).find(":input[name=formid]").val(),D,A)};this.selectDeselect=function(H,O,N,B,G,J){var C=ZCForm.getField(H,O,N);var L=C.attr("type");if((L=="radio"||L=="picklist"||L=="select-one"||C.attr("disptype")=="popup")&&G){C=ZCForm.setFieldValue(H,O,N,B,null,false,null,J)}else{if(L=="multiselect"||L=="select-multiple"||L=="checkbox"){var K=false;var F=(L=="checkbox")?C:$(C).children();var D=null;$.each(F,function(){var R=(L=="checkbox")?$(this).prop("checked"):$(this).prop("selected");if(B.constructor.toString().indexOf("Array")==-1){B=B.replace(new RegExp(ZCConstants.REPLACE_DQ_CHAR,"g"),'"');B=B.replace(new RegExp(ZCConstants.REPLACE_NL_CHAR,"g"),"\n");if($(this).val()==B){(L=="checkbox")?$(this).prop("checked",G):$(this).prop("selected",G)}}else{if(jQuery.inArray(($(this).val()),B)!=-1){(L=="checkbox")?$(this).prop("checked",G):$(this).prop("selected",G)}}var Q=(L=="checkbox")?$(this).prop("checked"):$(this).prop("selected");if(R!=Q){K=true}D=(L=="checkbox")?$(this):$(C)});if(K){if(D!=null){fireOnChange(D)}}}else{if(!G){if(L=="radio"){$(C).removeAttr("checked")}else{if(L=="picklist"||L=="select-one"){$(C).val(G)}}}}}var A=new Array();if(J!=undefined){if(J.constructor.toString().indexOf("Array")==-1){A.push(J)}else{A=J}}if(L=="searchLookupSingle"||(L=="searchLookupMulti"&&typeof (B)=="string")){if(G){if($(C).find("li[selValue='"+B+"']").length==0){var M=$(C).parent("div").find("div[elName=srchValDiv]").find("table").find("tr[value='"+B+"']");var E=searchFactory.formatValueToShow(M,O,L,$(C).width(),B,A[0]);$(C).find("span[elName=selectEl]").hide();if(C.attr("fieldType")==ZCConstants.SINGLE_SELECT){$(C).find("li").remove()}$(C).append(E)}}else{$(C).find("li[selValue='"+B+"']").remove()}if($(C).find("li").length==0){if(L=="searchLookupSingle"){var P=searchFactory.formatValueToShow($(C).parent("div:first").find("table").find("tr[value=-Select-]"),$(C).attr("name"),L,$(C).width());$(C).append(P)}$(C).find("span[elName=selectEl]").show()}}else{if(L=="searchLookupMulti"&&typeof (B)=="object"){if(G){for(var I=0;I<B.length;I++){if($(C).find("li[selValue='"+B[I]+"']").length==0){var M=$(C).parent("div").find("div[elName=srchValDiv]").find("table").find("tr[value='"+B[I]+"']");var E=searchFactory.formatValueToShow(M,O,L,$(C).width(),B[I],A[I]);$(C).find("span[elName=selectEl]").hide();$(C).append(E)}}}else{for(var I=0;I<B.length;I++){$(C).find("li[selValue='"+B[I]+"']").remove()}}if($(C).find("li").length==0){$(C).find("span[elName=selectEl]").show()}}}};this.selectDeselectAll=function(D,J,I,C){var A=ZCForm.getField(D,J,I);var F=A.attr("type");if(F=="multiselect"||F=="select-multiple"){if(C){$(A).find("option:not(selected)").prop("selected",true)}else{$(A).find("option:selected").prop("selected",false)}}else{if(F=="checkbox"){$(A).prop("checked",C)}else{if(A.attr("disptype")=="popup"){ZCForm.setFieldValue(D,J,I,"-Select-")}else{if(F=="searchLookupMulti"){if(C){$(A).find("li").remove();var G=$(A).parent("div:first").find("div[elName=srchDivEl]").find("table").find("tr");for(var E=0;E<G.length;E++){var H=G[E];var B=searchFactory.formatValueToShow(H,J,F,$(A).width());$(A).find("span[elName=selectEl]").hide();$(A).append(B)}}else{$(A).find("li").remove();$(A).find("span[elName=selectEl]").show()}}}}}};this.useNewGetFieldApi=false;this.getField=function(C,E,A,B){if(ZCForm.useNewGetFieldApi){return ZCForm.getZCField(C,E,A,B)}var D=$(ZCForm.getForm(C,A,B)).find(":input[name='"+E+"'], span[name='"+E+"'], div[name='"+E+"'], table[name='"+E+"'], div[elName=srchDiv][name='"+E+"'],div[elName=subformComposite][compositeName='"+E+"']");if($(D).attr("type")=="searchLookupSingle"||$(D).attr("type")=="searchLookupMulti"){D=$(D).eq(0)}return D};this.getZCField=function(E,H,A,C){var F=ZCForm.getForm(E,A,C);var G=new Array();var D=F[0].elements[H];if(msieversion()&&(D instanceof HTMLCollection)){var B=new Array();for(x=0;x<D.length;x++){B.push(D[x])}D=B.length==0?undefined:B}if(D!==undefined){if(D instanceof NodeList){G=Array.prototype.slice.call(D)}else{G.push(D)}D=$(F).find("div[elName=srchDiv][name='"+H+"']")[0];if(D!==undefined){G=new Array();G.push(D)}if(msieversion()){if($(G[0]).attr("type")=="radio"||$(G[0]).attr("type")=="checkbox"){G=G[0]}}return $(G)}D=D===undefined?$(F).find("span[name='"+H+"']")[0]:D;D=D===undefined?$(F).find("div[name='"+H+"']")[0]:D;D=D===undefined?$(F).find("table[name='"+H+"']")[0]:D;D=D===undefined?$(F).find("div[elName=subformComposite][compositeName='"+H+"']")[0]:D;if(D!==undefined){G.push(D);return $(G)}return $(G)};this.getFileUploadField=function(B,C,A){return $(ZCForm.getForm(B,A)).find(":input[labelname='"+C+"'],span[name='"+C+"'],div[name='"+C+"'], table[name='"+C+"']")};this.getFormCont=function(C,A,B){if(ZCUtil.isNull(A)){A=ZCConstants.FORM_ALONE}if(ZCUtil.isNull(B)){return $("#"+C+"_"+A)}else{return $("#"+B+"_"+C+"_"+A)}};this.getForm=function(D,A,C){if(!this.zcFormAttributes.formParentDiv){return $("form[elName="+D+"]")}else{var B=ZCForm.getFormCont(D,A,C);if($(B).attr("formType")=="Form"){return $(B).find("form[elName="+D+"]")}else{return B}}};this.selectCustomDDValue=function(A,H,E,B,G){var D=document.getElementById(A+":"+H+"_"+B+"_comp");var F=$(D).parents("[elname=zc-fieldtd]:first");var C=$(F).find("[elname=zcDDPagination] tr[elvalue='"+E+"']");if(C!=null){$(F).find("[elname=zcDropDownSelVal]:first").html(E)}};this.hideFormMenus=function(A){if($(A)[0]){ZCUtil.hideMenu($(A)[0],$(A).find("div[elName=zc-formOptionsDIV]")[0]);$(A).find("div[elName=zc-moreactionsel]").find("a:first").removeClass("zc-viewheader-menus-moreicon")}};this.regCommonFormEvents=function(E,A,C){var B=ZCForm.getFormCont(E,A,C);var G=ZCForm.getForm(E,A,C);var F=$(B).find("div[elName=zc-moreactionsel]");$(F).click(function(J){$(F).find("a:first").addClass("zc-viewheader-menus-moreicon");var I=$(B).find("div[elName=zc-formOptionsDIV]")[0];ZCUtil.showDropDownMenu(this,I);$(I).css("top",$(I).position().top-1);ZCApp.hideAndStopPropogation(J)});var H={};$(B).find("a[elName=zc-toggleupload]").click(function(){var K=$(this).attr("enable");var J=$(this).attr("fileupname");ZCUtil.getParent(this)[0].style.display="none";var I=ZCUtil.getParent(this,"td");if(H[J]==undefined||H[J]==""){H[J]=$(I).find("input[subtype=file]").prop("value");$(I).find("input[subtype=file]").attr("value","")}else{$(I).find("input[subtype=file]").attr("value",H[J]);H[J]=""}var L=$(I).find(":input[name=uploadFile]");$(L).attr("changed",(K=="enable")?"changed":null);$(I).find("span[elName=zc-"+K+"upload],div[elName=zc-"+K+"upload]")[0].style.display=""});$(B).find("div[eleName=signature-field], div[eleName=signature-field-subform]").each(function(){var J=this;var M=$(J).attr("recordsequence");M=M!==undefined?M:"1";if(M!=="0"){try{var I=$(J).find("div[eleName=signature]");$(J).find("a[eleName=signatureClear]").click(function(){$(I).jSignature("reset")});$(I).jSignature({"decor-color":"transparent",height:"100",width:"300"});$(I).addClass("signature-div");var K=$(this).find("div[divName=signatureEle]");if($(K).attr("isHide")==="true"){$(K).hide()}$(J).find("a[eleName=zc-togglesignature]").click(function(){$(J).find("div[elName=editEle-signature]").hide();var N=$(J).find("div[divName=signatureEle]");$(N).show();$(N).find("div[eleName=signature]").attr("update","true")});$(J).find("a[elName=zc-togglesignature-restore]").click(function(){$(J).find("div[elName=editEle-signature]").show();var N=$(J).find("div[divName=signatureEle]");$(N).hide();$(N).find("div[eleName=signature]").attr("update","false")})}catch(L){}}});var D={};$(B).find("a[elName=zc-toggleimage]").click(function(){var K=$(this).attr("enable");var M=$(this).attr("imgname");ZCUtil.getParent(this)[0].style.display="none";var I=ZCUtil.getParent(this,"table");var N="";if(D[M]==undefined||D[M]==""){D[M]=$(I).find("input[subtype=image]").prop("value");$(I).find("input[subtype=image]").attr("value","")}else{$(I).find("input[subtype=image]").attr("value",D[M]);N=D[M];D[M]=""}var J=($(I).find("input[subname=zcimagetype]").attr("value")==undefined)?"input[subname=zcimagetype-"+M+"]":"input[subname=zcimagetype]";if(K=="enable"){$(I).find("tr[imagelocal=browselocal]").show();$(I).find("input[subtype=image]").attr("imagevalue","");$(I).find(J).attr("value","2")}else{$(I).find("tr[imagelocal=browselocal]").hide();$(I).find("input[subtype=image]").attr("imagevalue",N);$(I).find(J).attr("value","1")}if($(I).find("input[name=displayLinkImage]")[0]&&K=="enable"){$(I).find("input[subname=zcimagetype]").attr("value","2")}if($(I).find("input[name=displayLinkImage]")[0]&&K=="disable"){$(I).find("input[subname=zcimagetype]").attr("value","1")}var L=$(I).find(":input[name=uploadFile]");$(L).attr("changed",(K=="enable")?"changed":null);$(I).find("span[elName=zc-"+K+"upload],div[elName=zc-"+K+"upload]")[0].style.display=""});$(B).find("tr[elName=zc-showFormDialog],a[elName=zc-showFormDialog]").click(function(){var O=$(this).attr("dialogHTMLKey");if(ZCApp.htmlArr[E+"-"+O]==null){var M=$(B).find("div[elName='"+$(this).attr("dialogElName")+"']");ZCApp.htmlArr[E+"-"+O]=$(M).html();$(M).remove()}var L="";if(O=="embedDialogHtml"){L=",position=absolute,left=300"}ZCUtil.showInDialog(ZCApp.htmlArr[E+"-"+O],"closeButton=no, modal=yes"+L);if($(this).attr("dialogElName")=="zc-embed-dialog"||$(this).attr("dialogElName")=="zc-perma-dialog"){ZCForm.custParams="";var I=$("div[elName=zc-embed-dialog-div]");ZCApp.toggleLoginPrompt(B,I,E);ZCApp.setEmbedLink(B,I);var N=$(I).attr("embedurl");var K=N.substring(0,N.indexOf("height='")+8);var J=N.substr(N.indexOf("px")+2);N=K+($(B).find("table").attr("clientHeight")+200)+"px"+J;$(I).attr("embedurl",N);if($(this).attr("selectEl")=="zc-perma"){ZCForm.toggleEmbedTag($(I).find('td[comElName="zc-embed-crit-td"]')[1],"zc-javascript-code")}}});if(!this.zcFormAttributes.customCalendar){$(G).find(":input[fieldType="+ZCConstants.DATE+"], :input[fieldType="+ZCConstants.DATE_TIME+"]").each(function(){var J=$(this).attr("id");var K="dateButtonEl_"+J.substr(J.indexOf("_")+1);var M=($(this).attr("fieldType")==ZCConstants.DATE_TIME)?true:false;var L=M?ZCApp.dateFormat+" "+ZCConstants.TIME_FORMAT:ZCApp.dateFormat;var I=$(this).attr("workweek");ZCForm.setUpCalendar(J,K,L,M,I)})}};this.setEmbedLinks=function(A,B,C){C=ZCUtil.isNull(C)?"":C;var E=$(A).attr("embedurl");var D=$(A).attr("privateLink");if(ZCUtil.isNull(D)){D="";$(A).find("div[elName='zc-embedInfoDivDisable']").hide();$(A).find("div[elName='zc-embedInfoDivEnable']").show()}else{D=D+"/";$(A).find("div[elName='zc-embedInfoDivEnable']").hide();$(A).find("div[elName='zc-embedInfoDivDisable']").show()}$(A).find('textarea[elName="zc-embedSnippet"]').val(E+D+C+"'></iframe>")};this.showSubForm=function(C){var B="/showSubForm.do";var A=$(C).parents("td[elname = subformtd]:first").find("div[elname = subformdiv]");var G=$(C).attr("lblwidth");if(G!=null){G=G.replace("%","_")}var D=$(A).attr("parentFormName");var F=$(A).attr("subFormLinkName");var I=$(A).attr("subFormAppLinkName");var J=$(A).attr("dispType");var H=$(A).attr("name");var L=$(A).attr("formAccessType");var M=$(A).attr("formcompid");var E="sharedBy="+ZCApp.sharedByDisp+"&appLinkName="+I+"&formLinkName="+F+"&isSubform="+true+"&compType="+ZCConstants.FORM+"&formAccessType="+L+"&labelName="+H;var K=ZCUtil.getParamsAsMap("appLinkName="+I+"&formLinkName="+F+"&dispType="+J+"&parentFormName="+D+"&labelName="+H+"&formCompID="+M);ZCUtil.sendRequest(B,E,null,"ZCForm.loadSubForm",K)};this.cancelSubForm=function(D){var C="/showSubForm.do";var I=$(D).parents("div[elname = subFormContainer]:first");var E=$(I).attr("name");var F=$(I).attr("labelName");var B=$("div[name = "+F+"]");$(I).remove();$(B).attr("edit","");var G=$(B).parents("td[elname = subformtd]:first").find("a[elname=subFormLink]");var A="ZCForm.showSubForm(this);";$(G).attr("onClick",A);if($(B).attr("dispType")==ZCConstants.SUB_FORM_POPUP||$(I).attr("isEditRecord")=="true"){closeDialog()}var H=$(B).find("table[elname = subform_values]");if(parseInt($(H).attr("recCount"))==0){$(B).find("div[elname=no_records_div]").css("display","block")}else{$(B).find("div[elname=no_records_div]").css("display","none")}};this.loadSubForm=function(H,A,L){var I=ZCUtil.getFromMap(L,"dispType");var D=ZCUtil.getFromMap(L,"isSubformRecEdit");if(I==ZCConstants.SUB_FORM_POPUP||D=="true"){ZCForm.loadSubFormInDialog(H,A,L);return }var E=ZCUtil.getFromMap(L,"formLinkName");var B=ZCUtil.getFromMap(L,"parentFormName");var G=ZCForm.formArr[B];var C=ZCUtil.getFromMap(G,"formAccessType");var M=ZCUtil.getFromMap(A,"formAccessType");var F=ZCUtil.getFromMap(L,"labelName");var K=ZCForm.getField(B,F,C);$(K).find("div[elname=staticSubFormHolder]").html(H);ZCUtil.evalJS($(K).find("script").html());var J=$(K).parents("td[elname = subformtd]:first").find("a[elname=subFormLink]");$(J).attr("onClick","");$(K).find("div[elname=no_records_div]").css("display","none")};this.loadSubFormInDialog=function(E,F,G){ZCUtil.setInMap(G,"include","true");ZCApp.loadZCCompInDialog(E,F,G);var C=ZCUtil.getFromMap(G,"formLinkName");var A=ZCUtil.getFromMap(F,"formAccessType");var B=ZCForm.getForm(C,A);var D=$("div[subFormLinkName = "+C+"]")};this.triggerSubFormSubmit=function(B){var A=$(B).parents("div[elname = subFormContainer]:first");var C=$(A).find(":input[type=file]");if(C.length>0){ZCForm.uploadFilesAndSubmit(A,C,B,true);return false}else{ZCForm.submitSubForm(B)}};this.submitSubForm=function(B){var J=$(B).parents("div[elname = subFormContainer]:first");var F=$(J).attr("name");var G=$(J).attr("labelName");var A=$("div[name = "+G+"]");var I=$(A).attr("subFormAppLinkName");var C=$(A).attr("parentFormName");var D=$(A).attr("isNewTypeSubform");var H=$(A).attr("disptype");if(H==ZCConstants.SUB_FORM_POPUP){ZCForm.isSubFormFileSubmit=false}var L=ZCForm.formArr[F];var K=ZCUtil.getFromMap(L,"formAccessType");ZCForm.updateRichTextContent();var E="appLinkName="+I+"&formLinkName="+F+"&formAccessType="+K+"&";if(ZCUtil.isNull(ZCUtil.getFromMap(L,"onuserinput"))){ZCUtil.removeFromMap(L,"showfield");ZCUtil.removeFromMap(L,"autosubmit");E+=ZCUtil.getFieldsAsParams(J,":input[type!=reset][type!=submit][type!=button][type!=file]");ZCUtil.sendRequest("/validateSubForm.do",E,"json","ZCForm.handleSubFormResponse",ZCUtil.getParamsAsMap("formLinkName="+F+"&formAccessType="+K+"&parentFormName="+C+"&labelName="+G),i18n.pleasewait);return false}else{ZCUtil.removeFromMap(L,"showfield");ZCUtil.setInMap(L,"autosubmit","true");ZCForm.clearErrors(J);return false}};this.handleSubFormResponse=function(K,J,S){var T=ZCUtil.getFromMap(S,"labelName");var M=ZCUtil.getFromMap(S,"parentFormName");var F=ZCUtil.getFromMap(J,"formLinkName");var O=ZCForm.formArr[F];var N=ZCUtil.getFromMap(S,"formAccessType");var L=ZCUtil.getFromMap(S,"labelName");var U=ZCForm.getForm(F,N,L);var R=ZCUtil.getFromMap(O,"formID");var A=ZCForm.getMsgFromResponse(K,R);var I=ZCForm.getFieldsArrFromResponse(K,R);var G=A.succMsg;var C=A.errMsg;var Q=A.fieldErrObj;var D=A.infoMsg;var B=A.errorMsg;ZCForm.defreezeButton(U);ZCForm.clearErrors(U);var V=A.alertMsg;if(!ZCUtil.isNull(G)){if(relodCurrentForm=="true"){ZCForm.CreateSFTable(F,I,M,T,N);var H=$(U).find("input[name = reset]");if(N==ZCConstants.VIEW_EDIT_FORM){H=$(U).find("input[name = cancel]")}var P=$("#"+L+"_"+F);var E=$(P).attr("dispType");if(E==ZCConstants.SUB_FORM_POPUP||$(U).attr("isEditRecord")=="true"){$("div[elname = no_records_div]").css("display","none");closeDialog()}else{ZCForm.cancelSubForm(H)}}relodCurrentForm="true"}else{ZCApp.showFadingMsg(i18n.invalidmsg,0,5000);ZCForm.resetCaptcha(P);ZCForm.showErrors(F,N,null,null,Q,L);if(!ZCUtil.isNull(D)||!ZCUtil.isNull(B)){ZCForm.showInfo(D,G,F,N,B)}}};this.CreateSFTable=function(L,T,M,c,W){var l=ZCForm.formArr[M];var q=ZCUtil.getFromMap(l,"formAccessType");var Q=ZCForm.getForm(L,W);var B=$("div[id = "+c+"_"+L+"]");var G=$(B).find("table[elname=subform_values]");var m=0;var Y=$(G).find("tr")[1];var f=parseInt($(G).attr("recCount"));var F=parseInt($(B).attr("nextRecordSequence"))+1;var D=$(Y).clone();$(Y).append(ZCForm.createHiddenInputElement(c,F,"record::status","added",true));$(G).attr("recCount",f+1);$(B).attr("nextRecordSequence",F);if($(Y).css("display")=="none"){$(Y).css("display","")}for(m=1;m<T.length;m++){if(T[m]==null){continue}var C="";var E="";var V="";var d="";var A="";var J="";var h="";var X="";var e=false;var H=ZCUtil.getParamsAsMap(T[m]);var a=ZCUtil.getFromMap(H,"value");var S=ZCUtil.getFromMap(H,"labelName");var o=ZCUtil.getFromMap(H,"fieldName");var s=ZCUtil.getFromMap(H,"paramType");var N=ZCUtil.getFromMap(H,"fcType");if(N!=ZCConstants.PLAIN_TEXT&&N!=ZCConstants.SCRIPT){if($(G).attr("labelAdded")!="true"){var O=$(G).find("tr:first");var I=$(O).find("td:last");var Z=$(I).clone();$(I).attr("elname","labelCol");$(I).css("display","");$(I).attr("type",s);$(I).attr("label",S);$(I).attr("fcType",N);$(I).text(o);$(O).append(Z)}var R=$(Y).find("td:last");var p=$(R).clone();if(N==ZCConstants.URL){C=ZCUtil.getFromMap(H,"zcurl-"+S);E=ZCUtil.getFromMap(H,"zclnkname-"+S);V=ZCUtil.getFromMap(H,"zctitle-"+S);if(!ZCUtil.isNull(C)){a="URL : "+C;$(R).attr("urlvalue",C)}if(!ZCUtil.isNull(E)){a=a+"<br>Link : "+E;$(R).attr("linkvalue",E)}if(!ZCUtil.isNull(V)){a=a+"<br>Title : "+V;$(R).attr("titlevalue",V)}}if(N==ZCConstants.IMAGE){d=ZCUtil.getFromMap(H,"zcsource-"+S);J=ZCUtil.getFromMap(H,"zcfieldlink-"+S);A=ZCUtil.getFromMap(H,"zctitle-"+S);h=ZCUtil.getFromMap(H,"zcalttext-"+S);if(!ZCUtil.isNull(d)){a="Source : "+d;$(R).attr("imgSrc",d)}if(!ZCUtil.isNull(h)){a=a+"<br>Alt Text : "+h;$(R).attr("imgAltText",h)}if(!ZCUtil.isNull(J)){a=a+"<br>Link : "+J;$(R).attr("imgLink",J)}if(!ZCUtil.isNull(A)){a=a+"<br>Title : "+A;$(R).attr("imgTitle",A)}}else{if(N==ZCConstants.FILE_UPLOAD){if(a!=""){X=a.substring(a.indexOf("_")+1)}}else{if(N==ZCConstants.CHECK_BOX){if(a!=""){e=true;X="true"}else{e=false;X="false"}}}}$(R).attr("elname","valueCol");$(R).attr("label",S);$(R).attr("type",s);$(R).attr("fcType",N);$(R).css("display","");if((a==""||a==null||a=="-Select-")&&(N!=ZCConstants.CHECK_BOX)){$(R).html("&nbsp;")}else{if(N==ZCConstants.FILE_UPLOAD||N==ZCConstants.CHECK_BOX){$(R).html(X)}else{$(R).html(a)}}if(N==ZCConstants.URL){if(!ZCUtil.isNull(C)){$(R).append(ZCForm.createHiddenInputElement(c,F,"zcurl-"+S,C,true))}if(!ZCUtil.isNull(E)){$(R).append(ZCForm.createHiddenInputElement(c,F,"zclnkname-"+S,E,true))}if(!ZCUtil.isNull(V)){$(R).append(ZCForm.createHiddenInputElement(c,F,"zctitle-"+S,V,true))}}else{if(N==ZCConstants.IMAGE){if(!ZCUtil.isNull(d)){$(R).append(ZCForm.createHiddenInputElement(c,F,"zcsource-"+S,d,true))}if(!ZCUtil.isNull(J)){$(R).append(ZCForm.createHiddenInputElement(c,F,"zcfieldlink-"+S,J,true))}if(!ZCUtil.isNull(h)){$(R).append(ZCForm.createHiddenInputElement(c,F,"zcalttext-"+S,h,true))}if(!ZCUtil.isNull(A)){$(R).append(ZCForm.createHiddenInputElement(c,F,"zctitle-"+S,A,true))}}else{if(N==ZCConstants.MULTI_SELECT){var P=a.split(",");for(var K=0;K<P.length;K++){$(R).append(ZCForm.createHiddenInputElement(c,F,S,P[K],false))}}else{$(R).append(ZCForm.createHiddenInputElement(c,F,S,a,true))}}}$(R).attr("value",a);$(Y).append(p)}}if($(G).attr("labelAdded")!="true"){$(G).attr("labelAdded","true")}$(Y).attr("status","added");$(Y).attr("isTemp","false");$(D).css("display","none");if($(B).attr("edit")=="true"){var n=$(B).attr("rowInd");$(B).attr("edit","");var b=$(G).find("tr")[n];var U=$(b).attr("status");$(b).html($(Y).html());$(b).attr("status",U);$(Y).remove();$(G).attr("recCount",f)}$(G).find("tr:first").after(D);if($(G).css("display")=="none"){}$(G).css("display","");ZCForm.applyClass(G)};this.createHiddenInputElement=function(C,H,A,D,B){var G="";if(B){G="SV"}else{G="MV"}var F=document.createElement("input");$(F).attr("type","hidden");$(F).attr("value",D);var E="SF("+C+").FD(t::row_"+H+")."+G+"("+A+")";return $(F).attr("name",E)};this.applyClass=function(A){$.each($(A).find("tr[status!=deleted]"),function(B,C){if(B!=0&&(B%2)==0){$(C).attr("class","zc-subform-viewrow zc-row-1")}else{if(B!=0&&(B%2)!=0){$(C).attr("class","zc-subform-viewrow zc-row-2")}}})};this.EditSubFormRecord=function(B,D,F,O,C){var A="/showSubForm.do";var N=ZCForm.formArr[F];var P=ZCUtil.getFromMap(N,"formAccessType");var I=ZCForm.getField(F,O,P);var J=$(I).attr("formcompid");var H=ZCForm.formArr[D];var G=$(I).attr("formAccessType");var L=ZCForm.getForm(D,G);$(L).remove();var M=$(I).parents("td[elname = subformtd]:first").find("a[elname=subFormLink]");var R="ZCForm.showSubForm(this);";$(M).attr("onClick",R);var E=$(B).parents("table:first").find("tr").index($(B).parents("tr:first"));$(I).attr("edit","true");$(I).attr("rowInd",E);var Q="sharedBy="+ZCApp.sharedByDisp+"&appLinkName="+C+"&formLinkName="+D+"&parentFormName="+F+"&labelName="+O+"&compType="+ZCConstants.FORM+"&formCompID="+J+"&formAccessType="+ZCConstants.VIEW_EDIT_FORM+"&edit=true&rowIndex="+E+"&isSubform="+true+"&isSubformRecEdit="+true;$(B).parents("tr:first").find("td[elname=valueCol]").each(function(){var S=$(this).attr("label");var V=$(this).attr("value");if($(this).attr("fctype")==ZCConstants.CHECK_BOX){if(V!=""){V="true"}else{V="false"}}if($(this).attr("fctype")==ZCConstants.MULTI_SELECT){var U=V.split(",");for(var T=0;T<U.length;T++){Q+="&"+S+"="+U[T]}}else{if($(this).attr("fctype")==ZCConstants.URL){if(!ZCUtil.isNull($(this).attr("urlvalue"))){Q+="&zcurl-"+S+"="+$(this).attr("urlvalue")}if(!ZCUtil.isNull($(this).attr("linkvalue"))){Q+="&zclnkname-"+S+"="+$(this).attr("linkvalue")}if(!ZCUtil.isNull($(this).attr("titlevalue"))){Q+="&zctitle-"+S+"="+$(this).attr("titlevalue")}}else{if($(this).attr("fctype")==ZCConstants.IMAGE){if(!ZCUtil.isNull($(this).attr("imgSrc"))){Q+="&zcsource-"+S+"="+$(this).attr("imgSrc")}if(!ZCUtil.isNull($(this).attr("imgLink"))){Q+="&zcfieldlink-"+S+"="+$(this).attr("imgLink")}if(!ZCUtil.isNull($(this).attr("imgTitle"))){Q+="&zctitle-"+S+"="+$(this).attr("imgTitle")}if(!ZCUtil.isNull($(this).attr("imgAltText"))){Q+="&zcalttext-"+S+"="+$(this).attr("imgAltText")}Q+="&zcimagetype-"+S+"="+$(this).attr("zcimagetype")}else{Q+="&"+S+"="+V}}}});var K=ZCUtil.getParamsAsMap("appLinkName="+C+"&formLinkName="+D+"&dispType="+ZCConstants.SUB_FORM_POPUP+"&parentFormName="+F+"&labelName="+O+"&formCompID="+J+"&edit=true&rowIndex="+E);ZCUtil.sendRequest(A,Q,null,"ZCForm.loadSubForm",K)};this.DeleteSubFormRecord=function(C){var D=$(C).parents("tr:first");var A=$(D).parents("table[elname = subform_values]");$(A).attr("recCount",parseInt($(A).attr("recCount"))-1);if(parseInt($(A).attr("recCount"))==0){$(A).css("display","none");if($(A).parents("div[elname=subformdiv]").find("div[elname=subFormContainer]").css("visibility")!="visible"){$(A).parents("div[elname=subformdiv]").find("div[elname=no_records_div]").css("display","block")}}var B=$(D).attr("status");if(B=="added"){$(D).remove()}else{$(D).css("display","none");$(D).attr("status","deleted");$(D).find("input[elName=record_status]").attr("value","deleted")}ZCForm.applyClass(A)};this.resetSubForm=function(C){var B="/showSubForm.do";var O=$(C).parents("div[elname = subFormContainer]:first");var H=$(O).attr("name");var I=$(O).attr("labelName");var A=$("div[name = "+I+"]");var D=$(A).attr("parentFormName");var K=$(A).attr("subFormAppLinkName");var I=$(A).attr("name");var Q=ZCForm.formArr[H];var P=ZCUtil.getFromMap(Q,"formAccessType");var E=ZCUtil.getFromMap(Q,"subFormLabelName");var N=$("#"+E+"_"+H+"_"+P);$(A).find("div[elname=staticSubFormHolder]").css("visibility","hidden");$(N).remove();var J=$(A).parents("td[elname = subformtd]:first").find("a[elname=subFormLink]");var G=$(J).attr("lblwidth");if(G!=null){G=G.replace("%","_")}var L=$(A).attr("dispType");var F="sharedBy="+ZCApp.sharedByDisp+"&appLinkName="+K+"&formLinkName="+H+"&isSubform="+true+"&compType="+ZCConstants.FORM+"&formAccessType="+P+"&labelName="+E;var M=ZCUtil.getParamsAsMap("appLinkName="+K+"&formLinkName="+H+"&dispType="+L+"&parentFormName="+D+"&labelName="+I);if(L==ZCConstants.SUB_FORM_POPUP||$(O).attr("isEditRecord")=="true"){closeDialog();if($(O).attr("isEditRecord")=="true"){F+="&isSubformRecEdit="+true;ZCUtil.setInMap(M,"isSubformRecEdit","true")}}ZCUtil.sendRequest(B,F,null,"ZCForm.loadSubForm",M)};this.setPermaLinks=function(C,A){var B=$(C).attr("privateLink");if(!ZCUtil.isNull(B)){$("div[elName='zc-permaLinkDiv']").find("div[elName='zc-embedInfoDivEnable']").hide();$("div[elName='zc-permaLinkDiv']").find("div[elName='zc-embedInfoDivDisable']").show()}else{B="";$("div[elName='zc-permaLinkDiv']").find("div[elName='zc-embedInfoDivDisable']").hide();$("div[elName='zc-permaLinkDiv']").find("div[elName='zc-embedInfoDivEnable']").show()}$(C).find("textarea[elName=zc-textareaPermaDialog]").val($(C).attr("serverprefix")+"/"+ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/form-perma/"+A+"/"+B)};this.regBulkEditFormEvents=function(E,B){var D=ZCForm.getFormCont(E,B);var F=ZCForm.getForm(E,B);var C=[];var A=[];$(D).find(":input[fieldtype = "+ZCConstants.INLINE_SINGLE_SELECT+"]").change(function(){showOthersOption(this)});$.each($(D).find("select[elName=zc-formFieldSelectEl]").find("option[value!=-1]"),function(J,K){var I=$(K).attr("isBidirectOtherSideSingle");if(I=="true"){$(K).remove()}});$(D).find("select[elName=zc-formFieldSelectEl]").change(function(){var I=$(this).val();C[C.length]=I;ZCForm.showHideField(true,E,I,B);$(this)[0].options[0].innerHTML=i18n.selectcolumn;$(this)[0].options[$(this)[0].selectedIndex]=null});$(D).find("a[elName=zc-hideFormFieldEl]").click(function(){var I=$(this).attr("labelName");ZCUtil.removeFromArray(C,I);ZCForm.showHideField(false,E,I,B);ZCForm.getFormCont(E,B).find("select[elName=zc-formFieldSelectEl]").append($("<option value="+$(this).attr("labelName")+">").text($(this).attr("displayName")))});$.each($(F).find(":input[tagfor=formComp],div[tagfor=formComp],span[tagfor=formComp],div[elName=srchDiv]"),function(I,J){ZCUtil.getParent(J,"tr").attr("style","display:none")});$(F).find(":input[type=submit]").click(function(I){ZCForm.updateRichTextContent();return ZCForm.bulkEditRecords(E,B,C)});$(F).find("span[elname=zc-show-parent]").click(function(){ZCForm.showLookupForm(this)});ZCForm.regCustomLookUpEvents(F);ZCForm.showRichTextEditor(F);ZCForm.regMaskEvents(F);var H=ZCForm.formArr[E];var G=ZCUtil.getFromMap(H,"formID");searchFactory.regLookupSearchEvents(F,G,B)};this.adjustWidth=function(C){var B=ZCForm.getFormCont(C,ZCConstants.FORM_ALONE);var A=$(B).attr("formURL");var D=B.find("table[elName=zc-formTable]");if(A.indexOf("/showPermaForm.do")!=-1||A.indexOf("/liveFormHeader.do")!=-1){D.css("width","100%")}};this.isAddToParentLookup=false;this.childFormName=new Array();this.childAppName=new Array();this.childLabelName=new Array();this.lookupCount=1;this.findArrayLocation=function(D,C){var B=D.length;for(var A=0;A<B;A++){if(D[A]==C){return A}}return"-1"};this.setLookupCount=function(B){var A=ZCForm.findArrayLocation(ZCForm.childFormName,B);if(A!=-1){ZCForm.childFormName=ZCForm.childFormName.slice(0,A);ZCForm.childAppName=ZCForm.childAppName.slice(0,A);ZCForm.childLabelName=ZCForm.childLabelName.slice(0,A);ZCForm.lookupCount=A+1}};this.showLookupForm=function(B){if($("#wmstoolbar")!=null&&$("#wmstoolbar").attr("style")!=undefined){$("#wmstoolbar").css("z-index","")}if($(B).attr("disabled")=="disabled"){return false}var H=($(B).attr("isFromSubForm")=="true")?true:false;var K="";if(H){K=$(B).attr("parentFormName")}var F=$(B).attr("formLinkName");var Q=$(B).attr("viewLinkName");var G=$(B).attr("appLinkName");var P=$(B).attr("labelName");var L=$(B).attr("formAccessType");var S=$(B).attr("rowNo");S=ZCUtil.isNull(S)?-1:S;var U=$(B).attr("isNewTypeSubform");var A=$(B).attr("childSubformField");ZCForm.setLookupCount(F);ZCForm.childFormName[ZCForm.lookupCount-1]=F;ZCForm.childAppName[ZCForm.lookupCount-1]=G;ZCForm.childLabelName[ZCForm.lookupCount-1]=P;var J="";var C=ZCForm.childAppName.length;for(var O=1;O<=C;O++){J=J+"&zc_childformname_"+O+"="+ZCForm.childFormName[O-1]+"&zc_childappname_"+O+"="+ZCForm.childAppName[O-1]+"&zc_childlabelname_"+O+"="+ZCForm.childLabelName[O-1]}var T=$(B).attr("refFormCompName");var N=$(B).attr("formID");var M=$(B).attr("formCompID");var E=$(B).attr("dispType");if(!H){var I=$(B).parents("[elName="+F+"]").find(":input[name=privatelink]").val()}else{var I=$(B).parents("[elName="+K+"]").find(":input[name=privatelink]").val()}var D="/getRefFormDetails.do";var R="sharedBy="+ZCApp.sharedByDisp+"&appLinkName="+G+"&refFormID="+N+"&formLinkName="+F+"&formAccessType="+ZCConstants.FORM_LOOKUP_ADD_FORM+"&privateLink="+I+"&zc_lookupCount="+ZCForm.lookupCount+J;if(Q!==""){R=R+"&viewLinkName="+Q}if(U!==""){R=R+"&isNewTypeSubform="+U}ZCForm.lookupCount++;ZCUtil.sendRequest(D,R,"json","ZCForm.loadLookupForm",ZCUtil.getParamsAsMap("refFormCompName="+T+"&lookupFormCompID="+M+"&formAccessType="+L+"&formLinkName="+F+"&labelName="+P+"&refFormID="+N+"&privateLink="+I+"&isFromSubForm="+H+"&rowNo="+S+"&parentFormName="+K+"&isNewTypeSubform="+U+"&childSubformField="+A))};this.loadLookupForm=function(I,H,M){var G=ZCUtil.getFromMap(M,"isFromSubForm");var W=ZCUtil.getFromMap(M,"refFormCompName");var E="";var N="";var D="";if(G=="false"){D=ZCUtil.getFromMap(M,"formLinkName")}else{E=ZCUtil.getFromMap(H,"formLinkName");N=ZCUtil.getFromMap(H,"appLinkName");D=ZCUtil.getFromMap(M,"parentFormName")}var F=ZCUtil.getFromMap(M,"labelName");var L=ZCUtil.getFromMap(M,"formAccessType");var V=ZCUtil.getFromMap(M,"privateLink");var P=ZCUtil.getFromMap(M,"refFormID");var K=ZCUtil.parseJSONResponse(I);var S=K.refFormLinkName;var B=K.refAppLinkName;var G=ZCUtil.getFromMap(M,"isFromSubForm");var T=ZCUtil.getFromMap(M,"rowNo");var X=ZCUtil.getFromMap(M,"isNewTypeSubform");var A=ZCUtil.getFromMap(M,"childSubformField");var J="";var C=ZCForm.childAppName.length;var U=ZCForm.childAppName[C-1];for(var O=1;O<=C;O++){J=J+"&zc_childformname_"+O+"="+ZCForm.childFormName[O-1]+"&zc_childappname_"+O+"="+ZCForm.childAppName[O-1]+"&zc_childlabelname_"+O+"="+ZCForm.childLabelName[O-1]}if(!ZCUtil.isNull(S)&&!ZCUtil.isNull(B)){var R="sharedBy="+ZCApp.sharedByDisp+"&appLinkName="+B+"&compType="+ZCConstants.FORM+"&formLinkName="+S+"&formAccessType="+ZCConstants.FORM_LOOKUP_ADD_FORM+"&lookupFieldName="+W+"&childFormLinkName="+D+"&childFieldLabelName="+F+"&childFormAccessType="+L+"&childAppLinkName="+U+"&childFormPrivateLink="+V+"&zc_lookupCount="+(ZCForm.lookupCount-1)+J+"&isFromSubForm="+G+"&rowNo="+T+"&subFormLinkName="+E+"&subFormAppName="+N+"&isNewTypeSubform="+X+"&childSubformField="+A;if(isViewBeta){R=R+"&isNewAppearance=true"}var Q=ZCUtil.getFromMap(H,"viewLinkName");if(!ZCUtil.isNull(Q)){R=R+"&viewLinkName="+Q}ZCUtil.sendRequest(ZCApp.compProps["actionURL-"+ZCConstants.FORM],R,"html","ZCApp.loadZCCompInDialog",ZCUtil.getParamsAsMap("include=false&formAccessType="+ZCConstants.FORM_LOOKUP_ADD_FORM),i18n.pleasewait)}};this.regFormEvents=function(D,A,C){ZCForm.regCommonFormEvents(D,A,C);var B=ZCForm.getFormCont(D,A,C);var F=ZCForm.getForm(D,A,C);if(A==ZCConstants.VIEW_BULK_EDIT_FORM){ZCForm.regBulkEditFormEvents(D,A)}else{$(F).find("span[elname=zc-show-parent]").click(function(){ZCForm.showLookupForm(this)});$(F).find(":input[type=radio], :input[type=checkbox]").click(function(){var I=$(this).parents("div[elname=subformdiv]")[0];if(I){ZCForm.invokeOnChange(this,F,A,$(I).attr("formcompid"))}else{ZCForm.invokeOnChange(this,F,A)}});$(F).find(":input[type!=hidden][type!=reset][type!=submit][type!=button][type!=radio][type!=checkbox]").keyup(function(J){var I=this;if(!ZCUtil.isValueKeyPressed(J)){return false}if(window.RuleEvents!==undefined&&window.RuleEvents[$(F).attr("name")]!==undefined&&window.RuleEvents[$(F).attr("name")][$(I).attr("name")]!==undefined){window.RuleEvents[$(F).attr("name")][$(I).attr("name")]()}});$(F).find(":input[type!=hidden][type!=reset][type!=submit][type!=button][type!=radio][type!=checkbox]").change(function(){if($(this).attr("type")=="file"){$(this).attr("changed","changed")}var I=$(this).parents("div[elname=subformdiv]")[0];if(I){ZCForm.invokeOnChange(this,F,A,$(I).attr("formcompid"))}else{ZCForm.invokeOnChange(this,F,A)}});$(F).submit(function(I){ZCForm.updateRichTextContent();if(ZCForm.doSubmit(F)){ZCForm.freezeButton(F);if($(F).attr("formType")==ZCConstants.FORM_TYPE_OUTZC){return ZCForm.handleButtonOnClick(F,A,$(F).find(":input[type=submit]"))}else{if(!ZCForm.isSubFormFileSubmit){return ZCForm.triggerSubmit(F)}ZCForm.isSubFormFileSubmit=false}}else{return false}});$(F).find(":input[type=reset]").click(function(I){ZCForm.resetForm(D,A);var I=ZCForm.getForm(D,A);ZCForm.resetCaptcha(I)});$(F).find("#refreshCaptcha").click(function(I){var I=ZCForm.getForm(D,A);ZCForm.resetCaptcha(I)});$(F).find(":input[comElName=zc-extformbutton][type!=submit][type!=reset]").click(function(I){if(ZCForm.doSubmit(F)){ZCForm.freezeButton(F);return ZCForm.handleButtonOnClick(F,A,this)}});$(F).find(":input[elName=zc-cancelformbutton]").click(function(K){var I=$(F).find(":input[name=viewLinkName]").val();closeDialog();if(ZCApp.currURL.indexOf("zc_LoadIn=dialog")!=-1){window.location.href=ZCApp.prevURL;ZCApp.loadPage="false"}var J=ZCView.viewArr[I];if(ZCUtil.getFromMap(J,"viewType")==ZCConstants.VIEW_CALENDAR&&ZCView.currRecSumry){ZCUtil.showInDialog(ZCView.currRecSumry,"closeButton=no, closeOnBodyClick=yes, modal=yes")}});var H=ZCForm.formArr[D];var G=ZCUtil.getFromMap(H,"formID");searchFactory.regLookupSearchEvents(F,G,A);ZCForm.regCustomLookUpEvents(F);ZCForm.showRichTextEditor(F);ZCForm.regMaskEvents(F);ZCForm.fieldPermissionCheck(F);$(F).find("div[elName=subformdiv]").each(function(I,L){var M=$(L).attr("defRows");var K=$(L).find("tr[elName=dataRow][reclinkid!='t::row']").length;for(var J=0;J<M-K;J++){ZCForm.createNewSubFormRow($(L).find("a[elName=subFormLink]"),false)}if(K>0){$(L).find("tr[elName=dataRow][reclinkid!='t::row']").each(function(O,N){var Q=$(N).attr("reclinkid");var P=$(L).find("tr[reclinkid='"+Q+"']");$(P).find("div[elName=srchDiv]").each(function(S,R){if($(R).attr("readonlypermission")=="true"){$(R).parent("div:first").find("div[elName=srchDivEl]").css("display","none");$(R).css("background-color","#ebebe4");$(R).unbind()}});$(P).find("div[elName=zc-richtextarea]").each(function(a,U){var Y=$(U).attr("readonlypermission");if(Y){var S="freezdiv_"+$(U).attr("textareaname");var T=$(U).attr("id");U=$("div[id="+T+"]");var d=ZCForm.editorRef[T];try{if(d){if(d.mode=="plaintext"){$(d._textarea).attr("disabled",Y)}else{var e=d.iframe;var c=Y?"off":"on";if(!($.browser.msie)){d.doc.designMode=c}else{var W=Y?"false":"true";d.doc.body.contentEditable=W}}}}catch(b){}var R=$(U).find("#"+S);var X={zIndex:Y?50:-50};if($(U).find("#"+S)){R.css(X)}var Z=document.createElement("div");Z.className="freezeLayer";Z.id=S;var V={left:"0",top:"0",height:"100%",width:"100%",zIndex:50,background:"#AAAAAA",border:"1px solid #AAAAAA"};$(Z).css(V);$(U).css("position","relative");U[0].appendChild(Z)}})})}})}if(this.isEmbeddedForm=="true"||this.isPermaForm=="true"||A==ZCConstants.VIEW_ADD_FORM||A==ZCConstants.VIEW_EDIT_FORM||A==ZCConstants.FORM_LOOKUP_ADD_FORM||A==ZCConstants.FORM_ALONE){var E=ZCForm.getForm(D,A);E.find("td[elName=zc-formTableFix]").width("1px");this.handleScreenResize(E)}};this.regMaskEvents=function(A){};this.fieldPermissionCheck=function(E){var D=$(E).find("div[readonlyperm=true]").get();for(i=0;i<D.length;i++){var C=$(D[i]).attr("formlinkname");if(C===""){C=$(D[i]).attr("formLinkName")}var B=ZCForm.formArr[C];var A=ZCUtil.getFromMap(B,"formAccessType");var F=$(D[i]).attr("name");ZCForm.enDisableField(true,C,F,A)}};this.applyDefaultStylesToComponents=function(B,C,A){var C=JSON.parse(C);for(fieldName in C){for(attr in C[fieldName]){switch(attr){case"disabled":ZCForm.enDisableField(C[fieldName][attr],B,fieldName,A);break;case"display":ZCForm.showHideField(C[fieldName][attr]==="block",B,fieldName,A);break}}}};this.showRichTextEditor=function(H){var D=Math.floor(Math.random()*10000000);var J=$(H).find("div[elName=zc-richtextarea]").get();for(i=0;i<J.length;i++){D=D+1;divID=D+"";$(J[i]).attr("id",divID);var C=$(J[i]).attr("zc-editor-height");C=C.substring(0,C.length-2);var K=$(J[i]).attr("nameoftextarea");var A=$(H).find("textarea[name = '"+K+"']");var B=$(A).val();var I=$(A).attr("zc-rtetToolsJson");I=(ZCUtil.isNull(I)?"":JSON.parse(I));var E=$(A).attr("zc-rtetFontJson");E=(ZCUtil.isNull(E)?"":JSON.parse(E));var G=$(A).attr("zc-rtetFontFamilyJson");G=(ZCUtil.isNull(G)?"":JSON.parse(G));var F={id:divID,content:B,editorheight:C,toolbar:I,fontsize:E,fontfamily:G,fontFamilyDefinition:ZE_Init.FontFamilyDefinition};ZCForm.createRichTextEditor(divID,F)}};this.createRichTextEditor=function(A,B){try{B.allowAttrsInsertHTML=["target"];this.editorRef[A]=ZE.create(B);ZE_Init.loadFontCss(this.editorRef[A],fontscssPath);return true}catch(C){setTimeout(function(){ZCForm.createRichTextEditor(A,B)},1000)}};this.updateRichTextContent=function(){var C=$("div[elName=zc-richtextarea]").get();for(i=0;i<C.length;i++){divID=$(C[i]).attr("Id");var A=$(C[i]).attr("nameoftextarea");var B=this.editorRef[divID].getContent();var D=$("textarea[name='"+A+"']");$(D).val(B)}};this.doSubmit=function(A){var B=$(A).attr("freezeTime");if(!ZCUtil.isNull(B)&&((new Date()-new Date(B))<5000)){return false}$(A).removeAttr("freezeTime");return true};this.freezeButton=function(A){$(A).attr("freezeTime",new Date())};this.defreezeButton=function(A){$(A).removeAttr("freezeTime")};this.clearFieldEleError=function(C,B){if(B){$('tr[errEleFormCompName="'+C.attr("name")+'"]').remove()}else{var A=C.closest("tr").next("tr");if(A&&A.size()>0&&A.attr("tag")==="eleErr"){A.remove()}}};this.invokeOnChange=function(B,G,I,F){if(window.RuleEvents!==undefined&&window.RuleEvents[$(G).attr("name")]!==undefined&&window.RuleEvents[$(G).attr("name")][$(B).attr("name")]!==undefined){window.RuleEvents[$(G).attr("name")][$(B).attr("name")]()}var J=$(B);var C=J.attr("fieldtype");if(C==29){showOthersOption(J)}if(J.attr("type")==="text"&&(J.attr("delugetype")==="BIGINT"||J.attr("delugetype")==="DECIMAL")){this.clearFieldEleError(J,F);var H=J.prop("value");var K=J.attr("delugetype")==="BIGINT"?/^(\+|-)?[0-9]+$/:/^(\+|-)?[0-9]*(\.?[0-9]+)?$/;if(H!==""&&!(K.test(H))){var D=i18n["zc.formval.entervalidnumber"];var E=J.attr("formcompid");var A=F?$("th[formcompid='"+E+"']").attr("labelname"):J.closest("tr").find("label").html();D=D.replace("null",A);ZCForm.showFieldErr(B,D);setTimeout(function(){J.focus()},10);return }}if($(B).attr("onChangeExists")){ZCForm.showHideCog(B,"visible");if(F){var A=$(B).attr("name");if($(B).attr("type")=="file"){A=$(B).siblings("input[type=hidden]").attr("name")}onChangeSubFormScript(G,$(G).find(":input[name=formid]").val(),F,$(B).attr("formCompID"),A,I)}else{onChangeScript(G,$(G).find(":input[name=formid]").val(),$(B).attr("formCompID"),I)}}if($(B).attr("isFormulaExist")=="true"){ZCForm.showHideCog(B,"visible");if(F){executeFormulaforSubForm(G,$(G).find(":input[name=formid]").val(),F,$(B).attr("formCompID"),$(B).attr("name"),I)}else{executeFormula(G,$(G).find(":input[name=formid]").val(),$(B).attr("formCompID"))}}};this.invokeGridRowAction=function(D,F,E,C,B){if((C==="onaddrow"&&D.attr("onaddrowexist"))||(C==="ondeleterow"&&D.attr("ondeleterowexist"))){var A="SF("+$(D).attr("name")+").FD("+E+").SV(ID)";ZCForm.showHideCog(D.find("a[labelname='"+A+"']"),"visible",true);subFormRowAction(F,$(F).find(":input[name=formid]").val(),$(D).attr("formCompID"),$(D).attr("name"),E,C,B);return true}};this.handleButtonOnClick=function(E,B,A){ZCForm.updateRichTextContent();if($(A).attr("eventType")){var D=$(E).find(":input[name=formLinkName]").val();var C=ZCForm.formArr[D];if(ZCUtil.isNull(ZCUtil.getFromMap(C,"onuserinput"))){ZCUtil.removeFromMap(C,"fieldchange");ZCUtil.removeFromMap(C,"autosubmit");ZCUtil.removeFromMap(C,"buttonelem");submitExtForm(E,B,$(A).attr("buttonID"),$(A).attr("eventType"))}else{ZCUtil.removeFromMap(C,"fieldchange");ZCUtil.setInMap(C,"autosubmit","true");ZCUtil.setInMap(C,"buttonelem",A);ZCForm.clearErrors(E)}}return false};this.bulkEditRecords=function(F,H,B){var C=ZCForm.getForm(F,H);var E=$(C).find(":input[name=viewLinkName]").val();var A=ZCView.viewArr[E];var D=ZCUtil.getFromMap(A,"updateIdList").split(",").length-1;var G=new Array();G[0]=D;var I=replaceParams(i18n.bulkEditMsg,G);if(B==""||B==undefined||B==null){ZCView.showAlertPopUp(i18n["zc.viewlive.selectatleastonefield"]);return false}ZCView.showConfirmPopUp(I,function(){var M="addviewid="+ZCUtil.getFromMap(A,"viewID")+"&tableName="+ZCUtil.getFromMap(A,"tableName")+"&formid="+ZCUtil.getFromMap(A,"viewFormID")+"&updateIdList="+ZCUtil.getFromMap(A,"updateIdList")+"&privateLink="+ZCUtil.getFromMap(A,"privateLink");M=M+"&dateFormat="+$(C).find(":input[name=dateFormat]").val()+"&timeZone="+$(C).find(":input[name=timeZone]").val()+"&viewLinkName="+E;var J=$(C).find(":input[name*=othersVal]");$.each(J,function(N,O){M=M+"&"+O.name+"="+O.value});$.each(B,function(O,T){var R="";var S=$(C).find(":input[name="+T+"],div[name="+T+"]");var N=S.attr("type");if(N=="url"||N=="image"||N=="radio"||(N=="checkbox"&&$(C).find("span[name=parentOf-"+T+"]")[0])){if(N=="checkbox"||N=="radio"){S=$(C).find("span[name=parentOf-"+T+"],div[name=parentOf-"+T+"]")}$.each($(S).find(":input"),function(V,U){if((N=="radio"&&$(U).attr("type")==="text")||($(U).attr("type")=="radio"&&!$(U).prop("checked"))||(N=="checkbox"&&!$(U).prop("checked"))){return }R=R+"&"+$(U).attr("name")+"="+encodeURIComponent($(U).val())})}else{if(N=="checkbox"&&$(S).prop("checked")){checkboxVal=$(S).is(":checked")?"zc_checked":"zc_unchecked";R=R+"&"+T+"="+checkboxVal}else{if(N=="searchLookupSingle"||N=="searchLookupMulti"){$.each($(S).find("input"),function(U,V){R=R+"&"+T+"="+encodeURIComponent($(V).val())})}else{if(N==="composite"){$.each($(S).find(":input"),function(V,U){R=R+"&"+$(this).attr("name")+"="+$(this).val()});R=R+"&CF("+$(S).attr("name")+").SV(status)=edit"}else{if(N=="select-multiple"||N=="multiselect"){var Q=ZCUtil.getFieldValue(S);if(!ZCUtil.isNull(Q)){$.each(Q,function(U,V){if(!ZCUtil.isNull(V)){R=R+"&"+T+"="+encodeURIComponent(V)}})}}else{if(S.attr("fieldtype")==25){var P=$(C).find(":input[name="+T+"_ID],div[name="+T+"_ID]");R=R+"&"+T+"="+encodeURIComponent(ZCUtil.getFieldValue(S));R=R+"&"+T+"_ID="+encodeURIComponent(ZCUtil.getFieldValue(P));B[B.length]=T+"_ID"}else{if($(S).length>1){$.each(S,function(U,V){R=R+"&"+$(V).attr("name")+"="+encodeURIComponent($(V).val())})}else{R=R+"&"+T+"="+encodeURIComponent(ZCUtil.getFieldValue(S))}}}}}}}M=M+R});var L=ZCUtil.getFromMap(A,"linkedView");if(!ZCUtil.isNull(L)){M=M+"&linkedView="+L}M=M+"&"+ZCUtil.getParamsFromArray(B,"SelLabel");var K="/editbulkrecord.do";ZCUtil.sendRequest(K,M,"json","ZCForm.handleBulkEditResponse",ZCUtil.getParamsAsMap("viewLinkName="+E+"&formLinkName="+F+"&formAccessType="+H+"&fid="+ZCUtil.getFromMap(A,"viewFormID")),i18n.pleasewait);return false});return false};this.windowScrollTop;this.offsetTop;this.getParamsFromIfrme=function(){var B=document.location.hash;if(B.length>1){B=B.substr(1);var A=ZCForm.parseIframeParameters(B);if((A.windowScrollTop!=null)&&(A.offsetTop!=null)){ZCForm.windowScrollTop=A.windowScrollTop;ZCForm.offsetTop=A.offsetTop}}};this.parseIframeParameters=function(B){var E=new Array();var C=B.split(/&/);for(var A in C){var D=C[A].split(/=/);E[D[0]]=D[1]}return E};this.triggerSubmit=function(D){ZCApp.setLoadingMsg($("#zc-loading"),i18n.pleasewait+" ...");var B=$("#zc-loading");var A=B.find("[loading=true]");if(A.length==0){A=B.find("[loading=false]")}A.attr("loading","true");ZCApp.showLoading("zc-loading");ZCForm.clearErrors(D);var C=$(D).find(":input[type=file]");if(C.length>0){return ZCForm.uploadFilesAndSubmit(D,C)}else{return ZCForm.submitForm(D)}};this.resetForm=function(D,K){var M=ZCForm.formArr[D];if(ZCUtil.getFromMap(M,"zc_LoadIn")=="dialog"){ZCApp.reloadZCComp(D)}else{if(K==ZCConstants.VIEW_ADD_FORM){closeDialog();var R=ZCUtil.getFromMap(M,"viewLinkName");var H=ZCUtil.getFromMap(M,"dateJsonObject");if(!ZCUtil.isNull(H)){H=H.replace(new RegExp("#zc_comma#","g"),",");H=H.replace(new RegExp("&#034,","g"),'"')}ZCView.showAddForm(ZCView.getViewCont(R).find("a[elName=zc-showAddFormEl]"),R,H)}else{if(K==ZCConstants.FORM_LOOKUP_ADD_FORM){var T=ZCForm.getForm(D,K);var A=$(T).find(":input[type=reset]");var V=$(T).find(":input[name=lookupFieldName]").val();var C=$(T).find(":input[name=childFormLinkName]").val();var E=$(T).find(":input[name=childFieldLabelName]").val();var N=$(T).find(":input[name=childFormAccessType]").val();var U=$(T).find(":input[name=childFormPrivateLink]").val();var G=$(T).find(":input[name=childAppLinkName]").val();var I=($(T).find(":input[name=isFromSubForm]").val()=="true")?true:false;var F=$(T).find(":input[name=appLinkName]").val();var J="";var B=ZCForm.childAppName.length;for(var P=1;P<=B;P++){J=J+"&zc_childformname_"+P+"="+ZCForm.childFormName[P-1]+"&zc_childappname_"+P+"="+ZCForm.childAppName[P-1]+"&zc_childlabelname_"+P+"="+ZCForm.childLabelName[P-1]}var S="sharedBy="+ZCApp.sharedByDisp+"&appLinkName="+F+"&compType="+ZCConstants.FORM+"&formLinkName="+D+"&formAccessType="+ZCConstants.FORM_LOOKUP_ADD_FORM+"&lookupFieldName="+V+"&childFormLinkName="+C+"&childFieldLabelName="+E+"&childFormAccessType="+N+"&childAppLinkName="+G+"&childFormPrivateLink="+U+"&zc_lookupCount="+ZCForm.lookupCount+J+"&isFromSubForm="+I+"&isNewAppearance=true";ZCUtil.sendRequest(ZCApp.compProps["actionURL-"+ZCConstants.FORM],S,"html","ZCApp.loadZCCompInDialog",ZCUtil.getParamsAsMap("include = false & closedialog = true & formAccessType ="+ZCConstants.FORM_LOOKUP_ADD_FORM),i18n.pleasewait)}else{if(ZCUtil.getFromMap(M,"client")=="changed"){ZCUtil.setInMap(M,"client","reset");ZCForm.showForm(D,K);var T=ZCForm.getForm(D,K)}var O=document.getElementsByTagName("iframe");var L=O.length;for(var P=0;P<L;P++){if(O[P].className==="ze_area"){O[P].contentWindow.document.body.innerHTML=""}}var Q=ZCForm.getForm(D,K);$(Q).find("input[type=file]").each(function(){ZCForm.removeUploadedFile($(this))});$(Q).find("div[elName=zcDropDownSelVal]").each(function(){$(this).attr("elValue","-Select-");$(this).html("-Select-")});$(Q).find("div[elName=srchDiv]").each(function(){$(this).find("li").remove();if($(this).attr("type")=="searchLookupSingle"){var W=searchFactory.formatValueToShow($(this).parent("div:first").find("table").find("tr[value=-Select-]"),$(this).attr("name"),$(this).attr("type"),$(this).width());$(this).append(W)}else{$(this).find("span[elName=selectEl]").show()}});$(T).find("table[elname=subform_values]").each(function(){$(this).find("tr").each(function(W,X){if(W<=1){$(X).find("td[elname!=delCol][elname!=editCol][elname!=template]").each(function(){$(this).remove()})}else{$(X).remove()}});$(this).css("display","none");$(this).attr("labelAdded","");$(this).attr("reccount","0")});return false}}}};this.clearEmptyFiles=function(B,A){A=A.substring(1,A.length-1);A=ZCUtil.getParamsAsMap(A,",","=");$(B).find(":input[type=file][changed='changed']").each(function(){var D=$(this).attr("labelName");var C=ZCUtil.getFromMap(A,D);if(ZCUtil.isNull(C)){$(B).find("input[subType=file][name="+D+"]").each(function(){$(this).attr("value","")})}})};this.submitForm=function(A){var D=$(A).find(":input[name=formLinkName]").val();var I=$(A).find(":input[name=recType]").val();var F=document.activeElement;var G=$(F).parents("div[class=zc-formcontainer]:first");var K=$(A).find("div[eleName=signature]");$.each(K,function(S,O){var Q=$(O).attr("isEdit");var U="add";var P="true";if(Q==="true"){U="update";P=$(O).attr("update");P=P===undefined?true:P}if(P==="true"){try{var V=$(O).jSignature("getData","base30");if(V!=undefined){var N=V[1].length;if(N>0){var R=$(O).jSignature("getData","image");var M=U+","+R[1];var L=$(O).parent();$(L).find("textarea[elename=signatureText]").val(M)}else{if(Q){var L=$(O).parent();$(L).find("textarea[elename=signatureText]").val("")}}}}catch(T){}}});if($(G).attr("formType")=="SubForm"){var J=$(G).attr("name");var B=$(G).parents("div[elname=subformdiv]").attr("name");ZCForm.submitSubForm(J,D,B);return false}var H=ZCForm.formArr[D];if(ZCUtil.isNull(ZCUtil.getFromMap(H,"onuserinput"))){ZCUtil.removeFromMap(H,"fieldchange");ZCUtil.removeFromMap(H,"autosubmit");$(A).find("div[elName=zc-fileuploadtemplate]").html("");var C=ZCUtil.getFieldsAsParams(A,":input[type!=reset][type!=submit][type!=button][type!=file]",D,I);var E=ZCUtil.getFromMap(H,"linkedView");if(!ZCUtil.isNull(E)){C+="&linkedView="+E}C+="&hasSubForm="+ZCUtil.getFromMap(H,"hasSubForm");C+="&formBasedOperation="+ZCUtil.getFromMap(H,"formBasedOperation");ZCUtil.sendRequest($(A).attr("action"),C,"json","ZCForm.handleResponse",ZCUtil.getParamsAsMap("formLinkName="+D+"&formAccessType="+I),i18n.pleasewait);return false}else{ZCUtil.removeFromMap(H,"fieldchange");ZCUtil.setInMap(H,"autosubmit","true");ZCForm.clearErrors(A);return false}};this.uploadFilesAndSubmit=function(A,H,D,G){var E="";var I=ZCUtil.getParent(A,"div").find("div[elName=zc-fileuploadtemplate]:first");var B=I.find("form")[0];$(B).find("[name='"+ZCApp.csrfParamName+"']").val(ZCApp.csrfParamValue);if(ZCApp.sharedByDisp!=undefined){B.sharedBy.value=ZCApp.sharedByDisp}var C=$(A).find(":input[subType=image]");$.each(C,function(K,L){var M=$(L).prop("value");var J=$(L).attr("imagevalue");if(M==""&&J!=""&&J!=null){$(L).val(J)}});var F=new RegExp("^[^/\\<>*%$]{0,255}$");$.each(H,function(J,K){var L=K.value.split("\\").pop();if(!F.test(L)){E="invalidfilename";ZCForm.showFieldErr(K,i18n["zc.uploadfile.invalidname"])}});if(E=="invalidfilename"){$(A).removeAttr("freezeTime");ZCApp.hideLoading("zc-loading");return false}$.each(H,function(K,L){var N=$(L).attr("changed");if(N&&N=="changed"){E="submit";if($(L).attr("zc-Attached-Type")=="browse"){$(L).next().hide();$(L).after($(L).clone()[0]);$(L).attr("name",$(L).attr("labelName"));$(B).append(L)}else{if($(L).attr("zc-Attached-Type")=="cloud"){var J=document.createElement("input");$(J).attr("type","hidden");$(J).attr("name","cloudDocAttachments");$(J).attr("value",$(L).attr("labelName"));$(B).append(J);var M=document.createElement("input");$(M).attr("type","hidden");$(M).attr("name",$(L).attr("labelName"));$(M).attr("value",$(L).attr("zc-DocId"));$(B).append(M)}else{if($(L).attr("zc-Attached-Type")=="google"){var J=document.createElement("input");$(J).attr("type","hidden");$(J).attr("name","gDocAttachments");$(J).attr("value",$(L).attr("labelName"));$(B).append(J);var M=document.createElement("input");$(M).attr("type","hidden");$(M).attr("name",$(L).attr("labelName"));$(M).attr("value",$(L).attr("zc-DocId"));$(B).append(M)}else{if($(L).attr("zc-Attached-Type")=="zoho"){var J=document.createElement("input");$(J).attr("type","hidden");$(J).attr("name","zDocAttachments");$(J).attr("value",$(L).attr("labelName"));$(B).append(J);var M=document.createElement("input");$(M).attr("type","hidden");$(M).attr("name",$(L).attr("labelName"));$(M).attr("value",$(L).attr("zc-DocId"));$(B).append(M)}}}}$(B).find("input[name='"+$(L).attr("name")+"']").removeAttr("disabled")}});if(E=="submit"){if(G==true){ZCForm.isSubFormFileSubmit=true}else{ZCForm.isSubFormFileSubmit=false}$(B).submit()}else{if(G!=true){return ZCForm.submitForm(A)}else{return ZCForm.submitSubForm(D)}}return false};this.clearimagevalue=function(E,D){var A=$(E).parents("[elName=zc-fieldtd]:first");var C=$(A).find("input[name="+D+"]").val();$(A).find("input[name="+D+"]").attr("imagevalue",C);var B=$(A).find("input[subname="+D+"]").val();$(A).find("input[subname="+D+"]").attr("imagevalue",B)};this.clearUploadForm=function(C){var A=ZCUtil.getParent(C,"div").find("div[elName=zc-fileuploadtemplate]");var B=A.find("form");$(B).find(":input").remove("[type=file]")};this.revertUpload=function(C){var A=ZCUtil.getParent(C,"div").find("div[elName=zc-fileuploadtemplate]");var B=A.find("form");$.each($(C).find(":input[type=file]"),function(D,E){$(E).attr("name","uploadFile")});$.each((B).find("input[name=gDocAttachments]"),function(D,E){var F=$(B).find("input[name=gDocAttachments]").prop("value");$(B).find("input[name=gDocAttachments]").remove();$(B).find("input[name="+F+"]").remove()});$.each((B).find("input[name=zDocAttachments]"),function(D,E){var F=$(B).find("input[name=zDocAttachments]").prop("value");$(B).find("input[name=zDocAttachments]").remove();$(B).find("input[name="+F+"]").remove()});ZCForm.clearUploadForm(C);ZCApp.hideLoading("zc-loading")};this.setUpCalendar=function(C,F,E,B,A){var D=new Array();if(A!=undefined&&A!=""){D=A.split(",")}Calendar.setup({inputField:C,ifFormat:E,showsTime:B,button:F,onUpdate:ZCForm.triggerOnChange})};this.triggerOnChange=function(B){var A=B.params.inputField;$(A).change()};this.checkAndAppend=function(C,E,B,A){var D=$(C).find(":input[name="+E+"]");if(D.get(0)){D.attr("value",B)}else{$(ZCUtil.createElem("input","type=hidden,name="+E+",value="+B,"")).insertAfter($(A))}return C};this.getFieldsArrFromResponse=function(H,F){var K=new Array();if(typeof (H)=="object"){for(var C in H){var J=H[C];if(typeof (J)=="object"){for(var B in J){var G=J[B];if(typeof (G)=="object"){var I="";var D="";for(var E in G){var A=G[E];if(E=="seq"){I=A}D=D+E+"="+A+"&"}if(I!=""){K[I]=D}}}}}}return K};this.getMsgFromResponse=function(F,G){var D=[];if(typeof (F)=="object"){for(var C in F){var H=F[C];if(typeof (H)=="object"){for(var E in H){var B=H[E];if(E==("success"+G)){D.succMsg=B}else{if(E==("errors"+G)&&typeof (B)=="object"){D.fieldErrObj=B}else{if(E==("errors"+G)){D.errors=B}else{if(E==("permissionError")&&typeof (B)!="object"){var A="permissionError";D[A]=B}else{if(E==("errorList"+G)&&typeof (B)=="object"){D.errorList=B}else{if(E==("successList"+G)&&typeof (B)=="object"){D.successList=B}else{if(E==("successes"+G)){D.fieldSuccObj=B}else{if(E==("recordDetails"+G)){D.recordDetails=B}else{if(E==("msg"+G)){D.errMsg=B}else{if(E==("info"+G)){D.infoMsg=B}else{if(E==("alert"+G)){D.alertMsg=B}else{if(E==("successMsgDuration"+G)){D.successMsgDuration=B}else{if(E==("captcha"+G)){D.captchaTxt=B}else{if(E==("generatedjs"+G)){D.generatedjs=B}else{if(E==("errorMsg"+G)){D.errorMsg=B}else{if(E==("status"+G)){D.statusMsg=B}else{if(E==("dummyForm")){D.dummyForm=B}else{if(E==("execType")){D.execType=B}else{if(E==("successmsg")){D.successmsg=B}else{if(E==("lookupFieldValue"+G)){D.lookupFieldValue=B}else{if(E==("childFormAccessType"+G)){D.childFormAccessType=B}else{if(E==("childFieldLabelName"+G)){D.childFieldLabelName=B}else{if(E==("childFormLinkName"+G)){D.childFormLinkName=B}else{if(E==("isFromSubForm"+G)){D.isFromSubForm=B}else{if(E==("compType"+G)){D.compType=B}else{if(E==("childSubformField"+G)){D.childSubformField=B}else{if(E==("rowNo"+G)){D.rowNo=B}else{if(E==("recLinkID"+G)){D.recLinkID=B}else{if(E==("paymentConfigId"+G)){D.paymentConfigId=B}else{if(E==("combinedValue"+G)){D.combinedValue=B}else{if(E==("paidUserFieldError"+G)){D.paidUserFieldError=B}else{if(E===("nexturl_rule"+G)){D.nexturl_rule=B}else{if(E==("showHtmlOnly")){D.showHtmlOnly=B}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}return D};this.handleBulkEditResponse=function(K,D,L){var E=ZCUtil.getFromMap(L,"viewLinkName");var I=ZCUtil.getFromMap(L,"formLinkName");var O=ZCUtil.getFromMap(L,"formAccessType");var A=ZCView.viewArr[E];var B=ZCForm.getForm(I,O);var G=$(B).find(":input[name=formid]").val();var H=ZCForm.getMsgFromResponse(K,G);var F=H.succMsg;var J=H.errMsg;var N=H.fieldErrObj;ZCForm.clearErrors(B);if(ZCUtil.isNull(F)){if(J!=undefined&&typeof J=="string"&&J!=""){var P="position=absmiddle, closeParent=false";var M=i18n.headererrormsg;var C=i18n.invalidmsg;ZCApp.showErrorDialog(M,C,P)}ZCForm.showErrors(I,O,J,"",N)}else{closeDialog();ZCUtil.removeFromMap(A,"bulkEditParams");ZCView.showView(A,F)}};this.resetCaptcha=function(E){var A=$(E).find("img[elName='zc-captcha']");var G='<span class="zc-captcha-loading"><img src="/appcreator/live/01/images/loading.gif"></img><span>Please Wait</span>';A.hide();A.after(G);A.siblings("#refreshCaptcha").hide();$(E).find("img[elName='zc-captcha']").attr("src","");var F=$(E).find(":input[name=formid]").val();$(E).find(":input[name=captcha]").val("");var D="/getcaptcha.do?time="+new Date()+"&formid="+F;if(ZCApp.contextPath!=""){D=ZCApp.contextPath+D}var B="";var C=$(E).find("[elName='zc-captcha-digest']");if(A.length>0){$.ajax({url:D,method:"GET",progress:function(){$(E).find("img[elName='zc-captcha']").attr("src","")},success:function(H){capUrl=decodeURIComponent(H);B=capUrl.slice(capUrl.indexOf("cdigest="),(capUrl.indexOf("&")));B=B.split("cdigest=")[1];captchaURL=H;$(E).find("img[elName='zc-captcha']").attr("src",decodeURIComponent(captchaURL));C.val(B);A.show();A.siblings("span.zc-captcha-loading").remove();A.siblings("#refreshCaptcha").show()}})}};this.handleResponse=function(J,N,T){var V=ZCUtil.getFromMap(N,"formLinkName");var U=ZCForm.formArr[V];var q=ZCUtil.getFromMap(U,"zc_NextUrl");var e=ZCUtil.getFromMap(U,"zc_newPage");var M=ZCUtil.getFromMap(U,"zc_EditType");var X=ZCUtil.getFromMap(N,"formBasedOperation");var p=ZCUtil.getFromMap(N,"recType");var AQ=ZCForm.getForm(V,p);var AJ=$(AQ).find(":input[name=formid]").val();var o=ZCForm.getMsgFromResponse(J,AJ);var y=o.succMsg;var AB=o.successMsgDuration;AB=(AB!=undefined)?AB:5000;var K=o.errMsg;var z=o.paidUserFieldError;var E=o.fieldErrObj;var AG=o.combinedValue;var H=o.lookupFieldValue;var d=o.compType;var L=o.childFormLinkName;var R=o.childFieldLabelName;var v=o.childFormAccessType;var AM=(o.isFromSubForm=="true")?true:false;var AP=o.rowNo;var AH=o.childSubformField;var G=o.infoMsg;var AK=o.errorMsg;ZCForm.defreezeButton(AQ);ZCForm.clearErrors(AQ);var AF=o.alertMsg;var P=o.captchaTxt;var Y=o.generatedjs;var AD=o.nexturl_rule;var AE=o.paymentConfigId;var Z=o.recLinkID;if(!ZCUtil.isNull(y)){if(p==ZCConstants.FORM_LOOKUP_ADD_FORM){relodCurrentForm="false";closeDialog();var I="SF("+AH+").FD(t::row_"+AP+")."+(ZCConstants.MULTI_SELECT==d?"MV(":"SV(")+R+")";var AA=$(ZCForm.getForm(L,v)).find("[name='"+I+"']");addValue(L,R,AA,H,v,AG,AM);setValue(L,R,new makeList(H),v,AM,AP,AG,AH);ZCForm.isAddToParentLookup=false}if(!ZCUtil.isNull(Y)&&ZCUtil.isNull(AE)){if(relodCurrentForm!="falseRS"){ZCApp.showFadingMsg(y,0,AB)}if(p!=ZCConstants.FORM_LOOKUP_ADD_FORM){evaluateJs(Y,p)}}if(!ZCUtil.isNull(AD)){var Q=AD;if(Q!=undefined&&Q!=null&&!$.isEmptyObject(Q)){var O=o.nexturl_rule.nexturl;var AN=Q.openin;var W=Q.type;W=(W=="form")?"Form":(W=="view")?"Report":(W=="html")?"Page":W;if(W!="url"||ZCSecurity.isValidURL(O)){var C=Q.component;if(O&&W=="url"){O=ZCSecurity.isURLXSSVulnerable(O)?null:O}if(AN=="2"){if(W=="url"){window.open(O)}else{var n=window.location.href.split("#")[0]+"#"+W+":"+C;window.open(n)}}else{if(AN=="3"){var l=window.opener;var B=window;B=(l!=null)?l:window.parent;if(W=="url"){B.location.href=O}else{B.location.hash="#"+W+":"+C}}else{if(W=="url"){window.location=O}else{window.location.hash="#"+W+":"+C}}}}else{alert(i18n["zc.live.form.invalidurlerror"])}}}if(p==ZCConstants.VIEW_EDIT_FORM&&X&&X=="true"){relodCurrentForm="false";closeDialog();ZCAppSearch.loadLayoutData(V,"current")}else{if(p==ZCConstants.VIEW_EDIT_FORM&&(e=="true"||M!="default")){var h=ZCUtil.getURLParams();var F=false;if(h){var m=h.split("&");for(var AI=0;AI<m.length;AI++){var S=(m[AI]).split("=");if(S[0]=="zc_LoadIn"&&S[1]=="dialog"){F=true;break}}}if(!ZCUtil.isNull(q)){ZCApp.showFadingMsg(y,0,AB||2500);if(layerCount>1){closeDialog()}q=ZCForm.correctURL(q);ZCUtil.setURLInLocationBar(q)}else{if(relodCurrentForm=="true"){if(layerCount>1){ZCApp.showFadingMsg(y,0,AB||2500);closeDialog();ZCUtil.setURLInLocationBar(F?ZCApp.prevURL:ZCApp.currURL);if(!F){ZCApp.reloadSameURL(ZCApp.currURL)}}else{var AL=document.createElement("form");AL.method="post";AL.action=encodeURI("/jsp/successpage.jsp");var u=document.createElement("input");u.name="success";u.type="hidden";u.value=y;AL.appendChild(u);document.body.appendChild(AL);relodCurrentForm="true";AL.submit()}}}}else{if(relodCurrentForm=="true"){if(!this.zcFormAttributes.ajaxreload){var b=location.href;if(b.indexOf("?")==-1){b=b+"?zc_success=true"}else{b=b+"&zc_success=true"}location.href=b}if(!ZCUtil.isNull(AE)){var U=ZCForm.formArr[V];ZCUtil.setInMap(U,"processPayment",true);ZCUtil.setInMap(U,"recLinkID",Z);ZCUtil.setInMap(U,"paymentConfigId",AE);var AC=ZCForm.getFormCont(V,p);var w=$(AC).attr("formURL");if(w.indexOf("/showPermaForm.do")!=-1){ZCUtil.setInMap(U,"perma","true")}if(!ZCUtil.isNull(q)){var A=ZCForm.correctURL(q);q="";ZCUtil.setInMap(U,"zc_NextUrl",q);ZCUtil.setInMap(U,"zc_PmtNextUrl",A)}ZCForm.formArr[V]=U;ZCForm.reloadFormView(V,p,N,G,AK,y)}else{ZCForm.reloadFormView(V,p,N,G,AK,y,AB)}}else{if(!ZCUtil.isNull(ZCForm.callbackFunc)){relodCurrentForm="true";ZCForm.callbackFunc(V,p,N,G,AK,y,AB)}else{if(relodCurrentForm=="falseRS"){closeDialog();ZCApp.showFadingMsg(y,0,relodCurrentForm=="falseRS"?1000:5000);var AO=ZCUtil.getFromMap(N,"viewLinkName");ZCView.refreshRecordSummaryView(AO);relodCurrentForm="true"}}}}}if(ZCUtil.isNull(ZCForm.callbackFunc)){relodCurrentForm="true"}}else{var c="position=absmiddle, closeParent=false";var s=i18n.headererrormsg;if(AF==""||AF==undefined){AF=i18n.invalidmsg}if(!this.zcFormAttributes.browseralert){if(z==undefined){s=i18n.headererrormsg;if(typeof (AF)=="object"){AF=AF[0];for(var a in AF){var D=AF[a];D=D.replace(new RegExp("\n","g"),"<br>");D=D.replace(new RegExp("#zc_amp#","g"),"&");ZCApp.showErrorDialog(s,D,c)}}else{ZCApp.showErrorDialog(s,AF,c)}}else{if(ZCApp.isAdmin=="true"){ZCApp.showUpgradeDialog(z)}else{ZCApp.showErrorDialog(s,z,c)}}}else{if(typeof (AF)=="object"){AF=AF[0];for(var a in AF){var D=AF[a];D=D.replace(new RegExp("\n","g"),"<br>");D=D.replace(new RegExp("#zc_amp#","g"),"&");alert(D)}}else{alert(AF)}}ZCForm.resetCaptcha(AQ);if(z==undefined){ZCForm.showErrors(V,p,K,null,E);if(!ZCUtil.isNull(G)||!ZCUtil.isNull(AK)){ZCForm.showInfo(G,y,V,p,AK)}}if(!ZCUtil.isNull(Y)){evaluateJs(Y,p)}}};this.reloadFormView=function(I,N,M,H,B,J,P){var O=ZCForm.formArr[I];var K=ZCUtil.getFromMap(O,"zc_EditType");var A=ZCUtil.getFromMap(O,"processPayment");if(N==ZCConstants.VIEW_ADD_FORM||N==ZCConstants.VIEW_EDIT_FORM){if(N==ZCConstants.VIEW_EDIT_FORM&&K!="default"){ZCApp.showFadingMsg(J,0,5000)}else{closeAllDialog();var E=ZCView.viewArr[ZCUtil.getFromMap(M,"viewLinkName")];ZCUtil.removeFromMap(E,"startDate");ZCUtil.removeFromMap(E,"endDate");if(ZCUtil.getFromMap(E,"viewType")==ZCConstants.VIEW_CALENDAR){if(N==ZCConstants.VIEW_EDIT_FORM){var L=ZCView.zc_calendar.fullCalendar("getView");var Q=ZCView.calDisplayType(L.name);ZCUtil.setInMap(E,"calViewType",Q)}else{if(N==ZCConstants.VIEW_ADD_FORM){var D=ZCUtil.getFromMap(O,"dateJsonObject");if(!ZCUtil.isNull(D)){D=D.replace(new RegExp("#zc_comma#","g"),",");D=D.replace(new RegExp("&#034,","g"),'"');ZCUtil.setInMap(E,"dateJsonObject",D)}}}}ZCView.showView(E,J,H,P,B)}}else{if(!ZCUtil.isNull(A)&&A==true){ZCUtil.removeFromMap(O,"client");var R=ZCUtil.getParamsFromMap(O);var C="compLinkName="+I+"&formAccessType="+N+"&succMsg="+J+"&compName=Form&compType="+ZCConstants.FORM;var G=ZCForm.convertInfoMsgObjToString(H);var M=ZCUtil.getParamsAsMap(C);M.infoMsg=new Array();M.infoMsg[0]=G;M.errorMsg=new Array();M.errorMsg[0]=B;var F=(window.top!=window.self)?true:false;if(F){R=R+"&zc_pmtRetUrl="+encodeURIComponent(window.location.href)}else{R=R+"&zc_pmtRetUrl="+encodeURIComponent(window.location.href)}if(window.location.href.indexOf("/form-perma/")!=-1||window.location.href.indexOf("/view-perma/")!=-1){R=R+"&isPermaPage=true"}if(window.location.href.indexOf("/form-embed/")!=-1||window.location.href.indexOf("/view-embed/")!=-1){R=R+"&isPermaPage=true"}ZCUtil.sendRequest(ZCApp.contextPath+"/formpaymentprocess.do",R,"html","ZCForm.loadForm",M,i18n.loadingmsg,false)}else{ZCForm.showForm(I,N,H,B,J,P)}}};this.getInfoMsgHtml=function(F,E){infoMsg=F;if(typeof (infoMsg)=="object"){infoMsg=ZCForm.convertInfoMsgObjToString(infoMsg);F=infoMsg}if(infoMsg!=""&&infoMsg!=undefined){infoMsg=infoMsg.replace(new RegExp("\r\n","g"),"<br>");infoMsg=infoMsg.replace(new RegExp("\n","g"),"<br>");infoMsg=infoMsg.replace(/\\n|\\r/g,"<br />");infoMsg=infoMsg.replace(/\\t/g," ");infoMsg=infoMsg.replace(/\\\\/g,"@@@BSD@@@");infoMsg=infoMsg.replace(/\\/g,"");infoMsg=infoMsg.replace(/@@@BSD@@@/g,"\\\\");try{infoMsg=JSON.parse(infoMsg)}catch(G){}if(typeof (infoMsg)=="object"){var J="<table style='width:100%;' elname='errortable' border='0' cellpadding='0' cellspacing='0'><tbody>";var C="";var H="";for(var I in infoMsg){var D=infoMsg[I];if(D.HeaderMsg!=undefined){C=D.UserMsgs;H=D.HeaderMsg;J+="<tr><td valign='middle' class='zoho-black-small-text'><strong>"+H+"</strong></td></tr>";if(C!=""){J+="<tr><td valign='middle' class='zoho-black-small-text'>";for(var A in C){var B=C[A];B=B.replace(new RegExp(ZCConstants.REPLACE_DQ_CHAR,"g"),'"');B=B.replace(/&/g,"&amp;");B=B.replace(/</g,"&lt;");B=B.replace(/>/g,"&gt;");J+=B+"<br><br>"}J+="</td></tr>"}}}if(E!=""&&E!=undefined){J+="<tr><td valign='middle' class='zoho-black-small-text'>"+E+"</td></tr>"}J+="</tbody></table>";return J}}if(E!=""&&E!=undefined){return E}return F};this.showInfo=function(A,D,E,I,F){var H=ZCForm.getInfoMsgHtml(A,F);if(H==""){return }var C=(!ZCUtil.isNull(D))?i18n.viewlogdetails:i18n.viewerrordetails;var B=ZCForm.getForm(E,I);if(D&&D!=""&&I!=ZCConstants.FORM_ALONE){ZCUtil.showInDialog(ZCApp.dialogAbove+H+ZCApp.dialogBelow,"closeButton=no");ZCUtil.removeInfoHdr()}else{var G=$(B).find("tr[elName='zc-errorLogAlert']");$(G).find("a[elName=errorLogAnc]").html(C);$(G).show();$(G).children().children().unbind("click");$(G).children().children().click(function(){if(I!=ZCConstants.FORM_ALONE||I==ZCConstants.VIEW_ADD_FORM||I==ZCConstants.VIEW_EDIT_FORM){var M=$(B).find("table[elname='zc-formTable']");if(M.length==0){M=$(B).find("table[elname='zc-form2Table']")}if($(B).find("tr[elName=zc-infoMsgTag]")[0]){var T=12;$(B).find("tr").remove("[elName=zc-infoMsgTag]");if(!isViewBeta){var S=M.height();S=S+$("#_DIALOG_CONTENT").find("div[elname='zc-dialogheader']").height();$("#_DIALOG_CONTENT").height(S+12);var N=M.width();$("#_DIALOG_CONTENT").find("div[elname='zc-dialogheader']").width(N-8)}}else{var J=B.attr("colValue");var L=2;if(J=="2"){L=3}var O="<tr tag='eleErr'elName='zc-infoMsgTag'><td class='zc-form-errormsg' width='100%' height='100%' valign='top' text-align='left' colspan='"+L+"'>  "+H+"</td></tr>";$(O).insertBefore(ZCUtil.getParent($(B).find(":input[elName='zc-submitformbutton']"),"tr"));var P=$("#FreezeLayer_1").height();var K=$("#_DIALOG_LAYER_1").height();var R=$("#_DIALOG_LAYER_1").position().top;var Q=K+R;if(Q>P){$("#FreezeLayer_1").height(Q)}$("#_DIALOG_CONTENT").height("auto");$("#_DIALOG_CONTENT").find("div[elname='zc-dialogheader']").width("auto")}}else{ZCUtil.showInDialog(ZCApp.dialogAbove+H+ZCApp.dialogBelow,"closeButton=yes, width=500px");ZCUtil.removeInfoHdr();var N=$("#_DIALOG_CONTENT").find("table[elname='errortable']").width();if(N<500){N=490}$("#_DIALOG_CONTENT").find("div[elname='zc-dialogheader']").width(N)}})}};this.clearErrors=function(A){$(A).find("tr[tag=eleErr], div[tag=eleErr]").remove();$(A).find("tr[elName=zc-errorLogAlert], div[elName=zc-errorLogAlert]").hide()};this.showErrors=function(G,O,J,C,M,F){var A=ZCForm.getForm(G,O);var L=$(A).find("tr[elName=zc-errorLogAlert], div[elName=zc-errorLogAlert]");var B=A.attr("colValue");var D=2;if(B=="2"){D=3}var K=this.zcFormAttributes.eleErrTemplate;K=K.replace("insertColSpan",D);if(!ZCUtil.isNull(C)){$(K.replace("insertMessage",C)).insertBefore(L)}if(!ZCUtil.isNull(J)){$(K.replace("insertMessage",J)).insertBefore(L)}if(typeof (M)=="object"){for(var E in M){var H=M[E];if(typeof (H)=="object"){for(var N in H){var P=H[N];var I=ZCForm.getField(G,N,O,F);ZCForm.showFieldErr(I,P,F);if(this.focusElement==""){this.focusElement=I}}}}}};this.showFieldErr=function(F,D,A){if($(F)[0]){if($(F).attr("type")=="radio"||($(F).attr("type")=="checkbox"&&$(F).attr("fieldtype")!=9)){var H=docid("opt-table-"+$(F).attr("formCompID"));F=$(ZCUtil.getParent(H,"span"))}var C=$(ZCUtil.getParent(F,"tr"));var G=C.children("td").size();if(ZCUtil.isNull(A)){G=G+1}var E=this.zcFormAttributes.eleErrTemplate;E=E.replace("insertColSpan",G);E=E.replace("insertMessage",D);E=E.replace("height='100%'","height='25px'");var B=$(E);B.insertAfter(ZCUtil.getParent(F,this.zcFormAttributes.fieldContainer));if($(F).attr("name")){B.attr("errEleFormCompName",$(F).attr("name"))}}};this.showHideCog=function(C,A,B){if(this.inZohoCreator){if(B){$("#zc-rowaction-image").css("visibility",A)}else{ZCUtil.getParent(C,"td[elName=zc-fieldtd],div[elName=zc-fieldtd]").find("img[elName=zc-onchange-image]").css("visibility",A)}}else{}};this.correctURL=function(C){if(C.indexOf("http:")==0){var B=C.indexOf("/");var A=C.substr(0,B);if(C.charAt(B+1)!="/"){C=A+"//"+C.substr(B+1)}}return C};this.showForm=function(F,M,E,B,G,O){var N=ZCForm.formArr[F];var P=ZCUtil.getFromMap(N,"zc_NextUrl");var L=ZCUtil.getFromMap(N,"ZC_URL_TYPE");var A=ZCUtil.getFromMap(N,"zc_SuccMsg");var H=ZCUtil.getFromMap(N,"zc_OpenUrlIn");var S=ZCUtil.getFromMap(N,"zc_LoadIn");var I=ZCUtil.getFromMap(N,"client");ZCUtil.setInMap(N,"zc-mobile",ZCApp.isMobileSite);G=ZCUtil.isNull(A)?G:A;if(!ZCUtil.isNull(G)&&G!="zc_success"&&I!="reset"){if(!ZCUtil.isNull(O)){O=O*1000;ZCApp.showFadingMsg(G,0,O)}else{ZCApp.showFadingMsg(G,0,2000)}}if(!ZCUtil.isNull(P)&&I!="reset"){closeDialog();if(L=="ZC_NOT_TRUSTED_DOMAIN"){if(confirm(i18n["zc.live.form.secureurlconfirmation"])){if(S=="dialog"&&P.indexOf("#Script:")!=0){ZCApp.reloadZCComp(ZCUtil.getLinkName(P),ZCUtil.getParams(P));return false}else{var K=5000;ZCUtil.setURLInLocationBar(P,H,K)}}}else{if(L=="ZC_INVALID_URL"){alert(i18n["zc.live.form.invalidurlerror"])}else{P=ZCForm.correctURL(P);if(ZCSecurity.isValidURL(P)){if(S=="dialog"&&P.indexOf("#Script:")!=0){ZCApp.reloadZCComp(ZCUtil.getLinkName(P),ZCUtil.getParams(P));return false}else{var K=(P.indexOf("#")==0)?0:5000;ZCUtil.setURLInLocationBar(P,H,K)}}else{alert(i18n["zc.live.form.invalidurlerror"])}}}}else{var Q=ZCForm.getFormCont(F,M);ZCUtil.removeFromMap(N,"client");var R=ZCUtil.getParamsFromMap(N);var C="compLinkName="+F+"&formAccessType="+M+"&succMsg="+G+"&compName=Form&compType="+ZCConstants.FORM;var D=ZCForm.convertInfoMsgObjToString(E);var J=ZCUtil.getParamsAsMap(C);J.infoMsg=new Array();J.infoMsg[0]=D;J.errorMsg=new Array();J.errorMsg[0]=B;ZCUtil.sendRequest($(Q).attr("formURL"),R,"html","ZCForm.loadForm",J,i18n.loadingform)}};this.convertInfoMsgObjToString=function(A){var B="";var F=0;if(A!=""&&A!=undefined){for(var J in A){if(J.length>0){F++;if(F!=1){B+=","}B+='"'+J+'":';var I='{"UserMsgs":[';var K="";var H=A[J];if(H.HeaderMsg!=undefined){var G=H.UserMsgs;var D="";for(var C in G){if(C>0){D+=","}var E=G[C];E=E.replace(new RegExp('"',"g"),ZCConstants.REPLACE_DQ_CHAR);D+='"'+E+'"'}I+=D;K+=',"HeaderMsg":"';K+=H.HeaderMsg+'"}'}I+="]";B+=I+K}}if(B.length>1){B="{"+B+"}"}while(B.indexOf("#zc_amp#")!=-1){B=B.replace("#zc_amp#","&")}}return B};this.loadForm=function(B,C,G){var A=ZCUtil.getFromMap(G,"infoMsg");var F=ZCUtil.getFromMap(G,"errorMsg");var D=ZCUtil.getFromMap(G,"succMsg");var E=ZCUtil.getFromMap(G,"compLinkName");var I=ZCUtil.getFromMap(G,"formAccessType");var H=ZCForm.formArr[E];ZCUtil.setInMap(H,"infoMsg",A);ZCApp.loadZCComponent(B,C,G);if(!ZCUtil.isNull(A)||!ZCUtil.isNull(F)){ZCForm.showInfo(A,D,E,I,F)}};this.changeImpMode=function(B,A){var C=$("#zc-import-dialog");if($(B).val()=="pastedata"){$(C).find("div[elName=impDataFileSec]").hide();$(C).find("div[elName=impPasteDataSec]").show();$(C).find("div[elName=fileExtension]").show();$(C).find("input[elName=headerRow]").prop("checked",false)}if($(B).val()=="importfile"){$(C).find("div[elName=impPasteDataSec]").hide();$(C).find("div[elName=impDataFileSec]").show();$(C).find("div[elName=fileExtension]").hide();$(C).find("input[elName=headerRow]").prop("checked","checked")}};this.importData=function(A,B){if($(A).find("textarea[name=pData]").val()==""&&$(A).find("input[elName=writeDataRadio]").is(":checked")){alert(i18n.pastedata);return false}ZCUtil.sendRequest("/isFormBusy.do","fid="+B,"text","ZCForm.submitImportForm",ZCUtil.setInMap(new Object(),"formElem",A),i18n.importing)};this.submitImportForm=function(B,C,D){if(B=="true"){alertFormLiveBusy();return false}var A=$("#zc-import-dialog").find("form[elName=zc-import-form]");$(A)[0].submit};this.handleImportResp=function(B,G,H){var E=ZCForm.getMsgFromResponse(B,"");var D=E.statusMsg;if(D=="success"){closeDialog();var A=ZCUtil.getFromMap(G,"viewLinkName");if(!ZCUtil.isNull(A)){ZCView.showView(ZCView.viewArr[A],i18n.successmsg)}else{ZCApp.showFadingMsg(i18n.successmsg,0,2000)}}else{var F=E.errorMsg;var C=E.info;if(!ZCUtil.isNull(F)){alert(F)}else{if(!ZCUtil.isNull(C)){alert(C)}else{alert(i18n.dataerror)}}}};this.updateEmbedField=function(C,B){var E=$(C).val().trim();if(D!=""){if($(C).attr("elName").indexOf("Clr")!=-1&&E.indexOf("#")==-1){var A=new Array("aqua","black","blue","fuchsia","gray","green","lime","maroon","navy","olive","purple","red","silver","teal","white","yellow");if("rgb"!=(E.substr(0,3).toLowerCase())&&A.indexOf(E.toLowerCase())==-1){E="#"+E}}if($(C).attr("elName").indexOf("Height")!=-1||$(C).attr("elName").indexOf("Width")!=-1){if(E.indexOf("px")==-1&&E.indexOf("%")==-1){E=E+"px"}}var D=E.replace("#","_");D=D.replace("%","_");if(ZCForm.custParams.indexOf($(C).attr("elName"))!=-1){ZCForm.removeParam(C)}ZCForm.custParams=ZCForm.custParams+ZCForm.checkForAnd(ZCForm.custParams)+$(C).attr("elName")+"="+D;if($(C).attr("elName").indexOf("Clr")!=-1){$(C).css("background-color",E)}}else{if(ZCForm.custParams.indexOf($(C).attr("elName"))!=-1){ZCForm.removeParam(C)}}ZCApp.resetEmbedParams(B)};this.removeParam=function(D){var A=ZCForm.custParams.indexOf($(D).attr("elName"));var C=ZCForm.custParams.substring(0,A);var B=ZCForm.custParams.substring(A);var E="";if(B.indexOf("&")!=-1){E=B.substring(B.indexOf("&")+1,B.length)}else{C=C.substring(0,C.lastIndexOf("&"))}ZCForm.custParams=C+E};this.getEmbedParams=function(D){var A=$('div[elName="zc-embed-dialog-div"]');var F=$(A).find("input[elName=zc-successmsg]").val();var C=$(A).find("input[elName=zc-nexturl]").val();C=((C.substring(0,3)).indexOf("www")!=-1)?"http://"+C:C;var B=$(A).find("input[elName=zc-openinparent]").is(":checked");var E=($(A).find("input[elName=zc-hidehdr]").is(":checked"))?"zc_Header=false":"";E=ZCUtil.isNull(F)?E:E+ZCForm.checkForAnd(E)+"zc_SuccMsg="+F;E=ZCUtil.isNull(C)?E:E+ZCForm.checkForAnd(E)+"zc_NextUrl="+C;E=ZCUtil.isNull(C)?E:(B==true)?E+"&zc_OpenUrlIn=parent":E;if(ZCForm.custParams!=""&&E!=""){E=ZCForm.custParams+"&"+E}else{E=ZCForm.custParams+E}return E};this.checkForAnd=function(A){var B=A!=""?"&":"";return B};this.showCustomize=function(C){var A=$('div[elName="zc-embed-dialog-div"]');$(A).find("td[comElName=zc-embed-left-td]").attr("class","zc-dialog-viewtypes-normal");$(A).find("table[comElName=zc-embed-table]").hide();$(C).attr("class","zc-dialog-viewtypes-selected");var B=$(C).attr("elName");$(A).find("table[elName="+B+"]").show()};this.alertFormLiveBusy=function(){alert(i18n.formulacalc)};this.toggleEmbedTag=function(E,D){var A=ZCUtil.getParent(E).find('td[comElName="zc-embed-crit-td"]');for(var C=0;C<A.length;C++){$(A[C]).attr("class","zc-dialog-viewtypes-normal-tab")}$(E).attr("class","zc-dialog-viewtypes-selected-tab");var B=ZCUtil.getParent(E,"td").find('[comElName="zc-embed-crit-table"]');for(var C=0;C<B.length;C++){if(D.match($(B[C]).attr("elName"))){$(B[C]).show()}else{$(B[C]).hide()}}};this.toggleEmbedProps=function(B){var A=ZCUtil.getParent(B).find('table[elName="zc-embed-props-table"]');var C=$(B).find("img")[0];if(A[0].style.display=="none"){$(C).attr("src",$(C).attr("src").replace("show","hide"));$(A[0]).show()}else{$(C).attr("src",$(C).attr("src").replace("hide","show"));$(A[0]).hide()}};this.showImportDialog=function(A){params="";if(isViewBeta){params="&isViewBeta=true"}ZCUtil.sendRequest("/showImportDialog.do","formLinkName="+A+params,"html","ZCForm.loadImportDialog","",i18n.pleasewait)};this.loadImportDialog=function(A,B){closeDialog();ZCUtil.showDialog(A,"false","modal=yes, width=800px")};this.showImportError=function(B){if(!ZCUtil.isNull(B)){var A=i18n.importerror;if(B=="NOFILE"){A=i18n.nofiletoimport}else{if(B=="EMPTYFILE"){A=i18n.emptyfiletoimport}else{if(B=="FILETOOLARGE"){A=i18n.largefiletoimport+"\n"+i18n.uploadmore}}}alert(A)}};this.setImportMode=function(B){var A=$("#ZC_IMPORTDATA_DIV").find("div[elName=UPDATE_ADD_DIV]");if($(B).val()=="UPDATE_ADD"){A.show()}else{A.hide();A.find(":input[type=checkbox]").prop("checked",false)}};this.toggleDataLoc=function(C){var B=$(C).val();var A=$("#ZC_IMPORTDATA_DIV");if(B=="PASTED_DATA"){A.find("div[elName=WEBCLIENT_DIV]").show();A.find("div[elName=PASTED_DATA_DIV]").show();A.find("div[elName=LOCAL_DRIVE_DIV]").hide();A.find("div[elName=MIGRATION_DIV]").hide();A.find("div[elName=CLOUD_PICKER_DIV]").hide();A.find("div[elName=GOOGLE_DOCS_DIV]").hide()}else{if(B=="CLOUD_PICKER"){A.find("div[elName=WEBCLIENT_DIV]").show();A.find("div[elName=PASTED_DATA_DIV]").hide();A.find("div[elName=LOCAL_DRIVE_DIV]").hide();A.find("div[elName=CLOUD_PICKER_DIV]").show();A.find("div[elName=GOOGLE_DOCS_DIV]").hide();A.find("div[elName=MIGRATION_DIV]").hide()}else{if(B=="GOOGLE_DOCS"){A.find("div[elName=WEBCLIENT_DIV]").show();A.find("div[elName=PASTED_DATA_DIV]").hide();A.find("div[elName=LOCAL_DRIVE_DIV]").hide();A.find("div[elName=CLOUD_PICKER_DIV]").hide();A.find("div[elName=GOOGLE_DOCS_DIV]").show();A.find("div[elName=MIGRATION_DIV]").hide()}else{if(B=="LOCAL_DRIVE"){A.find("div[elName=WEBCLIENT_DIV]").show();A.find("div[elName=PASTED_DATA_DIV]").hide();A.find("div[elName=LOCAL_DRIVE_DIV]").show();A.find("div[elName=MIGRATION_DIV]").hide();A.find("div[elName=CLOUD_PICKER_DIV]").hide();A.find("div[elName=GOOGLE_DOCS_DIV]").hide()}else{if(B=="MIGRATION"){A.find("div[elName=PASTED_DATA_DIV]").hide();A.find("div[elName=LOCAL_DRIVE_DIV]").hide();A.find("div[elName=WEBCLIENT_DIV]").hide();A.find("div[elName=MIGRATION_DIV]").show();A.find("div[elName=CLOUD_PICKER_DIV]").hide();A.find("div[elName=GOOGLE_DOCS_DIV]").hide()}}}}}};this.toggleScriptDiv=function(){var A=$("#ZC_IMPORTDATA_DIV").find("div[elName=SKIP_SCRIPT_DIV]");if($(A).css("display")=="none"){$(A).show()}else{$(A).hide()}};this.continueImport=function(B){var A=ZCForm.checkInputs(B);if(A){ZCApp.showLoading("zc-loading")}return A};this.checkInputs=function(B){if($(B).find(":input[name=IMPORT_MODE]").val()=="UPDATE_ADD"){var A=true;$.each($(B).find("div[elName=UPDATE_ADD_DIV]").find(":input[name=UPDATE_ADD_COLS]"),function(C,D){if($(D).is(":checked")){A=false}});if(ZCUtil.isTrue(A)){alert(i18n.nofldtomatch);return false}}if($(B).find(":input[elName=PASTED_DATA_RADIO]").is(":checked")){if($(B).find(":input[name=PASTED_DATA]").val()==""){alert(i18n.plzpastedata);return false}}if($(B).find(":input[elName=GOOGLE_DOCS_RADIO]").is(":checked")){if($(B).find(":input[name=GDOC_ID]").val()==""){alert(i18n.nofiletoimport);return false}}return true};this.toggleFirstRow=function(E){var D=$("#ZC_IMPORTDATA_DIV").find("div[elName=ZCIMPORT_PREVIEW_DIV]");var A=$(D).find("tr[elName=ZCIMPORT_HDRDATA_TR]");var B=$(D).find("tr[elName=ZCIMPORT_HASHDR_TR]");var C=$(D).find("tr[elName=ZCIMPORT_NOHDR_TR]");if(ZCUtil.isTrue($(E).val())){$(A).hide();$(C).hide();$(B).show()}else{$(A).show();$(B).hide();$(C).show()}};this.toggleCSVSettings=function(){var C=$("#ZC_IMPORTDATA_DIV");var A=$(C).find("div[elName=ZCIMPORT_CSVSETTINGS_DIV]");var B=$(C).find("div[elName=ZCIMPORT_PREVIEW_REFRESH_DIV]");if(ZCUtil.isHidden(A)){$(A).show()}else{$(A).hide()}};this.refreshPreview=function(D,G){var F=$("#ZC_IMPORTDATA_DIV");G=$("#sheet_"+D).val();var C=$(F).find("div[elName=ZCIMPORT_CSVSETTINGS_DIV]");var B="ZCACTION=PARSEFILE&formLinkName="+D+"&FILENAME="+G;B+="&DELIMETER="+$(C).find(":input[name=DELIMETER]").val();B+="&HASFIELDNAMES="+$(F).find(":input[elName=HASFIELDNAMES_RADIO]").is(":checked");B+="&TEXT_QUALIFIER="+$(C).find(":input[name=TEXT_QUALIFIER]").val();B+="&isViewBeta="+$(C).find(":input[name=isViewBeta]").val();var E=$(C).find(":input[name=SKIP_TOP_ROWS]").val();if(!ZCUtil.isNull(E)){B+="&SKIP_TOP_ROWS="+E}var A=$(C).find(":input[name=COMMENT_CHAR]").val();if(!ZCUtil.isNull(A)){B+="&COMMENT_CHAR="+A}ZCUtil.sendRequest("/importFormData.do",B,"html","ZCForm.reloadPreview","",i18n.pleasewait)};this.reloadPreview=function(A){$("#ZC_IMPORTDATA_DIV").find("div[elName=ZCIMPORT_PREVIEW_DIV]").html(A)};this.fieldOnChange=function(F){var E=$("#ZC_IMPORTDATA_DIV").find("div[elName=ZCIMPORT_PREVIEW_DIV]");var B=$(F).attr("colIndex");var A=$(F).val();var C=$(E).find("tr[elName=ZCIMPORT_NOHDR_TR]");var D=$(E).find("tr[elName=ZCIMPORT_HASHDR_TR]");if(A==-1){$(D).find(":checkbox:eq("+B+")").prop("checked",false);$(C).find(":checkbox:eq("+B+")").prop("checked",false)}else{$.each($(E).find("select"),function(G,I){if(A==$(I).val()){var H=(G==B);if(!ZCUtil.isTrue(H)){$(I).val(-1)}$(D).find(":checkbox:eq("+G+")").prop("checked",H);$(C).find(":checkbox:eq("+G+")").prop("checked",H)}})}};this.checkColumn=function(A){if(!ZCUtil.isTrue($(A).is(":checked"))){$("#ZC_IMPORTDATA_DIV").find("div[elName=ZCIMPORT_PREVIEW_DIV]").find("select:eq("+$(A).attr("colIndex")+")").val(-1)}};this.importFormData=function(I,O){var K=$("#ZC_IMPORTDATA_DIV");var M=$(K).find("div[elName=ZCIMPORT_PREVIEW_DIV]");var C=$(M).find("tr[elName=ZCIMPORT_LABEL_TR]");var N=$(K).find(":input[elName=HASFIELDNAMES_RADIO]").is(":checked");var P=N?$(M).find("tr[elName=ZCIMPORT_HASHDR_TR]"):$(M).find("tr[elName=ZCIMPORT_NOHDR_TR]");var G="ZCACTION=IMPORT";G+="&formLinkName="+I;G+="&HASFIELDNAMES="+N;G+="&DELIMETER="+$(K).find(":input[name=DELIMETER]").val();G+="&TEXT_QUALIFIER="+$(K).find(":input[name=TEXT_QUALIFIER]").val();G+="&SKIP_TOP_ROWS="+$(K).find(":input[name=SKIP_TOP_ROWS]").val();G+="&ONIMPORTERROR="+$(K).find(":input[name=ONIMPORTERROR]").val();G+="&isViewBeta="+$(K).find(":input[name=isViewBeta]").val();var F=$(K).find(":input[name=DATE_FORMAT]").val();if(!ZCUtil.isNull(F)){G+="&DATE_FORMAT="+F}var B=$(K).find(":input[name=COMMENT_CHAR]").val();if(!ZCUtil.isNull(B)){G+="&DATE_FORMAT="+B}var E=ZCUtil.evalJSONObject(O);if(!ZCUtil.isNull(E.FILENAME)){var H=E.FILENAME;var A=$(K).find("select[name=SHEET_NAME]").val();if(A!=undefined){H=A}G+="&FILENAME="+encodeURIComponent(H)}var D=$(K).find("select[name=DATE_TYPE]").val();if(!ZCUtil.isNull(D)){G+="&DATE_TYPE="+D}if(!ZCUtil.isNull(E.IMPORT_MODE)){G+="&IMPORT_MODE="+E.IMPORT_MODE}if(!ZCUtil.isNull(E.SKIP_ONUPDATE)){G+="&SKIP_ONUPDATE="+E.SKIP_ONUPDATE}if(!ZCUtil.isNull(E.SKIP_ONSUBMIT)){G+="&SKIP_ONSUBMIT="+E.SKIP_ONSUBMIT}if(!ZCUtil.isNull(E.SKIP_ONCOMMIT)){G+="&SKIP_ONCOMMIT="+E.SKIP_ONCOMMIT}if(!ZCUtil.isNull(E.IMPORTSUBFORMDATA)){G+="&IMPORTSUBFORMDATA="+E.IMPORTSUBFORMDATA}if(!ZCUtil.isNull(E.MATCHING_COLUMNS)){var L=ZCUtil.evalJSONArray(E.MATCHING_COLUMNS);for(var Q=0;Q<L.length;Q++){G+="&MATCHING_COLUMNS="+L[Q]}}var J=false;G+="&IMPORTCOLUMNS=<COLUMNS>";$.each($(P).find(":input[type=checkbox]"),function(R,S){var T=$(C).find(":input:eq("+R+")").val();var U=(ZCUtil.isTrue($(S).is(":checked"))&&(T!=-1));if(ZCUtil.isTrue(U)){J=true}G+='<COLUMN INDEX="'+(R+1)+'" DELUGENAME="'+T+'" IMPORT="'+U+'" />'});G+="</COLUMNS>";if(J){ZCUtil.sendRequest("/importFormData.do",G,"html","ZCForm.loadImportDialog","",i18n.importingmsg)}else{alert(i18n.selcols4imp)}};this.showHideImportError=function(B){var A=ZCUtil.getParent(B,"table").find("tr[elName=ZCERRORDETAILS]");if(ZCUtil.isTrue($(B).attr("showError"))){$(A).show();$(B).attr("showError",false);$(B).html(i18n.hideimperrors)}else{$(A).hide();$(B).attr("showError",true);$(B).html(i18n.showimperrors)}};this.closeImportDialog=function(){closeDialog();if(ZCUtil.getFromMap(ZCApp.compNameVsTypeMap,ZCApp.currZCComp)==ZCConstants.VIEW){ZCView.showView(ZCView.viewArr[ZCApp.currZCComp])}};this.createNewSubFormRow=function(C,P){var R=$(C).parents("form");var Q=$(R).attr("name");var K=ZCForm.formArr[Q];var J=ZCUtil.getFromMap(K,"formAccessType");var L=$(C).parents("td[elname = subformtd]:first").find("div[elname = subformdiv]");var A=$(L).attr("maxRows");if(A==0){ZCApp.showErrorDialog(i18n.headererrormsg,i18n.cannoraddsubformrowmsg);return }var I=$(L).attr("name");$(L).find("tr[elName="+I+"_norecordrow]").css("display","none");var T=$(L).attr("name");var O=$(L).attr("formcompid");var F=ZCUtil.isNull($(L).attr("nextRecordSequence"))?0:$(L).attr("nextRecordSequence");var B=parseInt(F)+1;var M=$(L).find("table[elName='zc-subFormTable']");var D=$(L).find("tr[id='"+T+"_t::row']").attr("class");var S=$(L).find("tr[elName=dataRow]");$.each($(S),function(V,U){$(U).find("td").css("border-bottom","")});var E=$(L).find("tr[id='"+T+"_t::row']").clone();$(E).attr("id",T+"-"+F);$(E).show();$(E).find("td").css("border-bottom","none");$(L).attr("nextRecordSequence",B);$(M).children("tbody").append(E);$($(E).find(':input,textarea,div[elname="srchDiv"]').filter(":visible").get(0)).trigger("focus");$(E).attr("reclinkid","");$(E).find(":input[id*='0'],:checkbox[id*='0'],:radio[id*='0'],:hidden[id*='0'],div[id*='0'],span[id*='0'],a[id*='0'],label[id*='0']").each(function(){$(this).attr("id",$(this).attr("id").replace("row_0","row_"+F))});$(E).find(":input[name*='0'],:checkbox[name*='0'],:radio[name*='0'],:hidden[name*='0'],div[name*='0'],span[name*='0'],a[name*='0'],label[name*='0']").each(function(){$(this).attr("name",$(this).attr("name").replace("row_0","row_"+F))});$(E).find("label[for*='0']").each(function(){$(this).attr("for",$(this).attr("for").replace("_0","_"+F))});$(E).find("a[labelName*='0'],:file[labelName*='0']").each(function(){$(this).attr("labelName",$(this).attr("labelName").replace("row_0","row_"+F))});$(E).find("span[rowNo*='0']").each(function(){$(this).attr("rowNo",F)});$(E).find(":input[rowLabelName*='0']").each(function(){$(this).attr("rowLabelName",$(this).attr("rowLabelName").replace("_0","_"+F))});$(E).find("div[compositename*='0']").each(function(){$(this).attr("compositename",$(this).attr("compositename").replace("_0","_"+F))});ZCForm.regMaskEvents(E);$(E).find(":input[fieldType="+ZCConstants.DATE+"], :input[fieldType="+ZCConstants.DATE_TIME+"]").each(function(){var U=$(this).attr("id");var V="dateButtonEl_"+U.substr(U.indexOf("_")+1);var X=($(this).attr("fieldType")==ZCConstants.DATE_TIME)?true:false;var W=X?ZCApp.dateFormat+" "+ZCConstants.TIME_FORMAT:ZCApp.dateFormat;ZCForm.setUpCalendar(U,V,W,X)});$(E).find(":input[type=radio], :input[type=checkbox]").click(function(){ZCForm.invokeOnChange(this,R,J,O)});$(E).find(":input[type!=hidden][type!=reset][type!=submit][type!=button][type!=radio][type!=checkbox]").change(function(){if($(this).attr("type")=="file"){$(this).attr("changed","changed")}ZCForm.invokeOnChange(this,R,J,O)});$(E).find("span[elname=zc-show-parent]").click(function(){ZCForm.showLookupForm(this)});var G=Math.floor(Math.random()*10000000);$(E).find("div[elName=zc-richtextarea]").each(function(b,q){$(this).attr("nameoftextarea",$(this).attr("nameoftextarea").replace("0",F));G=G+1;var o=$(L).find("tr[id='"+T+"_t::row']");var Y=$(o).find("div[elname=zc-richtextarea]").attr("disablerichtext");var h=$(o).find("div[elname=zc-richtextarea]").attr("readonlypermission");Y=(h)?h:Y;divID=G+"";$(q).attr("id",divID);var f=$(q).attr("zc-editor-height");f=f.substring(0,f.length-2);var W=$(q).parents("td").find("textarea[formcompid="+$(q).attr("textAreaName")+"]");var l=$(W).val();var p=$(W).attr("zc-rtetToolsJson");p=(ZCUtil.isNull(p)?"":JSON.parse(p));var Z=$(W).attr("zc-rtetFontJson");Z=(ZCUtil.isNull(Z)?"":JSON.parse(Z));var d=$(W).attr("zc-rtetFontFamilyJson");d=(ZCUtil.isNull(d)?"":JSON.parse(d));var X={id:divID,content:l,editorheight:f,toolbar:p,fontsize:Z,fontfamily:d,fontFamilyDefinition:ZE_Init.FontFamilyDefinition};$(q).html("");ZCForm.createRichTextEditor(divID,X);var m="freezdiv_"+$(this).attr("textareaname");_editordiv=$("div[id="+divID+"]");var c=ZCForm.editorRef[divID];if((Y=="true")){try{if(c){if(c.mode=="plaintext"){$(c._textarea).attr("disabled",Y)}else{var n=c.iframe;var s=Y?"off":"on";var V=Y?"false":"true";if(!($.browser.msie)){setTimeout(function(){c.doc.body.contentEditable=V},100);c.doc.designMode=s}else{setTimeout(function(){c.doc.body.contentEditable=V},100)}}}}catch(a){}var e=document.createElement("div");e.className="freezeLayer";e.id=m;var U={left:"0",top:"0",height:"100%",width:"100%",zIndex:50,background:"#AAAAAA",border:"1px solid #AAAAAA"};$(e).css(U);$(_editordiv).css("position","relative");_editordiv[0].appendChild(e)}});$(E).find("div[elName=srchDiv]").each(function(){$(this).attr("subFormRow",F)});var H=ZCForm.formArr[Q];var N=ZCUtil.getFromMap(H,"formID");searchFactory.regLookupSearchEvents(E,N,J,R);$(E).find("div[elName=srchDiv]").each(function(V,U){if($(U).attr("disable")=="true"){$(U).unbind()}if($(U).attr("readonlypermission")=="true"){$(U).parent("div:first").find("div[elName=srchDivEl]").css("display","none");$(U).css("background-color","#ebebe4");$(U).unbind()}});$(E).find("div[eleName=signature-field-subform]").each(function(){var V=this;var U=$(V).find("div[eleName=signature]");$(V).find("a[eleName=signatureClear]").click(function(){$(U).jSignature("reset")});$(U).jSignature({"decor-color":"transparent",height:"100",width:"300"});$(U).addClass("signature-div");var W=$(this).find("div[divName=signatureEle]");if($(W).attr("isHide")==="true"){$(W).hide()}});if(P){ZCForm.invokeGridRowAction(L,R,"t::row_"+F,"onaddrow",J)}$(L).attr("maxRows",A-1);if(!isViewBeta){resizeDialog($(R).parents("div[id=_DIALOG_CONTENT]:first"))}};this.deleteSubFormRow=function(K){var A=$(K).parents("tr:first");var B=A.parents("form");var H=$(B).attr("name");var L=ZCForm.formArr[H];var M=ZCUtil.getFromMap(L,"formAccessType");var I=A.attr("reclinkid");var D=A.parents("div[elname = subformdiv]");var J=parseInt($(D).attr("maxRows"));var C=$(K).attr("labelname");var F="SF("+$(D).attr("name")+").FD(";var E=").SV(ID)";var G=C.split(F)[1].split(E)[0];while(A.next("tr").attr("tag")==="eleErr"){A.next("tr").remove()}if(!ZCForm.invokeGridRowAction(D,B,G,"ondeleterow",M)){$($(A).prev().find(':input,textarea,div[elname="srchDiv"]').filter(":visible").get(0)).focus();ZCForm.removeTR(B,$(D).attr("name"),G)}$(D).attr("maxRows",J+1);if(!isViewBeta){resizeDialog($(B).parents("div[id=_DIALOG_CONTENT]:first"))}};this.removeTR=function(B,J,E){var C=B.find("div[name="+J+"]");var D="SF("+J+").FD("+E+").SV(ID)";var I=C.find("a[labelname='"+D+"']");var A=$(I).parents("tr:first");var H=$(A).parents("table[elName=zc-subFormTable]");var G=$(H).find("tr[elName=dataRow]").length;if(G-1==1){$(H).find("tr[elName="+J+"_norecordrow]").css("display","")}var F=A.attr("reclinkid");$(A).remove()};this.triggerExternalOnUser=function(O){try{if(O==ExternalFieldName){var P=document.getElementById(O);var K=P.getAttribute("onChangeExists");var E=P.getAttribute("isFormulaExist");var F=P.getAttribute("setdataatcell");if(K=="true"||E=="true"){var H=P.getAttribute("formCompID");var B=$(P).parents("form");var J=$(B).attr("name");var N=ZCForm.formArr[J];var M=ZCUtil.getFromMap(N,"formAccessType");var D=ZCUtil.getFromMap(N,"formID");var C=ZCForm.getForm(J,M);var G=P.getAttribute("isSubForm");if(K=="true"){if(G=="true"){var A=P.getAttribute("mainformcompid");var L=P.getAttribute("name");onChangeSubFormScript(C,D,A,H,L)}else{onChangeScript(C,D,H)}}if(E=="true"){executeFormula(C,D,H)}}else{if(F==="true"){ZCSheetView.updateZohoCrmVal(O)}}}ExternalFieldName=""}catch(I){}};this.showhideFileUploadDiv=function(C,B){var A=$(C).parents("[elName=zc-fieldtd]:first");if($(A).find(":input[type=file]").attr("isAttached")=="true"){alert(i18n.alreadyfileuploaded);return }$(A).find("[zc-type=fileUpload-Div]").hide();$(A).find("[zc-type=fileUpload-Div][elName="+B+"]").show();var D=$(C).attr("name");$(A).find("[name="+D+"]").removeClass("selected");$(A).find("[name="+D+"]").removeClass("normal");$(A).find("[name="+D+"]").addClass("normal");$(C).removeClass("normal").addClass("selected")};this.showhideImageDiv=function(D,H,F,I,C){var E=$(D).parents("[elName=zc-fieldtd]:first");if($(E).find("[name=zcimagetype-"+F+"],[subname=zcimagetype-"+F+"]").attr("disabled")==true){return }$(E).find("[zc-type=imageUpload-Div]").hide();$(E).find("[zc-type=imageUpload-Div][elName="+H+"]").show();var A=$(D).attr("name");$(E).find("[name="+A+"]").removeClass("selected");$(E).find("[name="+A+"]").removeClass("normal");$(E).find("[name="+A+"]").addClass("normal");$(D).removeClass("normal").addClass("selected");if(C&&I=="link"){$(E).find("[name=zcsource-"+F+"]").val("");$(E).find("[subname=zcsource-"+F+"]").val("")}if(C&&I=="local"){var B=$(E).find("[name=zcsource-"+F+"]").attr("imagevalue");$(E).find("[name=zcsource-"+F+"]").val(B);var G=$(E).find("[subname=zcsource-"+F+"]").attr("imagevalue");$(E).find("[subname=zcsource-"+F+"]").val(G)}if(I=="link"){$(E).find("[name=zcimagetype-"+F+"]").val("1");$(E).find("[subname=zcimagetype-"+F+"]").val("1")}else{$(E).find("[name=zcimagetype-"+F+"]").val("2");$(E).find("[subname=zcimagetype-"+F+"]").val("2")}};this.browseAttachEvent=function(B){$(B).attr("zc-Attached-Type","browse");$(B).attr("zc-DocId","");$(B).attr("isAttached","true");var A=$(B).next();($(B).val()!="")?$(A).show():$(A).hide()};this.googleDocAttachEvent=function(C,B){$("[isAttachOpen=true]:first").find("[elName=zc-GoogleDoc-FileName]").text(C);var A=$("[isAttachOpen=true]:first").find(":input[type=file]");$(A).attr("zc-Attached-Type","google");$(A).attr("zc-DocId",B);$(A).attr("isAttached","true");$(A).attr("changed","changed");$(A).parent().html($(A).parent().html());$("[isAttachOpen=true]:first").find("[elName=zc-GoogleDoc-Button]").hide();$("[isAttachOpen=true]:first").find("[elName=zc-GoogleDoc-FileAttach]").show();ZCForm.closeDocsAttachTemplate()};this.isImport=false;this.cloudDocAttachEvent=function(A,C){if(this.isImport){$("#cloudPickVal").val(A);$("#cloudFileName").text(C);this.isImport=false}else{$("[isAttachOpen=true]:first").find("[elName=zc-CloudDoc-FileName]").html(C);var B=$("[isAttachOpen=true]:first").find(":input[type=file]");$(B).attr("zc-Attached-Type","cloud");$(B).attr("zc-DocId",A);$(B).attr("isAttached","true");$(B).attr("changed","changed");$("[isAttachOpen=true]:first").find("[elName=zc-CloudDoc-Button]").hide();$("[isAttachOpen=true]:first").find("[elName=zc-CloudDoc-FileAttach]").show()}};this.openCloudPickerForImport=function(B){this.isImport=true;var A=$('<div id="zc-gadgets_cloudpicker_div"></div>');A.addClass("gadgets_cloudpicker_div");A.css("z-index","99");A.append("<iframe class='gadgets_cloudpicker_iframe' style='' id='zc-file_attach_iframe' src='"+clouddocurl+"'>");$("body").append(A)};this.zohoDocAttachEvent=function(C,A){$("[isAttachOpen=true]:first").find("[elName=zc-ZohoDoc-FileName]").html(C);var B=$("[isAttachOpen=true]:first").find(":input[type=file]");$(B).attr("zc-Attached-Type","zoho");$(B).attr("zc-DocId",A);$(B).attr("isAttached","true");$(B).attr("changed","changed");$(B).parent().html($(B).parent().html());$("[isAttachOpen=true]:first").find("[elName=zc-ZohoDoc-Button]").hide();$("[isAttachOpen=true]:first").find("[elName=zc-ZohoDoc-FileAttach]").show();ZCForm.closeDocsAttachTemplate()};this.openCloudAttachTemplate=function(E){$(E).parents("[elName=zc-fieldtd]:first").attr("isattachopen","true");var C=$('<div id="zc-gadgets_cloudpicker_div"></div>');C.addClass("gadgets_cloudpicker_div");var A=$(E).attr("cloudService");var F=$(E).attr("fileCnt");var D="attachLimit="+F+"&sources="+A+"&zservice=zcreator&zsoid="+ZCGlobal.scopeId;var B=fileCloudUrl.replace("ZC_PARAMS=",D);C.append("<iframe class='gadgets_cloudpicker_iframe' style='' id='zc-file_attach_iframe' src='"+B+"'>");$("body").append(C)};this.openDocsAttachTemplate=function(B){$(B).parents("[elName=zc-fieldtd]:first").attr("isattachopen","true");var A="";if($(B).attr("zc-Doc-Type")=="zoho"){A=zohodocurl}else{if($(B).attr("zc-Doc-Type")=="google"){A=googledocurl}}ZCUtil.showDialog("<iframe style='width:760px;height: 602px;' class='file_attach_iframe' id='zc-file_attach_iframe' src='"+A+"'>","false","closelink=no,modal=yes");$(".file_attach_iframe").parents(".dialog-border:first").removeClass("dialog-border")};this.openImportGDocDialog=function(){$("#gFormName").attr("importOpen",true);ZCUtil.showDialog("<iframe class='file_attach_iframe' id='zc-file_attach_iframe' src='"+googlesheeturl+"'>","false","modal=yes");$(".file_attach_iframe").parents(".dialog-border:first").removeClass("dialog-border")};this.closeDocsAttachTemplate=function(){$("[isAttachOpen=true]").attr("isAttachOpen","false");closeDialog()};this.removeUploadedFile=function(C){var A=$(C).parents("[elName=zc-fieldtd]:first");var B=$(A).find(":input[type=file]");$(A).find(":input[subtype=file]").attr("value","");$(A).find(":input[type=file]").attr({"zc-Attached-Type":"browse","zc-DocId":"",isAttached:"false"});B.replaceWith(B=$(B).val("").clone(true));$(C).hide();$(A).find("[elName=zc-GoogleDoc-FileName]").html("");$(A).find("[elName=zc-ZohoDoc-FileName]").html("");$(A).find("[elName=zc-GoogleDoc-Button]").show();$(A).find("[elName=zc-GoogleDoc-FileAttach]").hide();$(A).find("[elName=zc-ZohoDoc-Button]").show();$(A).find("[elName=zc-ZohoDoc-FileAttach]").hide();$(A).find("[elName=zc-Browse-FileAttach]").hide();$(A).find("[elName=zc-CloudDoc-Button]").show();$(A).find("[elName=zc-CloudDoc-FileAttach]").hide();$(A).find("[elName=zc-CloudDoc-FileName]").html("")}}();function searchVariables(){this.formEl=null;this.formID=null;this.formAccessType=null;this.privateLink=null;this.viewPrivateLink=null;this.viewLinkName=null;this.childFormPrivateLink=null;this.childFormLinkName=null;this.labelName=null;this.onChangeExists=false;this.isFormulaExist=false;this.fieldType=null;this.formCompId=null;this.nameOfInput=null;this.srchDiv=null;this.srchContDiv=null;this.srchInputDiv=null;this.srchValDiv=null;this.srchInput=null;this.mainFormEl=null;this.isSubForm=false;this.recLinkID=null;this.subFormRow=null;this.subFormCompId=null;this.subFormId=null;this.subFormLabelName=null}var searchFactory=new function(){this.cacheMap={};this.maxRows=200;this.cacheThreshold=100;this.delay=1500;this.currentElement=0;this.waitTime=0;this.lastRequestSentTime;this.timeout;this.scrollPointToSendReq=1200;this.isRequestCompleted=false;this.setVariables=function(B,A){var D=new searchVariables();for(key in D){searchFactory[key]=D[key]}searchFactory.groupByColumnName=$(B).attr("groupByColumnName");searchFactory.groupByTableName=$(B).attr("groupByTableName");searchFactory.formLinkName=$(B).attr("formLinkName");var C=ZCForm.formArr[searchFactory.formLinkName];searchFactory.formID=ZCUtil.getFromMap(C,"formID");searchFactory.formAccessType=ZCUtil.getFromMap(C,"formAccessType");searchFactory.formEl=ZCForm.getForm(searchFactory.formLinkName,searchFactory.formAccessType);searchFactory.privateLink=$(searchFactory.formEl).find(":input[name=privatelink]").val();searchFactory.viewPrivateLink=$(searchFactory.formEl).find(":input[name=viewPrivateLink]").val();searchFactory.childFormPrivateLink=$(searchFactory.formEl).find(":input[name=childFormPrivateLink]").val();searchFactory.viewLinkName=$(searchFactory.formEl).find(":input[name=viewLinkName]").val();searchFactory.childFormLinkName=$(searchFactory.formEl).find(":input[name=childFormLinkName]").val();searchFactory.labelName=$(B).attr("labelName");searchFactory.onChangeExists=$(B).attr("onChangeExists");searchFactory.isFormulaExist=$(B).attr("isformulaexist");searchFactory.fieldType=$(B).attr("fieldType");searchFactory.formCompId=$(B).attr("formCompId");if(!A){searchFactory.nameOfInput=searchFactory.labelName}else{searchFactory.mainFormEl=searchFactory.formEl;searchFactory.isSubForm=A;searchFactory.subFormLabelName=$(B).attr("subFormLabelName");searchFactory.subFormCompId=$(B).attr("subFormCompId");searchFactory.subFormId=$(B).attr("subFormId");searchFactory.subFormRow=$(B).attr("subFormRow");searchFactory.recLinkID=$(B).attr("recLinkID");if(searchFactory.fieldType==ZCConstants.SINGLE_SELECT||searchFactory.fieldType==ZCConstants.SYSTEM_LOOKUP){searchFactory.nameOfInput="SF("+searchFactory.subFormLabelName+").FD("+searchFactory.recLinkID+"_"+searchFactory.subFormRow+").SV("+searchFactory.labelName+")"}else{searchFactory.nameOfInput="SF("+searchFactory.subFormLabelName+").FD("+searchFactory.recLinkID+"_"+searchFactory.subFormRow+").MV("+searchFactory.labelName+")"}}searchFactory.srchDiv=$(B);searchFactory.srchContDiv=$(searchFactory.srchDiv).siblings("div[elName=srchDivEl]");searchFactory.srchValDiv=$(searchFactory.srchContDiv).find("div[elName=srchValDiv]");searchFactory.srchInputDiv=$(searchFactory.srchContDiv).find("div[elName=srchInputDiv]");searchFactory.srchInput=$(searchFactory.srchInputDiv).find("input")};this.regLookupSearchEvents=function(C,D,B,A){$(C).find("div[elName=srchDiv]").each(function(){var G=$(this).attr("subFormLabelName");var F=$(this).attr("type");if($("#sysLookupSingleSrch").html()!=undefined||(F=="searchLookupSingle"&&$(this).find("li").length==0&&ZCUtil.isNull(A))){var H=$(this).width();if(ZCApp.isMobileSite){H=""}var E="";if(F=="searchLookupSingle"&&$(this).find("li").length==0&&ZCUtil.isNull(A)){E=searchFactory.formatValueToShow($(this).parent("div:first").find("table").find("tr[value=-Select-]"),$(this).attr("name"),F,H)}if($(this).attr("elemName")==="usersPicklist"&&$(this).find("li").length===0){E=searchFactory.formatValueToShow($(this).next().find("table").find("tr[value=-Select-]"),$(this).attr("name"),F,H)}$(this).append(E)}$(this).bind("click focus",function(I){if(!ZCUtil.isNull(G)){searchFactory.setVariables(this,true)}else{searchFactory.setVariables(this,false)}searchFactory.triggerClickEvent(I)})})};this.triggerClickEvent=function(C){if($(C.target).attr("elName")=="removeVal"){searchFactory.triggerRuleEvents();$(C.target).parent("li:first").remove();if($(searchFactory.srchDiv).find("li").length==0){$(searchFactory.srchDiv).find("span[elName=selectEl]").show()}var B=$(this).attr("isformulaexist");if(B=="true"&&searchFactory.formAccessType!=ZCConstants.VIEW_BULK_EDIT_FORM){ZCForm.showHideCog(searchFactory.srchDiv,"visible");executeFormula(searchFactory.formEl,searchFactory.formID,searchFactory.formCompId,true)}var A=$(this).attr("onChangeExists");if(A=="true"&&searchFactory.formAccessType!=ZCConstants.VIEW_BULK_EDIT_FORM){ZCForm.showHideCog(searchFactory.srchDiv,"visible");if(searchFactory.isSubForm){onChangeSubFormScript(searchFactory.mainFormEl,searchFactory.formID,searchFactory.subFormCompId,searchFactory.formCompId,searchFactory.nameOfInput,searchFactory.formAccessType)}else{onChangeScript(searchFactory.formEl,searchFactory.formID,searchFactory.formCompId,searchFactory.formAccessType,true)}}return }$("[elName=srchDivEl]").hide();if(searchFactory.getCache(searchFactory.nameOfInput)==undefined){searchFactory.buildCache(searchFactory.nameOfInput)}else{if(searchFactory.getCache(searchFactory.nameOfInput).cacheData[""]==undefined){searchFactory.setCache(searchFactory.nameOfInput,$(searchFactory.srchContDiv).find("div[elName=srchValDiv]").html(),"")}}searchFactory.bindEventHandlers(searchFactory.labelName);$(searchFactory.srchInput).val("");searchFactory.changeDivContentByCache(searchFactory.labelName,searchFactory.getCache(searchFactory.nameOfInput).cacheData[""]);searchFactory.getCache(searchFactory.nameOfInput).noOfRecords=$(searchFactory.srchValDiv).find("table").find("tr[elName=srchValtr][rowno != 0]").length;$(searchFactory.srchContDiv).show();$(searchFactory.srchValDiv).scrollTop(0);$(searchFactory.srchInput).focus();searchFactory.applyBrowserStyles();ZCApp.hideAndStopPropogation(C)};this.buildCache=function(A){searchFactory.createCache(A);searchFactory.setCache(A,$(searchFactory.srchContDiv).find("div[elName=srchValDiv]").html(),"")};this.createCache=function(A){if(searchFactory.getCache(A)==undefined){var B={cacheData:{},cacheLength:0,noOfRecords:0};searchFactory.cacheMap[A]=B}};this.clearCache=function(A){if(ZCUtil.isNull(A)){searchFactory.cacheMap={}}else{if(searchFactory.getCache(A)!=undefined){searchFactory.getCache(A).cacheData={}}}};this.getCache=function(A){if(searchFactory.cacheMap[A]){return searchFactory.cacheMap[A]}};this.setCache=function(B,C,A){if(searchFactory.getCache(B)!=undefined){if(searchFactory.getCache(B).cacheLength==searchFactory.cacheThreshold){searchFactory.clearCache(B)}searchFactory.getCache(B).cacheData[A]=C;searchFactory.getCache(B).cacheLength=searchFactory.getCache(B).cacheLength+1;searchFactory.getCache(B).noOfRecords=$(C).find("tr[elName=srchValtr][rowno != 0]").length}};this.bindEventHandlers=function(A){$(searchFactory.srchInput).unbind("keyup");$(searchFactory.srchInput).unbind("keydown");$(searchFactory.srchInput).unbind("click");$(searchFactory.srchValDiv).unbind("scroll");$(searchFactory.srchInput).bind("keyup",function(F){var C=F.keyCode;if((C>=ZCConstants.KEYPAD_ZERO&&C<=ZCConstants.KEYPAD_NINE)||(C>=ZCConstants.APLPHABET_A&&C<=ZCConstants.APLPHABET_Z)||(C>=ZCConstants.NUMBERPAD_ZERO&&C<=ZCConstants.NUMBERPAD_DECIMAL)||(C>=ZCConstants.KEYPAD_SEMICOLON&&C<=ZCConstants.KEYPAD_GRAVEACCENT)||(C>=ZCConstants.KEYPAD_OPENBRACE&&C<=ZCConstants.KEYPAD_SINGLEQUOTE)||C==ZCConstants.BACKSPACE||C==ZCConstants.DELETE||C==ZCConstants.SPACE||C==ZCConstants.KEYPAD_KEYPRESS_ANDROID){var E=encodeURIComponent($.trim($(searchFactory.srchInput).val()));var B=searchFactory.isSearchValueInCache(A,E);if(B){var D=searchFactory.getFilterdRowsCount($(searchFactory.srchValDiv).find("table"));if(D<searchFactory.maxRows){searchFactory.loadDataFromServer(E,A,false)}}else{searchFactory.loadDataFromServer(E,A,false)}}});$(searchFactory.srchInput).bind("keydown",function(C){var B=C.keyCode;if(B==ZCConstants.DOWN){searchFactory.currentElement++;searchFactory.moveElement(A,searchFactory.srchValDiv,B)}else{if(B==ZCConstants.UP){searchFactory.currentElement--;searchFactory.moveElement(A,searchFactory.srchValDiv,B)}else{if(B==ZCConstants.ENTER||(!C.shiftKey&&B==ZCConstants.TAB)){searchFactory.selectValue($(searchFactory.srchValDiv).find("table"));if(searchFactory.isFormulaExist=="true"&&searchFactory.formAccessType!=ZCConstants.VIEW_BULK_EDIT_FORM){ZCForm.showHideCog(searchFactory.srchDiv,"visible");if(searchFactory.isSubForm){executeFormulaforSubForm(searchFactory.mainFormEl,searchFactory.formID,searchFactory.subFormCompId,searchFactory.formCompId,searchFactory.nameOfInput,searchFactory.formAccessType,true)}else{executeFormula(searchFactory.formEl,searchFactory.formID,searchFactory.formCompId,true)}}if(searchFactory.onChangeExists=="true"&&searchFactory.formAccessType!=ZCConstants.VIEW_BULK_EDIT_FORM){ZCForm.showHideCog(searchFactory.srchDiv,"visible");if(searchFactory.isSubForm){onChangeSubFormScript(searchFactory.mainFormEl,searchFactory.formID,searchFactory.subFormCompId,searchFactory.formCompId,searchFactory.nameOfInput,searchFactory.formAccessType)}else{onChangeScript(searchFactory.formEl,searchFactory.formID,searchFactory.formCompId,searchFactory.formAccessType,true)}}if(searchFactory.fieldType==ZCConstants.SINGLE_SELECT||searchFactory.fieldType==ZCConstants.SYSTEM_LOOKUP||B==ZCConstants.TAB){$(searchFactory.srchContDiv).hide()}else{$(searchFactory.srchInput).focus()}if(B!=ZCConstants.TAB){if(searchFactory.fieldType!=ZCConstants.MULTI_SELECT){if(!searchFactory.isSubForm){$($(searchFactory.srchDiv).closest("tr").next().find(':input,textarea,div[elname="srchDiv"]').filter(":visible").get(0)).trigger("focus")}else{$($(searchFactory.srchDiv).closest("td").next().find(':input,textarea,div[elname="srchDiv"]').filter(":visible").get(0)).trigger("focus")}}return false}}else{if(B==ZCConstants.ESCAPE){$(searchFactory.srchContDiv).hide();return false}else{if(!C.shiftKey&&B==ZCConstants.TAB){$(searchFactory.srchContDiv).next().focus();$(searchFactory.srchContDiv).hide()}else{if(C.shiftKey&&B==ZCConstants.TAB){$(searchFactory.srchContDiv).prev().focus();$(searchFactory.srchContDiv).hide()}}}}}}});$(searchFactory.srchInput).focus(function(B){$(searchFactory.srchDiv).removeAttr("tabIndex")});$(searchFactory.srchInput).blur(function(B){$(searchFactory.srchDiv).attr("tabIndex",0)});$(searchFactory.srchInput).click(function(B){ZCApp.hideAndStopPropogation(B)});$(searchFactory.srchValDiv).scroll(function(B){if($(searchFactory.srchValDiv).get(0).scrollHeight-$(searchFactory.srchValDiv).get(0).scrollTop<searchFactory.scrollPointToSendReq){searchFactory.loadDataFromServer($(searchFactory.srchInput).val(),A,true)}})};this.rowEvents=function(B,A){$(B).unbind("mouseover");$(B).unbind("click");$(B).mouseover(function(C){$(searchFactory.srchValDiv).find("table").find("tr[elName=srchValtr][rowNo="+searchFactory.currentElement+"]").removeClass("zc-searchlookupselectvalue");searchFactory.currentElement=$(this).attr("rowNo");$(this).addClass("zc-searchlookupselectvalue")});$(B).click(function(E){if(searchFactory.fieldType==ZCConstants.MULTI_SELECT){$(searchFactory.srchInput).focus();ZCApp.hideAndStopPropogation(E)}var D=searchFactory.checkIsAlreadySelected(this);if(D){return }var F=$(searchFactory.srchDiv).width();if(ZCApp.isMobileSite){F=""}var C=searchFactory.formatValueToShow(this,null,searchFactory.fieldType,F);$(searchFactory.srchDiv).find("span[elName=selectEl]").hide();if(searchFactory.fieldType==ZCConstants.SINGLE_SELECT||searchFactory.fieldType==ZCConstants.SYSTEM_LOOKUP){$(searchFactory.srchDiv).find("li").remove()}$(searchFactory.srchDiv).append(C);if(searchFactory.isFormulaExist=="true"&&searchFactory.formAccessType!=ZCConstants.VIEW_BULK_EDIT_FORM){ZCForm.showHideCog(searchFactory.srchDiv,"visible");if(searchFactory.isSubForm){executeFormulaforSubForm(searchFactory.mainFormEl,searchFactory.formID,searchFactory.subFormCompId,searchFactory.formCompId,searchFactory.nameOfInput,searchFactory.formAccessType,true)}else{executeFormula(searchFactory.formEl,searchFactory.formID,searchFactory.formCompId,true)}}searchFactory.triggerRuleEvents();if(searchFactory.onChangeExists=="true"&&searchFactory.formAccessType!=ZCConstants.VIEW_BULK_EDIT_FORM){ZCForm.showHideCog(searchFactory.srchDiv,"visible");if(searchFactory.isSubForm){onChangeSubFormScript(searchFactory.mainFormEl,searchFactory.formID,searchFactory.subFormCompId,searchFactory.formCompId,searchFactory.nameOfInput,searchFactory.formAccessType)}else{onChangeScript(searchFactory.formEl,searchFactory.formID,searchFactory.formCompId,searchFactory.formAccessType,true)}}})};this.moveElement=function(B,F,A){var E=$(searchFactory.srchValDiv).find("table").find("tr[elName=srchValtr][rowNo="+searchFactory.currentElement+"]");var D=E.prop("offsetTop");var C=E.prop("offsetHeight");if($(E).val()==undefined){searchFactory.currentElement=(A==ZCConstants.DOWN)?searchFactory.currentElement-1:searchFactory.currentElement+1;if(A==ZCConstants.UP){$(F).scrollTop(0)}else{$(F).scrollTop($(F).scrollTop()+$(F).height()+10)}return }else{if($(E).css("display")=="none"){searchFactory.currentElement=(A==ZCConstants.DOWN)?searchFactory.currentElement+1:searchFactory.currentElement-1;searchFactory.moveElement(B,F,A);return }}$(searchFactory.srchValDiv).find("table").find("tr[elName=srchValtr][class=zc-searchlookupselectvalue]").removeClass("zc-searchlookupselectvalue");$(E).addClass("zc-searchlookupselectvalue");if(A==ZCConstants.DOWN){if(D>$(F).height()){$(F).scrollTop($(F).scrollTop()+C)}}else{if(D<$(F).scrollTop()){$(F).scrollTop($(F).scrollTop()-C)}}};this.isSearchValueInCache=function(B,C){var A=false;var E=searchFactory.getCache(searchFactory.nameOfInput).cacheData[C];if(searchFactory.fieldType==ZCConstants.SYSTEM_LOOKUP){searchFactory.changeDivContentByCache(B,E);A=true}else{if(E){searchFactory.changeDivContentByCache(B,E);A=true}else{for(var D=C.length-1;D>=1;D--){E=searchFactory.getCache(searchFactory.nameOfInput).cacheData[C.substring(0,D)];if(E){searchFactory.changeDivContentByCache(B,E);A=true;break}}}}return A};this.loadDataFromServer=function(A,G,I){var J=$(searchFactory.srchDiv).data("immutable");var B="/LoadLookupValues.do";var E=new Date();var C=E.getTime();var D=C-searchFactory.lastRequestSentTime;$(searchFactory.srchValDiv).find("table").find("tr[elName=noResultTr]").remove();if($(searchFactory.srchValDiv).find("table").attr("isSaturated")=="true"||!searchFactory.isRequestCompleted||J){searchFactory.filterValues(A);return }searchFactory.lastRequestSentTime=C;var F="sharedBy="+ZCApp.sharedByDisp+"&searchValue="+A+"&formCompId="+searchFactory.formCompId+"&appnedRows="+I+(!ZCUtil.isNull(searchFactory.groupByColumnName)?"&groupByColumnName="+searchFactory.groupByColumnName:"")+(!ZCUtil.isNull(searchFactory.groupByTableName)?"&groupByTableName="+searchFactory.groupByTableName:"")+"&noOfRecsInCache="+searchFactory.getCache(searchFactory.nameOfInput).noOfRecords+(!ZCUtil.isNull(searchFactory.subFormId)?"&subFormId="+searchFactory.subFormId:"");if(!ZCUtil.isNull(searchFactory.privateLink)){F=F+"&privateLink="+searchFactory.privateLink}F=F+"&formAccessType="+searchFactory.formAccessType;F=F+"&"+cloneAndGetParams(this.formEl);if(this.recLinkID&&this.subFormRow){F=F+"&subFormRecID="+this.recLinkID+"_"+this.subFormRow+"&subFormLabelName="+this.subFormLabelName}if(searchFactory.fieldType==ZCConstants.SYSTEM_LOOKUP){F=F+"&labelName="+G+"&fType="+searchFactory.fieldType}var H=F+"&labelName="+G+"&nameOfInput="+searchFactory.nameOfInput;$(searchFactory.srchDiv).parents("td:first").find("img[elName=zc-onchange-image]").css("visibility","visible");if(D<searchFactory.delay){if(D<=searchFactory.waitTime){clearTimeout(searchFactory.timeout);searchFactory.waitTime=searchFactory.waitTime-D}else{searchFactory.waitTime=(searchFactory.waitTime-D)+searchFactory.delay}}$(searchFactory.srchValDiv).find("table").append(searchFactory.getStatusMessage("Loading ..."));searchFactory.timeout=setTimeout('ZCUtil.sendRequest("'+B+'","'+F+'",'+null+',"searchFactory.loadValuesToCache","'+H+'",'+null+","+true+")",searchFactory.waitTime);searchFactory.isRequestCompleted=false};this.loadValuesToCache=function(D,C,F){var G=ZCUtil.getParamsAsMap(F);var B=G.searchValue;var E=G.labelName;var H=G.appnedRows;var A=G.noOfRecsInCache;var I=G.nameOfInput;$(searchFactory.srchDiv).parents("td:first").find("img[elName=zc-onchange-image]").css("visibility","hidden");if(H=="true"){responsenew="<tbody>"+D+"</tbody>";searchFactory.getCache(I).noOfRecords=searchFactory.getCache(I).noOfRecords+$(responsenew).find("tr[elName=srchValtr][rowno != 0]").length;if($(responsenew).find("tr[elName=srchValtr]").length<searchFactory.maxRows){$(searchFactory.srchValDiv).find("table").attr("isSaturated","true")}}else{searchFactory.setCache(I,D,B)}$(searchFactory.srchValDiv).find("table").find("tr[elName=noResultTr]").remove();searchFactory.changeDivContentByCache(E,D,H)};this.changeDivContentByCache=function(B,C,D){if(D=="true"){$(searchFactory.srchValDiv).find("table").append(C);searchFactory.applyStyleToValuesFromServer();searchFactory.rowEvents($(searchFactory.srchValDiv).find("table").find("tr[elName=srchValtr]"),B);searchFactory.filterValues(A);searchFactory.isRequestCompleted=true;return }var A=$(searchFactory.srchInput).val();$(searchFactory.srchValDiv).html(C);searchFactory.applyStyleToValuesFromServer();searchFactory.rowEvents($(searchFactory.srchValDiv).find("table").find("tr[elName=srchValtr]"),B);if(searchFactory.fieldType!=ZCConstants.SYSTEM_LOOKUP){searchFactory.rearrangeRows(A)}searchFactory.currentElement=0;if(A!=""){searchFactory.filterValues(A)}searchFactory.isRequestCompleted=true};this.filterValues=function(B){if(ZCUtil.isNull(B)){return }var G=false;B=decodeURIComponent(B);B=B.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");var F=new RegExp(B,"i");var D=$(searchFactory.srchValDiv).find("table").find("tr[elName=srchValtr][rowno != 0]");$(searchFactory.srchValDiv).find("table").find("tr[elName=srchValtr][rowno=0]").hide();for(var C=0;C<D.length;C++){var A=$(D[C]);var E=$(A).find("td").html();E=E.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&nbsp;/g," ");if(F.test(E)){$(A).show();if(!G){$(searchFactory.srchValDiv).find("table").find("tr[class=zc-searchlookupselectvalue]").removeClass("zc-searchlookupselectvalue");$(A).addClass("zc-searchlookupselectvalue");searchFactory.currentElement=$(A).attr("rowNo")}G=true}else{$(A).hide()}}if(!G){$(searchFactory.srchValDiv).find("table").find("tr[class=zc-searchlookupselectvalue]").removeClass("zc-searchlookupselectvalue");$(searchFactory.srchValDiv).find("table").append(searchFactory.getStatusMessage("No results found"))}};this.getFilterdRowsCount=function(A){var D=0;var E=$(A).find("tr");for(var B=0;B<E.length;B++){var C=$(E[B]);if($(C).css("display")!="none"){D++}}return D};this.selectValue=function(A){var E=$(A).find("tr");for(var C=0;C<E.length;C++){var D=$(E[C]);if($(D).prop("class")!=""){var B=searchFactory.checkIsAlreadySelected(D);if(B){return }var F=searchFactory.formatValueToShow(D,null,searchFactory.fieldType,$(searchFactory.srchDiv).width());$(searchFactory.srchDiv).find("span[elName=selectEl]").hide();if(searchFactory.fieldType==ZCConstants.SINGLE_SELECT||searchFactory.fieldType==ZCConstants.SYSTEM_LOOKUP){$(searchFactory.srchDiv).find("li").remove()}$(searchFactory.srchDiv).append(F);break}}};this.formatValueToShow=function(M,G,B,D,F,I){var K=ZCUtil.isNull(F)?$(M).find("td").html():F;if(K==undefined){K=""}var H=ZCUtil.isNull(F)?$(M).attr("value"):F;var A=ZCUtil.isNull(G)?searchFactory.nameOfInput:G;if(B=="searchLookupSingle"){B=ZCConstants.SINGLE_SELECT}if(ZCUtil.isNull(I)){I=K}var N='style="display:block;overflow:hidden;width:'+(D-17)+'px;"';if(newGenerateJsCodeEnabled&&!ZCUtil.isNull(F)){var L=$("<li></li>");L.attr("class","search-selected-val "+(B==ZCConstants.SINGLE_SELECT||B==ZCConstants.SYSTEM_LOOKUP?"":"search-selected-val-multi"));L.attr("selValue",H);L.append(B==ZCConstants.SINGLE_SELECT?"":'<span elName="removeVal" class="search-selected-val-del"></span>');var O=$("<span elname='inputVal'"+(B==ZCConstants.SINGLE_SELECT||B==ZCConstants.SYSTEM_LOOKUP?N:"")+" ></span>");O.attr("title",I);O.text(I);L.append(O);var J=$("<input type='hidden'/>");J.attr("name",A);J.attr("value",H);J.attr("isSubformLookup",true);L.append(J);return L}else{var E=I.replace(/"/g,"'");var C='<li class="search-selected-val '+(B==ZCConstants.SINGLE_SELECT?"":"search-selected-val-multi")+'" selValue="'+H+'" >'+(B==ZCConstants.SINGLE_SELECT?"":'<span elName="removeVal" class="search-selected-val-del"></span>')+'<span title="'+E+'" elname="inputVal" '+(B==ZCConstants.SINGLE_SELECT?N:"")+">"+I+"</span>";if(B==ZCConstants.SYSTEM_LOOKUP){C='<li class="search-selected-val '+(B==ZCConstants.SYSTEM_LOOKUP?"":"search-selected-val-multi")+'" selValue="'+H+'" >'+(B==ZCConstants.SYSTEM_LOOKUP?"":'<span elName="removeVal" class="search-selected-val-del"></span>')+'<span title="'+E+'" elname="inputVal" '+(B==ZCConstants.SYSTEM_LOOKUP?N:"")+">"+I+"</span>"}var J='<input type="hidden" name="'+A+'" value="'+H+'" isSubformLookup="true"/></li>';return(C+""+J)}};this.getStatusMessage=function(B){var A='<tr value="-1" elName="noResultTr"><td><div class="no-search-val-div">'+B+"</div></td></tr>";return A};this.checkIsAlreadySelected=function(C){var B=false;var A=$(C).attr("value");$(searchFactory.srchDiv).find("input").each(function(D,E){var F=$(E).val();if(A==F){B=true}});return B};this.applyStyleToValuesFromServer=function(){if(searchFactory.isSubForm){$(searchFactory.srchValDiv).find("table").find("td").each(function(A,B){$(B).addClass("resetGridClass")})}};this.applyBrowserStyles=function(){if($.browser.msie){var A=269;var D=$(searchFactory.srchValDiv).outerHeight();var B=D>A?A:D;$(searchFactory.srchValDiv).height(B)}if(ZCApp.isMobileSite){var C=$(searchFactory.srchDiv).outerWidth();$(searchFactory.srchInputDiv).width(C-8);$(searchFactory.srchValDiv).width(C-8);$(searchFactory.srchInput).width(C-30)}};this.rearrangeRows=function(A){A=decodeURIComponent(A);var F=$(searchFactory.srchValDiv).find("table").find("tr[elName=srchValtr][rowno != 0]");$(searchFactory.srchValDiv).find("table").find("tr[elName=srchValtr][rowno != 0]").remove();var E=new RegExp("^"+A,"i");var D=new RegExp(A,"i");for(var B=0;B<F.length;B++){var C=$(F[B]);var G=$(C).find("td").html();G=G.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"');if(E.test(G)){$(searchFactory.srchValDiv).find("table").append(C)}}for(var B=0;B<F.length;B++){var C=$(F[B]);var G=$(C).find("td").html();G=G.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"');if(!E.test(G)&&D.test(G)){$(searchFactory.srchValDiv).find("table").append(C)}}for(var B=0;B<F.length;B++){var C=$(F[B]);var G=$(C).find("td").html();G=G.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"');if(!E.test(G)&&!D.test(G)){$(C).hide();$(searchFactory.srchValDiv).find("table").append(C)}}searchFactory.rowEvents($(searchFactory.srchValDiv).find("table").find("tr[elName=srchValtr]"))};this.triggerRuleEvents=function(){if(window.RuleEvents!==undefined&&window.RuleEvents[searchFactory.formLinkName]!==undefined&&window.RuleEvents[searchFactory.formLinkName][searchFactory.labelName]!==undefined){window.RuleEvents[searchFactory.formLinkName][searchFactory.labelName]()}}};if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());var ZCReport=new function(){this.getReportCont=function(A){return $("#zc-reportcontainer_"+A)};this.hideReportMenus=function(A){if($(A)[0]){ZCUtil.hideMenu($(A)[0],$(A).find("div[elName=zc-moreactionsdiv]")[0])}};this.showMoreActions=function(B,C,A){ZCUtil.showDropDownMenu($(B)[0],ZCReport.getReportCont(C).find("div[elName=zc-moreactionsdiv]")[0]);ZCApp.hideAndStopPropogation(A)};this.showRepDialog=function(C,G){var B=ZCReport.getReportCont(G);var E=$(C).attr("dialogElName");if(ZCApp.htmlArr[G+"-"+E]==null){var D=$(B).find("div[elName="+E+"]");ZCApp.htmlArr[G+"-"+E]=$(D).html();$(D).remove()}ZCUtil.showInDialog(ZCApp.htmlArr[G+"-"+E],"closeButton=no, modal=yes");if(E=="zc-perma-dialog"){var F=$("div[elName=zc-perma-dialog-div]");ZCApp.toggleLoginPrompt(B,F,G);ZCApp.setPermaLink(B,F,G)}else{if(E=="zc-embed-dialog"){var A=$("div[elName=zc-embed-dialog-div]");ZCApp.toggleLoginPrompt(B,A,G);ZCApp.setEmbedLink(B,A)}}};this.exportAsPDF=function(D){var A=ZCReport.getReportCont(D);var B=$(A).find("div[elName=zc-linkinfo-div]");var C=$(B).attr("scheme")+"://"+$(B).attr("exportServerPrefix")+"/"+ZCApp.sharedByDisp+"/"+ZCApp.appLinkName+"/report-pdf/"+D+"/";window.open(C)};this.regenerateReport=function(A){ZCUtil.sendRequest("/genReport.do","reportLinkName="+A,"json","ZCReport.showHint","",i18n.pleasewait)};this.showHint=function(B,C){var D=ZCUtil.getFromMap(C,"repLinkName");var A=ZCApp.getRespArr(B);if(A.ZCSTATUS=="SUCCESS"){ZCApp.showFadingMsg(i18n.regensuccmsg1+"\n"+i18n.regensuccmsg2,0,5000)}else{if(A.ZCERROR=="DENIED"){ZCApp.showFadingMsg(i18n.deniedmsg1,0,2000)}else{ZCApp.showFadingMsg(i18n.regenfailmsg,0,2000)}}}};var layerCount=1;var _DIALOG_LAYER_VAR="_DIALOG_LAYER";var FreezeLayer_VAR="FreezeLayer";var FreezeIFrame_VAR="FreezeIFrame";var oDialog,doc,srcEl,closeOnEscKey=true,closeOnBodyClick=false,needIframe=true,iframeIEHack,isTransparentFreezeLayer=false;var dialogProperties=new Array("position","top","left","height","width","srcElement","modal","draggable","title","closeButton","closeOnEscKey","transitionType","transitionInterval","closeOnBodyClick","needIframe","closeParent","maxWidth","closeOutside","closelink");var oCloseClBk=null;function showDialoginExistingLayer(I,K,D,N,H){var O="_DIALOG_LAYER_"+I;var L=document.getElementById(O);var J=K;var K='<div id="_DIALOG_CONTENT">'+K+"</div>";var G='<table class="DialogBox" border="0" cellspacing="0" cellpadding="0"><tr><td class="boxTL">&nbsp;</td>';if(dialog_draggable!="undefined"&&dialog_draggable=="no"){G+='<td class="boxHeader">'}else{G+='<td class="boxHeader drag" onMouseDown="captureDialog(event)">'}if(dialog_title!="undefined"){if(dialog_title.charAt(0)=="'"&&dialog_title.charAt(dialog_title.length-1)=="'"){dialog_title=dialog_title.substr(1,dialog_title.length-2)}if(dialog_title.trim().length==0){dialog_title="&nbsp;"}}else{dialog_title="&nbsp;"}G+=dialog_title+'</td><td class="boxCtrlButtonPane">';if(dialog_closeButton!="undefined"&&dialog_closeButton=="no"){G+="&nbsp;</td>"}else{G+='<input type="button" class="closeButton" onClick="closeDialog()"></td>'}G+='<td class="boxTR">&nbsp;</td></tr><tr><td colspan="4" class="boxContent">'+K+"</td></tr>";G+='<tr><td class="boxBL"></td><td class="boxBC" colspan="2"></td><td class="boxBR"></td></tr></table>';L.style.display="block";var E=true;if(dialog_closeButton!="undefined"){if(dialog_title=="&nbsp;"&&dialog_closeButton=="no"){E=false}}if(E){L.innerHTML="<table cellpadding='0' cellspacing='0' class='dialog-border'><tr><td height='100%' style='display:block'>"+G+"</td></tr></table>"}else{L.innerHTML="<table cellpadding='0' cellspacing='0' class='dialog-border'><tr><td height='100%' style='display:block'>"+K+"</td></tr></table>"}if(typeof isViewBeta!="undefined"&&isViewBeta){var M="zc-dialog-align-property";if(dialog_closeOutside!="undefined"&&dialog_closeOutside=="true"){M="zc-dialog-align-property-close"}var C='<table class="zc-dialog-box-shadow"  cellpadding="0" cellspacing="0"><tr><td height="100%" style="display:block"><div id="_DIALOG_CONTENT"><div elname="zc-dialog-container" class="zc-dialog-containner zc-dialog-appearence '+M+'" style="" onmousedown="captureDialog(event)">';if(dialog_closelink=="undefined"||dialog_closelink=="yes"){C=C+'<div class="zc-dialog-close" onclick="ZCApp.closeDialog();"></div><div class="zc-dialog-close-old" onclick="ZCApp.closeDialog();"><span>Close</span></div>'}C=C+J+"</div></div></td></tr></table>";oDialog.innerHTML=C}var B=L.getElementsByTagName("SCRIPT");for(var F=0;F<B.length;F++){var A=document.createElement("SCRIPT");A.type="text/javascript";A.language="javascript";if(B[F].src!=""){A.src=B[F].src}A.text=B[F].text;if(typeof document.getElementsByTagName("HEAD")[0]=="undefined"){document.createElement("HEAD").appendChild(A)}else{document.getElementsByTagName("HEAD")[0].appendChild(A)}}return L}function showDialog(W,G,B,F){_DIALOG_LAYER_VAR="_DIALOG_LAYER_"+layerCount;FreezeLayer_VAR="FreezeLayer_"+layerCount;FreezeIFrame_VAR="FreezeIFrame_"+layerCount;oCloseClBk=F;if(typeof (G)=="undefined"){var G="position=absmiddle"}G=G.split(",");var b;for(var Y=0;Y<dialogProperties.length;Y++){b=false;for(var X=0;X<G.length;X++){if(G[X].indexOf(dialogProperties[Y])>=0){b=true;break}}self["dialog_"+dialogProperties[Y]]=(b)?G[X].substr(G[X].indexOf("=")+1,G[X].length).trim():"undefined"}if(dialog_closeParent=="undefined"){dialog_closeParent=true}oldDialogId=document.getElementById(_DIALOG_LAYER_VAR);if(dialog_closeParent&&oldDialogId!=null&&oldDialogId){oldDialogId.parentNode.removeChild(oldDialogId)}oDialog=document.createElement("DIV");oDialog.id=_DIALOG_LAYER_VAR;document.body.appendChild(oDialog);var S=W;var W='<div id="_DIALOG_CONTENT">'+W+"</div>";var N='<table class="DialogBox" border="0" cellspacing="0" cellpadding="0"><tr><td class="boxTL">&nbsp;</td>';if(dialog_draggable!="undefined"&&dialog_draggable=="no"){N+='<td class="boxHeader">'}else{N+='<td class="boxHeader drag" onMouseDown="captureDialog(event)">'}if(dialog_title!="undefined"){if(dialog_title.charAt(0)=="'"&&dialog_title.charAt(dialog_title.length-1)=="'"){dialog_title=dialog_title.substr(1,dialog_title.length-2)}if(dialog_title.trim().length==0){dialog_title="&nbsp;"}}else{dialog_title="&nbsp;"}N+=dialog_title+'</td><td class="boxCtrlButtonPane">';if(dialog_closeButton!="undefined"&&dialog_closeButton=="no"){N+="&nbsp;</td>"}else{N+='<input type="button" class="closeButton" onClick="ZCApp.closeDialog()"></td>'}N+='<td class="boxTR">&nbsp;</td></tr><tr><td colspan="4" class="boxContent">'+W+"</td></tr>";N+='<tr><td class="boxBL"></td><td class="boxBC" colspan="2"></td><td class="boxBR"></td></tr></table>';oDialog.style.display="block";var I=true;if(dialog_closeButton!="undefined"){if(dialog_title=="&nbsp;"&&dialog_closeButton=="no"){I=false}}if(I){oDialog.innerHTML="<table cellpadding='0' cellspacing='0' class='dialog-border'><tr><td height='100%' style='display:block'>"+N+"</td></tr></table>"}else{oDialog.innerHTML="<table cellpadding='0' cellspacing='0' class='dialog-border'><tr><td height='100%' style='display:block'>"+W+"</td></tr></table>"}if((typeof isViewBeta!="undefined"&&isViewBeta)||showSecurityBannerInLive){var V="zc-dialog-align-property";if(dialog_closeOutside!="undefined"&&dialog_closeOutside=="true"){V="zc-dialog-align-property-close"}var E='<table class="zc-dialog-box-shadow"  cellpadding="0" cellspacing="0"><tr><td height="100%" style="display:block"><div id="_DIALOG_CONTENT"><div elname="zc-dialog-container" class="zc-dialog-containner zc-dialog-appearence '+V+'" style="" onmousedown="captureDialog(event)">';if(dialog_closelink=="undefined"||dialog_closelink=="yes"){E=E+'<div class="zc-dialog-close" onclick="ZCApp.closeDialog();"></div><div class="zc-dialog-close-old" onclick="ZCApp.closeDialog();"><span>'+i18n.formliveclose+"</span></div>"}E=E+S+"</div></div></td></tr></table>";oDialog.innerHTML=E}oDialog.style.position="absolute";oDialog.style.left="-1000px";oDialog.style.top="-1000px";oDialog.style.zIndex=91+layerCount;if(dialog_position!="relative"){var e=150;var C=350;if(self.dialog_maxWidth!="undefined"){if(oDialog.offsetWidth>self.dialog_maxWidth){oDialog.style.width=self.dialog_maxWidth+"px"}}var O=getIEClientHeight();var h=getIEClientWidth();var M=oDialog.offsetWidth;var f=oDialog.offsetHeight;if(layerCount>1){var H=_DIALOG_LAYER_VAR.substring(_DIALOG_LAYER_VAR.lastIndexOf("_")+1);H=H-1;h=document.getElementById("_DIALOG_LAYER_"+H).offsetWidth;O=document.getElementById("_DIALOG_LAYER_"+H).offsetHeight}if((O-f)>0){if(((O-f)/2)<150){e=(O-f)/2}}else{if((O-f)<=0){e=0}}if((h-M)>0){if(((h-M)/2)<350){C=(h-M)/2}}else{if((h-M)<=0){C=0}}if(layerCount>1){var H=_DIALOG_LAYER_VAR.substring(_DIALOG_LAYER_VAR.lastIndexOf("_")+1);H=H-1;var D=document.getElementById("_DIALOG_LAYER_"+H).style.left;D=D.substring(0,D.indexOf("px"));var R=document.getElementById("_DIALOG_LAYER_"+H).style.top;R=R.substring(0,R.indexOf("px"));C=C+parseInt(D);e=e+parseInt(R)}dialog_left=C;dialog_top=e}if(browser_opera){var d=W;var Z=oDialog.getElementsByTagName("STYLE");for(var Y=0;Y<Z.length;Y++){Z[Y].innerHTML=d.substring(d.indexOf("<style>")+7,d.indexOf("</style>")-1);d=d.substring(d.indexOf("</style>")+8,d.length)}}if(dialog_width!="undefined"){if(browser_ie){oDialog.childNodes[0].style.width=parseInt(dialog_width)+"px"}else{if(browser_nn4||browser_nn6){oDialog.childNodes.item(0).style.width=parseInt(dialog_width)+"px"}}}if(dialog_height!="undefined"){if(browser_ie){oDialog.childNodes[0].style.height=parseInt(dialog_height)+"px"}else{if(browser_nn4||browser_nn6){oDialog.childNodes.item(0).style.height=parseInt(dialog_height)+"px"}}}oDialogContent=document.getElementById("_DIALOG_CONTENT");var D=0,R=0;if(typeof isViewBeta=="undefined"||!isViewBeta){if(browser_opera){if(dialog_width!="undefined"){oDialogContent.style.width=parseInt(dialog_width)+"px"}else{Content.style.width=oDialogContent.offsetWidth+"px";oDialog.style.width=oDialogContent.offsetWidth+"px"}}if(browser_nn4||browser_nn6||browser_ie){if(!browser_chrome){oDialogContent.style.width="100%"}if(dialog_width!="undefined"){oDialogContent.style.width=parseInt(dialog_width)+"px"}else{var A=getWindowWidth()-100;if(A>oDialogContent.offsetWidth){A=oDialogContent.offsetWidth+20}oDialogContent.style.width=(A)+"px"}}if(dialog_height!="undefined"){if(browser_ie&&(parseInt(dialog_height)<oDialogContent.offsetHeight)){D=-15}oDialogContent.style.height=parseInt(dialog_height)+"px"}oDialogContent.style.overflowX="auto"}if(browser_ie){oDialogContent.style.paddingBottom="17px"}var U=oDialog.offsetWidth;var T=oDialog.offsetHeight;doc=findDocDim();if(dialog_closeOnEscKey!="undefined"&&dialog_closeOnEscKey=="no"){closeOnEscKey=false}else{closeOnEscKey=true}if(dialog_closeOnBodyClick!="undefined"&&dialog_closeOnBodyClick=="yes"){closeOnBodyClick=true}else{closeOnBodyClick=false}if(dialog_needIframe!="undefined"&&dialog_needIframe=="no"){needIframe=false}else{needIframe=true}if(!browser_opera){if(dialog_modal!="undefined"&&dialog_modal=="yes"){freezeBackground()}else{if(document.getElementById(FreezeLayer_VAR)!=null){document.body.removeChild(document.getElementById(FreezeLayer_VAR))}}}if(dialog_left!="undefined"){D+=parseInt(dialog_left)}if(dialog_top!="undefined"){R+=parseInt(dialog_top)}var c=(getIEScrollLeft()>0)?15:0;var J=(getIEScrollTop()>0)?15:0;if(dialog_position!="undefined"&&dialog_position=="relative"){if(dialog_srcElement!="undefined"){srcEl=getObj(dialog_srcElement)}else{if(srcEl==null){srcEl=document.body}}var Q=(srcEl.offsetWidth)?srcEl.offsetWidth:0;var a=(srcEl.offsetHeight)?srcEl.offsetHeight:0;if(findPosX(srcEl)+U>doc.width-c){D+=findPosX(srcEl)+Q-U}else{D+=findPosX(srcEl)}if(findPosY(srcEl)+a+T>doc.height-J){R+=findPosY(srcEl)-T}else{R+=findPosY(srcEl)+a+2}}else{if(dialog_position!="undefined"&&dialog_position=="current"){if(dialog_cursor_left!=null&&dialog_cursor_top!=null){D=dialog_cursor_left;R=dialog_cursor_top}else{D=R=0}D=(dialog_cursor_left!=null)?dialog_cursor_left:0;R=(dialog_cursor_top!=null)?dialog_cursor_top:0;if(D+U>doc.width-c){D-=U}if(R+T>doc.height-J){R-=T}}else{if(dialog_position!="undefined"&&dialog_position=="absolute"){D=getIEScrollLeft()+(document.body.clientWidth/2)-(U/2);if(browser_ie){R+=getIEScrollTop()}else{R+=document.documentElement.scrollTop}}else{D=getIEScrollLeft()+(getIEClientWidth()/2)-(U/2);R=getIEScrollTop()+(getIEClientHeight()/2)-(T/2)}}}D=(D>0)?D:0;R=(R>0)?R:0;if(dialog_transitionType!="undefined"){if(dialog_transitionInterval=="undefined"){dialog_transitionInterval=10}Effect.init({type:dialog_transitionType,speed:dialog_transitionInterval,layerId:_DIALOG_LAYER_VAR,layerTop:R,layerLeft:D});Effect.display()}else{oDialog.style.left=parseInt(D)+"px";oDialog.style.top=parseInt(R)+"px"}if(browser_ie&&!browser_opera&&needIframe==true){iframeIEHack=document.createElement("IFRAME");iframeIEHack.id=FreezeIFrame_VAR;iframeIEHack.scrolling="no";iframeIEHack.frameBorder=0;if(window.CONTEXT_PATH!=null){iframeIEHack.src=CONTEXT_PATH+"/framework/html/blank.html"}iframeIEHack.style.position="absolute";iframeIEHack.style.zIndex=89+layerCount;iframeIEHack.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)";if(dialog_modal!="undefined"&&dialog_modal=="yes"){iframeIEHack.style.width=document.getElementById(FreezeLayer_VAR).style.width;iframeIEHack.style.top="0px";iframeIEHack.style.left="0px"}else{iframeIEHack.style.width=oDialog.offsetWidth+"px";iframeIEHack.style.height=oDialog.offsetHeight+"px";iframeIEHack.style.top=parseInt(R)+"px";iframeIEHack.style.left=parseInt(D)+"px"}document.body.appendChild(iframeIEHack)}if(!browser_opera){if(dialog_modal!="undefined"&&dialog_modal=="yes"){var P=findFullDocDim();document.getElementById(FreezeLayer_VAR).style.width=P.width+"px";document.getElementById(FreezeLayer_VAR).style.height=P.height+"px";if(browser_ie&&iframeIEHack!=null){iframeIEHack.style.height=document.getElementById(FreezeLayer_VAR).style.height}}}var L=oDialog.getElementsByTagName("SCRIPT");for(var Y=0;Y<L.length;Y++){var K=document.createElement("SCRIPT");K.type="text/javascript";K.language="javascript";if(L[Y].src!=""){K.src=L[Y].src}K.text=L[Y].text;if(typeof document.getElementsByTagName("HEAD")[0]=="undefined"){document.createElement("HEAD").appendChild(K)}else{document.getElementsByTagName("HEAD")[0].appendChild(K)}}if(B!=null&&typeof B!="undefined"){B()}layerCount++;return oDialog}resizeDialog=function(A){if(A[0]!=undefined){A[0].style.width="100%";var B=getWindowWidth()-100;if(B>A[0].offsetWidth){B=A[0].offsetWidth+20}A[0].style.width=(B)+"px";var C=getWindowWidth()/2-A[0].offsetWidth/2;$(A[0]).parents("div[id *= _DIALOG_LAYER]:first")[0].style.left=parseInt(C)+"px"}};function freezeBackground(){var A=document.createElement("DIV");A.id=FreezeLayer_VAR;A.className="freezeLayer";if((typeof isViewBeta!="undefined"&&isViewBeta)||showSecurityBannerInLive){A.className="freezeLayer freezeLayer-color"}A.style.width="100%";A.style.zIndex=90+layerCount;document.body.appendChild(A);if(isTransparentFreezeLayer==true){A.style.background="#FFFFFF";A.style.opacity="0"}}var diffLeft=0,diffTop=0;function captureDialog(A){oDialog.style.cursor="move";if(browser_ie){diffLeft=window.event.clientX+getIEScrollLeft()-parseInt(findPosX(oDialog));diffTop=window.event.clientY+getIEScrollTop()-parseInt(findPosY(oDialog))}else{if(browser_nn4||browser_nn6){diffLeft=A.pageX-parseInt(findPosX(oDialog));diffTop=A.pageY-parseInt(findPosY(oDialog))}}document.onmousemove=moveDialog;document.onmouseup=releaseDialog}function stopPropogation(A){if($.browser.msie){window.event.cancelBubble=true}else{if(browser_nn6){A.stopPropagation()}}}function moveDialog(A){clearTextSelection();if(browser_ie){var C=window.event.clientX+getIEScrollLeft()-diffLeft;var B=window.event.clientY+getIEScrollTop()-diffTop;C=(C>=0)?C:0;B=(B>=0)?B:0;if(document.getElementById(FreezeLayer_VAR)!=null||browser_opera||iframeIEHack==null){oDialog.style.left=C+"px";oDialog.style.top=B+"px"}else{oDialog.style.left=iframeIEHack.style.left=C+"px";oDialog.style.top=iframeIEHack.style.top=B+"px"}}else{if(browser_nn4||browser_nn6){oDialog.style.left=((A.pageX-diffLeft>0)?A.pageX-diffLeft:0)+"px";oDialog.style.top=((A.pageY-diffTop>0)?A.pageY-diffTop:0)+"px"}}}function releaseDialog(){oDialog.style.cursor="default";document.onmousemove=null;document.onmouseup=null}function closeDialog(A){if(oDialog!=null&&oDialog.style.display!="none"){document.body.removeChild(oDialog);if(document.getElementById(FreezeLayer_VAR)!=null){document.getElementById(FreezeLayer_VAR).parentNode.removeChild(document.getElementById(FreezeLayer_VAR))}if(browser_ie&&!browser_opera&&iframeIEHack!=null){document.body.removeChild(iframeIEHack)}closeOnBodyClick=false;if(oCloseClBk&&oCloseClBk!=null&&oCloseClBk!="undefined"){oCloseClBk()}if(typeof A!="undefined"&&A.srcElement=="undefined"){A()}var B=_DIALOG_LAYER_VAR.substring(_DIALOG_LAYER_VAR.lastIndexOf("_")+1);B=B-1;_DIALOG_LAYER_VAR="_DIALOG_LAYER_"+B;FreezeLayer_VAR="FreezeLayer_"+B;FreezeIFrame_VAR="FreezeIFrame_"+B;oDialog=document.getElementById(_DIALOG_LAYER_VAR);iframeIEHack=document.getElementById(FreezeIFrame_VAR);layerCount--;if(ZCForm.focusElement!=""){ZCForm.focusElement.focus();ZCForm.focusElement=""}}}function closeAllDialog(){while(layerCount>1){closeDialog()}}function selElemData(A){A.select()}document.onkeydown=function(A){if(browser_ie){var B=window.event.keyCode}else{if(browser_nn4||browser_nn6){var B=A.which}}if(B==27&&closeOnEscKey==true&&oDialog!=null&&oDialog.style.display!="none"){closeDialog()}};var dialog_cursor_left,dialog_cursor_top;document.onmousedown=function(B){if(browser_ie){srcEl=window.event.srcElement}else{if(browser_nn4||browser_nn6){srcEl=B.target}}var G=getCursorPos(B);var A=G.x;var F=G.y;dialog_cursor_left=A;dialog_cursor_top=F;if(typeof closeOnBodyClick!="undefined"&&closeOnBodyClick==true&&oDialog!=null&&oDialog.style.visibility!="hidden"){if((A<findPosX(oDialog)||A>=findPosX(oDialog)+oDialog.offsetWidth)||(F<findPosY(oDialog)||F>=findPosY(oDialog)+oDialog.offsetHeight)){var D=getIEScrollBarPos();var E=D.scrollX;var C=D.scrollY;if(A<E&&F<C){closeDialog()}}}};function getIEScrollBarPos(){var B=18;if(browser_ie){var A=document.body.offsetWidth+getIEScrollLeft()-B;var C=document.body.offsetHeight+getIEScrollTop()-B}else{var A=getWindowWidth()+window.pageXOffset-B;var C=getWindowHeight()+window.pageYOffset-B}return{scrollX:A,scrollY:C}}function getCursorPos(B){if(browser_ie){var A=window.event.clientX+getIEScrollLeft();var C=window.event.clientY+getIEScrollTop()}else{if(browser_nn6){var A=B.pageX;var C=B.pageY}}return{x:A,y:C}}var scrollEnd=0,cnt=0;function scrollPage(){if(cnt<=scrollEnd){document.body.scrollTop+=10;cnt+=10}else{scrollEnd=cnt=0;clearInterval(scrollInterval)}}function showURLInDialog(C,D,B,A){callBack=function(E){var F=showDialog(E.responseText,D,B);if(A){F.setAttribute("opener",A)}};AjaxAPI.sendRequest({METHOD:"GET",URL:C,ONSUCCESSFUNC:callBack})}function closeParentDialog(A,C){closeDialog();if(C){var B=DOMUtils.getParentWithAttr(A,"opener");AjaxAPI.refreshOpener({OPENER:B.getAttribute("opener")})}}function callDialog(D,B,A){var C="<div class='zc-dialogheader' elname='zc-dialogheader' onmousedown='captureDialog(event)'><table cellspacing='0' cellpadding='0' border='0'><tr><td class='zc-dialog-left'>";if(D&&D!=""){C=C+D+"</td>"}else{C=C+"&nbsp;</td>"}C=C+"<td class='zc-dialog-right' onclick='closeDialog();'>Close</td></tr></table></div><div class='zc-appformcontent' style='padding:2px;'><table border='0' cellpadding='0' cellspacing='0'><tr><td>";if(B&&B!=""){C=C+B+"</td></tr></table></div>"}else{C=C+"&nbsp;</td></tr></table></div>"}showDialog(C,A)}var ZCDialogLayer=new function(){this.showDialog=function(G,B,A,H,E){var I;var C;if(A){if(A.viewLinkName){I="zc-viewcontainer_"+A.viewLinkName[0]}else{if(A.formLinkName){C=A.formLinkName[0]}}if(I||C){for(var D=1;D<layerCount;D++){var F=document.getElementById("_DIALOG_LAYER_"+D);if((I&&$(F).find("[id="+I+"]")[0])||(C&&$(F).find("form[elName="+C+"]")[0])){return showDialoginExistingLayer(D,G,B,H,E)}}}}return showDialog(G,B,H,E)}};function Tour(B,A){this.cookieName=A;this.tourObjects=B;this.tourObjectNo=0;this.curr_Tour_El=null;this.curr_tour_obj={element:null,title:"",message:"",arrow:"",highlight:false,offset:{},onBefore:function(){},tour:function(){},prev:function(){},next:function(){}};$(document).unbind("keyup").bind("keyup",function(D){var C=D.keyCode;if(C==39){$("#tour").find("a[en=next]").trigger("click")}if(C==37){$("#tour").find("a[en=prev]").trigger("click")}if(C==27){escapeEventStack.push(function(){$("#tour").find("div[elName=finish]").trigger("click")})}})}Tour.prototype.startTour=function(){var A=this;A.curr_tour_obj=A.tourObjects[A.tourObjectNo];if(A.curr_tour_obj==undefined){return 0}if(A.curr_tour_obj.onBefore!=undefined){(A.curr_tour_obj.onBefore)()}A.triggerTour()};Tour.prototype.endTour=function(){var A=this;var B=A.getTourMessage();$(B).find("div[elName=finish]").trigger("click")};Tour.prototype.triggerTour=function(){var A=this;var B=A.getTourMessage();A.curr_Tour_El=$(B);if(A.tourObjectNo==0){$(B).find("a[en=prev]").hide()}else{$(B).find("a[en=prev]").show()}if(A.tourObjectNo==(A.tourObjects.length-1)){$(B).find("a[en=next]").hide()}else{$(B).find("a[en=next]").show()}($(A.curr_tour_obj.tour))[0];$(B).find("a[en=prev]").click(function(C){A.prev();stopEventPropagation(C)});$(B).find("a[en=next]").click(function(C){if(A.curr_tour_obj.isLast){$(B).find("div[elName=finish]").trigger("click");return false}A.next();stopEventPropagation(C)})};Tour.prototype.next=function(){var A=this;$(A.curr_tour_obj.element).removeClass("tourParentContainer");$(A.curr_tour_obj.element).removeClass("highlight");A.tourObjectNo=A.tourObjectNo+1;if(A.tourObjectNo>A.tourObjects.length){A.tourObjectNo=A.tourObjects.length}$(A.curr_tour_obj.next)[0];A.startTour()};Tour.prototype.prev=function(){var A=this;$(A.curr_tour_obj.element).removeClass("tourParentContainer");$(A.curr_tour_obj.element).removeClass("highlight");A.tourObjectNo=A.tourObjectNo-1;if(A.tourObjectNo<0){A.tourObjectNo=0}$(A.curr_tour_obj.prev)[0];A.startTour()};Tour.prototype.tour=function(B){var A=this;if(isTourFinished(A.cookieName)){return }if(B!=undefined){A.tourObjectNo=B;A.startTour();return }};Tour.prototype.getTourMessage=function(){var J=this;var A=getTourMessage(J);$(J.curr_tour_obj.element).append(A);$(J.curr_tour_obj.element).addClass("tourParentContainer");var B=20;var H=20;var I=$(document).width()-($(J.curr_tour_obj.element).offset().left+$(J.curr_tour_obj.element).width());var E=$(J.curr_tour_obj.element).offset().left;var D=$(document).height()-($(J.curr_tour_obj.element).offset().top+$(J.curr_tour_obj.element).height());var C=$(J.curr_tour_obj.element).offset().top;if(J.curr_tour_obj.highlight==undefined){J.curr_tour_obj.highlight=false}var F={left:0,right:0,top:0};var G="";if(($(A).width()<I||$(A).width()<E)&&(($(A).height()/2)<C||($(A).height()/2)<D)&&B<C&&B<D){F.left=$(A).width()<I?parseInt($(J.curr_tour_obj.element).width()):-parseInt($(A).outerWidth(true));G=$(A).width()<I?"tourleftArrow":"tourrightArrow"}else{if(($(A).height()<C||$(A).height()<D)&&(($(A).width()/2)<I||($(A).width()/2)<E)&&H<I&&H<E){F.top=$(A).height()>C?parseInt($(J.curr_tour_obj.element).outerHeight(true)):-parseInt($(A).outerHeight(true));G=$(A).height()<C?"tourbottomArrow":"tourtopArrow"}}G=(J.curr_tour_obj.arrow==undefined)?G:"tour"+J.curr_tour_obj.arrow+"Arrow";$(A).css(F).find(".tourArrow").addClass(G);if(J.curr_tour_obj.offset!=undefined){$(A).css(J.curr_tour_obj.offset)}if(J.curr_tour_obj.highlight){$(J.curr_tour_obj.element).addClass("highlight")}return A};Tour.prototype.changeCurrentTourTitle=function(B){var A=this;$(A.curr_Tour_El).find("h2").text(B)};Tour.prototype.changeCurrentTourMsg=function(B){var A=this;$(A.curr_Tour_El).find("p").text(B)};function getTourMessage(B){if($("#tour").length!=0){$("#tour").find("h2").text(B.curr_tour_obj.title);$("#tour").find("p").html(B.curr_tour_obj.message);$("#tour").find("b[en=arrow]").attr("class","tourArrow");$("#tour").find("b[en=number]").text((B.tourObjectNo+1)+"/"+B.tourObjects.length);$("#tour").find("a").unbind("click");return $("#tour")}var A=$('<div id="tour" class="tourhelper"><div elname="finish" class="tourCloseWrapper"><div class="tourClose"></div></div><b en="arrow" class="tourArrow"><small></small></b><div class="content"><h2 class="title">'+B.curr_tour_obj.title+"</h2><p>"+B.curr_tour_obj.message+'</p><div class="tourButton"><a href="javascript:;" en="prev" class="tourprevarrow"></a><b en="number">'+(B.tourObjectNo+1)+"/"+B.tourObjects.length+'</b><a href="javascript:;" en="next" style="float:right;" class="tournextarrow"></a></div></div></div>');$(A).find("div[elName=finish]").click(function(C){setCookie(B.cookieName,true,2000);$("#tour").fadeOut(500,function(){$(this).remove()});$("#tour").unbind("hover");$(B.curr_tour_obj.element).removeClass("tourParentContainer")});$(A).click(function(C){stopEventPropagation(C)});return A}function stopEventPropagation(A){if($.browser.msie){window.event.cancelBubble=true}else{A.stopPropagation()}}function getCookie(B){var D=document.cookie.split(";");var A;var E;for(var C=0;C<D.length;C++){A=D[C].substr(0,D[C].indexOf("="));E=D[C].substr(D[C].indexOf("=")+1);A=A.replace(/^\s+|\s+$/g,"");if(A==B){return unescape(E)}}}function setCookie(B,D,A){var C=new Date();C.setDate(C.getDate()+A);D=escape(D)+((A==null)?"":";expires="+C.toUTCString());D=D+";path=/";document.cookie=B+"="+D}function isTourFinished(A){var B=getCookie(A);if(B!=null&&B!=undefined){return true}else{return false}}function deleteCookie(A){setCookie(A,false,-1)}function closeAllTour(){$("#tour").remove()}Calendar=function(D,C,F,A){this.activeDiv=null;this.currentDateEl=null;this.getDateStatus=null;this.getDateToolTip=null;this.getDateText=null;this.timeout=null;this.onSelected=F||null;this.onClose=A||null;this.dragging=false;this.hidden=false;this.minYear=1970;this.maxYear=2050;this.dateFormat=Calendar._TT.DEF_DATE_FORMAT;this.ttDateFormat=Calendar._TT.TT_DATE_FORMAT;this.isPopup=true;this.weekNumbers=true;this.firstDayOfWeek=typeof D=="number"?D:Calendar._FD;this.showsOtherMonths=false;this.dateStr=C;this.ar_days=null;this.showsTime=false;this.time24=true;this.yearStep=2;this.hiliteToday=true;this.multiple=null;this.table=null;this.element=null;this.tbody=null;this.firstdayname=null;this.monthsCombo=null;this.yearsCombo=null;this.hilitedMonth=null;this.activeMonth=null;this.hilitedYear=null;this.activeYear=null;this.dateClicked=false;if(typeof Calendar._SDN=="undefined"){if(typeof Calendar._SDN_len=="undefined"){Calendar._SDN_len=3}var B=new Array();for(var E=8;E>0;){B[--E]=Calendar._DN[E].substr(0,Calendar._SDN_len)}Calendar._SDN=B;if(typeof Calendar._SMN_len=="undefined"){Calendar._SMN_len=3}B=new Array();for(var E=12;E>0;){B[--E]=Calendar._MN[E].substr(0,Calendar._SMN_len)}Calendar._SMN=B}};Calendar._C=null;Calendar.is_ie=(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent));Calendar.is_ie5=(Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent));Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);Calendar.getAbsolutePos=function(E){var A=0,D=0;var C=/^div$/i.test(E.tagName);if(C&&E.scrollLeft){A=E.scrollLeft}if(C&&E.scrollTop){D=E.scrollTop}var F={x:E.offsetLeft-A,y:E.offsetTop-D};if(E.offsetParent){var B=this.getAbsolutePos(E.offsetParent);F.x+=B.x;F.y+=B.y}return F};Calendar.isRelated=function(C,A){var D=A.relatedTarget;if(!D){var B=A.type;if(B=="mouseover"){D=A.fromElement}else{if(B=="mouseout"){D=A.toElement}}}while(D){if(D==C){return true}D=D.parentNode}return false};Calendar.removeClass=function(E,D){if(!(E&&E.className)){return }var A=E.className.split(" ");var B=new Array();for(var C=A.length;C>0;){if(A[--C]!=D){B[B.length]=A[C]}}E.className=B.join(" ")};Calendar.addClass=function(B,A){Calendar.removeClass(B,A);B.className+=" "+A};Calendar.getElement=function(A){var B=Calendar.is_ie?window.event.srcElement:A.currentTarget;while(B.nodeType!=1||/^div$/i.test(B.tagName)){B=B.parentNode}return B};Calendar.getTargetElement=function(A){var B=Calendar.is_ie?window.event.srcElement:A.target;while(B.nodeType!=1){B=B.parentNode}return B};Calendar.stopEvent=function(A){A||(A=window.event);if(Calendar.is_ie){A.cancelBubble=true;A.returnValue=false}else{A.preventDefault();A.stopPropagation()}return false};Calendar.addEvent=function(A,C,B){if(A.attachEvent){A.attachEvent("on"+C,B)}else{if(A.addEventListener){A.addEventListener(C,B,true)}else{A["on"+C]=B}}};Calendar.removeEvent=function(A,C,B){if(A.detachEvent){A.detachEvent("on"+C,B)}else{if(A.removeEventListener){A.removeEventListener(C,B,true)}else{A["on"+C]=null}}};Calendar.createElement=function(C,B){var A=null;if(document.createElementNS){A=document.createElementNS("http://www.w3.org/1999/xhtml",C)}else{A=document.createElement(C)}if(typeof B!="undefined"){B.appendChild(A)}return A};Calendar._add_evs=function(el){with(Calendar){addEvent(el,"mouseover",dayMouseOver);addEvent(el,"mousedown",dayMouseDown);addEvent(el,"mouseout",dayMouseOut);if(is_ie){addEvent(el,"dblclick",dayMouseDblClick);el.setAttribute("unselectable",true)}}};Calendar.findMonth=function(A){if(typeof A.month!="undefined"){return A}else{if(typeof A.parentNode.month!="undefined"){return A.parentNode}}return null};Calendar.findYear=function(A){if(typeof A.year!="undefined"){return A}else{if(typeof A.parentNode.year!="undefined"){return A.parentNode}}return null};Calendar.showMonthsCombo=function(){var E=Calendar._C;if(!E){return false}var E=E;var F=E.activeDiv;var D=E.monthsCombo;if(E.hilitedMonth){Calendar.removeClass(E.hilitedMonth,"hilite")}if(E.activeMonth){Calendar.removeClass(E.activeMonth,"active")}var C=E.monthsCombo.getElementsByTagName("div")[E.date.getMonth()];Calendar.addClass(C,"active");E.activeMonth=C;var B=D.style;B.display="block";if(F.navtype<0){B.left=F.offsetLeft+"px"}else{var A=D.offsetWidth;if(typeof A=="undefined"){A=50}B.left=(F.offsetLeft+F.offsetWidth-A)+"px"}B.top=(F.offsetTop+F.offsetHeight)+"px"};Calendar.showYearsCombo=function(D){var A=Calendar._C;if(!A){return false}var A=A;var C=A.activeDiv;var F=A.yearsCombo;if(A.hilitedYear){Calendar.removeClass(A.hilitedYear,"hilite")}if(A.activeYear){Calendar.removeClass(A.activeYear,"active")}A.activeYear=null;var B=A.date.getFullYear()+(D?1:-1);var I=F.firstChild;var H=false;for(var E=12;E>0;--E){if(B>=A.minYear&&B<=A.maxYear){I.innerHTML=B;I.year=B;I.style.display="block";H=true}else{I.style.display="none"}I=I.nextSibling;B+=D?A.yearStep:-A.yearStep}if(H){var J=F.style;J.display="block";if(C.navtype<0){J.left=C.offsetLeft+"px"}else{var G=F.offsetWidth;if(typeof G=="undefined"){G=50}J.left=(C.offsetLeft+C.offsetWidth-G)+"px"}J.top=(C.offsetTop+C.offsetHeight)+"px"}};Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal){return false}if(cal.timeout){clearTimeout(cal.timeout)}var el=cal.activeDiv;if(!el){return false}var target=Calendar.getTargetElement(ev);ev||(ev=window.event);Calendar.removeClass(el,"active");if(target==el||target.parentNode==el){Calendar.cellClick(el,ev)}var mon=Calendar.findMonth(target);var date=null;if(mon){date=new Date(cal.date);if(mon.month!=date.getMonth()){date.setMonth(mon.month);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}else{var year=Calendar.findYear(target);if(year){date=new Date(cal.date);if(year.year!=date.getFullYear()){date.setFullYear(year.year);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}}with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);cal._hideCombos();_C=null;return stopEvent(ev)}};Calendar.tableMouseOver=function(M){var A=Calendar._C;if(!A){return }var C=A.activeDiv;var I=Calendar.getTargetElement(M);if(I==C||I.parentNode==C){Calendar.addClass(C,"hilite active");Calendar.addClass(C.parentNode,"rowhilite")}else{if(typeof C.navtype=="undefined"||(C.navtype!=50&&(C.navtype==0||Math.abs(C.navtype)>2))){Calendar.removeClass(C,"active")}Calendar.removeClass(C,"hilite");Calendar.removeClass(C.parentNode,"rowhilite")}M||(M=window.event);if(C.navtype==50&&I!=C){var L=Calendar.getAbsolutePos(C);var O=C.offsetWidth;var N=M.clientX;var P;var K=true;if(N>L.x+O){P=N-L.x-O;K=false}else{P=L.x-N}if(P<0){P=0}var F=C._range;var H=C._current;var G=Math.floor(P/10)%F.length;for(var E=F.length;--E>=0;){if(F[E]==H){break}}while(G-->0){if(K){if(--E<0){E=F.length-1}}else{if(++E>=F.length){E=0}}}var B=F[E];C.innerHTML=B;A.onUpdateTime()}var D=Calendar.findMonth(I);if(D){if(D.month!=A.date.getMonth()){if(A.hilitedMonth){Calendar.removeClass(A.hilitedMonth,"hilite")}Calendar.addClass(D,"hilite");A.hilitedMonth=D}else{if(A.hilitedMonth){Calendar.removeClass(A.hilitedMonth,"hilite")}}}else{if(A.hilitedMonth){Calendar.removeClass(A.hilitedMonth,"hilite")}var J=Calendar.findYear(I);if(J){if(J.year!=A.date.getFullYear()){if(A.hilitedYear){Calendar.removeClass(A.hilitedYear,"hilite")}Calendar.addClass(J,"hilite");A.hilitedYear=J}else{if(A.hilitedYear){Calendar.removeClass(A.hilitedYear,"hilite")}}}else{if(A.hilitedYear){Calendar.removeClass(A.hilitedYear,"hilite")}}}return Calendar.stopEvent(M)};Calendar.tableMouseDown=function(A){if(Calendar.getTargetElement(A)==Calendar.getElement(A)){return Calendar.stopEvent(A)}};Calendar.calDragIt=function(B){var C=Calendar._C;if(!(C&&C.dragging)){return false}var E;var D;if(Calendar.is_ie){D=window.event.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);E=window.event.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft)}else{E=B.pageX;D=B.pageY}C.hideShowCovered();var A=C.element.style;A.left=(E-C.xOffs)+"px";A.top=(D-C.yOffs)+"px";return Calendar.stopEvent(B)};Calendar.calDragEnd=function(ev){var cal=Calendar._C;if(!cal){return false}cal.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(ev)}cal.hideShowCovered()};Calendar.dayMouseDown=function(ev){var el=Calendar.getElement(ev);if(el.disabled){return false}var cal=el.calendar;cal.activeDiv=el;Calendar._C=cal;if(el.navtype!=300){with(Calendar){if(el.navtype==50){el._current=el.innerHTML;addEvent(document,"mousemove",tableMouseOver)}else{addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver)}addClass(el,"hilite active");addEvent(document,"mouseup",tableMouseUp)}}else{if(cal.isPopup){cal._dragStart(ev)}}if(el.navtype==-1||el.navtype==1){if(cal.timeout){clearTimeout(cal.timeout)}cal.timeout=setTimeout("Calendar.showMonthsCombo()",250)}else{if(el.navtype==-2||el.navtype==2){if(cal.timeout){clearTimeout(cal.timeout)}cal.timeout=setTimeout((el.navtype>0)?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250)}else{cal.timeout=null}}return Calendar.stopEvent(ev)};Calendar.dayMouseDblClick=function(A){Calendar.cellClick(Calendar.getElement(A),A||window.event);if(Calendar.is_ie){document.selection.empty()}};Calendar.dayMouseOver=function(B){var A=Calendar.getElement(B);if(Calendar.isRelated(A,B)||Calendar._C||A.disabled){return false}if(A.ttip){if(A.ttip.substr(0,1)=="_"){A.ttip=A.caldate.print(A.calendar.ttDateFormat)+A.ttip.substr(1)}A.calendar.tooltips.innerHTML=A.ttip}if(A.navtype!=300){Calendar.addClass(A,"hilite");if(A.caldate){Calendar.addClass(A.parentNode,"rowhilite")}}return Calendar.stopEvent(B)};Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);if(isRelated(el,ev)||_C||el.disabled){return false}removeClass(el,"hilite");if(el.caldate){removeClass(el.parentNode,"rowhilite")}if(el.calendar){el.calendar.tooltips.innerHTML=_TT.SEL_DATE}return stopEvent(ev)}};Calendar.cellClick=function(E,N){var C=E.calendar;var H=false;var K=false;var F=null;if(typeof E.navtype=="undefined"){if(C.currentDateEl){Calendar.removeClass(C.currentDateEl,"selected");Calendar.addClass(E,"selected");H=(C.currentDateEl==E);if(!H){C.currentDateEl=E}}C.date.setDateOnly(E.caldate);F=C.date;var B=!(C.dateClicked=!E.otherMonth);if(!B&&!C.currentDateEl){C._toggleMultipleDate(new Date(F))}else{K=!E.disabled}if(B){C._init(C.firstDayOfWeek,F)}}else{if(E.navtype==200){Calendar.removeClass(E,"hilite");C.callCloseHandler();return }F=new Date(C.date);if(E.navtype==0){F.setDateOnly(new Date())}C.dateClicked=false;var M=F.getFullYear();var G=F.getMonth();function A(Q){var R=F.getDate();var P=F.getMonthDays(Q);if(R>P){F.setDate(P)}F.setMonth(Q)}switch(E.navtype){case 400:Calendar.removeClass(E,"hilite");var O=Calendar._TT.ABOUT;if(typeof O!="undefined"){O+=C.showsTime?Calendar._TT.ABOUT_TIME:""}else{O='Help and about box text is not translated into this language.\nIf you know this language and you feel generous please update\nthe corresponding file in "lang" subdir to match calendar-en.js\nand send it back to <mihai_bazon@yahoo.com> to get it into the distribution  ;-)\n\nThank you!\nhttp://dynarch.com/mishoo/calendar.epl\n'}alert(O);return ;case -2:if(M>C.minYear){F.setFullYear(M-1)}break;case -1:if(G>0){A(G-1)}else{if(M-->C.minYear){F.setFullYear(M);A(11)}}break;case 1:if(G<11){A(G+1)}else{if(M<C.maxYear){F.setFullYear(M+1);A(0)}}break;case 2:if(M<C.maxYear){F.setFullYear(M+1)}break;case 100:C.setFirstDayOfWeek(E.fdow);return ;case 50:var J=E._range;var L=E.innerHTML;for(var I=J.length;--I>=0;){if(J[I]==L){break}}if(N&&N.shiftKey){if(--I<0){I=J.length-1}}else{if(++I>=J.length){I=0}}var D=J[I];E.innerHTML=D;C.onUpdateTime();return ;case 0:if((typeof C.getDateStatus=="function")&&C.getDateStatus(F,F.getFullYear(),F.getMonth(),F.getDate())){return false}break}if(!F.equalsTo(C.date)){C.setDate(F);K=true}else{if(E.navtype==0){K=H=true}}}if(K){N&&C.callHandler()}if(H){Calendar.removeClass(E,"hilite");N&&C.callCloseHandler()}};Calendar.prototype.create=function(L){var K=null;if(!L){K=document.getElementsByTagName("body")[0];this.isPopup=true}else{K=L;this.isPopup=false}this.date=this.dateStr?new Date(this.dateStr):new Date();var O=Calendar.createElement("table");this.table=O;O.cellSpacing=0;O.cellPadding=0;O.calendar=this;Calendar.addEvent(O,"mousedown",Calendar.tableMouseDown);var A=Calendar.createElement("div");this.element=A;A.className="calendar";if(this.isPopup){A.style.position="absolute";A.style.display="none"}A.style.zIndex="6000";A.appendChild(O);var I=Calendar.createElement("thead",O);var M=null;var P=null;var B=this;var E=function(S,R,Q){M=Calendar.createElement("td",P);M.colSpan=R;M.className="button";if(Q!=0&&Math.abs(Q)<=2){M.className+=" nav"}Calendar._add_evs(M);M.calendar=B;M.navtype=Q;M.innerHTML="<div unselectable='on'>"+S+"</div>";return M};P=Calendar.createElement("tr",I);var C=6;(this.isPopup)&&--C;(this.weekNumbers)&&++C;E("?",1,400).ttip=Calendar._TT.INFO;this.title=E("",C,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT.DRAG_TO_MOVE;this.title.style.cursor="move";E("&#x00d7;",1,200).ttip=Calendar._TT.CLOSE}P=Calendar.createElement("tr",I);P.className="headrow";this._nav_py=E("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT.PREV_YEAR;this._nav_pm=E("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT.PREV_MONTH;this._nav_now=E(Calendar._TT.TODAY,this.weekNumbers?4:3,0);this._nav_now.ttip=Calendar._TT.GO_TODAY;this._nav_nm=E("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT.NEXT_MONTH;this._nav_ny=E("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT.NEXT_YEAR;P=Calendar.createElement("tr",I);P.className="daynames";if(this.weekNumbers){M=Calendar.createElement("td",P);M.className="name wn";M.innerHTML=Calendar._TT.WK}for(var H=7;H>0;--H){M=Calendar.createElement("td",P);if(!H){M.navtype=100;M.calendar=this;Calendar._add_evs(M)}}this.firstdayname=(this.weekNumbers)?P.firstChild.nextSibling:P.firstChild;this._displayWeekdays();var G=Calendar.createElement("tbody",O);this.tbody=G;for(H=6;H>0;--H){P=Calendar.createElement("tr",G);if(this.weekNumbers){M=Calendar.createElement("td",P)}for(var F=7;F>0;--F){M=Calendar.createElement("td",P);M.calendar=this;Calendar._add_evs(M)}}if(this.showsTime){P=Calendar.createElement("tr",G);P.className="time";M=Calendar.createElement("td",P);M.className="time";M.colSpan=2;M.innerHTML=Calendar._TT.TIME||"&nbsp;";M=Calendar.createElement("td",P);M.className="time";M.colSpan=this.weekNumbers?4:3;(function(){function V(e,h,f,l){var c=Calendar.createElement("span",M);c.className=e;c.innerHTML=h;c.calendar=B;c.ttip=Calendar._TT.TIME_PART;c.navtype=50;c._range=[];if(typeof f!="number"){c._range=f}else{for(var d=f;d<=l;++d){var S;if(d<10&&l>=10){S="0"+d}else{S=""+d}c._range[c._range.length]=S}}Calendar._add_evs(c);return c}var a=B.date.getHours();var Q=B.date.getMinutes();var W=B.date.getSeconds();var b=!B.time24;var R=(a>12);if(b&&R){a-=12}var Y=V("hour",a,b?1:0,b?12:23);var X=Calendar.createElement("span",M);X.innerHTML=":";X.className="colon";var U=V("minute",Q,0,59);var X=Calendar.createElement("span",M);X.innerHTML=":";X.className="colon";var T=V("second",10,0,59);var Z=null;M=Calendar.createElement("td",P);M.className="time";M.colSpan=2;if(b){Z=V("ampm",R?"pm":"am",["am","pm"])}else{M.innerHTML="&nbsp;"}B.onSetTime=function(){var c,S=this.date.getHours(),d=this.date.getMinutes();W=this.date.getSeconds();if(b){c=(S>=12);if(c){S-=12}if(S==0){S=12}Z.innerHTML=c?"pm":"am"}Y.innerHTML=(S<10)?("0"+S):S;U.innerHTML=(d<10)?("0"+d):d;T.innerHTML=(W<10)?("0"+W):W};B.onUpdateTime=function(){var c=this.date;var e=parseInt(Y.innerHTML,10);if(b){if(/pm/i.test(Z.innerHTML)&&e<12){e+=12}else{if(/am/i.test(Z.innerHTML)&&e==12){e=0}}}var f=c.getDate();var S=c.getMonth();var l=c.getFullYear();c.setHours(e);c.setMinutes(parseInt(U.innerHTML,10));c.setSeconds(parseInt(T.innerHTML,10));c.setFullYear(l);c.setMonth(S);c.setDate(f);this.dateClicked=false;this.callHandler()}})()}else{this.onSetTime=this.onUpdateTime=function(){}}var J=Calendar.createElement("tfoot",O);P=Calendar.createElement("tr",J);P.className="footrow";M=E(Calendar._TT.SEL_DATE,this.weekNumbers?8:7,300);M.className="ttip";if(this.isPopup){M.ttip=Calendar._TT.DRAG_TO_MOVE;M.style.cursor="move"}this.tooltips=M;A=Calendar.createElement("div",this.element);this.monthsCombo=A;A.className="combo";for(H=0;H<Calendar._MN.length;++H){var D=Calendar.createElement("div");D.className=Calendar.is_ie?"label-IEfix":"label";D.month=H;D.innerHTML=Calendar._SMN[H];A.appendChild(D)}A=Calendar.createElement("div",this.element);this.yearsCombo=A;A.className="combo";for(H=12;H>0;--H){var N=Calendar.createElement("div");N.className=Calendar.is_ie?"label-IEfix":"label";A.appendChild(N)}this._init(this.firstDayOfWeek,this.date);K.appendChild(this.element)};Calendar._keyEvent=function(L){var A=window._dynarch_popupCalendar;if(!A||A.multiple){return false}(Calendar.is_ie)&&(L=window.event);var I=(Calendar.is_ie||L.type=="keypress"),M=L.keyCode;if(L.ctrlKey){switch(M){case 37:I&&Calendar.cellClick(A._nav_pm);break;case 38:I&&Calendar.cellClick(A._nav_py);break;case 39:I&&Calendar.cellClick(A._nav_nm);break;case 40:I&&Calendar.cellClick(A._nav_ny);break;default:return false}}else{switch(M){case 32:Calendar.cellClick(A._nav_now);break;case 27:I&&A.callCloseHandler();break;case 37:case 38:case 39:case 40:if(I){var E,N,J,G,C,D;E=M==37||M==38;D=(M==37||M==39)?1:7;function B(){C=A.currentDateEl;var K=C.pos;N=K&15;J=K>>4;G=A.ar_days[J][N]}B();function F(){var K=new Date(A.date);K.setDate(K.getDate()-D);A.setDate(K)}function H(){var K=new Date(A.date);K.setDate(K.getDate()+D);A.setDate(K)}while(1){switch(M){case 37:if(--N>=0){G=A.ar_days[J][N]}else{N=6;M=38;continue}break;case 38:if(--J>=0){G=A.ar_days[J][N]}else{F();B()}break;case 39:if(++N<7){G=A.ar_days[J][N]}else{N=0;M=40;continue}break;case 40:if(++J<A.ar_days.length){G=A.ar_days[J][N]}else{H();B()}break}break}if(G){if(!G.disabled){Calendar.cellClick(G)}else{if(E){F()}else{H()}}}}break;case 13:if(I){Calendar.cellClick(A.currentDateEl,L)}break;default:return false}}return Calendar.stopEvent(L)};Calendar.prototype._init=function(L,V){var U=new Date(),P=U.getFullYear(),X=U.getMonth(),B=U.getDate();this.table.style.visibility="hidden";var H=V.getFullYear();if(H<this.minYear){H=this.minYear;V.setFullYear(H)}else{if(H>this.maxYear){H=this.maxYear;V.setFullYear(H)}}this.firstDayOfWeek=L;this.date=new Date(V);var W=V.getMonth();var Z=V.getDate();var Y=V.getMonthDays();V.setDate(1);var Q=(V.getDay()-this.firstDayOfWeek)%7;if(Q<0){Q+=7}if(Q<0){Q=Math.abs(Q)}else{if(Q>0){Q=0-Q}}V.setDate(Q);V.setDate(V.getDate()+1);var E=this.tbody.firstChild;var J=Calendar._SMN[W];var N=this.ar_days=new Array();var M=Calendar._TT.WEEKEND;var D=this.multiple?(this.datesCells={}):null;for(var S=0;S<6;++S,E=E.nextSibling){var A=E.firstChild;if(this.weekNumbers){A.className="day wn";A.innerHTML=V.getWeekNumber();A=A.nextSibling}E.className="daysrow";var T=false,F,C=N[S]=[];for(var R=0;R<7;++R,A=A.nextSibling,V.setDate(F+1)){F=V.getDate();var G=V.getDay();A.className="day";A.pos=S<<4|R;C[R]=A;var K=(V.getMonth()==W);if(!K){if(this.showsOtherMonths){A.className+=" othermonth";A.otherMonth=true}else{A.className="emptycell";A.innerHTML="&nbsp;";A.disabled=true;continue}}else{A.otherMonth=false;T=true}A.disabled=false;A.innerHTML=this.getDateText?this.getDateText(V,F):F;if(D){D[V.print("%Y%m%d")]=A}if(this.getDateStatus){var O=this.getDateStatus(V,H,W,F);if(this.getDateToolTip){var I=this.getDateToolTip(V,H,W,F);if(I){A.title=I}}if(O===true){A.className+=" disabled";A.disabled=true}else{if(/disabled/i.test(O)){A.disabled=true}A.className+=" "+O}}if(!A.disabled){A.caldate=new Date(V);A.ttip="_";if(!this.multiple&&K&&F==Z&&this.hiliteToday){A.className+=" selected";this.currentDateEl=A}if(V.getFullYear()==P&&V.getMonth()==X&&F==B){A.className+=" today";A.ttip+=Calendar._TT.PART_TODAY}if(M.indexOf(G.toString())!=-1){A.className+=A.otherMonth?" oweekend":" weekend"}}}if(!(T||this.showsOtherMonths)){E.className="emptyrow"}}this.title.innerHTML=Calendar._MN[W]+", "+H;this.onSetTime();this.table.style.visibility="visible";this._initMultipleDates()};Calendar.prototype._initMultipleDates=function(){if(this.multiple){for(var B in this.multiple){var A=this.datesCells[B];var C=this.multiple[B];if(!C){continue}if(A){A.className+=" selected"}}}};Calendar.prototype._toggleMultipleDate=function(B){if(this.multiple){var C=B.print("%Y%m%d");var A=this.datesCells[C];if(A){var D=this.multiple[C];if(!D){Calendar.addClass(A,"selected");this.multiple[C]=B}else{Calendar.removeClass(A,"selected");delete this.multiple[C]}}}};Calendar.prototype.setDateToolTipHandler=function(A){this.getDateToolTip=A};Calendar.prototype.setDate=function(A){if(!A.equalsTo(this.date)){this._init(this.firstDayOfWeek,A)}};Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date)};Calendar.prototype.setFirstDayOfWeek=function(A){this._init(A,this.date);this._displayWeekdays()};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(A){this.getDateStatus=A};Calendar.prototype.setRange=function(A,B){this.minYear=A;this.maxYear=B};Calendar.prototype.callHandler=function(){if(this.onSelected){this.onSelected(this,this.date.print(this.dateFormat))}};Calendar.prototype.callCloseHandler=function(){if(this.onClose){this.onClose(this)}this.hideShowCovered()};Calendar.prototype.destroy=function(){var A=this.element.parentNode;if(A){A.removeChild(this.element)}Calendar._C=null;window._dynarch_popupCalendar=null};Calendar.prototype.reparent=function(B){var A=this.element;A.parentNode.removeChild(A);B.appendChild(A)};Calendar._checkCalendar=function(B){var C=window._dynarch_popupCalendar;if(!C){return false}var A=Calendar.is_ie?Calendar.getElement(B):Calendar.getTargetElement(B);for(;A!=null&&A!=C.element;A=A.parentNode){}if(A==null){window._dynarch_popupCalendar.callCloseHandler();return Calendar.stopEvent(B)}};Calendar.prototype.show=function(){if(window._dynarch_popupCalendar){window._dynarch_popupCalendar.callCloseHandler()}var E=this.table.getElementsByTagName("tr");for(var D=E.length;D>0;){var F=E[--D];Calendar.removeClass(F,"rowhilite");var C=F.getElementsByTagName("td");for(var B=C.length;B>0;){var A=C[--B];Calendar.removeClass(A,"hilite");Calendar.removeClass(A,"active")}}this.element.style.display="block";this.hidden=false;if(this.isPopup){window._dynarch_popupCalendar=this;Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"keypress",Calendar._keyEvent);Calendar.addEvent(document,"mousedown",Calendar._checkCalendar)}this.hideShowCovered()};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"keypress",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar)}this.element.style.display="none";this.hidden=true;this.hideShowCovered()};Calendar.prototype.showAt=function(A,C){var B=this.element.style;B.left=A+"px";B.top=C+"px";this.show()};Calendar.prototype.showAtElement=function(C,D){var A=this;var E=Calendar.getAbsolutePos(C);if(!D||typeof D!="string"){this.showAt(E.x,E.y+C.offsetHeight);return true}function B(I){if(I.x<0){I.x=0}if(I.y<0){I.y=0}var J=document.createElement("div");var H=J.style;H.position="absolute";H.right=H.bottom=H.width=H.height="0px";document.body.appendChild(J);var G=Calendar.getAbsolutePos(J);document.body.removeChild(J);if(Calendar.is_ie){G.y+=(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);G.x+=(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft)}else{G.y+=window.scrollY;G.x+=window.scrollX}var F=I.x+I.width-G.x;if(F>0){I.x-=F}F=I.y+I.height-G.y;if(F>0){I.y-=F}}this.element.style.display="block";Calendar.continuation_for_the_fucking_khtml_browser=function(){var F=A.element.offsetWidth;var H=A.element.offsetHeight;A.element.style.display="none";var G=D.substr(0,1);var I="l";if(D.length>1){I=D.substr(1,1)}switch(G){case"T":E.y-=H;break;case"B":E.y+=C.offsetHeight;break;case"C":E.y+=(C.offsetHeight-H)/2;break;case"t":E.y+=C.offsetHeight-H;break;case"b":break}switch(I){case"L":E.x-=F;break;case"R":E.x+=C.offsetWidth;break;case"C":E.x+=(C.offsetWidth-F)/2;break;case"l":E.x+=C.offsetWidth-F;break;case"r":break}E.width=F;E.height=H+40;A.monthsCombo.style.display="none";B(E);A.showAt(E.x,E.y)};if(Calendar.is_khtml){setTimeout("Calendar.continuation_for_the_fucking_khtml_browser()",10)}else{Calendar.continuation_for_the_fucking_khtml_browser()}};Calendar.prototype.setDateFormat=function(A){this.dateFormat=A};Calendar.prototype.setTtDateFormat=function(A){this.ttDateFormat=A};Calendar.prototype.parseDate=function(B,A){if(!A){A=this.dateFormat}this.setDate(Date.parseDate(B,A))};Calendar.prototype.hideShowCovered=function(){if(!Calendar.is_ie&&!Calendar.is_opera){return }function B(R){var Q=R.style.visibility;if(!Q){if(document.defaultView&&typeof (document.defaultView.getComputedStyle)=="function"){if(!Calendar.is_khtml){Q=document.defaultView.getComputedStyle(R,"").getPropertyValue("visibility")}else{Q=""}}else{if(R.currentStyle){Q=R.currentStyle.visibility}else{Q=""}}}return Q}var P=new Array("applet","iframe","select");var C=this.element;var A=Calendar.getAbsolutePos(C);var F=A.x;var D=C.offsetWidth+F;var O=A.y;var N=C.offsetHeight+O;for(var H=P.length;H>0;){var G=document.getElementsByTagName(P[--H]);var E=null;for(var J=G.length;J>0;){E=G[--J];A=Calendar.getAbsolutePos(E);var M=A.x;var L=E.offsetWidth+M;var K=A.y;var I=E.offsetHeight+K;if(this.hidden||(M>D)||(L<F)||(K>N)||(I<O)){if(!E.__msh_save_visibility){E.__msh_save_visibility=B(E)}E.style.visibility=E.__msh_save_visibility}else{if(!E.__msh_save_visibility){E.__msh_save_visibility=B(E)}E.style.visibility="hidden"}}}};Calendar.prototype._displayWeekdays=function(){var B=this.firstDayOfWeek;var A=this.firstdayname;var D=Calendar._TT.WEEKEND;for(var C=0;C<7;++C){A.className="day name";var E=(C+B)%7;if(C){A.ttip=Calendar._TT.DAY_FIRST.replace("%s",Calendar._DN[E]);A.navtype=100;A.calendar=this;A.fdow=E;Calendar._add_evs(A)}if(D.indexOf(E.toString())!=-1){Calendar.addClass(A,"weekend")}A.innerHTML=Calendar._SDN[(C+B)%7];A=A.nextSibling}};Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none"};Calendar.prototype._dragStart=function(ev){if(this.dragging){return }this.dragging=true;var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);posX=window.event.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft)}else{posY=ev.clientY+window.scrollY;posX=ev.clientX+window.scrollX}var st=this.element.style;this.xOffs=posX-parseInt(st.left);this.yOffs=posY-parseInt(st.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseup",calDragEnd)}};Date._MD=new Array(31,28,31,30,31,30,31,31,30,31,30,31);Date.SECOND=1000;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date.parseDate=function(H,A){var I=new Date();var J=0;var B=-1;var G=0;var L=H.split(/\W+/);var K=A.match(/%./g);var E=0,D=0;var M=0;var C=0;var F=0;for(E=0;E<L.length;++E){if(!L[E]){continue}switch(K[E]){case"%d":case"%e":G=parseInt(L[E],10);break;case"%m":B=parseInt(L[E],10)-1;break;case"%Y":case"%y":J=parseInt(L[E],10);(J<100)&&(J+=(J>29)?1900:2000);break;case"%b":case"%B":for(D=0;D<12;++D){if(Calendar._MN[D].substr(0,L[E].length).toLowerCase()==L[E].toLowerCase()){B=D;break}}break;case"%H":case"%I":case"%k":case"%l":M=parseInt(L[E],10);break;case"%P":case"%p":if(/pm/i.test(L[E])&&M<12){M+=12}else{if(/am/i.test(L[E])&&M>=12){M-=12}}break;case"%M":C=parseInt(L[E],10);break;case"%S":F=parseInt(L[E],10);break}}if(isNaN(J)){J=I.getFullYear()}if(isNaN(B)){B=I.getMonth()}if(isNaN(G)){G=I.getDate()}if(isNaN(M)){M=I.getHours()}if(isNaN(C)){C=I.getMinutes()}if(isNaN(F)){F=I.getMinutes()}if(J!=0&&B!=-1&&G!=0){return new Date(J,B,G,M,C,F)}J=0;B=-1;G=0;for(E=0;E<L.length;++E){if(L[E].search(/[a-zA-Z]+/)!=-1){var N=-1;for(D=0;D<12;++D){if(Calendar._MN[D].substr(0,L[E].length).toLowerCase()==L[E].toLowerCase()){N=D;break}}if(N!=-1){if(B!=-1){G=B+1}B=N}}else{if(parseInt(L[E],10)<=12&&B==-1){B=L[E]-1}else{if(parseInt(L[E],10)>31&&J==0){J=parseInt(L[E],10);(J<100)&&(J+=(J>29)?1900:2000)}else{if(G==0){G=L[E]}}}}}if(J==0){J=I.getFullYear()}if(B!=-1&&G!=0){return new Date(J,B,G,M,C,F)}return I};Date.prototype.getMonthDays=function(B){var A=this.getFullYear();if(typeof B=="undefined"){B=this.getMonth()}if(((0==(A%4))&&((0!=(A%100))||(0==(A%400))))&&B==1){return 29}else{return Date._MD[B]}};Date.prototype.getDayOfYear=function(){var A=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var C=new Date(this.getFullYear(),0,0,0,0,0);var B=A-C;return Math.floor(B/Date.DAY)};Date.prototype.getWeekNumber=function(){var C=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var B=C.getDay();C.setDate(C.getDate()-(B+6)%7+3);var A=C.valueOf();C.setMonth(0);C.setDate(4);return Math.round((A-C.valueOf())/(7*86400000))+1};Date.prototype.equalsTo=function(A){return((this.getFullYear()==A.getFullYear())&&(this.getMonth()==A.getMonth())&&(this.getDate()==A.getDate())&&(this.getHours()==A.getHours())&&(this.getMinutes()==A.getMinutes()))};Date.prototype.setDateOnly=function(A){var B=new Date(A);this.setDate(1);this.setFullYear(B.getFullYear());this.setMonth(B.getMonth());this.setDate(B.getDate())};Date.prototype.print=function(I){var A=this.getMonth();var H=this.getDate();var J=this.getFullYear();var L=this.getWeekNumber();var M=this.getDay();var Q={};var N=this.getHours();var B=(N>=12);var F=(B)?(N-12):N;var P=this.getDayOfYear();if(F==0){F=12}var C=this.getMinutes();var G=this.getSeconds();Q["%a"]=Calendar._SDN[M];Q["%A"]=Calendar._DN[M];Q["%b"]=Calendar._SMN[A];Q["%B"]=Calendar._MN[A];Q["%C"]=1+Math.floor(J/100);Q["%d"]=(H<10)?("0"+H):H;Q["%e"]=H;Q["%H"]=(N<10)?("0"+N):N;Q["%I"]=(F<10)?("0"+F):F;Q["%j"]=(P<100)?((P<10)?("00"+P):("0"+P)):P;Q["%k"]=N;Q["%l"]=F;Q["%m"]=(A<9)?("0"+(1+A)):(1+A);Q["%M"]=(C<10)?("0"+C):C;Q["%n"]="\n";Q["%p"]=B?"PM":"AM";Q["%P"]=B?"pm":"am";Q["%s"]=Math.floor(this.getTime()/1000);Q["%S"]=(G<10)?("0"+G):G;Q["%t"]="\t";Q["%U"]=Q["%W"]=Q["%V"]=(L<10)?("0"+L):L;Q["%u"]=M+1;Q["%w"]=M;Q["%y"]=(""+J).substr(2,2);Q["%Y"]=J;Q["%%"]="%";var O=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml){return I.replace(O,function(R){return Q[R]||R})}var K=I.match(O);for(var E=0;E<K.length;E++){var D=Q[K[E]];if(D){O=new RegExp(K[E],"g");I=I.replace(O,D)}}return I};Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear;Date.prototype.setFullYear=function(B){var A=new Date(this);A.__msh_oldSetFullYear(B);if(A.getMonth()!=this.getMonth()){this.setDate(28)}this.__msh_oldSetFullYear(B)};window._dynarch_popupCalendar=null;var ZCSecurity=new function(){this.isURLXSSVulnerable=function(E){if(E){var B=E.trim().toLowerCase();var D=document.createElement("a");D.href=B;var A=D.protocol;if(A.indexOf("javascript:")===0||A.indexOf("vbscript:")===0||A.indexOf("data:")===0){return true}B=B.replace(/&/g,"&").replace(/</g,"<").replace(/>/g,">").replace(/"/g,'"').replace(/'/g,"'");try{var F=decodeURIComponent(ZCSecurity.safariCheck(B)).replace(/[^\w:]/g,"").toLowerCase()}catch(C){}if(F.indexOf("javascript:")===0||F.indexOf("vbscript:")===0||F.indexOf("data:")===0){return true}}return false};this.isValidURL=function(A){A=A.toLowerCase();if(A.match("^(#|www|/|https?:|ftp:|mailto:)")){return true}return false};this.safariCheck=function(A){return A.replace(/&([#\w]+);/g,function(C,B){if(B==="colon"){return":"}if(B.charAt(0)==="#"){return B.charAt(1)==="x"?String.fromCharCode(parseInt(B.substring(2),16)):String.fromCharCode(+B.substring(1))}return""})}}();var genScriptURL="/triggerWorkflow.do";var form_element=new Array();var relodCurrentForm="true";var viewLogPreviousValue="";var reloadCurrView=true;var isOpenWindowTaskExec=false;var newGenerateJsCodeEnabled=true;var isRecursionInGenJSAllowed=true;var ZCNewGenerateJsTask=new function(){this.executeTask=function(A,E){for(var C=0;C<A.length;C++){var B=A[C];var D=ZCUtil.getFromMap(E,"recType");if((B.compType==12||B.compType==13||B.compType==29||B.compType==30)&&(!B.fieldValue)&&(B.task==ZCConstants.SET_VALUE||ZCConstants.APPEND_VALUE)){B.fieldValue=""}if(B.subFormName!=null){subFormFieldJSTask(B.task,B.formName,B.subFormName,B.fieldValue,B.rowNo,B.fieldName,B.compType,99,D,B.combinedValue,B.isAppend)}else{if(B.groupCompName!=null){B.fieldName="CF("+B.groupCompName+").SV("+B.fieldName+")"}switch(B.task){case ZCConstants.RELOAD:reloadForm(B.formName,D);break;case ZCConstants.CLEAR:clearComponent(B.formName,B.fieldName,D);break;case ZCConstants.HIDE:hideComponent(B.formName,B.fieldName,D);break;case ZCConstants.SHOW:showComponent(B.formName,B.fieldName,D);break;case ZCConstants.ENABLE:enableComponent(B.formName,B.fieldName,D);break;case ZCConstants.DISABLE:disableComponent(B.formName,B.fieldName,D);break;case ZCConstants.SELECTALL:selectAllValue(B.formName,B.fieldName,D);break;case ZCConstants.DESELECTALL:deSelectAllValue(B.formName,B.fieldName,D);break;case ZCConstants.ALERT:jsalert(B.alertValue);break;case ZCConstants.SET_VALUE:setValue(B.formName,B.fieldName,B.fieldValue,D,B.isFromSubForm,B.rowNo,B.combinedValue,null);break;case ZCConstants.SELECT:selectValue(B.formName,B.fieldName,B.fieldValue,D,B.combinedValue);break;case ZCConstants.DESELECT:deSelectValue(B.formName,B.fieldName,B.fieldValue,D,B.combinedValue);break;case ZCConstants.APPEND_VALUE:addValueToTheFieldElem(B.formName,B.fieldName,B.fieldValue,D,B.combinedValue,B.isAppend);break;case ZCConstants.OPEN_URL:openWindowTask(B.urlString,B.windowType,B.windowSpecificArgument);break;case ZCConstants.PRINT_TASK:printInfoMsg(B.infoValue,E,B.headerMsg);break;case ZCConstants.ERROR_TASK:showValidationError(B.errors,E);break;case ZCConstants.RESET_LOAD_LOOKUP_TASK:resetLoadLookupOptions(B.formName,null,B.fieldName,D);break;default:handleScriptError(B.message)}}}}};function getRowIdFromCompName(A){return A.split(").FD(")[1].split(").")[0]}function printInfoMsg(E,G,D){var C=ZCUtil.getFromMap(G,"formLinkName");var A=ZCUtil.getFromMap(G,"recType");var B=ZCUtil.getFromMap(G,"infoMsg");var F={};if(B!=null&&B!=""){F=$.parseJSON(B)}F["3"]={UserMsgs:E,HeaderMsg:D};F=ZCForm.getInfoMsgHtml(F,"");var H=$(F)[0].outerHTML;ZCForm.showInfo(H,H,C,A,"")}function showValidationError(C,D){var B=ZCUtil.getFromMap(D,"formLinkName");var A=ZCUtil.getFromMap(D,"recType");ZCForm.showErrors(B,A,"","",C)}function genScriptURLValue(){if(genScriptURL.indexOf(ZCApp.contextPath)<0){genScriptURL=ZCApp.contextPath+genScriptURL}return genScriptURL}function onChangeScript(A,B,E,C,G){setFormState(A);try{ZCForm.updateRichTextContent()}catch(H){if(H instanceof TypeError){setTimeout(function(){onChangeScript(A,B,E,C,G)},500);return false}}var D=$(A).attr("name");var I=ZCForm.formArr[D];var F=new Array();if(!ZCUtil.isNull(ZCUtil.getFromMap(I,"onuserinput"))){F=ZCUtil.getFromMap(I,"onuserinput");if(!ZCUtil.contains(F,E)){F[F.length]=E}}else{F[0]=E}ZCUtil.setInMap(I,"onuserinput",F);doAction(A,B,E,C,null,null,G,ZCForm.isRecursiveCall)}function executeFormula(A,B,F,G){if(newGenerateJsCodeEnabled){var H="json"}else{var H="script"}var C=cloneAndGetParams(A);C=C+"&isFormula=true";C=C+"&fcid="+F;C=C+"&isLookupSearch="+G;C=C+"&"+getCsrfParamName()+"="+getCsrfParamValue();var D=i18n.loadingmsg;var J=true;var E=$(A).attr("name");var I=ZCForm.formArr[E];ZCUtil.setInMap(I,"executeFormula",F);ZCUtil.sendRequest(genScriptURLValue(),C,H,"handleHttpResponse",ZCUtil.getParamsAsMap("isLookupSearch="+G),D,J);ZCUtil.removeFromMap(I,"executeFormula")}function executeFormulaforSubForm(A,C,H,K,M,D,I){if(newGenerateJsCodeEnabled){var B="/newCalculateFormula.do";var J="json"}else{var J="script";var B="/CalculateFormula.do"}var F=i18n.loadingmsg;var N=true;var E=cloneAndGetParams(A);E=E+"&fcid="+H;E=E+"&isFormula=true";E=E+"&subfcid="+K;E=E+"&subfcname="+M;E=E+"&isSubForm=true";E=E+"&"+getCsrfParamName()+"="+getCsrfParamValue();if(newGenerateJsCodeEnabled){E=E+"&rowseqid="+getRowIdFromCompName(M)}var G=$(A).attr("name");var L=ZCForm.formArr[G];ZCUtil.setInMap(L,"executeFormula",H);ZCUtil.sendRequest(B,E,J,"handleHttpResponse",ZCUtil.getParamsAsMap("isLookupSearch="+I),F,N);ZCUtil.removeFromMap(L,"executeFormula")}function onChangeSubFormScript(A,B,G,I,L,C){if(newGenerateJsCodeEnabled){var J="json"}else{var J="script"}ZCApp.setLoadingMsg($("#zc-loading"),i18n.pleasewait);var E=cloneAndGetParams(A);E=E+"&fcid="+G;E=E+"&subfcid="+I;E=E+"&subfcname="+L;E=E+"&"+getCsrfParamName()+"="+getCsrfParamValue();if(newGenerateJsCodeEnabled){E=E+"&rowseqid="+getRowIdFromCompName(L)}var F=$(A).attr("name");var K=ZCForm.formArr[F];var H=new Array();if(!ZCUtil.isNull(ZCUtil.getFromMap(K,"onuserinput"))){H=ZCUtil.getFromMap(K,"onuserinput");if(!ZCUtil.contains(H,L)){H[H.length]=L}}else{H[0]=L}ZCUtil.setInMap(K,"onuserinput",H);var D=i18n.loadingmsg;var M=((G!=null)&&(G.length>0));ZCUtil.sendRequest(genScriptURLValue(),E,J,"handleHttpResponse",new Object(),D,M)}function subFormRowAction(A,D,H,B,C,I,E){if(newGenerateJsCodeEnabled){var J="json"}else{var J="script"}ZCApp.setLoadingMsg($("#zc-loading"),i18n.pleasewait);var G=cloneAndGetParams(A);G=G+"&fcid="+H;G=G+"&fcname="+B;G=G+"&rowseqid="+C;G=G+"&rowactiontype="+I;G=G+"&"+getCsrfParamName()+"="+getCsrfParamValue();var F=i18n.loadingmsg;var K=((H!=null)&&(H.length>0));ZCUtil.sendRequest(genScriptURLValue(),G,J,"handleHttpResponse",new Object(),F,K)}function onInitScript(F,G,B,E){setFormState(F);var D=$(F).attr("name");var C=ZCForm.formArr[D];var A=new Array();if(!ZCUtil.isNull(ZCUtil.getFromMap(C,"oninit"))){A=ZCUtil.getFromMap(C,"oninit");if(!ZCUtil.contains(A,B)){A[A.length]=B}}else{A[0]=B}ZCUtil.setInMap(C,"oninit",A);doAction(F,G,B,E)}function submitExtForm(D,A,C,B){setFormState(D);doAction(D,"","",A,C,B)}function doActionOnLoad(F,E,H){setFormState(E);var G=cloneAndGetParams(E);G=G+"&"+getCsrfParamName()+"="+getCsrfParamValue();if($(E).attr("formType")=="SubForm"){var C=$(E).attr("name");var B=ZCForm.formArr[C];var D=ZCUtil.getFromMap(B,"formID");G+="&formLinkName="+C+"&formid="+D+"&subform=true&"}if(newGenerateJsCodeEnabled){var A="json"}else{var A="script"}ZCUtil.sendRequest(genScriptURLValue(),G,A,"handleFormActionOnLoad","",i18n.pleasewait,false)}function cloneAndGetParams(B){var D="";var C=new Array();var A=0;$(":input[type!=reset][type!=submit][type!=button][type!=file][name!=srchInput]",$(B)).each(function(G){var I=$(this);$delugeType=$(I).attr("delugeType");var L=$(I).attr("name");var J=$(I).prop("value");var H=false;$.each($(I).parents("div[formType=SubForm]"),function(N,M){H=true});if(H&&$(B).attr("elName")!="subFormContainer"){return true}if($(I).attr("elName")=="subforminput"){return true}if($delugeType){var F=$(I).attr("type");if((F!="file"&&L!="uploadFile")&&(F!="radio"||(F=="radio"&&$(I).prop("checked")))){if(F=="select-multiple"||F=="multiselect"){$.each(ZCUtil.getFieldValue(I),function(M,N){if(!ZCUtil.isNull(N)){D=D+$(I).attr("name")+"="+encodeURIComponent(N)+"&"}})}else{if(F=="checkbox"){if($delugeType=="BOOLEAN"){var E=$(I).prop("checked")?"zc_checked":"zc_unchecked";D=D+L+"="+E+"&"}else{if($(I).prop("checked")){D=D+L+"="+encodeURIComponent(J)+"&"}}}else{var K=ZCUtil.getFieldValue($(I));if(ZCUtil.isNull(K)){K=""}if(($(I).attr("type")!="radio"&&$(I).attr("type")!="checkbox")||!ZCUtil.isNull(K)){D=D+$(I).attr("name")+"="+encodeURIComponent(K)+"&"}}}}}else{D=D+L+"="+encodeURIComponent(J)+"&"}});D=(D!="")?D.substring(0,D.length-1):D;return D}function handleFormActionOnLoad(A,C){if(newGenerateJsCodeEnabled){ZCNewGenerateJsTask.executeTask(A,C)}else{evaluateJs(A,ZCUtil.getFromMap(C,"recType"))}for(fe in form_element){var B=form_element[fe];form_element[fe]="";if(B!=""){fireOnChange(B)}}form_element=new Array();if(ZCForm.showFormVar=="true"){ZCForm.enableForm(ZCUtil.getFromMap(C,"formLinkName"),ZCUtil.getFromMap(C,"recType"))}ZCForm.showFormVar="true"}function doAction(B,I,A,D,M,C,H,J){if(newGenerateJsCodeEnabled){var K="json"}else{var K="script"}ZCApp.setLoadingMsg($("#zc-loading"),i18n.pleasewait);var F=cloneAndGetParams(B);F=F+"&fcid="+A;F=F+"&"+getCsrfParamName()+"="+getCsrfParamValue();var E=i18n.loadingmsg;if(C){K="json";F=F+"&buttonid="+M+"&buttonwftype="+C;E=i18n.pleasewait}if($(B).attr("formType")=="SubForm"){var G=$(B).attr("name");F+="&formLinkName="+G+"&formid="+I+"&subform=true&"}if(J){F+="&isRecursiveCall="+J}var L=((A!=null)&&(A.length>0));ZCUtil.sendRequest(genScriptURLValue(),F,K,"handleHttpResponse",ZCUtil.getParamsAsMap("eventType="+C+"&isLookupSearch="+H),E,L)}function evaluateJs(A,C){var B=document.createElement("script");B.text=A;document.getElementsByTagName("body")[0].appendChild(B);doaction(C)}function handleScriptError(A){A=A.replace(new RegExp(ZCConstants.REPLACE_SQ_CHAR,"g"),"'");ZCUtil.showDialog(A,"true");ZCForm.showFormVar="false"}function handleHttpResponse(K,I,N){var C=new Array();var G=ZCUtil.getFromMap(I,"formLinkName");var L=ZCUtil.getFromMap(I,"recType");var H=ZCForm.getForm(G,L);var J=ZCUtil.getFromMap(N,"eventType");var B=ZCUtil.getFromMap(N,"isLookupSearch");var O="";ZCForm.defreezeButton(H);if(!ZCUtil.isNull(J)){if(newGenerateJsCodeEnabled){ZCForm.clearErrors(H);if(J==ZCConstants.BUTTON_WFLOW_TYPE){relodCurrentForm="false"}}else{C=ZCForm.getMsgFromResponse(K,ZCUtil.getFromMap(I,"formid"));var E=C.errMsg;var F=C.infoMsg;var E=(!ZCUtil.isNull(E))?E:"";var M=(!ZCUtil.isNull(F))?F:"";ZCForm.clearErrors(H);if(!ZCUtil.isNull(M)||!ZCUtil.isNull(E)){ZCForm.showInfo(M,F,G,L,E)}ZCForm.showErrors(G,L,"","",C.fieldErrObj);K=C.generatedjs;O=C.dummyForm}}if(O&&O=="true"){relodCurrentForm="false"}var D="";if(!ZCUtil.isNull(ZCUtil.getFromMap(I,"fcid"))&&!ZCUtil.isNull(ZCUtil.getFromMap(I,"subfcid"))){D=ZCUtil.getFromMap(I,"subfcname");if(H!=undefined&&$(H).find(":input[name='"+ZCUtil.getFromMap(I,"subfcname")+"']").length>0){ZCForm.showHideCog($(H).find(":input[name='"+ZCUtil.getFromMap(I,"subfcname")+"']"),"hidden")}else{if(H!=undefined&&$(H).find("div[elName=srchDiv][name='"+ZCUtil.getFromMap(I,"subfcname")+"']").length>0){ZCForm.showHideCog($(H).find("div[elName=srchDiv][name='"+ZCUtil.getFromMap(I,"subfcname")+"']"),"hidden")}else{ZCForm.showHideCog($(H).find(":input[name='"+ZCUtil.getFromMap(I,"subfcname")+"']"),"hidden")}}}else{if(!ZCUtil.isNull(ZCUtil.getFromMap(I,"fcid"))&&!ZCUtil.isNull(ZCUtil.getFromMap(I,"rowseqid"))){var P="SF("+ZCUtil.getFromMap(I,"fcname")+").FD("+ZCUtil.getFromMap(I,"rowseqid")+").SV(ID)";ZCForm.showHideCog($(H).find("a[labelname='"+P+"']"),"hidden",true)}else{if(!ZCUtil.isNull(ZCUtil.getFromMap(I,"fcid"))){D=ZCUtil.getFromMap(I,"fcid");if(B=="true"){ZCForm.showHideCog($(H).find("div[elName=srchDiv][formCompID="+ZCUtil.getFromMap(I,"fcid")+"]"),"hidden")}else{ZCForm.showHideCog($(H).find(":input[formCompID="+ZCUtil.getFromMap(I,"fcid")+"]"),"hidden")}}}}if(!ZCUtil.isNull(K)){if(newGenerateJsCodeEnabled){ZCNewGenerateJsTask.executeTask(K,I)}else{evaluateJs(K,L)}}if(!ZCUtil.isNull(J)){if(relodCurrentForm&&relodCurrentForm=="true"&&ZCUtil.isNull(C.errMsg)&&ZCUtil.isNull(C.fieldErrObj)){ZCForm.showForm(G,L,"","",C.succMsg)}relodCurrentForm="true"}if(form_element!=""){var R=form_element;form_element="";fireOnChange(R)}for(fe in form_element){var R=form_element[fe];form_element[fe]="";if(R!=""){fireOnChange(R)}}form_element=new Array();var Q=ZCForm.formArr[G];var A=ZCUtil.getFromMap(Q,"onuserinput");if(A!=""){A=ZCUtil.removeFromArray(A,D);if(A.length>0){ZCUtil.setInMap(Q,"onuserinput",A)}else{ZCUtil.removeFromMap(Q,"onuserinput")}}if(ZCUtil.isNull(ZCUtil.getFromMap(Q,"fieldchange"))&&!ZCUtil.isNull(ZCUtil.getFromMap(Q,"autosubmit"))&&A==""){if(!ZCUtil.isNull(ZCUtil.getFromMap(Q,"buttonelem"))){buttonEl=ZCUtil.getFromMap(Q,"buttonelem");ZCForm.handleButtonOnClick(H,L,buttonEl)}else{ZCForm.submitForm(H)}}else{if(!ZCUtil.isNull(ZCUtil.getFromMap(Q,"fieldchange"))&&!ZCUtil.isNull(ZCUtil.getFromMap(Q,"autosubmit"))){ZCApp.showFadingMsg(i18n.invalidsubmission,0,1000);ZCForm.clearErrors(H);ZCForm.showErrors(G,L,"",i18n.showfield)}}if(ZCUtil.getFromMap(I,"rowactiontype")==="ondeleterow"){ZCForm.removeTR(H,ZCUtil.getFromMap(I,"fcname"),ZCUtil.getFromMap(I,"rowseqid"))}}function hideComponent(A,C,B){ZCForm.showHideField(false,A,C,B)}function showComponent(B,D,C){ZCForm.showHideField(true,B,D,C);var A=ZCForm.formArr[B];ZCUtil.setInMap(A,"fieldchange","true")}function enableComponent(B,D,C){ZCForm.enDisableField(false,B,D,C);var A=ZCForm.formArr[B];ZCUtil.setInMap(A,"fieldchange","true")}function disableComponent(A,C,B){ZCForm.enDisableField(true,A,C,B)}function clearComponent(A,D,C){var B=ZCForm.clearField(A,D,C);if($(B).attr("type")=="picklist"||$(B).attr("type")=="select-one"){$(B).append(ZCUtil.createElem("option","value=-Select-","-"+i18n.selectOption+"-"))}if(!form_element[B]){form_element[B]=B}}function resetLoadLookupOptions(E,D,H,C){if(D){var G="SF("+D.Name+").FD("+D.rowID+")."+(ZCConstants.MULTI_SELECT==D.compType?"MV(":"SV(")+H+")";var A=ZCForm.getForm(E,C);var B=$(A).find("div[name='"+G+"']")}else{var B=ZCForm.getField(E,H,C)}$(B).data("immutable",false);var F=B.siblings("div[elname='srchDivEl']");var I=F.find("table[id='"+H+"_valTable']");I.attr("issaturated","false")}function addValueToTheFieldElem(C,G,E,D,B,F){var A=document.getElementById(C+":"+G+"_recType_comp");addValue(C,G,A,E,D,B,null,null,F)}function decodeChoices(B){var C=document.createElement("textarea");for(var A in B){C.innerHTML=B[A];B[A]=C.value}return B}function addValue(V,E,b,P,a,T,H,O,G){P=decodeChoices(P);if(!newGenerateJsCodeEnabled&&P.constructor.toString().indexOf("Array")==-1){P=P.replace(new RegExp(ZCConstants.REPLACE_DQ_CHAR,"g"),'"');P=P.replace(new RegExp(ZCConstants.REPLACE_NL_CHAR,"g"),"\n")}var Z=ZCForm.getForm(V,a);var C;if(H){C=$(ZCForm.getForm(V,a)).find(":input[lblName='"+E+"'][name='"+$(b).attr("name")+"'], div[elName=srchDiv][labelName='"+E+"'][name='"+$(b).attr("name")+"']")}else{C=ZCForm.getField(V,E,a)}C=(C[0])?C:Z.find("div[name='parentOf-"+E+"'],span[name='parentOf-"+E+"']");var X=$(C).onchange;$(C).onchange=new Function("evt","");var L=new Array();var c=new Array();if(P.constructor.toString().indexOf("Array")==-1){L.push(P)}else{L=P}if(T!=undefined){if(T.constructor.toString().indexOf("Array")==-1){c.push(T)}else{c=T}}if($(C).attr("type")=="picklist"||$(C).attr("type")=="select-one"||$(C).attr("type")=="multiselect"||$(C).attr("type")=="select-multiple"){for(var W=0;W<L.length;W++){var Y=L[W];var Q=c[W];if(newGenerateJsCodeEnabled){var J=$("<option></option>");J.val(Y);J.text(Y)}else{var J=$('<option value="'+Y+'">'+Y+"</option>")}if(Q!=undefined){if(newGenerateJsCodeEnabled){J.text(Q)}else{J=$('<option value="'+Y+'">'+Q+"</option>")}}$(C).append(J)}$(C).onchange=X}if($(C).attr("type")=="searchLookupSingle"||$(C).attr("type")=="searchLookupMulti"){var I=0;for(var W=0;W<L.length;W++){var Y=L[W];var Q=c[W];var B=E;if(B.indexOf(":")>0){B=B.replace(/\(/g,"\\(");B=B.replace(/\)/g,"\\)");B=B.replace(/:/g,"\\:");B=B.replace(/\./g,"\\.")}if(newGenerateJsCodeEnabled){var N=$('<tr elname="srchValtr" class=""><td class="resetGridClass"></td></tr>');N.attr("labelname",E);N.attr("value",Y);N.attr("rowno",(I+1));N.children().text(Y)}else{var N='<tr labelname="'+E+'" elname="srchValtr" value="'+Y+'" rowno="'+(I+1)+'" class=""><td class="resetGridClass">'+Y+"</td></tr>"}if(Q!=undefined){if(newGenerateJsCodeEnabled){N.children().text(Q)}else{N='<tr labelname="'+E+'" elname="srchValtr" value="'+Y+'" rowno="'+(I+1)+'" class=""><td class="resetGridClass">'+Q+"</td></tr>"}}if(!H){if(searchFactory.getCache(E)!=undefined){$(C).parent("div:first").find("div[elName=srchValDiv]").html(searchFactory.getCache(E).cacheData[""]);searchFactory.clearCache(E)}$(C).parent("div:first").find("div[elName=srchValDiv]").find("table").find("tr[elName=noResultTr]").remove();$(C).parent("div:first").find("div[elName=srchValDiv]").find("table").append(N)}else{for(var U=0;U<$(C).length;U++){if(searchFactory.getCache(E)!=undefined){$(C[U]).parent("div:first").find("div[elName=srchValDiv]").html(searchFactory.getCache(E).cacheData[""])}}searchFactory.clearCache(E);$(b).parent("div:first").find("div[elName=srchValDiv]").find("table").find("tr[elName=noResultTr]").remove();$(b).parent("div:first").find("div[elName=srchValDiv]").find("table").append(N);if(G!=undefined&&G==true){if(searchFactory.getCache(O)!=undefined){var S=searchFactory.getCache(O).cacheData[""];if(S!=undefined){$(S).find("tr[elName=noResultTr]").remove();S=$(S).append(N);searchFactory.setCache(O,S,"")}}}}I=I+1}}else{var M=docid("opt-table-"+C.attr("formCompID"));if($(C).attr("name")!=undefined&&($(C).attr("name")).indexOf("parentOf-")==-1){C=$(M).parent()}if($(C).attr("type")=="radio"){var A=1;if(!ZCUtil.isNull($(C).attr("layout"))){A=parseInt($(C).attr("layout"))}var R=ZCUtil.createElem("tr","","");for(var W=0;W<L.length;W++){var Y=L[W];var Q=c[W];var F=$("<td></td>");if(newGenerateJsCodeEnabled){var D=$('<input class="zc-radio" tagfor="formComp" type="radio" delugeType="STRING" formCompID="'+C.attr("formCompID")+'" onChangeExists="'+C.attr("onChangeExists")+'" isformulaexist="'+C.attr("isformulaexist")+'"/>');D.attr("id","radioEl_"+E+"_"+Y+"_1");D.attr("name",E);D.attr("value",Y)}else{var D=$('<input class="zc-radio" tagfor="formComp" type="radio" name="'+E+'" value="'+Y+'" delugeType="STRING" formCompID="'+C.attr("formCompID")+'" onChangeExists="'+C.attr("onChangeExists")+'" isformulaexist="'+C.attr("isformulaexist")+'"/>');D.attr("id","radioEl_"+E+"_"+Y+"_1")}D.onchange=X;$(F).append(D);if(newGenerateJsCodeEnabled){var K=$('<td><label class="zc-radiolabel">'+Y+"</label></td>");K.children().attr("for","radioEl_"+E+"_"+Y+"_1")}else{var K=$('<td><label class="zc-radiolabel" for="radioEl_'+E+"_"+Y+'_1">'+Y+"</label></td>")}if(Q!=undefined){if(newGenerateJsCodeEnabled){K=$('<td><label class="zc-radiolabel">'+Q+"</label></td>");K.children().attr("for","radioEl_"+E+"_"+Y+"_1")}else{K=$('<td><label class="zc-radiolabel" for="radioEl_'+E+"_"+Y+'_1">'+Q+"</label></td>")}}$(R).append(F);$(R).append(K);setOnClickAndDisable(C,Z,D,a);$(M).append(R);if((W+1)%(A)===0){R=ZCUtil.createElem("tr","","")}}}else{if($(C).attr("type")=="checkbox"){var A=1;if(!ZCUtil.isNull($(C).attr("layout"))){A=parseInt($(C).attr("layout"))}var R=ZCUtil.createElem("tr","","");for(var W=0;W<L.length;W++){var Y=L[W];var Q=c[W];var F=$("<td></td>");if(newGenerateJsCodeEnabled){var D=$('<input class="zc-checkboxes" tagfor="formComp" type="checkbox" delugeType="'+$(C).attr("delugetype")+'" fieldtype="13" formCompID="'+C.attr("formCompID")+'" onChangeExists="'+C.attr("onChangeExists")+'" isformulaexist="'+C.attr("isformulaexist")+'"/>');D.attr("name",E);D.attr("id","checkboxesEl_"+E+"_"+Y+"_1");D.val(Y)}else{var D=$('<input class="zc-checkboxes" tagfor="formComp" type="checkbox" name="'+E+'" value="'+Y+'" delugeType="'+$(C).attr("delugetype")+'" fieldtype="13" id="checkboxesEl_'+E+"_"+Y+'_1" formCompID="'+C.attr("formCompID")+'" onChangeExists="'+C.attr("onChangeExists")+'" isformulaexist="'+C.attr("isformulaexist")+'"/>')}D.onchange=X;$(F).append(D);if(newGenerateJsCodeEnabled){var K=$('<td><label class="zc-checkboxeslabel">'+Y+"</label></td>");K.children().attr("for","checkboxesEl_"+E+"_"+Y+"_1")}else{var K=$('<td><label class="zc-checkboxeslabel" for="checkboxesEl_'+E+"_"+Y+'_1">'+Y+"</label></td>")}if(Q!=undefined){if(newGenerateJsCodeEnabled){K=$('<td><label class="zc-checkboxeslabel">'+Q+"</label></td>");K.children().attr("for","checkboxesEl_"+E+"_"+Y+"_1")}else{K=$('<td><label class="zc-checkboxeslabel" for="checkboxesEl_'+E+"_"+Y+'_1">'+Q+"</label></td>")}}$(R).append(F);$(R).append(K);setOnClickAndDisable(C,Z,D,a);$(M).append(R);if((W+1)%(A)===0){R=ZCUtil.createElem("tr","","")}}}}}var C=ZCForm.getField(V,E,a);C=(C[0])?C:Z.find("div[name='parentOf-"+E+"']")}function setOnChangeAndDisable(B,C,D,A){$(D).change(function(){if($(D).attr("onChangeExists")=="true"){onChangeScript(C,$(C).find(":input[name=formid]").val(),$(D).attr("formCompID"),A)}});if($(B).attr("status")=="disable"){$(D).attr("disabled",true)}}function setOnClickAndDisable(B,C,D,A){$(D).click(function(){var E=$(this).parents("div[elname=subformdiv]")[0];if(E){ZCForm.invokeOnChange(this,C,A,$(E).attr("formcompid"))}else{ZCForm.invokeOnChange(this,C,A)}});if($(B).attr("status")=="disable"){$(D).attr("disabled",true)}}function selectValue(B,E,D,C,A){ZCForm.selectDeselect(B,E,C,D,true,A)}function deSelectValue(B,E,D,C,A){ZCForm.selectDeselect(B,E,C,D,false,A)}function selectAllValue(A,C,B){ZCForm.selectDeselectAll(A,C,B,true)}function deSelectAllValue(A,C,B){ZCForm.selectDeselectAll(A,C,B,false)}function setValue(C,H,F,D,G,E,B,A){if(!newGenerateJsCodeEnabled&&F.constructor.toString().indexOf("Array")==-1){F=F.replace(new RegExp(ZCConstants.REPLACE_DQ_CHAR,"g"),'"');F=F.replace(new RegExp(ZCConstants.REPLACE_NL_CHAR,"g"),"\n")}el=ZCForm.setFieldValue(C,H,D,F,A,G,E,B);if(isRecursionInGenJSAllowed){fireOnChange(el)}}function subFormFieldJSTask(E,G,N,A,J,I,B,L,D,H,M){if(J){var K="SF("+N+").FD("+J+")."+(ZCConstants.MULTI_SELECT==B?"MV(":"SV(")+I+")"}switch(E){case ZCConstants.CLEAR:var C=ZCForm.clearField(G,K,D);if($(C).attr("type")=="picklist"||$(C).attr("type")=="select-one"){$(C).append(ZCUtil.createElem("option","value=-Select-","-"+i18n.selectOption+"-"))}break;case ZCConstants.SET_VALUE:if(B==ZCConstants.IMAGE||B==ZCConstants.URL){setSubFormImageUrlValue(G,N,K,J,I,A,D)}else{if(!newGenerateJsCodeEnabled&&A.constructor.toString().indexOf("Array")==-1){A=A.replace(new RegExp(ZCConstants.REPLACE_DQ_CHAR,"g"),'"');A=A.replace(new RegExp(ZCConstants.REPLACE_NL_CHAR,"g"),"\n")}C=ZCForm.setSubFormValue(G,K,D,A,L,H,N,true,J)}break;case ZCConstants.DISABLE:case ZCConstants.HIDE:case ZCConstants.ENABLE:case ZCConstants.SHOW:subFormColumnLevelAction(G,N,I,E,B,D);break;case ZCConstants.APPEND_VALUE:var F=$(ZCForm.getForm(G,D)).find("[name='"+K+"']");addValue(G,I,F,A,D,H,true,K,M);break;case ZCConstants.RESET_LOAD_LOOKUP_TASK:var O=new Object();O.Name=N;O.rowID=J;O.compType=B;resetLoadLookupOptions(G,O,I,D);break}}function subFormColumnLevelAction(S,J,N,L,P,b){var V=ZCForm.getField(S,J,b);var O="[name*=')."+(ZCConstants.MULTI_SELECT==P?"MV":"SV")+"("+N+")']";var H=V.find(O);switch(L){case ZCConstants.HIDE:case ZCConstants.SHOW:var X=L===ZCConstants.SHOW;$.each(H,function(c,e){var d=$(e).parents("td");$(d[0]).css("display",X?"":"none")});V.find("th[delugename="+N+"]").css("display",X?"":"none");break;case ZCConstants.ENABLE:case ZCConstants.DISABLE:var G=L===ZCConstants.DISABLE;$(H).parent().each(function(c,d){$(d).parent("div:first").parent().find("span[elname=zc-show-parent]").removeAttr("disabled","disabled");if(G){$(d).parent("div:first").parent().find("span[elname=zc-show-parent]").attr("disabled","disabled")}});switch(P){case ZCConstants.RICH_TEXT_AREA:searchrt="[nameoftextarea*=')."+(ZCConstants.MULTI_SELECT==P?"MV":"SV")+"("+N+")']";var D=V.find(O);for(var U=0;U<D.length;U++){var Z=$(D[U]).attr("formcompid");var Q="freezdiv_"+Z;var W=$("div[textareaname="+Z+"]")[U];var A=$(W).attr("id");W=$("div[id="+A+"]");var K=ZCForm.editorRef[A];try{if(K){if(K.mode=="plaintext"){$(K._textarea).attr("disabled",G)}else{var T=K.iframe;var Y=G?"off":"on";if(!($.browser.msie)){K.doc.designMode=Y}else{var C=G?"false":"true";K.doc.body.contentEditable=C}}}}catch(I){}var F=W.find("#"+Q);var a={zIndex:G?50:-50};if(W.find("#"+Q)[U]){F.css(a)}if(G){if(W.attr("disablerichtext")!="true"){var M=document.createElement("div");M.className="freezeLayer";M.id=Q;var B={left:"0",top:"0",height:"100%",width:"100%",zIndex:50,background:"#AAAAAA",border:"1px solid #AAAAAA"};$(M).css(B);$(W).css("position","relative");W.attr("disablerichtext",true);W[0].appendChild(M)}}else{W.attr("disablerichtext",false);F.css(a)}}break;case ZCConstants.DATE:case ZCConstants.DATE_TIME:H.attr("disabled",G);$.each(H,function(c,d){if(G){ZCUtil.getParent(d).find("a").css("visibility","hidden")}else{ZCUtil.getParent(d).find("a").css("visibility","visible")}});break;case ZCConstants.IMAGE:case ZCConstants.URL:$.each(H,function(d,e){var c=$(e).find(":input");if(P==ZCConstants.IMAGE&&b=="3"){$(e).find("a[enable=enable]").each(function(f,h){(G)?$(h).css("visibility","hidden"):$(h).css("visibility","visible")})}$.each(c,function(f,h){$(h).attr("disabled",G)})});break;case ZCConstants.FILE_UPLOAD:if(H.attr("subType")=="file"){var R=$(H);for(var U=0;U<R.length;U++){var E=ZCForm.getFileUploadField(S,$(R[U]).attr("name"),b);$(E).attr("disabled",G)}}break;case ZCConstants.SINGLE_SELECT:case ZCConstants.MULTI_SELECT:if(H.attr("type")=="searchLookupSingle"||H.attr("type")=="searchLookupMulti"){if(G){$(H).parent("div:first").find("div[elName=srchDivEl]").css("display","none");$(H).css("background-color","#ebebe4");$(H).attr("disable","true");$(H).unbind()}else{$(H).css("background-color","");$(H).attr("disable","false");$(H).click(function(c){if(!ZCUtil.isNull($(H).attr("subformlabelname"))){searchFactory.setVariables(this,true)}else{searchFactory.setVariables(this,false)}searchFactory.triggerClickEvent(c)})}}else{H.attr("disabled",G)}break;default:H.attr("disabled",G);break}break}}function setSubFormImageUrlValue(J,I,H,G,F,C,E){var D=$(ZCForm.getForm(J,E)).find("div[name='"+H+"']");var B="SF("+I+").FD("+G+").SV(";if(newGenerateJsCodeEnabled){C=C==null?"":C}var A=ZCUtil.getAttrsAsArr(C,D.attr("type"));if(D.attr("type")=="image"){D.find(":input[name='"+B+"zcsource-"+F+")']").val(checkValue(A["zcsource-"]));D.find(":input[name='"+B+"zctitle-"+F+")']").val(checkValue(A["zctitle-"]));D.find(":input[name='"+B+"zcalttext-"+F+")']").val(checkValue(A["zcalttext-"]));D.find(":input[name='"+B+"zcfieldlink-"+F+")']").val(checkValue(A["zcfieldlink-"]));D.find(":input[name='"+B+"zctarget-"+F+")']").val(checkValue(A.target))}else{D.find(":input[name='"+B+"zcurl-"+F+")']").val(checkValue(A["zcurl-"]));D.find(":input[name='"+B+"zctitle-"+F+")']").val(checkValue(A["zctitle-"]));D.find(":input[name='"+B+"zclnkname-"+F+")']").val(checkValue(A["zclnkname-"]));D.find(":input[name='"+B+"zctarget-"+F+")']").val(checkValue(A.target))}}function makeArray(){var A=new Array();for(i=0;i<makeArray.arguments.length;i=i+2){A[makeArray.arguments[i]]=makeArray.arguments[i+1]}return A}function makeList(){var A=new Array();for(i=0;i<makeList.arguments.length;i++){A[i]=makeList.arguments[i]}return A}function checkValue(A){if(A){return A}return""}function setImageUrlValue(A,E,D,C){var B=ZCForm.getField(A,E,C);if(B.attr("type")=="image"){B.find(":input[name='zcsource-"+E+"']").val(checkValue(D["zcsource-"]));B.find(":input[name='zctitle-"+E+"']").val(checkValue(D["zctitle-"]));B.find(":input[name='zcalttext-"+E+"']").val(checkValue(D["zcalttext-"]));B.find(":input[name='zcfieldlink-"+E+"']").val(checkValue(D["zcfieldlink-"]));B.find(":input[value="+D.target+"]").prop("checked","checked")}else{B.find(":input[name='zcurl-"+E+"']").val(checkValue(D["zcurl-"]));B.find(":input[name='zctitle-"+E+"']").val(checkValue(D["zctitle-"]));B.find(":input[name='zclnkname-"+E+"']").val(checkValue(D["zclnkname-"]));B.find(":input[value="+D.target+"]").prop("checked","checked")}}function openWindowTask(D,C,B){if(D!=""&&D!=null&&D!=undefined&&ZCSecurity.isValidURL(D)){isOpenWindowTaskExec=true;C=C.toLowerCase();D=trimLeftString(D);var A=D.toLowerCase();if(ZCSecurity.isURLXSSVulnerable(D)){D=null}if(D!=null){if(C=="new window"||C=="new"||ZCUtil.isNull(C)){window.open(D,"_new")}else{if(C=="iframe"){window.open(D,B)}else{if(C=="popup"||C=="popup window"){if(D.indexOf("#")==0||D.indexOf("/#")==0||D.indexOf("/")==0){ZCApp.openUrlInDialog(D,B)}else{var E="resizable=false,scrollbars=yes,toolbar=false,location=false,directories=false,status=false,menubar=false,copyhistory=false";E=E+","+B;window.open(D,"_blank",E)}}else{closeAllDialog();reloadCurrView=false;relodCurrentForm="false";ZCUtil.setURLInLocationBar(D,C,0);ZCApp.reloadSameURL(D,C)}}}}}else{alert(i18n["zc.live.form.invalidurlerror"])}}function jsalert(A){if(!newGenerateJsCodeEnabled){A=A.replace(new RegExp(ZCConstants.REPLACE_DQ_CHAR,"g"),'"');A=A.replace(new RegExp(ZCConstants.REPLACE_NL_CHAR,"g"),"<br>")}else{A=A.replace(/\r/g,"");A=A.replace(/\n/g,"<br>")}ZCApp.showErrorDialog(null,A)}function fireOnChange(A){if($(A).attr("onChangeExists")){ZCForm.isRecursiveCall=true;if($(A).attr("type")=="radio"||$(A).attr("type")=="checkbox"){$(A).triggerHandler("click")}else{$(A).change()}ZCForm.isRecursiveCall=false}if(form_element[A]){form_element[A]=""}}function setFormState(C){var B=$(C).attr("name");var A=ZCForm.formArr[B];ZCUtil.setInMap(A,"client","changed")}function getURLFromViewer(D){if(viewLogPreviousValue!=D&&D!=-1){if(D==-1){alert(i18Arr["zc.alertmsg.selectadate"])}else{var B="/GetURLFromViewer.do";var C=new Array("date");var A=new Array(D);getHtmlForForm(getForm(B,C,A),"setURLtoIFrame",null,i18Arr["zc.viewlive.loading"])}}viewLogPreviousValue=D}function getScheduleURLFromViewer(F,A,D){if(viewLogPreviousValue!=F&&F!=-1){if(F==-1){alert(i18Arr["zc.alertmsg.selectadate"])}else{var C=null;if(A=="true"){C="/GetScheduleURLFromViewer_zcadmin.do?sharedBy="+D}else{C="/GetScheduleURLFromViewer.do"}var E=new Array("date");var B=new Array(F);getHtmlForForm(getForm(C,E,B),"setURLtoIFrame",null,i18Arr["zc.viewlive.loading"])}}viewLogPreviousValue=F}function setURLtoIFrame(A){document.getElementById("display-loginfo-span").innerHTML=A}function copySelectionFromGvn(A,C){for(var B=0;B<A.length;B++){C[B].selected=A[B].selected}}function trimLeftString(A){do{index=A.indexOf(" ");if(index==0){A=A.substring(1)}}while(index==0);return A}function getLoggingDetailWhileRefresh(){try{var C=document.getElementById("loggingDetailSelect");var B=C.value;if(B!=""&&B!=undefined){getURLFromViewer(B)}}catch(A){}}function getScheduleLoggingDetailWhileRefresh(){try{var C=document.getElementById("loggingDetailSelect");var B=C.value;if(B!=""&&B!=undefined){getURLFromViewer(B)}}catch(A){}}function showStackTrace(B){var A=window.open("","name1","height=500,width=500");A.document.write("<html><head><title>StackTrace</title>");A.document.write("</head><body>");A.document.write('<textarea style="width:500;height:500">'+document.getElementById(B).value+"</textarea>");A.document.write("</body></html>");A=null}function reloadForm(A,B){ZCForm.resetForm(A,B)}Calendar._DN=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday");Calendar._SDN=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun");Calendar._FD=0;Calendar._MN=new Array("January","February","March","April","May","June","July","August","September","October","November","December");Calendar._SMN=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");Calendar._TT={};Calendar._TT.INFO="About the calendar";Calendar._TT.ABOUT="DHTML Date/Time Selector\n(c) dynarch.com 2002-2005 / Author: Mihai Bazon\nFor latest version visit: http://www.dynarch.com/projects/calendar/\nDistributed under GNU LGPL.  See http://gnu.org/licenses/lgpl.html for details.\n\nDate selection:\n- Use the \xab, \xbb buttons to select year\n- Use the "+String.fromCharCode(8249)+", "+String.fromCharCode(8250)+" buttons to select month\n- Hold mouse button on any of the above buttons for faster selection.";Calendar._TT.ABOUT_TIME="\n\nTime selection:\n- Click on any of the time parts to increase it\n- or Shift-click to decrease it\n- or click and drag for faster selection.";Calendar._TT.PREV_YEAR="Prev. year (hold for menu)";Calendar._TT.PREV_MONTH="Prev. month (hold for menu)";Calendar._TT.GO_TODAY="Go Today";Calendar._TT.NEXT_MONTH="Next month (hold for menu)";Calendar._TT.NEXT_YEAR="Next year (hold for menu)";Calendar._TT.SEL_DATE="Select date";Calendar._TT.DRAG_TO_MOVE="Drag to move";Calendar._TT.PART_TODAY=" (today)";Calendar._TT.DAY_FIRST="Display %s first";Calendar._TT.WEEKEND="0,6";Calendar._TT.CLOSE="Close";Calendar._TT.TODAY="Today";Calendar._TT.TIME_PART="(Shift-)Click or drag to change value";Calendar._TT.DEF_DATE_FORMAT="%Y-%m-%d";Calendar._TT.TT_DATE_FORMAT="%a, %b %e";Calendar._TT.WK="wk";Calendar._TT.TIME="Time:";Calendar.setup=function(G){function F(H,I){if(typeof G[H]=="undefined"){G[H]=I}}F("inputField",null);F("displayArea",null);F("button",null);F("eventName","click");F("ifFormat","%Y/%m/%d");F("daFormat","%Y/%m/%d");F("singleClick",true);F("disableFunc",null);F("dateStatusFunc",G.disableFunc);F("dateText",null);F("firstDay",null);F("align","Br");F("range",[1900,2999]);F("weekNumbers",true);F("flat",null);F("flatCallback",null);F("onSelect",null);F("onClose",null);F("onUpdate",null);F("date",null);F("showsTime",false);F("timeFormat","24");F("electric",true);F("step",2);F("position",null);F("cache",false);F("showOthers",false);F("multiple",null);var C=["inputField","displayArea","button"];for(var B in C){if(typeof G[C[B]]=="string"){G[C[B]]=document.getElementById(G[C[B]])}}if(!(G.flat||G.multiple||G.inputField||G.displayArea||G.button)){alert("Calendar.setup:\n  Nothing to setup (no fields found).  Please check your code");return false}function A(I){var H=I.params;var J=(I.dateClicked||H.electric);if(J&&H.inputField){H.inputField.value=I.date.print(H.ifFormat);if(typeof H.inputField.onchange=="function"){H.inputField.onchange()}}if(J&&H.displayArea){H.displayArea.innerHTML=I.date.print(H.daFormat)}if(J&&typeof H.onUpdate=="function"){H.onUpdate(I)}if(J&&H.flat){if(typeof H.flatCallback=="function"){H.flatCallback(I)}}if(J&&H.singleClick&&I.dateClicked){I.callCloseHandler()}}if(G.flat!=null){if(typeof G.flat=="string"){G.flat=document.getElementById(G.flat)}if(!G.flat){alert("Calendar.setup:\n  Flat specified but can't find parent.");return false}var E=new Calendar(G.firstDay,G.date,G.onSelect||A);E.showsOtherMonths=G.showOthers;E.showsTime=G.showsTime;E.time24=(G.timeFormat=="24");E.params=G;E.weekNumbers=G.weekNumbers;E.setRange(G.range[0],G.range[1]);E.setDateStatusHandler(G.dateStatusFunc);E.getDateText=G.dateText;if(G.ifFormat){E.setDateFormat(G.ifFormat)}if(G.inputField&&typeof G.inputField.value=="string"){E.parseDate(G.inputField.value)}E.create(G.flat);E.show();return false}var D=G.button||G.displayArea||G.inputField;D["on"+G.eventName]=function(){var H=G.inputField||G.displayArea;var J=G.inputField?G.ifFormat:G.daFormat;var N=false;var L=window.calendar;if(H){G.date=Date.parseDate(H.value||H.innerHTML,J)}if(!(L&&G.cache)){window.calendar=L=new Calendar(G.firstDay,G.date,G.onSelect||A,G.onClose||function(O){O.hide()});L.showsTime=G.showsTime;L.time24=(G.timeFormat=="24");L.weekNumbers=G.weekNumbers;N=true}else{if(G.date){L.setDate(G.date)}L.hide()}if(G.multiple){L.multiple={};for(var I=G.multiple.length;--I>=0;){var M=G.multiple[I];var K=M.print("%Y%m%d");L.multiple[K]=M}}L.showsOtherMonths=G.showOthers;L.yearStep=G.step;L.setRange(G.range[0],G.range[1]);L.params=G;L.setDateStatusHandler(G.dateStatusFunc);L.getDateText=G.dateText;L.setDateFormat(J);if(N){L.create()}L.refresh();if(!G.position){L.showAtElement(G.button||G.displayArea||G.inputField,G.align)}else{L.showAt(G.position[0],G.position[1])}return false};return E};!function(Y){var X="Compound",W="Identifier",V="MemberExpression",U="Literal",T="ThisExpression",S="CallExpression",R="UnaryExpression",Q="BinaryExpression",P="LogicalExpression",O=!0,N={"-":O,"!":O,"~":O,"+":O},M={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},L=function(e){var Z,h=0;for(var f in e){(Z=f.length)>h&&e.hasOwnProperty(f)&&(h=Z)}return h},K=L(N),J=L(M),I={"true":!0,"false":!1,"null":null},H="this",G=function(Z){return M[Z]||0},F=function(e,Z,h){var f="||"===e||"&&"===e?P:Q;return{type:f,operator:e,left:Z,right:h}},E=function(Z){return Z>=48&&57>=Z},D=function(Z){return 36===Z||95===Z||Z>=65&&90>=Z||Z>=97&&122>=Z},C=function(Z){return 36===Z||95===Z||Z>=65&&90>=Z||Z>=97&&122>=Z||Z>=48&&57>=Z},B=function(AD){for(var AC,AB,AA=0,w=AD.charAt,h=AD.charCodeAt,e=function(a){return w.call(AD,a)},c=function(a){return h.call(AD,a)},v=AD.length,u=function(){for(var n=c(AA);32===n||9===n;){n=c(++AA)}},s=function(){u();for(var a=AD.substr(AA,J),n=a.length;n>0;){if(M.hasOwnProperty(a)){return AA+=n,a}a=a.substr(0,--n)}return !1},q=function(){var y,n,AI,AH,AG,AF,AE,z;if(AF=p(),n=s(),!n){return AF}if(AG={value:n,prec:G(n)},AE=p(),!AE){throw new Error("Expected expression after "+n+" at character "+AA)}for(AH=[AF,AG,AE];(n=s())&&(AI=G(n),0!==AI);){for(AG={value:n,prec:AI};AH.length>2&&AI<=AH[AH.length-2].prec;){AE=AH.pop(),n=AH.pop().value,AF=AH.pop(),y=F(n,AF,AE),AH.push(y)}if(y=p(),!y){throw new Error("Expected expression after "+n+" at character "+AA)}AH.push(AG),AH.push(y)}for(z=AH.length-1,y=AH[z];z>1;){y=F(AH[z-1].value,AH[z-2],y),z-=2}return y},p=function(){var a,y,n;if(u(),a=c(AA),E(a)||46===a){return o()}if(39===a||34===a){return m()}if(D(a)){return d()}if(40===a){return b()}for(y=AD.substr(AA,K),n=y.length;n>0;){if(N.hasOwnProperty(y)){return AA+=n,{type:R,operator:y,argument:p(),prefix:!0}}y=y.substr(0,--n)}return !1},o=function(){for(var n="";E(c(AA));){n+=e(AA++)}if("."===e(AA)){for(n+=e(AA++);E(c(AA));){n+=e(AA++)}}if("e"===e(AA)||"E"===e(AA)){for(n+=e(AA++),("+"===e(AA)||"-"===e(AA))&&(n+=e(AA++));E(c(AA));){n+=e(AA++)}if(!E(c(AA-1))){throw new Error("Expected exponent ("+n+e(AA)+") at character "+AA)}}if(D(c(AA))){throw new Error("Variable names cannot start with a number ("+n+e(AA)+") at character "+AA)}return{type:U,value:parseFloat(n),raw:n}},m=function(){for(var y,n="",AE=e(AA++),z=!1;v>AA;){if(y=e(AA++),y===AE){z=!0;break}if("\\"===y){switch(y=e(AA++)){case"n":n+="\n";break;case"r":n+="\r";break;case"t":n+="	";break;case"b":n+="\b";break;case"f":n+="\f";break;case"v":n+=""}}else{n+=y}}if(!z){throw new Error('Unclosed quote after "'+n+'"')}return{type:U,value:n,raw:AE+n+AE}},l=function(){var a,y=c(AA),n=AA;if(!D(y)){throw new Error("Unexpected "+e(AA)+"at character "+AA)}for(AA++;v>AA&&(y=c(AA),C(y));){AA++}return a=AD.slice(n,AA),I.hasOwnProperty(a)?{type:U,value:I[a],raw:a}:a===H?{type:T}:{type:W,name:a}},f=function(){for(var n,z,y=[];v>AA;){if(u(),n=e(AA),")"===n){AA++;break}if(","===n){AA++}else{if(z=q(),!z||z.type===X){throw new Error("Expected comma at character "+AA)}y.push(z)}}return y},d=function(){var y,n,z;for(n=l(),u(),y=e(AA);"."===y||"["===y||"("===y;){if("."===y){AA++,u(),n={type:V,computed:!1,object:n,property:l()}}else{if("["===y){if(z=AA,AA++,n={type:V,computed:!0,object:n,property:q()},u(),y=e(AA),"]"!==y){throw new Error("Unclosed [ at character "+AA)}AA++,u()}else{"("===y&&(AA++,n={type:S,arguments:f(),callee:n})}}u(),y=e(AA)}return n},b=function(){AA++;var n=q();if(u(),")"===e(AA)){return AA++,n}throw new Error("Unclosed ( at character "+AA)},Z=[];v>AA;){if(AC=e(AA),";"===AC||","===AC){AA++}else{if(AB=q()){Z.push(AB)}else{if(v>AA){throw new Error("Unexpected '"+e(AA)+"' at character "+AA)}}}}return 1===Z.length?Z[0]:{type:X,body:Z}};if(B.version="0.2.8",B.toString=function(){return"JavaScript Expression Parser (JSEP) v"+B.version},B.addUnaryOp=function(Z){return N[Z]=O,this},B.addBinaryOp=function(c,Z){return J=Math.max(c.length,J),M[c]=Z,this},B.removeUnaryOp=function(Z){return delete N[Z],Z.length===K&&(K=L(N)),this},B.removeBinaryOp=function(Z){return delete M[Z],Z.length===J&&(J=L(M)),this},"undefined"==typeof exports){var A=Y.jsep;Y.jsep=B,B.noConflict=function(){return Y.jsep===B&&(Y.jsep=A),B}}else{"undefined"!=typeof module&&module.exports?exports=module.exports=B:exports.parse=B}}(this);window.RuleEvents={};function SetupRules(B){this.form=$("form[name="+B.formLinkName+"]");this.fields={};this.fieldsStatus={};this.fieldCriteria={};this.effectFields={};this.taskType={HIDE_FIELDS:1,DISABLE_FIELDS:2,ENABLE_FIELDS:3,SHOW_FIELDS:4,HIDE_SUBFORM_ADD_ENTRY:9,SHOW_SUBFORM_ADD_ENTRY:10,HIDE_SUBFORM_DELETE_ENTRY:11,SHOW_SUBFORM_DELETE_ENTRY:12,SET_FIELD_VALUE:14};this.valuesCache={};this.zohoVars=undefined;this.isNewWfEnabled=B.isNewWfEnabled;window.RuleEvents[B.formLinkName]={};(function(J){J._setupFields=function(O){for(i=0;i<O.length;i++){var Q=O[i];if(Q.getAttribute("type")==="radio"||Q.getAttribute("type")==="checkbox"){if(J.fields[Q.getAttribute("name")]===undefined){J.fields[Q.getAttribute("name")]=new Array()}J.fields[Q.getAttribute("name")].push(Q)}else{if(Q.getAttribute("type")==="file"){J.fields[Q.getAttribute("labelname")]=Q}else{J.fields[Q.getAttribute("name")]=Q}}if(Q.getAttribute("type")==="file"){var N=(Q.offsetWidth>0)?Q.offsetWidth>0:($(Q).parent().parent().find("input[name="+Q.getAttribute("labelname")+"]").val()!=null);J.fieldsStatus[Q.getAttribute("labelname")]={visible:N,accessible:Q.disabled}}else{if(Q.getAttribute("type")==="url"){var R=$(":input[name=zcurl-"+Q.getAttribute("name")+"]")[0];R=(R==undefined)?$(":input[name="+Q.getAttribute("name")+"]")[0]:R;J.fieldsStatus[Q.getAttribute("name")]={visible:R.offsetWidth>0,accessible:R.disabled}}else{if(Q.getAttribute("type")==="image"){var P=$(":input[name=zcsource-"+Q.getAttribute("name")+"]")[0];var M=$(":input[labelname=zcsource-"+Q.getAttribute("name")+"]")[0];R=(P.offsetWidth==0&&M!=undefined)?M:P;J.fieldsStatus[Q.getAttribute("name")]={visible:R.offsetWidth>0,accessible:R.disabled}}else{if(parseInt(Q.getAttribute("fieldtype"))===ZCConstants.RICH_TEXT_AREA){var R=$("div[nameoftextarea="+Q.getAttribute("name")+"]")[0];R=(R==undefined)?$("textarea[name="+Q.getAttribute("name")+"]")[0]:R;J.fieldsStatus[Q.getAttribute("name")]={visible:R.offsetWidth>0,accessible:R.disabled}}else{if(parseInt(Q.getAttribute("fieldtype"))===ZCConstants.SIGNATURE){var L=$(Q).siblings("canvas")[0];J.fieldsStatus[Q.getAttribute("name")]={visible:L.offsetWidth>0,accessible:L.disabled}}else{if(Q.getAttribute("type")==="plaintext"){if(Q.children.length>0){J.fieldsStatus[Q.getAttribute("name")]={visible:true,accessible:Q.disabled}}else{J.fieldsStatus[Q.getAttribute("name")]={visible:Q.offsetWidth>0,accessible:Q.disabled}}}else{if(Q.getAttribute("modtype")==ZCConstants.ZOHO_CRM_USERS){J.fieldsStatus[Q.getAttribute("id")]={visible:Q.offsetWidth>0,accessible:Q.disabled}}else{J.fieldsStatus[Q.getAttribute("name")]={visible:Q.offsetWidth>0,accessible:Q.disabled}}}}}}}}}};var K=$(J.form).find(":input[type!=hidden],div[elName=subformdiv],div[elName=srchDiv],div[name][type=url],div[name][type=image],span[type=plaintext]").not($(J.form).find("div[elName=subformdiv]").find(":input,div[elName=srchDiv],div[name][type=url],div[name][type=image]"));J._setupFields(K)}(this));this._getFieldStatus=function(K){var J=this;if(J.fieldsStatus[K]===undefined){J.fieldsStatus[K]={}}return J.fieldsStatus[K]};this._setEffectFields=function(J,K){if(this._getEffectFields(J).indexOf(K)===-1){this._getEffectFields(J).push(K)}if(this.effectFields[K]!==undefined){for(i in this.effectFields[K]){if(this._getEffectFields(J).indexOf(this.effectFields[K][i])===-1){this._getEffectFields(J).push(this.effectFields[K][i])}}}for(cf in this._getEffectFields()){if(this.effectFields[cf].indexOf(J)!==-1){if(this._getEffectFields(cf).indexOf(K)===-1){this._getEffectFields(cf).push(K)}}}};this._getField=function(J){return this.fields[J]};this._getEffectFields=function(K){var J=this;if(K===undefined){return J.effectFields}if(J.effectFields[K]===undefined){J.effectFields[K]=[]}return J.effectFields[K]};this._setCrit=function(N,L,M,J){if(M===undefined){return false}switch(L){case this.taskType.HIDE_FIELDS:this._getFieldCriteria(N).hide.criteria=(this._getFieldCriteria(N).hide.criteria===undefined)?M:(this._getFieldCriteria(N).hide.criteria+J+M);break;case this.taskType.DISABLE_FIELDS:this._getFieldCriteria(N).disable.criteria=(this._getFieldCriteria(N).disable.criteria===undefined)?M:(this._getFieldCriteria(N).disable.criteria+J+M);break;case this.taskType.ENABLE_FIELDS:this._getFieldCriteria(N).enable.criteria=(this._getFieldCriteria(N).enable.criteria===undefined)?M:(this._getFieldCriteria(N).enable.criteria+J+M);break;case this.taskType.SHOW_FIELDS:this._getFieldCriteria(N).show.criteria=(this._getFieldCriteria(N).show.criteria===undefined)?M:(this._getFieldCriteria(N).show.criteria+J+M);break;case this.taskType.HIDE_SUBFORM_ADD_ENTRY:this._getFieldCriteria(N).hidesubformaddentry.criteria=(this._getFieldCriteria(N).hidesubformaddentry.criteria===undefined)?M:(this._getFieldCriteria(N).hidesubformaddentry.criteria+J+M);break;case this.taskType.SHOW_SUBFORM_ADD_ENTRY:this._getFieldCriteria(N).showsubformaddentry.criteria=(this._getFieldCriteria(N).showsubformaddentry.criteria===undefined)?M:(this._getFieldCriteria(N).showsubformaddentry.criteria+J+M);break;case this.taskType.HIDE_SUBFORM_DELETE_ENTRY:this._getFieldCriteria(N).hidesubformdeleteentry.criteria=(this._getFieldCriteria(N).hidesubformdeleteentry.criteria===undefined)?M:(this._getFieldCriteria(N).hidesubformdeleteentry.criteria+J+M);break;case this.taskType.SHOW_SUBFORM_DELETE_ENTRY:this._getFieldCriteria(N).showsubformdeleteentry.criteria=(this._getFieldCriteria(N).showsubformdeleteentry.criteria===undefined)?M:(this._getFieldCriteria(N).showsubformdeleteentry.criteria+J+M);break;case this.taskType.SET_FIELD_VALUE:if(this._getFieldCriteria(N).setfieldvalue.criteria===undefined){this._getFieldCriteria(N).setfieldvalue.criteria=[]}var K={};K.criteria=M;this._getFieldCriteria(N).setfieldvalue.criteria.push(K);break}};this._setFieldValue=function(O,M,N){var J=this._getFieldCriteria(O).setfieldvalue.criteria;if(this._getFieldCriteria(O).setfieldvalue.value===undefined){this._getFieldCriteria(O).setfieldvalue.value=[]}for(var K=0;K<J.length;K++){if(J[K].criteria===N){var L={};L.value=M;this._getFieldCriteria(O).setfieldvalue.value.push(L)}}};this._setFieldCriteria=function(L,J,K){this._setCrit(L,J,K,"||")};this._getFieldCriteria=function(K){var J=this;if(K===undefined){return J.fieldCriteria}if(J.fieldCriteria[K]===undefined){if($("body").find("div[name="+K+"]").attr("elname")==="subformdiv"){J.fieldCriteria[K]={show:{},hide:{},enable:{},disable:{},hidesubformaddentry:{},showsubformaddentry:{},hidesubformdeleteentry:{},showsubformdeleteentry:{},setfieldvalue:{}}}else{J.fieldCriteria[K]={show:{},hide:{},enable:{},disable:{},setfieldvalue:{set:false,correctCrit:-1}}}}return J.fieldCriteria[K]};this._evaluteCondition=function(L){var K=this;var J=jsep(L.replace("is null",'== ""').replace("is not null",'!= ""'));_getZCFieldValue=function(O){var N=K._getField(O);if(!$(N).is(":visible")||$(N).is(":disabled")){return""}var M=K.valuesCache[O];if(M===undefined){M=_getFormFieldValue(O);K.valuesCache[O]=M}return M};_getFormFieldValue=function(S){var O;var Q=K._getField(S);if(parseInt($(Q).attr("fieldtype"))===ZCConstants.RICH_TEXT_AREA){var P="";var R=$(Q).attr("name");var N=$("div[nameoftextarea='"+R+"']");var M=$(N).attr("id");if(M!=""&&ZCForm.editorRef[M]!=null){P=ZCForm.editorRef[M].getContent()}return P}if(!$(Q).is(":visible")||$(Q).is(":disabled")){return""}if(Q instanceof Array&&(Q[0].type==="radio"||Q[0].type==="checkbox")){if(parseInt(Q[0].getAttribute("fieldtype"))===ZCConstants.CHECK_BOX){return Q[0].checked}O=new Array();for(i in Q){if(Q[i].checked){O.push(Q[i].value)}}}else{if(Q.type==="select-one"||Q.type==="select-multiple"){if(Q.getAttribute("fieldtype")===ZCConstants.INLINE_SINGLE_SELECT&&Q.value==="-otherVal-"){O=document.getElementsByName("othersVal"+Q.getAttribute("formcompid"))[0].value}else{O=$(Q).val()}}else{if(Q.getAttribute("type")==="searchLookupSingle"||Q.getAttribute("type")==="searchLookupMulti"){O=new Array();$(Q).find(":input").each(function(T,U){O.push(U.value)})}else{if(Q.getAttribute("type")==="plaintext"){O=$(Q).html()}else{O=Q.value}}}}return O===null?"":O};_getTreeValue=function(M){var N=M.type;var O;switch(N){case"Literal":if(typeof (M.value)==="number"&&M.raw.length>16){O=M.raw}else{O=M.value}break;case"Identifier":O=_getZCFieldValue(M.name);break;case"MemberExpression":if(M.object.name==="zoho"){if(K.zohoVars==undefined){$.ajax({url:"/misc.do",async:false,method:"GET",data:{mtd:"getZohoVars",sharedBy:ZCApp.sharedBy,appLinkName:ZCApp.appLinkName,formLinkName:B.formLinkName},success:function(P){K.zohoVars=P;K.zohoVars=$.extend(true,K.zohoVars,ZCForm.ZOHO_VARS)}})}O=K.zohoVars[M.property.name]}break}return O!==undefined&&typeof (O)!=="number"?O.toString():O};_evaluateCriteira=function(a){var P=a.operator;var Q=a.type;if(Q==="LogicalExpression"){switch(P){case"&&":return _evaluateCriteira(a.left)&&_evaluateCriteira(a.right);case"||":return _evaluateCriteira(a.left)||_evaluateCriteira(a.right);default:return false}}else{if(Q==="BinaryExpression"){var N=_getTreeValue(a.left);var U=_getTreeValue(a.right);var O="",Y="",Z=false,M=false;var T=K._getField(a.left.name);if(T!=undefined){var R=T[0]!=undefined?T[0].getAttribute("fieldtype"):T.getAttribute("fieldtype");if(R==ZCConstants.DATE||R==ZCConstants.DATE_TIME){var O=new Date(Date.parseDate(N,ZCApp.dateFormat));var Y=new Date(Date.parseDate(U,ZCApp.dateFormat));Z=true;if(N==""||U==""){M=true}}}if(typeof (U)==="number"){if(!$.isNumeric(N)){return false}if(N==parseInt(N)){N=parseInt(N)}else{N=parseFloat(N)}}switch(P){case"==":return N===U;case"!=":if(Z&&!M){return(O-Y)!==0}else{if(Z){return false}}return N!==U;case">":if(Z&&!M){return O>Y}else{if(Z){return false}}return N>U;break;case"<":if(Z&&!M){return O<Y}else{if(Z){return false}}return N<U;case">=":return N>=U;case"<=":return N<=U;default:return false}}else{if(Q==="CallExpression"){var V=a.callee.property.name;var S=_getTreeValue(a.callee.object);var X=_getTreeValue(a.arguments[0]);if(S===undefined){return false}switch(V){case"contains":return S.indexOf(X)!==-1;case"startsWith":return S.indexOf(X)===0;case"endsWith":return S.indexOf(X,S.length-X.length)!==-1;case"before":return new Date(Date.parseDate(S,ZCApp.dateFormat))<new Date(Date.parseDate(X,ZCApp.dateFormat));case"after":return new Date(Date.parseDate(S,ZCApp.dateFormat))>new Date(Date.parseDate(X,ZCApp.dateFormat));default:return false}}else{if(Q==="UnaryExpression"){return !_evaluateCriteira(a.argument)}else{if(Q==="Identifier"){var W=_getTreeValue(a);if(typeof (W)==="string"){W=W==="true"}return W}else{if(Q==="Literal"){return a.value}}}}}}};return _evaluateCriteira(J)};this._event=function(J){var K=this;return function(X){K.valuesCache[J]=undefined;for(W in K._getEffectFields(J)){var P=K._getEffectFields(J)[W];if(K._getFieldCriteria(P).hide.criteria!==undefined||K._getFieldCriteria(P).show.criteria!==undefined){var Q=undefined;var d=undefined;if(K._getFieldCriteria(P).hide.criteria!==undefined){Q=K._evaluteCondition(K._getFieldCriteria(P).hide.criteria)}if(K._getFieldCriteria(P).show.criteria!==undefined){d=K._evaluteCondition(K._getFieldCriteria(P).show.criteria)}Q=Q===undefined?true:Q;d=d===undefined?false:d;var Y=!Q&&d?true:(Q&&!d?false:K._getFieldStatus(P).visible);ZCForm.showHideField(Y,B.formLinkName,P,B.formAccessType)}if(K._getFieldCriteria(P).disable.criteria!==undefined||K._getFieldCriteria(P).enable.criteria!==undefined){var a,O;if(K._getFieldCriteria(P).disable.criteria!==undefined){a=K._evaluteCondition(K._getFieldCriteria(P).disable.criteria)}if(K._getFieldCriteria(P).enable.criteria!==undefined){O=K._evaluteCondition(K._getFieldCriteria(P).enable.criteria)}a=a===undefined?true:a;O=O===undefined?false:O;var Y=a&&!O?true:(!a&&O?false:K._getFieldStatus(P).accessible);ZCForm.enDisableField(Y,B.formLinkName,P,B.formAccessType)}if($("body").find("div[name="+P+"]").attr("elname")==="subformdiv"){if(K._getFieldCriteria(P).hidesubformaddentry.criteria!==undefined||K._getFieldCriteria(P).showsubformaddentry.criteria!==undefined){var T,M;if(K._getFieldCriteria(P).hidesubformaddentry.criteria!==undefined){T=K._evaluteCondition(K._getFieldCriteria(P).hidesubformaddentry.criteria)}if(K._getFieldCriteria(P).showsubformaddentry.criteria!==undefined){M=K._evaluteCondition(K._getFieldCriteria(P).showsubformaddentry.criteria)}T=T===undefined?true:T;M=M===undefined?false:M;var Y=T&&!M?true:(!T&&M?false:(!T&&!M?false:ZCForm.addButtonStatus(P)));ZCForm.hideShowAddEntry(Y,B.formLinkName,P,B.formAccessType)}if(K._getFieldCriteria(P).hidesubformdeleteentry.criteria!==undefined||K._getFieldCriteria(P).showsubformdeleteentry.criteria!==undefined){var L,R;if(K._getFieldCriteria(P).hidesubformdeleteentry.criteria!==undefined){R=K._evaluteCondition(K._getFieldCriteria(P).hidesubformdeleteentry.criteria)}if(K._getFieldCriteria(P).showsubformdeleteentry.criteria!==undefined){L=K._evaluteCondition(K._getFieldCriteria(P).showsubformdeleteentry.criteria)}R=R===undefined?true:R;L=L===undefined?false:L;var Y=R&&!L?true:(!R&&L?false:(!R&&!L?false:ZCForm.deleteButtonStatus(P)));ZCForm.hideShowDeleteEntry(Y,B.formLinkName,P,B.formAccessType)}}if(K._getFieldCriteria(P).setfieldvalue.criteria!==undefined){var N=K._getFieldCriteria(P).setfieldvalue.criteria.length;var c=K._getFieldCriteria(P).setfieldvalue.criteria;var Z=true,U=false;var b=0,V=-1;for(var W=0;W<N;W++){if(c[W].criteria==="true"){b++;V=W;continue}var S=c[W].criteria;if(K._evaluteCondition(S)){if(!K._getFieldCriteria(P).setfieldvalue.set){K._getFieldCriteria(P).setfieldvalue.prevalue=_getZCFieldValue(P)}else{if(K._getFieldCriteria(P).setfieldvalue.set&&Z===false){K._setFormFieldValue(P,K._getFieldCriteria(P).setfieldvalue.prevalue);K._getFieldCriteria(P).setfieldvalue.set=false;break}if(_getZCFieldValue(P)!==K._getFieldCriteria(P).setfieldvalue.value[K._getFieldCriteria(P).setfieldvalue.correctCrit].value){K._getFieldCriteria(P).setfieldvalue.prevalue=_getZCFieldValue(P)}}K._setFormFieldValue(P,K._getFieldCriteria(P).setfieldvalue.value[W].value);K._getFieldCriteria(P).setfieldvalue.set=true;K._getFieldCriteria(P).setfieldvalue.correctCrit=W;Z=false}}if(!K._getFieldCriteria(P).setfieldvalue.set&&b===1){K._setFormFieldValue(P,K._getFieldCriteria(P).setfieldvalue.value[V].value)}if(Z&&K._getFieldCriteria(P).setfieldvalue.set){if(_getZCFieldValue(P)===K._getFieldCriteria(P).setfieldvalue.value[K._getFieldCriteria(P).setfieldvalue.correctCrit].value){K._setFormFieldValue(P,K._getFieldCriteria(P).setfieldvalue.prevalue)}K._getFieldCriteria(P).setfieldvalue.set=false;K._getFieldCriteria(P).setfieldvalue.correctCrit=-1}}}}};this._setFormFieldValue=function(K,J){delete this.valuesCache[K];ZCForm.setFieldValue(B.formLinkName,K,B.formAccessType,J,null,false,null,null,false)};if(this.isNewWfEnabled=="false"||this.isNewWfEnabled==undefined){for(r in B.rules){var H=B.rules[r];try{H.condition=decodeURIComponent(H.condition);jsep(H.condition.replace("is null",'== ""').replace("is not null",'!= ""'));for(t in H.tasks){var C=H.tasks[t];for(tf in C.taskConfig.FIELDS){var D=C.taskConfig.FIELDS[tf];if(H.conditionFields.length===0){H.conditionFields[0]="_zc_Dummy_NullCritVar"}for(cf in H.conditionFields){this._setEffectFields(H.conditionFields[cf],D)}this._setFieldCriteria(D,C.taskType,H.condition)}if(C.taskType===this.taskType.SET_FIELD_VALUE){var E=JSON.parse(JSON.stringify(C.taskConfig));for(field in E.VALUES){this._setFieldValue(field,E.VALUES[field],H.condition)}}}}catch(G){var F=window.console;F.log(G)}}}else{for(r in B.rules){var H=B.rules[r];try{for(g in H.groups){var I=H.groups[g];I.condition=decodeURIComponent(I.condition);jsep(I.condition.replace("is null",'== ""').replace("is not null",'!= ""'));for(t in I.tasks){var C=I.tasks[t];for(tf in C.taskConfig.FIELDS){var D=C.taskConfig.FIELDS[tf];if(I.conditionFields.length===0){I.conditionFields[0]="_zc_Dummy_NullCritVar"}for(cf in I.conditionFields){this._setEffectFields(I.conditionFields[cf],D)}this._setFieldCriteria(D,C.taskType,I.condition)}if(C.taskType===this.taskType.SET_FIELD_VALUE){var E=JSON.parse(JSON.stringify(C.taskConfig));for(field in E.VALUES){this._setFieldValue(field,E.VALUES[field],I.condition)}}}}}catch(G){var F=window.console;F.log(G)}}}for(conditionField in this._getEffectFields()){var A=this._event(conditionField);window.RuleEvents[B.formLinkName][conditionField]=A;A(true)}}var Handsontable={extension:{},helper:{}};(function($,window,Handsontable){Handsontable.activeGuid=null;Handsontable.Core=function(rootElement,userSettings){var priv,datamap,grid,selection,editproxy,autofill,instance=this,GridSettings=function(){};Handsontable.helper.inherit(GridSettings,DefaultSettings);Handsontable.helper.extend(GridSettings.prototype,Handsontable.TextCell);expandType(userSettings);Handsontable.helper.extend(GridSettings.prototype,userSettings);this.rootElement=rootElement;var $document=$(document.documentElement);var $body=$(document.body);this.guid="ht_"+Handsontable.helper.randomString();if(!this.rootElement[0].id){this.rootElement[0].id=this.guid}priv={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new GridSettings(),settingsFromDOM:{},selStart:new Handsontable.SelectionPoint(),selEnd:new Handsontable.SelectionPoint(),editProxy:false,isPopulated:null,scrollable:null,extensions:{},colToProp:null,propToCol:null,dataSchema:null,dataType:"array",firstRun:true};datamap={recursiveDuckSchema:function(obj){var schema;if($.isPlainObject(obj)){schema={};for(var i in obj){if(obj.hasOwnProperty(i)){if($.isPlainObject(obj[i])){schema[i]=datamap.recursiveDuckSchema(obj[i])}else{schema[i]=null}}}}else{schema=[]}return schema},recursiveDuckColumns:function(schema,lastCol,parent){var prop,i;if(typeof lastCol==="undefined"){lastCol=0;parent=""}if($.isPlainObject(schema)){for(i in schema){if(schema.hasOwnProperty(i)){if(schema[i]===null){prop=parent+i;priv.colToProp.push(prop);priv.propToCol[prop]=lastCol;lastCol++}else{lastCol=datamap.recursiveDuckColumns(schema[i],lastCol,i+".")}}}}return lastCol},createMap:function(){if(typeof datamap.getSchema()==="undefined"){throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`")}var i,ilen,schema=datamap.getSchema();priv.colToProp=[];priv.propToCol={};if(priv.settings.columns){for(i=0,ilen=priv.settings.columns.length;i<ilen;i++){priv.colToProp[i]=priv.settings.columns[i].data;priv.propToCol[priv.settings.columns[i].data]=i}}else{datamap.recursiveDuckColumns(schema)}},colToProp:function(col){col=Handsontable.PluginHooks.execute(instance,"modifyCol",col);if(priv.colToProp&&typeof priv.colToProp[col]!=="undefined"){return priv.colToProp[col]}else{return col}},propToCol:function(prop){var col;if(typeof priv.propToCol[prop]!=="undefined"){col=priv.propToCol[prop]}else{col=prop}col=Handsontable.PluginHooks.execute(instance,"modifyCol",col);return col},getSchema:function(){if(priv.settings.dataSchema){if(typeof priv.settings.dataSchema==="function"){return priv.settings.dataSchema()}return priv.settings.dataSchema}return priv.duckDataSchema},createRow:function(index,amount){var row,colCount=instance.countCols(),numberOfCreatedRows=0,currentIndex;if(!amount){amount=1}if(typeof index!=="number"||index>=instance.countRows()){index=instance.countRows()}currentIndex=index;while(numberOfCreatedRows<amount&&instance.countRows()<priv.settings.maxRows){if(priv.dataType==="array"){row=[];for(var c=0;c<colCount;c++){row.push(null)}}else{if(priv.dataType==="function"){row=priv.settings.dataSchema(index)}else{row=$.extend(true,{},datamap.getSchema())}}if(index===instance.countRows()){GridSettings.prototype.data.push(row)}else{GridSettings.prototype.data.splice(index,0,row)}numberOfCreatedRows++;currentIndex++}instance.PluginHooks.run("afterCreateRow",index,numberOfCreatedRows);instance.forceFullRender=true;return numberOfCreatedRows},createCol:function(index,amount){if(priv.dataType==="object"||priv.settings.columns){throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting")}var rlen=instance.countRows(),data=GridSettings.prototype.data,constructor,numberOfCreatedCols=0,currentIndex;if(!amount){amount=1}currentIndex=index;while(numberOfCreatedCols<amount&&instance.countCols()<priv.settings.maxCols){constructor=Handsontable.helper.columnFactory(GridSettings,priv.columnsSettingConflicts);if(typeof index!=="number"||index>=instance.countCols()){for(var r=0;r<rlen;r++){if(typeof data[r]==="undefined"){data[r]=[]}data[r].push(null)}priv.columnSettings.push(constructor)}else{for(var r=0;r<rlen;r++){data[r].splice(currentIndex,0,null)}priv.columnSettings.splice(currentIndex,0,constructor)}numberOfCreatedCols++;currentIndex++}instance.PluginHooks.run("afterCreateCol",index,numberOfCreatedCols);instance.forceFullRender=true;return numberOfCreatedCols},removeRow:function(index,amount){if(!amount){amount=1}if(typeof index!=="number"){index=-amount}index=(instance.countRows()+index)%instance.countRows();var logicRows=this.physicalRowsToLogical(index,amount);instance.PluginHooks.run("beforeRemoveRow",index,amount);var newData=GridSettings.prototype.data.filter(function(row,index){return logicRows.indexOf(index)==-1});GridSettings.prototype.data.length=0;Array.prototype.push.apply(GridSettings.prototype.data,newData);instance.PluginHooks.run("afterRemoveRow",index,amount);instance.forceFullRender=true},removeCol:function(index,amount){if(priv.dataType==="object"||priv.settings.columns){throw new Error("cannot remove column with object data source or columns option specified")}if(!amount){amount=1}if(typeof index!=="number"){index=-amount}index=(instance.countCols()+index)%instance.countCols();instance.PluginHooks.run("beforeRemoveCol",index,amount);var data=GridSettings.prototype.data;for(var r=0,rlen=instance.countRows();r<rlen;r++){data[r].splice(index,amount)}priv.columnSettings.splice(index,amount);instance.PluginHooks.run("afterRemoveCol",index,amount);instance.forceFullRender=true},spliceCol:function(col,index,amount){var elements=4<=arguments.length?[].slice.call(arguments,3):[];var colData=instance.getDataAtCol(col);var removed=colData.slice(index,index+amount);var after=colData.slice(index+amount);Handsontable.helper.extendArray(elements,after);var i=0;while(i<amount){elements.push(null);i++}Handsontable.helper.to2dArray(elements);instance.populateFromArray(index,col,elements,null,null,"spliceCol");return removed},spliceRow:function(row,index,amount){var elements=4<=arguments.length?[].slice.call(arguments,3):[];var rowData=instance.getDataAtRow(row);var removed=rowData.slice(index,index+amount);var after=rowData.slice(index+amount);Handsontable.helper.extendArray(elements,after);var i=0;while(i<amount){elements.push(null);i++}instance.populateFromArray(row,index,[elements],null,null,"spliceRow");return removed},getVars:{},get:function(row,prop){datamap.getVars.row=row;datamap.getVars.prop=prop;instance.PluginHooks.run("beforeGet",datamap.getVars);if(typeof datamap.getVars.prop==="string"&&datamap.getVars.prop.indexOf(".")>-1){var sliced=datamap.getVars.prop.split(".");var out=priv.settings.data[datamap.getVars.row];if(!out){return null}for(var i=0,ilen=sliced.length;i<ilen;i++){out=out[sliced[i]];if(typeof out==="undefined"){return null}}return out}else{if(typeof datamap.getVars.prop==="function"){return datamap.getVars.prop(priv.settings.data.slice(datamap.getVars.row,datamap.getVars.row+1)[0])}else{return priv.settings.data[datamap.getVars.row]?priv.settings.data[datamap.getVars.row][datamap.getVars.prop]:null}}},setVars:{},set:function(row,prop,value,source){datamap.setVars.row=row;datamap.setVars.prop=prop;datamap.setVars.value=value;instance.PluginHooks.run("beforeSet",datamap.setVars,source||"datamapGet");if(typeof datamap.setVars.prop==="string"&&datamap.setVars.prop.indexOf(".")>-1){var sliced=datamap.setVars.prop.split(".");var out=priv.settings.data[datamap.setVars.row];for(var i=0,ilen=sliced.length-1;i<ilen;i++){out=out[sliced[i]]}out[sliced[i]]=datamap.setVars.value}else{if(typeof datamap.setVars.prop==="function"){datamap.setVars.prop(priv.settings.data.slice(datamap.setVars.row,datamap.setVars.row+1)[0],datamap.setVars.value)}else{priv.settings.data[datamap.setVars.row][datamap.setVars.prop]=datamap.setVars.value}}},physicalRowsToLogical:function(index,amount){var physicRow=(GridSettings.prototype.data.length+index)%GridSettings.prototype.data.length;var logicRows=[];var rowsToRemove=amount;while(physicRow<GridSettings.prototype.data.length&&rowsToRemove){this.get(physicRow,0);logicRows.push(this.getVars.row);rowsToRemove--;physicRow++}return logicRows},clear:function(){for(var r=0;r<instance.countRows();r++){for(var c=0;c<instance.countCols();c++){datamap.set(r,datamap.colToProp(c),"")}}},getAll:function(){return priv.settings.data},getRange:function(start,end){var r,rlen,c,clen,output=[],row;rlen=Math.max(start.row,end.row);clen=Math.max(start.col,end.col);for(r=Math.min(start.row,end.row);r<=rlen;r++){row=[];for(c=Math.min(start.col,end.col);c<=clen;c++){row.push(datamap.get(r,datamap.colToProp(c)))}output.push(row)}return output},getText:function(start,end){return SheetClip.stringify(datamap.getRange(start,end))}};grid={alter:function(action,index,amount,source,keepEmptyRows){var oldData,newData,changes,r,rlen,c,clen,delta;oldData=$.extend(true,[],datamap.getAll());amount=amount||1;switch(action){case"insert_row":delta=datamap.createRow(index,amount);if(delta){if(priv.selStart.exists()&&priv.selStart.row()>=index){priv.selStart.row(priv.selStart.row()+delta);selection.transformEnd(delta,0)}else{selection.refreshBorders()}}break;case"insert_col":delta=datamap.createCol(index,amount);if(delta){if(Handsontable.helper.isArray(instance.getSettings().colHeaders)){var spliceArray=[index,0];spliceArray.length+=delta;Array.prototype.splice.apply(instance.getSettings().colHeaders,spliceArray)}if(priv.selStart.exists()&&priv.selStart.col()>=index){priv.selStart.col(priv.selStart.col()+delta);selection.transformEnd(0,delta)}else{selection.refreshBorders()}}break;case"remove_row":datamap.removeRow(index,amount);priv.cellSettings.splice(index,amount);grid.adjustRowsAndCols();selection.refreshBorders();break;case"remove_col":datamap.removeCol(index,amount);for(var row=0,len=datamap.getAll().length;row<len;row++){if(row in priv.cellSettings){priv.cellSettings[row].splice(index,amount)}}if(Handsontable.helper.isArray(instance.getSettings().colHeaders)){if(typeof index=="undefined"){index=-1}instance.getSettings().colHeaders.splice(index,amount)}priv.columnSettings.splice(index,amount);grid.adjustRowsAndCols();selection.refreshBorders();break;default:throw new Error('There is no such action "'+action+'"');break}if(!keepEmptyRows){grid.adjustRowsAndCols()}},adjustRowsAndCols:function(){var r,rlen,emptyRows=instance.countEmptyRows(true),emptyCols;rlen=instance.countRows();if(rlen<priv.settings.minRows){for(r=0;r<priv.settings.minRows-rlen;r++){datamap.createRow()}}if(emptyRows<priv.settings.minSpareRows){for(;emptyRows<priv.settings.minSpareRows&&instance.countRows()<priv.settings.maxRows;emptyRows++){datamap.createRow()}}emptyCols=instance.countEmptyCols(true);if(!priv.settings.columns&&instance.countCols()<priv.settings.minCols){for(;instance.countCols()<priv.settings.minCols;emptyCols++){datamap.createCol()}}if(!priv.settings.columns&&priv.dataType==="array"&&emptyCols<priv.settings.minSpareCols){for(;emptyCols<priv.settings.minSpareCols&&instance.countCols()<priv.settings.maxCols;emptyCols++){datamap.createCol()}}if(priv.settings.enterBeginsEditing){for(;(((priv.settings.minRows||priv.settings.minSpareRows)&&instance.countRows()>priv.settings.minRows)&&(priv.settings.minSpareRows&&emptyRows>priv.settings.minSpareRows));emptyRows--){datamap.removeRow()}}if(priv.settings.enterBeginsEditing&&!priv.settings.columns){for(;(((priv.settings.minCols||priv.settings.minSpareCols)&&instance.countCols()>priv.settings.minCols)&&(priv.settings.minSpareCols&&emptyCols>priv.settings.minSpareCols));emptyCols--){datamap.removeCol()}}var rowCount=instance.countRows();var colCount=instance.countCols();if(rowCount===0||colCount===0){selection.deselect()}if(priv.selStart.exists()){var selectionChanged;var fromRow=priv.selStart.row();var fromCol=priv.selStart.col();var toRow=priv.selEnd.row();var toCol=priv.selEnd.col();if(fromRow>rowCount-1){fromRow=rowCount-1;selectionChanged=true;if(toRow>fromRow){toRow=fromRow}}else{if(toRow>rowCount-1){toRow=rowCount-1;selectionChanged=true;if(fromRow>toRow){fromRow=toRow}}}if(fromCol>colCount-1){fromCol=colCount-1;selectionChanged=true;if(toCol>fromCol){toCol=fromCol}}else{if(toCol>colCount-1){toCol=colCount-1;selectionChanged=true;if(fromCol>toCol){fromCol=toCol}}}if(selectionChanged){instance.selectCell(fromRow,fromCol,toRow,toCol)}}},populateFromArray:function(start,input,end,source,method){var r,rlen,c,clen,setData=[],current={};rlen=input.length;if(rlen===0){return false}var repeatCol,repeatRow,cmax,rmax;switch(method){case"shift_down":repeatCol=end?end.col-start.col+1:0;repeatRow=end?end.row-start.row+1:0;input=Handsontable.helper.translateRowsToColumns(input);for(c=0,clen=input.length,cmax=Math.max(clen,repeatCol);c<cmax;c++){if(c<clen){for(r=0,rlen=input[c].length;r<repeatRow-rlen;r++){input[c].push(input[c][r%rlen])}input[c].unshift(start.col+c,start.row,0);instance.spliceCol.apply(instance,input[c])}else{input[c%clen][0]=start.col+c;instance.spliceCol.apply(instance,input[c%clen])}}break;case"shift_right":repeatCol=end?end.col-start.col+1:0;repeatRow=end?end.row-start.row+1:0;for(r=0,rlen=input.length,rmax=Math.max(rlen,repeatRow);r<rmax;r++){if(r<rlen){for(c=0,clen=input[r].length;c<repeatCol-clen;c++){input[r].push(input[r][c%clen])}input[r].unshift(start.row+r,start.col,0);instance.spliceRow.apply(instance,input[r])}else{input[r%rlen][0]=start.row+r;instance.spliceRow.apply(instance,input[r%rlen])}}break;case"overwrite":default:current.row=start.row;current.col=start.col;for(r=0;r<rlen;r++){if((end&&current.row>end.row)||(!priv.settings.minSpareRows&&current.row>instance.countRows()-1)||(current.row>=priv.settings.maxRows)){break}current.col=start.col;clen=input[r]?input[r].length:0;for(c=0;c<clen;c++){if((end&&current.col>end.col)||(!priv.settings.minSpareCols&&current.col>instance.countCols()-1)||(current.col>=priv.settings.maxCols)){break}if(!instance.getCellMeta(current.row,current.col).readOnly){setData.push([current.row,current.col,input[r][c]])}current.col++;if(end&&c===clen-1){c=-1}}current.row++;if(end&&r===rlen-1){r=-1}}instance.setDataAtCell(setData,null,null,source||"populateFromArray");break}},getCornerCoords:function(coordsArr){function mapProp(func,array,prop){function getProp(el){return el[prop]}if(Array.prototype.map){return func.apply(Math,array.map(getProp))}return func.apply(Math,$.map(array,getProp))}return{TL:{row:mapProp(Math.min,coordsArr,"row"),col:mapProp(Math.min,coordsArr,"col")},BR:{row:mapProp(Math.max,coordsArr,"row"),col:mapProp(Math.max,coordsArr,"col")}}},getCellsAtCoords:function(start,end){var corners=grid.getCornerCoords([start,end]);var r,c,output=[];for(r=corners.TL.row;r<=corners.BR.row;r++){for(c=corners.TL.col;c<=corners.BR.col;c++){output.push(instance.view.getCellAtCoords({row:r,col:c}))}}return output}};this.selection=selection={inProgress:false,begin:function(){instance.selection.inProgress=true},finish:function(){var sel=instance.getSelected();instance.PluginHooks.run("afterSelectionEnd",sel[0],sel[1],sel[2],sel[3]);instance.PluginHooks.run("afterSelectionEndByProp",sel[0],instance.colToProp(sel[1]),sel[2],instance.colToProp(sel[3]));instance.selection.inProgress=false},isInProgress:function(){return instance.selection.inProgress},setRangeStart:function(coords){priv.selStart.coords(coords);selection.setRangeEnd(coords)},setRangeEnd:function(coords,scrollToCell){instance.selection.begin();priv.selEnd.coords(coords);if(!priv.settings.multiSelect){priv.selStart.coords(coords)}instance.view.wt.selections.current.clear();instance.view.wt.selections.current.add(priv.selStart.arr());instance.view.wt.selections.area.clear();if(selection.isMultiple()){instance.view.wt.selections.area.add(priv.selStart.arr());instance.view.wt.selections.area.add(priv.selEnd.arr())}if(priv.settings.currentRowClassName||priv.settings.currentColClassName){instance.view.wt.selections.highlight.clear();instance.view.wt.selections.highlight.add(priv.selStart.arr());instance.view.wt.selections.highlight.add(priv.selEnd.arr())}instance.PluginHooks.run("afterSelection",priv.selStart.row(),priv.selStart.col(),priv.selEnd.row(),priv.selEnd.col());instance.PluginHooks.run("afterSelectionByProp",priv.selStart.row(),datamap.colToProp(priv.selStart.col()),priv.selEnd.row(),datamap.colToProp(priv.selEnd.col()));if(scrollToCell!==false){instance.view.scrollViewport(coords)}selection.refreshBorders()},refreshBorders:function(revertOriginal,keepEditor){if(!keepEditor){editproxy.destroy(revertOriginal)}instance.view.render();if(selection.isSelected()&&!keepEditor){editproxy.prepare()}},isMultiple:function(){return !(priv.selEnd.col()===priv.selStart.col()&&priv.selEnd.row()===priv.selStart.row())},transformStart:function(rowDelta,colDelta,force){if(priv.selStart.row()+rowDelta>instance.countRows()-1){if(force&&priv.settings.minSpareRows>0){instance.alter("insert_row",instance.countRows())}else{if(priv.settings.autoWrapCol){rowDelta=1-instance.countRows();colDelta=priv.selStart.col()+colDelta==instance.countCols()-1?1-instance.countCols():1}}}else{if(priv.settings.autoWrapCol&&priv.selStart.row()+rowDelta<0&&priv.selStart.col()+colDelta>=0){rowDelta=instance.countRows()-1;colDelta=priv.selStart.col()+colDelta==0?instance.countCols()-1:-1}}if(priv.selStart.col()+colDelta>instance.countCols()-1){if(force&&priv.settings.minSpareCols>0){instance.alter("insert_col",instance.countCols())}else{if(priv.settings.autoWrapRow){rowDelta=priv.selStart.row()+rowDelta==instance.countRows()-1?1-instance.countRows():1;colDelta=1-instance.countCols()}}}else{if(priv.settings.autoWrapRow&&priv.selStart.col()+colDelta<0&&priv.selStart.row()+rowDelta>=0){rowDelta=priv.selStart.row()+rowDelta==0?instance.countRows()-1:-1;colDelta=instance.countCols()-1}}var totalRows=instance.countRows();var totalCols=instance.countCols();var coords={row:priv.selStart.row()+rowDelta,col:priv.selStart.col()+colDelta};if(coords.row<0){coords.row=0}else{if(coords.row>0&&coords.row>=totalRows){coords.row=totalRows-1}}if(coords.col<0){coords.col=0}else{if(coords.col>0&&coords.col>=totalCols){coords.col=totalCols-1}}selection.setRangeStart(coords)},transformEnd:function(rowDelta,colDelta){if(priv.selEnd.exists()){var totalRows=instance.countRows();var totalCols=instance.countCols();var coords={row:priv.selEnd.row()+rowDelta,col:priv.selEnd.col()+colDelta};if(coords.row<0){coords.row=0}else{if(coords.row>0&&coords.row>=totalRows){coords.row=totalRows-1}}if(coords.col<0){coords.col=0}else{if(coords.col>0&&coords.col>=totalCols){coords.col=totalCols-1}}selection.setRangeEnd(coords)}},isSelected:function(){return priv.selEnd.exists()},inInSelection:function(coords){if(!selection.isSelected()){return false}var sel=grid.getCornerCoords([priv.selStart.coords(),priv.selEnd.coords()]);return(sel.TL.row<=coords.row&&sel.BR.row>=coords.row&&sel.TL.col<=coords.col&&sel.BR.col>=coords.col)},deselect:function(){if(!selection.isSelected()){return }instance.selection.inProgress=false;priv.selEnd=new Handsontable.SelectionPoint();instance.view.wt.selections.current.clear();instance.view.wt.selections.area.clear();editproxy.destroy();selection.refreshBorders();instance.PluginHooks.run("afterDeselect")},selectAll:function(){if(!priv.settings.multiSelect){return }selection.setRangeStart({row:0,col:0});selection.setRangeEnd({row:instance.countRows()-1,col:instance.countCols()-1},false)},empty:function(){if(!selection.isSelected()){return }var corners=grid.getCornerCoords([priv.selStart.coords(),priv.selEnd.coords()]);var r,c,changes=[];for(r=corners.TL.row;r<=corners.BR.row;r++){for(c=corners.TL.col;c<=corners.BR.col;c++){if(!instance.getCellMeta(r,c).readOnly){changes.push([r,c,""])}}}instance.setDataAtCell(changes)}};this.autofill=autofill={handle:null,init:function(){if(!autofill.handle){autofill.handle={}}else{autofill.handle.disabled=false}},disable:function(){autofill.handle.disabled=true},selectAdjacent:function(){var select,data,r,maxR,c;if(selection.isMultiple()){select=instance.view.wt.selections.area.getCorners()}else{select=instance.view.wt.selections.current.getCorners()}data=datamap.getAll();rows:for(r=select[2]+1;r<instance.countRows();r++){for(c=select[1];c<=select[3];c++){if(data[r][c]){break rows}}if(!!data[r][select[1]-1]||!!data[r][select[3]+1]){maxR=r}}if(maxR){instance.view.wt.selections.fill.clear();instance.view.wt.selections.fill.add([select[0],select[1]]);instance.view.wt.selections.fill.add([maxR,select[3]]);autofill.apply()}},apply:function(){var drag,select,start,end,_data;autofill.handle.isDragged=0;drag=instance.view.wt.selections.fill.getCorners();if(!drag){return }instance.view.wt.selections.fill.clear();if(selection.isMultiple()){select=instance.view.wt.selections.area.getCorners()}else{select=instance.view.wt.selections.current.getCorners()}if(drag[0]===select[0]&&drag[1]<select[1]){start={row:drag[0],col:drag[1]};end={row:drag[2],col:select[1]-1}}else{if(drag[0]===select[0]&&drag[3]>select[3]){start={row:drag[0],col:select[3]+1};end={row:drag[2],col:drag[3]}}else{if(drag[0]<select[0]&&drag[1]===select[1]){start={row:drag[0],col:drag[1]};end={row:select[0]-1,col:drag[3]}}else{if(drag[2]>select[2]&&drag[1]===select[1]){start={row:select[2]+1,col:drag[1]};end={row:drag[2],col:drag[3]}}}}}if(start){_data=SheetClip.parse(datamap.getText(priv.selStart.coords(),priv.selEnd.coords()));instance.PluginHooks.run("beforeAutofill",start,end,_data);grid.populateFromArray(start,_data,end,"autofill");selection.setRangeStart({row:drag[0],col:drag[1]});selection.setRangeEnd({row:drag[2],col:drag[3]})}},showBorder:function(coords){coords.row=coords[0];coords.col=coords[1];var corners=grid.getCornerCoords([priv.selStart.coords(),priv.selEnd.coords()]);if(priv.settings.fillHandle!=="horizontal"&&(corners.BR.row<coords.row||corners.TL.row>coords.row)){coords=[coords.row,corners.BR.col]}else{if(priv.settings.fillHandle!=="vertical"){coords=[corners.BR.row,coords.col]}else{return }}instance.view.wt.selections.fill.clear();instance.view.wt.selections.fill.add([priv.selStart.coords().row,priv.selStart.coords().col]);instance.view.wt.selections.fill.add([priv.selEnd.coords().row,priv.selEnd.coords().col]);instance.view.wt.selections.fill.add(coords);instance.view.render()}};editproxy={init:function(){priv.onCut=function onCut(){if(!instance.isListening()){return }selection.empty()};priv.onPaste=function onPaste(str){if(!instance.isListening()||!selection.isSelected()){return }var input=str.replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),inputArray=SheetClip.parse(input),coords=grid.getCornerCoords([priv.selStart.coords(),priv.selEnd.coords()]),areaStart=coords.TL,areaEnd={row:Math.max(coords.BR.row,inputArray.length-1+coords.TL.row),col:Math.max(coords.BR.col,inputArray[0].length-1+coords.TL.col)};instance.PluginHooks.once("afterChange",function(changes,source){if(changes&&changes.length){instance.selectCell(areaStart.row,areaStart.col,areaEnd.row,areaEnd.col)}});grid.populateFromArray(areaStart,inputArray,areaEnd,"paste",priv.settings.pasteMode)};function onKeyDown(event){if(!instance.isListening()){return }if(priv.settings.beforeOnKeyDown){priv.settings.beforeOnKeyDown.call(instance,event)}if(Array.prototype.filter.call(document.body.querySelectorAll(".context-menu-list"),instance.view.wt.wtDom.isVisible).length){return }if(event.keyCode===17||event.keyCode===224||event.keyCode===91||event.keyCode===93){editproxy.setCopyableText();return }priv.lastKeyCode=event.keyCode;if(selection.isSelected()){var ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;if(Handsontable.helper.isPrintableChar(event.keyCode)&&ctrlDown){if(event.keyCode===65){selection.selectAll();editproxy.setCopyableText();event.preventDefault();event.stopImmediatePropagation()}}var rangeModifier=event.shiftKey?selection.setRangeEnd:selection.setRangeStart;instance.PluginHooks.run("beforeKeyDown",event);if(!event.isImmediatePropagationStopped()){switch(event.keyCode){case 38:if(event.shiftKey){selection.transformEnd(-1,0)}else{selection.transformStart(-1,0)}event.preventDefault();event.stopPropagation();break;case 9:var tabMoves=typeof priv.settings.tabMoves==="function"?priv.settings.tabMoves(event):priv.settings.tabMoves;if(event.shiftKey){selection.transformStart(-tabMoves.row,-tabMoves.col)}else{selection.transformStart(tabMoves.row,tabMoves.col,true)}event.preventDefault();event.stopPropagation();break;case 39:if(event.shiftKey){selection.transformEnd(0,1)}else{selection.transformStart(0,1)}event.preventDefault();event.stopPropagation();break;case 37:if(event.shiftKey){selection.transformEnd(0,-1)}else{selection.transformStart(0,-1)}event.preventDefault();event.stopPropagation();break;case 8:case 46:selection.empty(event);event.preventDefault();break;case 40:if(event.shiftKey){selection.transformEnd(1,0)}else{selection.transformStart(1,0)}event.preventDefault();event.stopPropagation();break;case 113:event.preventDefault();break;case 13:var enterMoves=typeof priv.settings.enterMoves==="function"?priv.settings.enterMoves(event):priv.settings.enterMoves;if(event.shiftKey){selection.transformStart(-enterMoves.row,-enterMoves.col)}else{selection.transformStart(enterMoves.row,enterMoves.col,true)}event.preventDefault();break;case 36:if(event.ctrlKey||event.metaKey){rangeModifier({row:0,col:priv.selStart.col()})}else{rangeModifier({row:priv.selStart.row(),col:0})}event.preventDefault();event.stopPropagation();break;case 35:if(event.ctrlKey||event.metaKey){rangeModifier({row:instance.countRows()-1,col:priv.selStart.col()})}else{rangeModifier({row:priv.selStart.row(),col:instance.countCols()-1})}event.preventDefault();event.stopPropagation();break;case 33:selection.transformStart(-instance.countVisibleRows(),0);instance.view.wt.scrollVertical(-instance.countVisibleRows());instance.view.render();event.preventDefault();event.stopPropagation();break;case 34:selection.transformStart(instance.countVisibleRows(),0);instance.view.wt.scrollVertical(instance.countVisibleRows());instance.view.render();event.preventDefault();event.stopPropagation();break;default:break}}}}instance.copyPaste=CopyPaste.getInstance();instance.copyPaste.onCut(priv.onCut);instance.copyPaste.onPaste(priv.onPaste);$document.on("keydown.handsontable."+instance.guid,onKeyDown)},destroy:function(revertOriginal){if(typeof priv.editorDestroyer==="function"){var destroyer=priv.editorDestroyer;priv.editorDestroyer=null;destroyer(revertOriginal)}},setCopyableText:function(){var startRow=Math.min(priv.selStart.row(),priv.selEnd.row());var startCol=Math.min(priv.selStart.col(),priv.selEnd.col());var endRow=Math.max(priv.selStart.row(),priv.selEnd.row());var endCol=Math.max(priv.selStart.col(),priv.selEnd.col());var finalEndRow=Math.min(endRow,startRow+priv.settings.copyRowsLimit-1);var finalEndCol=Math.min(endCol,startCol+priv.settings.copyColsLimit-1);instance.copyPaste.copyable(datamap.getText({row:startRow,col:startCol},{row:finalEndRow,col:finalEndCol}));if(endRow!==finalEndRow||endCol!==finalEndCol){instance.PluginHooks.run("afterCopyLimit",endRow-startRow+1,endCol-startCol+1,priv.settings.copyRowsLimit,priv.settings.copyColsLimit)}},prepare:function(){if(instance.getCellMeta(priv.selStart.row(),priv.selStart.col()).readOnly){return }var TD=instance.view.getCellAtCoords(priv.selStart.coords());priv.editorDestroyer=instance.view.applyCellTypeMethod("editor",TD,priv.selStart.row(),priv.selStart.col())}};this.init=function(){instance.PluginHooks.run("beforeInit");editproxy.init();this.updateSettings(priv.settings,true);this.parseSettingsFromDOM();this.view=new Handsontable.TableView(this);this.forceFullRender=true;this.view.render();if(typeof priv.firstRun==="object"){instance.PluginHooks.run("afterChange",priv.firstRun[0],priv.firstRun[1]);priv.firstRun=false}instance.PluginHooks.run("afterInit")};function ValidatorsQueue(){var resolved=false;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++;resolved=false},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1;this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){if(this.validatorsInQueue==0&&resolved==false){resolved=true;this.onQueueEmpty()}}}}function validateChanges(changes,source,callback){var waitingForValidator=new ValidatorsQueue();waitingForValidator.onQueueEmpty=resolve;for(var i=changes.length-1;i>=0;i--){if(changes[i]===null){changes.splice(i,1)}else{var col=datamap.propToCol(changes[i][1]);var logicalCol=instance.runHooksAndReturn("modifyCol",col);var cellProperties=instance.getCellMeta(changes[i][0],logicalCol);if(cellProperties.dataType==="number"&&typeof changes[i][3]==="string"){if(changes[i][3].length>0&&/^-?[\d\s]*\.?\d*$/.test(changes[i][3])){changes[i][3]=numeral().unformat(changes[i][3]||"0")}}if(cellProperties.validator){waitingForValidator.addValidatorToQueue();instance.validateCell(changes[i][3],cellProperties,(function(i,cellProperties){return function(result){if(typeof result!=="boolean"){throw new Error("Validation error: result is not boolean")}if(result===false&&cellProperties.allowInvalid===false){changes.splice(i,1);--i}waitingForValidator.removeValidatorFormQueue()}})(i,cellProperties),source)}}}waitingForValidator.checkIfQueueIsEmpty();function resolve(){var beforeChangeResult;if(changes.length){beforeChangeResult=instance.PluginHooks.execute("beforeChange",changes,source);if(typeof beforeChangeResult==="function"){$.when(result).then(function(){callback()})}else{if(beforeChangeResult===false){changes.splice(0,changes.length)}}}if(typeof beforeChangeResult!=="function"){callback()}}}function applyChanges(changes,source){var i=changes.length-1;if(i<0){return }for(;0<=i;i--){if(changes[i]===null){changes.splice(i,1);continue}if(priv.settings.minSpareRows){while(changes[i][0]>instance.countRows()-1){datamap.createRow()}}if(priv.dataType==="array"&&priv.settings.minSpareCols){while(datamap.propToCol(changes[i][1])>instance.countCols()-1){datamap.createCol()}}datamap.set(changes[i][0],changes[i][1],changes[i][3])}instance.forceFullRender=true;grid.adjustRowsAndCols();selection.refreshBorders(null,true);instance.PluginHooks.run("afterChange",changes,source||"edit")}this.validateCell=function(value,cellProperties,callback,source){var validator=cellProperties.validator;if(Object.prototype.toString.call(validator)==="[object RegExp]"){validator=(function(validator){return function(value,callback){callback(validator.test(value))}})(validator)}if(typeof validator==="function"){value=instance.PluginHooks.execute("beforeValidate",value,cellProperties.row,cellProperties.prop,source);validator.call(cellProperties,value,function(valid){cellProperties.valid=valid;valid=instance.PluginHooks.execute("afterValidate",valid,value,cellProperties.row,cellProperties.prop,source);callback(valid)})}else{cellProperties.valid=true;callback(true)}};function setDataInputToArray(row,prop_or_col,value){if(typeof row==="object"){return row}else{if($.isPlainObject(value)){return value}else{return[[row,prop_or_col,value]]}}}this.setDataAtCell=function(row,col,value,source){var input=setDataInputToArray(row,col,value),i,ilen,changes=[],prop;for(i=0,ilen=input.length;i<ilen;i++){if(typeof input[i]!=="object"){throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter")}if(typeof input[i][1]!=="number"){throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`")}prop=datamap.colToProp(input[i][1]);changes.push([input[i][0],prop,datamap.get(input[i][0],prop),input[i][2]])}if(!source&&typeof row==="object"){source=col}validateChanges(changes,source,function(){applyChanges(changes,source)})};this.setDataAtRowProp=function(row,prop,value,source){var input=setDataInputToArray(row,prop,value),i,ilen,changes=[];for(i=0,ilen=input.length;i<ilen;i++){changes.push([input[i][0],input[i][1],datamap.get(input[i][0],input[i][1]),input[i][2]])}if(!source&&typeof row==="object"){source=prop}validateChanges(changes,source,function(){applyChanges(changes,source)})};this.listen=function(){Handsontable.activeGuid=instance.guid;if(document.activeElement&&document.activeElement!==document.body){document.activeElement.blur()}else{if(!document.activeElement){document.body.focus()}}};this.unlisten=function(){Handsontable.activeGuid=null};this.isListening=function(){return Handsontable.activeGuid===instance.guid};this.destroyEditor=function(revertOriginal){selection.refreshBorders(revertOriginal)};this.populateFromArray=function(row,col,input,endRow,endCol,source,method){if(typeof input!=="object"){throw new Error("populateFromArray parameter `input` must be an array")}return grid.populateFromArray({row:row,col:col},input,typeof endRow==="number"?{row:endRow,col:endCol}:null,source,method)};this.spliceCol=function(col,index,amount){return datamap.spliceCol.apply(null,arguments)};this.spliceRow=function(row,index,amount){return datamap.spliceRow.apply(null,arguments)};this.getCornerCoords=function(coordsArr){return grid.getCornerCoords(coordsArr)};this.getSelected=function(){if(selection.isSelected()){return[priv.selStart.row(),priv.selStart.col(),priv.selEnd.row(),priv.selEnd.col()]}};this.parseSettingsFromDOM=function(){var overflow=this.rootElement.css("overflow");if(overflow==="scroll"||overflow==="auto"){this.rootElement[0].style.overflow="visible";priv.settingsFromDOM.overflow=overflow}else{if(priv.settings.width===void 0||priv.settings.height===void 0){priv.settingsFromDOM.overflow="auto"}}if(priv.settings.width===void 0){priv.settingsFromDOM.width=this.rootElement.width()}else{priv.settingsFromDOM.width=void 0}priv.settingsFromDOM.height=void 0;if(priv.settings.height===void 0){if(priv.settingsFromDOM.overflow==="scroll"||priv.settingsFromDOM.overflow==="auto"){var clone=this.rootElement[0].cloneNode(false);var parent=this.rootElement[0].parentNode;if(parent){clone.removeAttribute("id");parent.appendChild(clone);var computedHeight=parseInt(window.getComputedStyle(clone,null).getPropertyValue("height"),10);if(isNaN(computedHeight)&&clone.currentStyle){computedHeight=parseInt(clone.currentStyle.height,10)}if(computedHeight>0){priv.settingsFromDOM.height=computedHeight}parent.removeChild(clone)}}}};this.render=function(){if(instance.view){instance.forceFullRender=true;instance.parseSettingsFromDOM();selection.refreshBorders(null,true)}};this.loadData=function(data){if(!(data.push&&data.splice)){throw new Error("loadData only accepts array of objects or array of arrays ("+typeof data+" given)")}priv.isPopulated=false;GridSettings.prototype.data=data;if(priv.settings.dataSchema instanceof Array||data[0] instanceof Array){priv.dataType="array"}else{if($.isFunction(priv.settings.dataSchema)){priv.dataType="function"}else{priv.dataType="object"}}if(data[0]){priv.duckDataSchema=datamap.recursiveDuckSchema(data[0])}else{priv.duckDataSchema={}}datamap.createMap();grid.adjustRowsAndCols();instance.PluginHooks.run("afterLoadData");if(priv.firstRun){priv.firstRun=[null,"loadData"]}else{instance.PluginHooks.run("afterChange",null,"loadData");instance.render()}priv.isPopulated=true};this.getData=function(r,c,r2,c2){if(typeof r==="undefined"){return datamap.getAll()}else{return datamap.getRange({row:r,col:c},{row:r2,col:c2})}};this.updateSettings=function(settings,init){var i,r,rlen,c,clen;if(typeof settings.rows!=="undefined"){throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?")}if(typeof settings.cols!=="undefined"){throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?")}for(i in settings){if(i==="data"){continue}else{if(instance.PluginHooks.hooks.persistent[i]!==void 0||instance.PluginHooks.legacy[i]!==void 0){instance.PluginHooks.add(i,settings[i])}else{if(!init&&settings.hasOwnProperty(i)){GridSettings.prototype[i]=settings[i]}if(Handsontable.extension[i]){priv.extensions[i]=new Handsontable.extension[i](instance,settings[i])}}}}if(settings.data===void 0&&priv.settings.data===void 0){var data=[];var row;for(r=0,rlen=priv.settings.startRows;r<rlen;r++){row=[];for(c=0,clen=priv.settings.startCols;c<clen;c++){row.push(null)}data.push(row)}instance.loadData(data)}else{if(settings.data!==void 0){instance.loadData(settings.data)}else{if(settings.columns!==void 0){datamap.createMap()}}}clen=instance.countCols();priv.cellSettings.length=0;if(clen>0){var prop,proto,column;for(i=0;i<clen;i++){priv.columnSettings[i]=Handsontable.helper.columnFactory(GridSettings,priv.columnsSettingConflicts);proto=priv.columnSettings[i].prototype;if(GridSettings.prototype.columns){column=GridSettings.prototype.columns[i];expandType(column);Handsontable.helper.extend(proto,column)}}}if(typeof settings.fillHandle!=="undefined"){if(autofill.handle&&settings.fillHandle===false){autofill.disable()}else{if(!autofill.handle&&settings.fillHandle!==false){autofill.init()}}}if(!init){instance.PluginHooks.run("afterUpdateSettings")}grid.adjustRowsAndCols();if(instance.view){instance.forceFullRender=true;selection.refreshBorders(null,true)}};function expandType(obj){if(obj.hasOwnProperty("type")){var type,i;if(typeof obj.type==="object"){type=obj.type}else{if(typeof obj.type==="string"){type=Handsontable.cellTypes[obj.type];if(type===void 0){throw new Error('You declared cell type "'+obj.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes')}}}for(i in type){if(type.hasOwnProperty(i)&&!obj.hasOwnProperty(i)){obj[i]=type[i]}}}}this.getSettings=function(){return priv.settings};this.getSettingsFromDOM=function(){return priv.settingsFromDOM};this.clear=function(){selection.selectAll();selection.empty()};this.alter=function(action,index,amount,source,keepEmptyRows){grid.alter(action,index,amount,source,keepEmptyRows)};this.getCell=function(row,col){return instance.view.getCellAtCoords({row:row,col:col})};this.colToProp=function(col){return datamap.colToProp(col)};this.propToCol=function(prop){return datamap.propToCol(prop)};this.getDataAtCell=function(row,col){return datamap.get(row,datamap.colToProp(col))};this.getDataAtRowProp=function(row,prop){return datamap.get(row,prop)};this.getDataAtCol=function(col){return[].concat.apply([],datamap.getRange({row:0,col:col},{row:priv.settings.data.length-1,col:col}))};this.getDataAtProp=function(prop){return[].concat.apply([],datamap.getRange({row:0,col:datamap.propToCol(prop)},{row:priv.settings.data.length-1,col:datamap.propToCol(prop)}))};this.getDataAtRow=function(row){return priv.settings.data[row]};this.getCellMeta=function(row,col){var prop=datamap.colToProp(col),cellProperties;row=translateRowIndex(row);col=translateColIndex(col);if("undefined"===typeof priv.columnSettings[col]){priv.columnSettings[col]=Handsontable.helper.columnFactory(GridSettings,priv.columnsSettingConflicts)}if(!priv.cellSettings[row]){priv.cellSettings[row]=[]}if(!priv.cellSettings[row][col]){priv.cellSettings[row][col]=new priv.columnSettings[col]()}cellProperties=priv.cellSettings[row][col];cellProperties.row=row;cellProperties.col=col;cellProperties.prop=prop;cellProperties.instance=instance;instance.PluginHooks.run("beforeGetCellMeta",row,col,cellProperties);expandType(cellProperties);if(cellProperties.cells){var settings=cellProperties.cells.call(cellProperties,row,col,prop);if(settings){expandType(settings);Handsontable.helper.extend(cellProperties,settings)}}instance.PluginHooks.run("afterGetCellMeta",row,col,cellProperties);return cellProperties;function translateRowIndex(row){var getVars={row:row};instance.PluginHooks.execute("beforeGet",getVars);return getVars.row}function translateColIndex(col){return Handsontable.PluginHooks.execute(instance,"modifyCol",col)}};this.validateCells=function(callback){var waitingForValidator=new ValidatorsQueue();waitingForValidator.onQueueEmpty=callback;var i=instance.countRows()-1;while(i>=0){var j=instance.countCols()-1;while(j>=0){waitingForValidator.addValidatorToQueue();instance.validateCell(instance.getDataAtCell(i,j),instance.getCellMeta(i,j),function(){waitingForValidator.removeValidatorFormQueue()},"validateCells");j--}i--}waitingForValidator.checkIfQueueIsEmpty()};this.getRowHeader=function(row){if(row===void 0){var out=[];for(var i=0,ilen=instance.countRows();i<ilen;i++){out.push(instance.getRowHeader(i))}return out}else{if(Object.prototype.toString.call(priv.settings.rowHeaders)==="[object Array]"&&priv.settings.rowHeaders[row]!==void 0){return priv.settings.rowHeaders[row]}else{if(typeof priv.settings.rowHeaders==="function"){return priv.settings.rowHeaders(row)}else{if(priv.settings.rowHeaders&&typeof priv.settings.rowHeaders!=="string"&&typeof priv.settings.rowHeaders!=="number"){return row+1}else{return priv.settings.rowHeaders}}}}};this.getColHeader=function(col){if(col===void 0){var out=[];for(var i=0,ilen=instance.countCols();i<ilen;i++){out.push(instance.getColHeader(i))}return out}else{col=Handsontable.PluginHooks.execute(instance,"modifyCol",col);if(priv.settings.columns&&priv.settings.columns[col]&&priv.settings.columns[col].title){return priv.settings.columns[col].title}else{if(Object.prototype.toString.call(priv.settings.colHeaders)==="[object Array]"&&priv.settings.colHeaders[col]!==void 0){return priv.settings.colHeaders[col]}else{if(typeof priv.settings.colHeaders==="function"){return priv.settings.colHeaders(col)}else{if(priv.settings.colHeaders&&typeof priv.settings.colHeaders!=="string"&&typeof priv.settings.colHeaders!=="number"){return Handsontable.helper.spreadsheetColumnLabel(col)}else{return priv.settings.colHeaders}}}}}};this._getColWidthFromSettings=function(col){var cellProperties=instance.getCellMeta(0,col);var width=cellProperties.width;if(width===void 0||width===priv.settings.width){width=cellProperties.colWidths}if(width!==void 0){switch(typeof width){case"object":width=width[col];break;case"function":width=width(col);break}if(typeof width==="string"){width=parseInt(width,10)}}return width};this.getColWidth=function(col){col=Handsontable.PluginHooks.execute(instance,"modifyCol",col);var response={width:instance._getColWidthFromSettings(col)};if(!response.width){response.width=50}instance.PluginHooks.run("afterGetColWidth",col,response);return response.width};this.countRows=function(){return priv.settings.data.length};this.countCols=function(){if(priv.dataType==="object"||priv.dataType==="function"){if(priv.settings.columns&&priv.settings.columns.length){return priv.settings.columns.length}else{return priv.colToProp.length}}else{if(priv.dataType==="array"){if(priv.settings.columns&&priv.settings.columns.length){return priv.settings.columns.length}else{if(priv.settings.data&&priv.settings.data[0]&&priv.settings.data[0].length){return priv.settings.data[0].length}else{return 0}}}}};this.rowOffset=function(){return instance.view.wt.getSetting("offsetRow")};this.colOffset=function(){return instance.view.wt.getSetting("offsetColumn")};this.countVisibleRows=function(){return instance.view.wt.drawn?instance.view.wt.wtTable.rowStrategy.countVisible():-1};this.countVisibleCols=function(){return instance.view.wt.drawn?instance.view.wt.wtTable.columnStrategy.countVisible():-1};this.countEmptyRows=function(ending){var i=instance.countRows()-1,empty=0;while(i>=0){datamap.get(i,0);if(instance.isEmptyRow(datamap.getVars.row)){empty++}else{if(ending){break}}i--}return empty};this.countEmptyCols=function(ending){if(instance.countRows()<1){return 0}var i=instance.countCols()-1,empty=0;while(i>=0){if(instance.isEmptyCol(i)){empty++}else{if(ending){break}}i--}return empty};this.isEmptyRow=function(r){if(priv.settings.isEmptyRow){return priv.settings.isEmptyRow.call(instance,r)}var val;for(var c=0,clen=instance.countCols();c<clen;c++){val=instance.getDataAtCell(r,c);if(val!==""&&val!==null&&typeof val!=="undefined"){return false}}return true};this.isEmptyCol=function(c){if(priv.settings.isEmptyCol){return priv.settings.isEmptyCol.call(instance,c)}var val;for(var r=0,rlen=instance.countRows();r<rlen;r++){val=instance.getDataAtCell(r,c);if(val!==""&&val!==null&&typeof val!=="undefined"){return false}}return true};this.selectCell=function(row,col,endRow,endCol,scrollToCell){if(typeof row!=="number"||row<0||row>=instance.countRows()){return false}if(typeof col!=="number"||col<0||col>=instance.countCols()){return false}if(typeof endRow!=="undefined"){if(typeof endRow!=="number"||endRow<0||endRow>=instance.countRows()){return false}if(typeof endCol!=="number"||endCol<0||endCol>=instance.countCols()){return false}}priv.selStart.coords({row:row,col:col});if(document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body){document.activeElement.blur()}instance.listen();if(typeof endRow==="undefined"){selection.setRangeEnd({row:row,col:col},scrollToCell)}else{selection.setRangeEnd({row:endRow,col:endCol},scrollToCell)}instance.selection.finish();return true};this.selectCellByProp=function(row,prop,endRow,endProp,scrollToCell){arguments[1]=datamap.propToCol(arguments[1]);if(typeof arguments[3]!=="undefined"){arguments[3]=datamap.propToCol(arguments[3])}return instance.selectCell.apply(instance,arguments)};this.deselectCell=function(){selection.deselect()};this.destroy=function(){instance.clearTimeouts();if(instance.view){instance.view.wt.destroy()}instance.rootElement.empty();instance.rootElement.removeData("handsontable");instance.rootElement.off(".handsontable");$(window).off("."+instance.guid);$document.off("."+instance.guid);$body.off("."+instance.guid);instance.copyPaste.removeCallback(priv.onCut);instance.copyPaste.removeCallback(priv.onPaste);instance.PluginHooks.run("afterDestroy")};this.getInstance=function(){return instance.rootElement.data("handsontable")};(function(){instance.PluginHooks=new Handsontable.PluginHookClass();var _run=instance.PluginHooks.run,_exe=instance.PluginHooks.execute;instance.PluginHooks.run=function(key,p1,p2,p3,p4,p5){_run.call(this,instance,key,p1,p2,p3,p4,p5);Handsontable.PluginHooks.run(instance,key,p1,p2,p3,p4,p5)};instance.PluginHooks.execute=function(key,p1,p2,p3,p4,p5){var globalHandlerResult=Handsontable.PluginHooks.execute(instance,key,p1,p2,p3,p4,p5);var localHandlerResult=_exe.call(this,instance,key,globalHandlerResult,p2,p3,p4,p5);return typeof localHandlerResult=="undefined"?globalHandlerResult:localHandlerResult};instance.addHook=function(){instance.PluginHooks.add.apply(instance.PluginHooks,arguments)};instance.addHookOnce=function(){instance.PluginHooks.once.apply(instance.PluginHooks,arguments)};instance.removeHook=function(){instance.PluginHooks.remove.apply(instance.PluginHooks,arguments)};instance.runHooks=function(){instance.PluginHooks.run.apply(instance.PluginHooks,arguments)};instance.runHooksAndReturn=function(){return instance.PluginHooks.execute.apply(instance.PluginHooks,arguments)}})();this.timeouts={};this.registerTimeout=function(key,handle,ms){clearTimeout(this.timeouts[key]);this.timeouts[key]=setTimeout(handle,ms||0)};this.clearTimeouts=function(){for(var key in this.timeouts){if(this.timeouts.hasOwnProperty(key)){clearTimeout(this.timeouts[key])}}};this.version="0.9.17"};var DefaultSettings=function(){};DefaultSettings.prototype={data:void 0,width:void 0,height:void 0,startRows:5,startCols:5,minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,multiSelect:true,fillHandle:true,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:true,enterBeginsEditing:true,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:false,autoWrapCol:false,copyRowsLimit:1000,copyColsLimit:1000,pasteMode:"overwrite",currentRowClassName:void 0,currentColClassName:void 0,stretchH:"hybrid",isEmptyRow:void 0,isEmptyCol:void 0,observeDOMVisibility:true,allowInvalid:true,invalidCellClassName:"htInvalid",fragmentSelection:false,readOnly:false};$.fn.handsontable=function(action){var i,ilen,args,output,userSettings,$this=this.first(),instance=$this.data("handsontable");if(typeof action!=="string"){userSettings=action||{};if(instance){instance.updateSettings(userSettings)}else{instance=new Handsontable.Core($this,userSettings);$this.data("handsontable",instance);instance.init()}return $this}else{args=[];if(arguments.length>1){for(i=1,ilen=arguments.length;i<ilen;i++){args.push(arguments[i])}}if(instance){if(typeof instance[action]!=="undefined"){output=instance[action].apply(instance,args)}else{throw new Error("Handsontable do not provide action: "+action)}}return output}};Handsontable.TableView=function(instance){var that=this,$window=$(window),$documentElement=$(document.documentElement);this.instance=instance;this.settings=instance.getSettings();this.settingsFromDOM=instance.getSettingsFromDOM();instance.rootElement.data("originalStyle",instance.rootElement[0].getAttribute("style"));instance.rootElement.addClass("handsontable");var table=document.createElement("TABLE");table.className="htCore";this.THEAD=document.createElement("THEAD");table.appendChild(this.THEAD);this.TBODY=document.createElement("TBODY");table.appendChild(this.TBODY);instance.$table=$(table);instance.rootElement.prepend(instance.$table);instance.rootElement.on("mousedown.handsontable",function(event){if(!that.isTextSelectionAllowed(event.target)){event.preventDefault();clearTextSelection()}});$documentElement.on("keyup."+instance.guid,function(event){if(instance.selection.isInProgress()&&!event.shiftKey){instance.selection.finish()}});var isMouseDown,dragInterval;$documentElement.on("mouseup."+instance.guid,function(event){if(instance.selection.isInProgress()&&event.which===1){instance.selection.finish()}isMouseDown=false;clearInterval(dragInterval);dragInterval=null;if(instance.autofill.handle&&instance.autofill.handle.isDragged){if(instance.autofill.handle.isDragged>1){instance.autofill.apply()}instance.autofill.handle.isDragged=0}if(Handsontable.helper.isOutsideInput(document.activeElement)){instance.unlisten()}});$documentElement.on("mousedown."+instance.guid,function(event){var next=event.target;if(next!==that.wt.wtTable.spreader){while(next!==document.documentElement){if(next===null){return }if(next===instance.rootElement[0]||next.nodeName==="X-HANDSONTABLE"||next.id==="context-menu-layer"||$(next).is(".context-menu-list")||$(next).is(".typeahead li")){return }next=next.parentNode}}if(that.settings.outsideClickDeselects){instance.deselectCell()}else{instance.destroyEditor()}});instance.rootElement.on("mousedown.handsontable",".dragdealer",function(event){instance.destroyEditor()});instance.$table.on("selectstart",function(event){if(that.settings.fragmentSelection){return }event.preventDefault()});instance.$table.on("mouseenter",function(){if(dragInterval){clearInterval(dragInterval);dragInterval=null}});instance.$table.on("mouseleave",function(event){if(!(isMouseDown||(instance.autofill.handle&&instance.autofill.handle.isDragged))){return }var tolerance=1,offset=that.wt.wtDom.offset(table),offsetTop=offset.top+tolerance,offsetLeft=offset.left+tolerance,width=that.containerWidth-that.wt.getSetting("scrollbarWidth")-2*tolerance,height=that.containerHeight-that.wt.getSetting("scrollbarHeight")-2*tolerance,method,row=0,col=0,dragFn;if(event.pageY<offsetTop){row=-1;method="scrollVertical"}else{if(event.pageY>=offsetTop+height){row=1;method="scrollVertical"}else{if(event.pageX<offsetLeft){col=-1;method="scrollHorizontal"}else{if(event.pageX>=offsetLeft+width){col=1;method="scrollHorizontal"}}}}if(method){dragFn=function(){if(isMouseDown||(instance.autofill.handle&&instance.autofill.handle.isDragged)){that.wt[method](row+col).draw()}};dragFn();dragInterval=setInterval(dragFn,100)}});var clearTextSelection=function(){if(window.getSelection){if(window.getSelection().empty){window.getSelection().empty()}else{if(window.getSelection().removeAllRanges){window.getSelection().removeAllRanges()}}}else{if(document.selection){document.selection.empty()}}};var walkontableConfig={table:table,stretchH:this.settings.stretchH,data:instance.getDataAtCell,totalRows:instance.countRows,totalColumns:instance.countCols,scrollbarModelV:this.settings.scrollbarModelV,scrollbarModelH:this.settings.scrollbarModelH,offsetRow:0,offsetColumn:0,width:this.getWidth(),height:this.getHeight(),fixedColumnsLeft:function(){return that.settings.fixedColumnsLeft},fixedRowsTop:function(){return that.settings.fixedRowsTop},rowHeaders:function(){return that.settings.rowHeaders?[function(index,TH){that.appendRowHeader(index,TH)}]:[]},columnHeaders:function(){return that.settings.colHeaders?[function(index,TH){that.appendColHeader(index,TH)}]:[]},columnWidth:instance.getColWidth,cellRenderer:function(row,column,TD){that.applyCellTypeMethod("renderer",TD,row,column)},selections:{current:{className:"current",border:{width:2,color:"#5292F7",style:"solid",cornerVisible:function(){return that.settings.fillHandle&&!that.isCellEdited()&&!instance.selection.isMultiple()}}},area:{className:"area",border:{width:1,color:"#89AFF9",style:"solid",cornerVisible:function(){return that.settings.fillHandle&&!that.isCellEdited()&&instance.selection.isMultiple()}}},highlight:{highlightRowClassName:that.settings.currentRowClassName,highlightColumnClassName:that.settings.currentColClassName},fill:{className:"fill",border:{width:1,color:"red",style:"solid"}}},hideBorderOnMouseDownOver:function(){return that.settings.fragmentSelection},onCellMouseDown:function(event,coords,TD){instance.listen();isMouseDown=true;var coordsObj={row:coords[0],col:coords[1]};if(event.button===2&&instance.selection.inInSelection(coordsObj)){}else{if(event.shiftKey){instance.selection.setRangeEnd(coordsObj)}else{instance.selection.setRangeStart(coordsObj)}}if(that.settings.afterOnCellMouseDown){that.settings.afterOnCellMouseDown.call(instance,event,coords,TD)}},onCellMouseOver:function(event,coords){var coordsObj={row:coords[0],col:coords[1]};if(isMouseDown){instance.selection.setRangeEnd(coordsObj)}else{if(instance.autofill.handle&&instance.autofill.handle.isDragged){instance.autofill.handle.isDragged++;instance.autofill.showBorder(coords)}}},onCellCornerMouseDown:function(event){instance.autofill.handle.isDragged=1;event.preventDefault()},onCellCornerDblClick:function(){instance.autofill.selectAdjacent()},beforeDraw:function(force){that.beforeRender(force)},onDraw:function(force){that.onDraw(force)}};instance.PluginHooks.run("beforeInitWalkontable",walkontableConfig);this.wt=new Walkontable(walkontableConfig);$window.on("resize."+instance.guid,function(){instance.registerTimeout("resizeTimeout",function(){instance.parseSettingsFromDOM();var newWidth=that.getWidth();var newHeight=that.getHeight();if(walkontableConfig.width!==newWidth||walkontableConfig.height!==newHeight){instance.forceFullRender=true;that.render();walkontableConfig.width=newWidth;walkontableConfig.height=newHeight}},60)});$(that.wt.wtTable.spreader).on("mousedown.handsontable, contextmenu.handsontable",function(event){if(event.target===that.wt.wtTable.spreader&&event.which===3){event.stopPropagation()}});$documentElement.on("click."+instance.guid,function(){if(that.settings.observeDOMVisibility){if(that.wt.drawInterrupted){that.instance.forceFullRender=true;that.render()}}})};Handsontable.TableView.prototype.isTextSelectionAllowed=function(el){if(el.nodeName==="TEXTAREA"){return(true)}if(this.settings.fragmentSelection&&this.wt.wtDom.isChildOf(el,this.TBODY)){return(true)}return false};Handsontable.TableView.prototype.isCellEdited=function(){return document.activeElement!==document.body};Handsontable.TableView.prototype.getWidth=function(){var val=this.settings.width!==void 0?this.settings.width:this.settingsFromDOM.width;return typeof val==="function"?val():val};Handsontable.TableView.prototype.getHeight=function(){var val=this.settings.height!==void 0?this.settings.height:this.settingsFromDOM.height;return typeof val==="function"?val():val};Handsontable.TableView.prototype.beforeRender=function(force){if(force){this.instance.PluginHooks.run("beforeRender");this.wt.update("width",this.getWidth());this.wt.update("height",this.getHeight())}};Handsontable.TableView.prototype.onDraw=function(force){if(force){this.instance.PluginHooks.run("afterRender")}};Handsontable.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender);this.instance.forceFullRender=false;this.instance.rootElement.triggerHandler("render.handsontable")};Handsontable.TableView.prototype.applyCellTypeMethod=function(methodName,td,row,col){var prop=this.instance.colToProp(col),cellProperties=this.instance.getCellMeta(row,col),method=Handsontable.helper.getCellMethod(methodName,cellProperties[methodName]);return method(this.instance,td,row,col,prop,this.instance.getDataAtRowProp(row,prop),cellProperties)};Handsontable.TableView.prototype.getCellAtCoords=function(coords){var td=this.wt.wtTable.getCell([coords.row,coords.col]);if(td<0){return null}else{return td}};Handsontable.TableView.prototype.scrollViewport=function(coords){this.wt.scrollViewport([coords.row,coords.col])};Handsontable.TableView.prototype.appendRowHeader=function(row,TH){if(row>-1){this.wt.wtDom.fastInnerHTML(TH,this.instance.getRowHeader(row))}else{this.wt.wtDom.empty(TH)}};Handsontable.TableView.prototype.appendColHeader=function(col,TH){var DIV=document.createElement("DIV"),SPAN=document.createElement("SPAN");DIV.className="relative";SPAN.className="colHeader";this.wt.wtDom.fastInnerHTML(SPAN,this.instance.getColHeader(col));DIV.appendChild(SPAN);while(TH.firstChild){TH.removeChild(TH.firstChild)}TH.appendChild(DIV);this.instance.PluginHooks.run("afterGetColHeader",col,TH)};Handsontable.TableView.prototype.maximumVisibleElementWidth=function(left){var rootWidth=this.wt.wtViewport.getWorkspaceWidth();return rootWidth-left};Handsontable.TableView.prototype.maximumVisibleElementHeight=function(top){var rootHeight=this.wt.wtViewport.getWorkspaceHeight();return rootHeight-top};Handsontable.helper.isPrintableChar=function(keyCode){return((keyCode==32)||(keyCode>=48&&keyCode<=57)||(keyCode>=96&&keyCode<=111)||(keyCode>=186&&keyCode<=192)||(keyCode>=219&&keyCode<=222)||keyCode>=226||(keyCode>=65&&keyCode<=90))};Handsontable.helper.stringify=function(value){switch(typeof value){case"string":case"number":return value+"";break;case"object":if(value===null){return""}else{return value.toString()}break;case"undefined":return"";break;default:return value.toString()}};Handsontable.helper.spreadsheetColumnLabel=function(index){var dividend=index+1;var columnLabel="";var modulo;while(dividend>0){modulo=(dividend-1)%26;columnLabel=String.fromCharCode(65+modulo)+columnLabel;dividend=parseInt((dividend-modulo)/26,10)}return columnLabel};Handsontable.helper.isNumeric=function(n){var t=typeof n;return t=="number"?!isNaN(n)&&isFinite(n):t=="string"?!n.length?false:n.length==1?/\d/.test(n):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(n):t=="object"?!!n&&typeof n.valueOf()=="number"&&!(n instanceof Date):false};Handsontable.helper.isDescendant=function(parent,child){var node=child.parentNode;while(node!=null){if(node==parent){return true}node=node.parentNode}return false};Handsontable.helper.randomString=function(){function s4(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return s4()+s4()+s4()+s4()};Handsontable.helper.inherit=function(Child,Parent){function Bridge(){}Bridge.prototype=Parent.prototype;Child.prototype=new Bridge();Child.prototype.constructor=Child;return Child};Handsontable.helper.extend=function(target,extension){for(var i in extension){if(extension.hasOwnProperty(i)){target[i]=extension[i]}}};Handsontable.helper.columnFactory=function(GridSettings,conflictList){var i=0,len=conflictList.length,ColumnSettings=function(){};ColumnSettings.prototype=new GridSettings();for(;i<len;i++){ColumnSettings.prototype[conflictList[i]]=void 0}return ColumnSettings};Handsontable.helper.translateRowsToColumns=function(input){var i,ilen,j,jlen,output=[],olen=0;for(i=0,ilen=input.length;i<ilen;i++){for(j=0,jlen=input[i].length;j<jlen;j++){if(j==olen){output.push([]);olen++}output[j].push(input[i][j])}}return output};Handsontable.helper.to2dArray=function(arr){var i=0,ilen=arr.length;while(i<ilen){arr[i]=[arr[i]];i++}};Handsontable.helper.extendArray=function(arr,extension){var i=0,ilen=extension.length;while(i<ilen){arr.push(extension[i]);i++}};Handsontable.helper.getCellMethod=function(methodName,methodFunction){if(typeof methodFunction==="string"){var result=Handsontable.cellLookup[methodName][methodFunction];if(result===void 0){throw new Error("You declared cell "+methodName+' "'+methodFunction+'" as a string that is not mapped to a known function. Cell '+methodName+" must be a function or a string mapped to a function in Handsontable.cellLookup."+methodName+" lookup object")}return result}else{return methodFunction}};Handsontable.helper.isOutsideInput=function(element){var inputs=["INPUT","SELECT","TEXTAREA"];return inputs.indexOf(element.nodeName)>-1&&element.className.indexOf("handsontableInput")==-1};Handsontable.helper.isArray=function(obj){return Array.isArray?Array.isArray(obj):Object.prototype.toString.call(obj)=="[object Array]"};Handsontable.SelectionPoint=function(){this._row=null;this._col=null};Handsontable.SelectionPoint.prototype.exists=function(){return(this._row!==null)};Handsontable.SelectionPoint.prototype.row=function(val){if(val!==void 0){this._row=val}return this._row};Handsontable.SelectionPoint.prototype.col=function(val){if(val!==void 0){this._col=val}return this._col};Handsontable.SelectionPoint.prototype.coords=function(coords){if(coords!==void 0){this._row=coords.row;this._col=coords.col}return{row:this._row,col:this._col}};Handsontable.SelectionPoint.prototype.arr=function(arr){if(arr!==void 0){this._row=arr[0];this._col=arr[1]}return[this._row,this._col]};Handsontable.TextRenderer=function(instance,TD,row,col,prop,value,cellProperties){var escaped=Handsontable.helper.stringify(value);instance.view.wt.wtDom.fastInnerText(TD,escaped);if(cellProperties.readOnly){instance.view.wt.wtDom.addClass(TD,"htDimmed")}if(cellProperties.valid===false&&cellProperties.invalidCellClassName){instance.view.wt.wtDom.addClass(TD,cellProperties.invalidCellClassName)}};var clonableTEXT=document.createElement("DIV");clonableTEXT.className="htAutocomplete";var clonableARROW=document.createElement("DIV");clonableARROW.className="htAutocompleteArrow";clonableARROW.appendChild(document.createTextNode("\u25BC"));Handsontable.AutocompleteRenderer=function(instance,TD,row,col,prop,value,cellProperties){var TEXT=clonableTEXT.cloneNode(false);var ARROW=clonableARROW.cloneNode(true);if(!instance.acArrowListener){instance.acArrowListener=function(){instance.view.wt.getSetting("onCellDblClick")};instance.rootElement.on("mouseup",".htAutocompleteArrow",instance.acArrowListener)}Handsontable.TextRenderer(instance,TEXT,row,col,prop,value,cellProperties);if(!TEXT.firstChild){TEXT.appendChild(document.createTextNode("\u00A0"))}TEXT.appendChild(ARROW);instance.view.wt.wtDom.empty(TD);TD.appendChild(TEXT)};var clonableINPUT=document.createElement("INPUT");clonableINPUT.className="htCheckboxRendererInput";clonableINPUT.type="checkbox";clonableINPUT.setAttribute("autocomplete","off");Handsontable.CheckboxRenderer=function(instance,TD,row,col,prop,value,cellProperties){if(typeof cellProperties.checkedTemplate==="undefined"){cellProperties.checkedTemplate=true}if(typeof cellProperties.uncheckedTemplate==="undefined"){cellProperties.uncheckedTemplate=false}instance.view.wt.wtDom.empty(TD);var INPUT=clonableINPUT.cloneNode(false);if(value===cellProperties.checkedTemplate||value===Handsontable.helper.stringify(cellProperties.checkedTemplate)){INPUT.checked=true;TD.appendChild(INPUT)}else{if(value===cellProperties.uncheckedTemplate||value===Handsontable.helper.stringify(cellProperties.uncheckedTemplate)){TD.appendChild(INPUT)}else{if(value===null){INPUT.className+=" noValue";TD.appendChild(INPUT)}else{instance.view.wt.wtDom.fastInnerText(TD,"#bad value#")}}}var $input=$(INPUT);if(cellProperties.readOnly){$input.on("click",function(event){event.preventDefault()})}else{$input.on("mousedown",function(event){event.stopPropagation()});$input.on("mouseup",function(event){event.stopPropagation()});$input.on("change",function(){if(this.checked){instance.setDataAtRowProp(row,prop,cellProperties.checkedTemplate)}else{instance.setDataAtRowProp(row,prop,cellProperties.uncheckedTemplate)}})}if(!instance.CheckboxRenderer||!instance.CheckboxRenderer.beforeKeyDownHookBound){instance.CheckboxRenderer={beforeKeyDownHookBound:true};instance.addHook("beforeKeyDown",function(event){if(event.keyCode==32){event.stopImmediatePropagation();event.preventDefault();var selection=instance.getSelected();var cell,checkbox,cellProperties;var selStart={row:Math.min(selection[0],selection[2]),col:Math.min(selection[1],selection[3])};var selEnd={row:Math.max(selection[0],selection[2]),col:Math.max(selection[1],selection[3])};for(var row=selStart.row;row<=selEnd.row;row++){for(var col=selEnd.col;col<=selEnd.col;col++){cell=instance.getCell(row,col);cellProperties=instance.getCellMeta(row,col);checkbox=cell.querySelectorAll("input[type=checkbox]");if(checkbox.length>0&&!cellProperties.readOnly){for(var i=0,len=checkbox.length;i<len;i++){checkbox[i].checked=!checkbox[i].checked;$(checkbox[i]).trigger("change")}}}}}})}return TD};Handsontable.NumericRenderer=function(instance,TD,row,col,prop,value,cellProperties){if(Handsontable.helper.isNumeric(value)){if(typeof cellProperties.language!=="undefined"){numeral.language(cellProperties.language)}value=numeral(value).format(cellProperties.format||"0");instance.view.wt.wtDom.addClass(TD,"htNumeric")}Handsontable.TextRenderer(instance,TD,row,col,prop,value,cellProperties)};(function(Handosntable){Handsontable.PasswordRenderer=function(instance,TD,row,col,prop,value,cellProperties){Handsontable.TextRenderer.apply(this,arguments);value=TD.innerHTML;var hash;var hashLength=cellProperties.hashLength||value.length;var hashSymbol=cellProperties.hashSymbol||"*";for(hash="";hash.split(hashSymbol).length-1<hashLength;hash+=hashSymbol){}instance.view.wt.wtDom.fastInnerHTML(TD,hash)}})(Handsontable);function HandsontableTextEditorClass(instance){this.instance=instance;this.createElements();this.bindEvents()}HandsontableTextEditorClass.prototype.createElements=function(){this.STATE_VIRGIN="STATE_VIRGIN";this.STATE_EDITING="STATE_EDITING";this.STATE_WAITING="STATE_WAITING";this.STATE_FINISHED="STATE_FINISHED";this.state=this.STATE_VIRGIN;this.waitingEvent=null;this.wtDom=new WalkontableDom();this.TEXTAREA=document.createElement("TEXTAREA");this.TEXTAREA.className="handsontableInput";this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.$textarea=$(this.TEXTAREA);this.TEXTAREA_PARENT=document.createElement("DIV");this.TEXTAREA_PARENT.className="handsontableInputHolder";this.textareaParentStyle=this.TEXTAREA_PARENT.style;this.textareaParentStyle.top=0;this.textareaParentStyle.left=0;this.textareaParentStyle.display="none";this.$body=$(document.body);this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);this.instance.rootElement[0].appendChild(this.TEXTAREA_PARENT);var that=this;Handsontable.PluginHooks.add("afterRender",function(){that.instance.registerTimeout("refresh_editor_dimensions",function(){that.refreshDimensions()},0)})};HandsontableTextEditorClass.prototype.bindEvents=function(){var that=this;this.$textarea.off(".editor").on("keydown.editor",function(event){if(that.state===that.STATE_WAITING){event.stopImmediatePropagation()}else{that.waitingEvent=null}if(that.state!==that.STATE_EDITING){return }var ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;if(event.keyCode===17||event.keyCode===224||event.keyCode===91||event.keyCode===93){event.stopImmediatePropagation();return }switch(event.keyCode){case 38:that.finishEditing(false);break;case 40:that.finishEditing(false);break;case 9:that.finishEditing(false);event.preventDefault();break;case 39:if(that.wtDom.getCaretPosition(that.TEXTAREA)===that.TEXTAREA.value.length){that.finishEditing(false)}else{event.stopImmediatePropagation()}break;case 37:if(that.wtDom.getCaretPosition(that.TEXTAREA)===0){that.finishEditing(false)}else{event.stopImmediatePropagation()}break;case 27:that.instance.destroyEditor(true);event.stopImmediatePropagation();break;case 13:var selected=that.instance.getSelected();var isMultipleSelection=!(selected[0]===selected[2]&&selected[1]===selected[3]);if((event.ctrlKey&&!isMultipleSelection)||event.altKey){that.TEXTAREA.value=that.TEXTAREA.value+"\n";that.TEXTAREA.focus();event.stopImmediatePropagation()}else{that.finishEditing(false,ctrlDown)}event.preventDefault();break;default:event.stopImmediatePropagation();break}if(that.state!==that.STATE_FINISHED&&!event.isImmediatePropagationStopped()){that.waitingEvent=event;event.stopImmediatePropagation();event.preventDefault()}})};HandsontableTextEditorClass.prototype.bindTemporaryEvents=function(td,row,col,prop,value,cellProperties){var that=this;this.state=this.STATE_VIRGIN;function onDblClick(){that.TEXTAREA.value=that.originalValue;that.instance.destroyEditor();that.beginEditing(row,col,prop,true)}this.instance.view.wt.update("onCellDblClick",onDblClick);this.TD=td;this.row=row;this.col=col;this.prop=prop;this.originalValue=value;this.cellProperties=cellProperties;this.beforeKeyDownHook=function beforeKeyDownHook(event){if(that.state!==that.STATE_VIRGIN){return }var ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;if(Handsontable.helper.isPrintableChar(event.keyCode)){if(!ctrlDown){that.beginEditing(row,col,prop);event.stopImmediatePropagation()}}else{if(event.keyCode===113){that.beginEditing(row,col,prop,true);event.stopImmediatePropagation();event.preventDefault()}else{if(event.keyCode===13&&that.instance.getSettings().enterBeginsEditing){var selected=that.instance.getSelected();var isMultipleSelection=!(selected[0]===selected[2]&&selected[1]===selected[3]);if((ctrlDown&&!isMultipleSelection)||event.altKey){that.beginEditing(row,col,prop,true,"\n")}else{that.beginEditing(row,col,prop,true)}event.preventDefault();event.stopImmediatePropagation()}else{if([9,33,34,35,36,37,38,39,40].indexOf(event.keyCode)==-1){that.instance.addHookOnce("beforeKeyDown",beforeKeyDownHook)}}}}};that.instance.addHookOnce("beforeKeyDown",this.beforeKeyDownHook)};HandsontableTextEditorClass.prototype.unbindTemporaryEvents=function(){this.instance.removeHook("beforeKeyDown",this.beforeKeyDownHook);this.instance.view.wt.update("onCellDblClick",null)};HandsontableTextEditorClass.prototype.beginEditing=function(row,col,prop,useOriginalValue,suffix){if(this.state!==this.STATE_VIRGIN){return }this.state=this.STATE_EDITING;this.row=row;this.col=col;this.prop=prop;this.$textarea.on("cut.editor",function(event){event.stopPropagation()});this.$textarea.on("paste.editor",function(event){event.stopPropagation()});if(useOriginalValue){this.TEXTAREA.value=Handsontable.helper.stringify(this.originalValue)+(suffix||"")}else{this.TEXTAREA.value=""}this.refreshDimensions();this.TEXTAREA.focus();this.wtDom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length);var coords={row:row,col:col};this.instance.view.scrollViewport(coords);this.instance.view.render()};HandsontableTextEditorClass.prototype.refreshDimensions=function(){if(this.state!==this.STATE_EDITING){return }this.TD=this.instance.getCell(this.row,this.col);var $td=$(this.TD);var currentOffset=this.wtDom.offset(this.TD);var containerOffset=this.wtDom.offset(this.instance.rootElement[0]);var scrollTop=this.instance.rootElement.scrollTop();var scrollLeft=this.instance.rootElement.scrollLeft();var editTop=currentOffset.top-containerOffset.top+scrollTop-1;var editLeft=currentOffset.left-containerOffset.left+scrollLeft-1;var settings=this.instance.getSettings();var rowHeadersCount=settings.rowHeaders===false?0:1;var colHeadersCount=settings.colHeaders===false?0:1;if(editTop<0){editTop=0}if(editLeft<0){editLeft=0}if(rowHeadersCount>0&&parseInt($td.css("border-top-width"),10)>0){editTop+=1}if(colHeadersCount>0&&parseInt($td.css("border-left-width"),10)>0){editLeft+=1}if($.browser.msie&&parseInt($.browser.version,10)<=7){editTop-=1}this.textareaParentStyle.top=editTop+"px";this.textareaParentStyle.left=editLeft+"px";var width=$td.width(),maxWidth=this.instance.view.maximumVisibleElementWidth(editLeft)-10,height=$td.outerHeight()-4,maxHeight=this.instance.view.maximumVisibleElementHeight(editTop)-5;if(parseInt($td.css("border-top-width"),10)>0){height-=1}if(parseInt($td.css("border-left-width"),10)>0){if(rowHeadersCount>0){width-=1}}this.$textarea.autoResize({minHeight:Math.min(height,maxHeight),maxHeight:maxHeight,minWidth:Math.min(width,maxWidth),maxWidth:maxWidth,animate:false,extraSpace:0});this.textareaParentStyle.display="block"};HandsontableTextEditorClass.prototype.saveValue=function(val,ctrlDown){if(ctrlDown){var sel=this.instance.getSelected();this.instance.populateFromArray(sel[0],sel[1],val,sel[2],sel[3],"edit")}else{this.instance.populateFromArray(this.row,this.col,val,null,null,"edit")}};HandsontableTextEditorClass.prototype.finishEditing=function(isCancelled,ctrlDown){var hasValidator=false;if(this.state==this.STATE_WAITING||this.state==this.STATE_FINISHED){return }if(this.state==this.STATE_EDITING){var val;if(isCancelled){val=[[this.originalValue]]}else{val=[[$.trim(this.TEXTAREA.value)]]}hasValidator=this.instance.getCellMeta(this.row,this.col).validator;if(hasValidator){this.state=this.STATE_WAITING;var that=this;this.instance.addHookOnce("afterValidate",function(result){that.state=that.STATE_FINISHED;that.discardEditor(result)})}this.saveValue(val,ctrlDown)}if(!hasValidator){this.state=this.STATE_FINISHED;this.discardEditor()}};HandsontableTextEditorClass.prototype.discardEditor=function(result){if(this.state!==this.STATE_FINISHED){return }if(result===false&&this.cellProperties.allowInvalid!==true){this.state=this.STATE_EDITING;if(this.instance.view.wt.wtDom.isVisible(this.TEXTAREA)){this.TEXTAREA.focus();this.wtDom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)}}else{this.state=this.STATE_FINISHED;if(document.activeElement===this.TEXTAREA){this.instance.listen()}this.unbindTemporaryEvents();this.textareaParentStyle.display="none";if(this.waitingEvent){var ev=$.Event(this.waitingEvent.type);ev.keyCode=this.waitingEvent.keyCode;this.waitingEvent=null;$(document.activeElement).trigger(ev)}}};Handsontable.TextEditor=function(instance,td,row,col,prop,value,cellProperties){if(!instance.textEditor){instance.textEditor=new HandsontableTextEditorClass(instance)}if(instance.textEditor.state===instance.textEditor.STATE_VIRGIN||instance.textEditor.state===instance.textEditor.STATE_FINISHED){instance.textEditor.bindTemporaryEvents(td,row,col,prop,value,cellProperties)}return function(isCancelled){instance.textEditor.finishEditing(isCancelled)}};function HandsontableAutocompleteEditorClass(instance){this.instance=instance;this.createElements();this.bindEvents();this.emptyStringLabel="\u00A0\u00A0\u00A0"}Handsontable.helper.inherit(HandsontableAutocompleteEditorClass,HandsontableTextEditorClass);HandsontableAutocompleteEditorClass.prototype.createElements=function(){HandsontableTextEditorClass.prototype.createElements.call(this);this.$textarea.typeahead();this.typeahead=this.$textarea.data("typeahead");this.typeahead._render=this.typeahead.render;this.typeahead.minLength=0;this.typeahead.lookup=function(){var items;this.query=this.$element.val();items=$.isFunction(this.source)?this.source(this.query,$.proxy(this.process,this)):this.source;return items?this.process(items):this};this.typeahead.matcher=function(){return true};var _process=this.typeahead.process;var that=this;this.typeahead.process=function(items){var cloned=false;for(var i=0,ilen=items.length;i<ilen;i++){if(items[i]===""){if(!cloned){items=$.extend([],items);cloned=true}items[i]=that.emptyStringLabel}}return _process.call(this,items)}};HandsontableAutocompleteEditorClass.prototype.bindEvents=function(){var that=this;this.$textarea.off("keydown").off("keyup").off("keypress");this.$textarea.off(".acEditor").on("keydown.acEditor",function(event){switch(event.keyCode){case 38:that.typeahead.prev();event.stopImmediatePropagation();break;case 40:that.typeahead.next();event.stopImmediatePropagation();break;case 13:event.preventDefault();break}});this.$textarea.on("keyup.acEditor",function(event){if(Handsontable.helper.isPrintableChar(event.keyCode)||event.keyCode===113||event.keyCode===13||event.keyCode===8||event.keyCode===46){that.typeahead.lookup()}});this.typeahead.$menu.on("mouseleave",function(){that.typeahead.$menu.find(".active").removeClass("active")});HandsontableTextEditorClass.prototype.bindEvents.call(this)};HandsontableAutocompleteEditorClass.prototype.bindTemporaryEvents=function(td,row,col,prop,value,cellProperties){var that=this,i,j;this.typeahead._valueSelected=false;this.typeahead.select=function(){var active=this.$menu[0].querySelector(".active");var val=active.getAttribute("data-value");if(val===that.emptyStringLabel){val=""}if(typeof cellProperties.onSelect==="function"){cellProperties.onSelect(row,col,prop,val,that.instance.view.wt.wtDom.index(active))}else{that.TEXTAREA.value=val}this._valueSelected=true;this.hide();that.finishEditing();return this};this.typeahead.render=function(items){that.typeahead._render.call(this,items);if(!cellProperties.strict){var li=this.$menu[0].querySelector(".active");if(li){that.instance.view.wt.wtDom.removeClass(li,"active")}}return this};for(i in cellProperties){if(i==="options"){for(j in cellProperties.options){this.typeahead.options[j]=cellProperties.options[j]}}else{this.typeahead[i]=cellProperties[i]}}HandsontableTextEditorClass.prototype.bindTemporaryEvents.call(this,td,row,col,prop,value,cellProperties)};HandsontableAutocompleteEditorClass.prototype.beginEditing=function(){HandsontableTextEditorClass.prototype.beginEditing.apply(this,arguments);var that=this;this.instance.registerTimeout("IE9_align_fix",function(){that.typeahead.lookup()},1)};HandsontableAutocompleteEditorClass.prototype.finishEditing=function(isCancelled,ctrlDown){if(!isCancelled){if(this.isMenuExpanded()){if(this.typeahead.$menu[0].querySelector(".active")){this.typeahead.select();this.state=this.STATE_FINISHED}else{if(this.cellProperties.strict){this.state=this.STATE_FINISHED}}}}HandsontableTextEditorClass.prototype.finishEditing.call(this,isCancelled,ctrlDown)};HandsontableAutocompleteEditorClass.prototype.isMenuExpanded=function(){if(this.instance.view.wt.wtDom.isVisible(this.typeahead.$menu[0])){return this.typeahead}else{return false}};Handsontable.AutocompleteEditor=function(instance,td,row,col,prop,value,cellProperties){if(!instance.autocompleteEditor){instance.autocompleteEditor=new HandsontableAutocompleteEditorClass(instance)}instance.autocompleteEditor.bindTemporaryEvents(td,row,col,prop,value,cellProperties);return function(isCancelled){instance.autocompleteEditor.finishEditing(isCancelled)}};function toggleCheckboxCell(instance,row,prop,cellProperties){if(Handsontable.helper.stringify(instance.getDataAtRowProp(row,prop))===Handsontable.helper.stringify(cellProperties.checkedTemplate)){instance.setDataAtRowProp(row,prop,cellProperties.uncheckedTemplate)}else{instance.setDataAtRowProp(row,prop,cellProperties.checkedTemplate)}}Handsontable.CheckboxEditor=function(instance,td,row,col,prop,value,cellProperties){if(typeof cellProperties==="undefined"){cellProperties={}}if(typeof cellProperties.checkedTemplate==="undefined"){cellProperties.checkedTemplate=true}if(typeof cellProperties.uncheckedTemplate==="undefined"){cellProperties.uncheckedTemplate=false}instance.$table.on("keydown.editor",function(event){var ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;if(!ctrlDown&&Handsontable.helper.isPrintableChar(event.keyCode)){toggleCheckboxCell(instance,row,prop,cellProperties);event.stopImmediatePropagation();event.preventDefault()}});instance.view.wt.update("onCellDblClick",function(){toggleCheckboxCell(instance,row,prop,cellProperties)});return function(){instance.$table.off(".editor");instance.view.wt.update("onCellDblClick",null)}};function HandsontableDateEditorClass(instance){if(!$.datepicker){throw new Error("jQuery UI Datepicker dependency not found. Did you forget to include jquery-ui.custom.js or its substitute?")}this.isCellEdited=false;this.instance=instance;var that=this;this.createElements();this.bindEvents();this.instance.addHook("afterDestroy",function(){that.destroyElements()})}Handsontable.helper.inherit(HandsontableDateEditorClass,HandsontableTextEditorClass);HandsontableDateEditorClass.prototype.createElements=function(){HandsontableTextEditorClass.prototype.createElements.call(this);this.datePicker=document.createElement("DIV");this.instance.view.wt.wtDom.addClass(this.datePicker,"htDatepickerHolder");this.datePickerStyle=this.datePicker.style;this.datePickerStyle.position="absolute";this.datePickerStyle.top=0;this.datePickerStyle.left=0;this.datePickerStyle.zIndex=99;document.body.appendChild(this.datePicker);this.$datePicker=$(this.datePicker);var that=this;var defaultOptions={dateFormat:"yy-mm-dd",showButtonPanel:true,changeMonth:true,changeYear:true,altField:this.$textarea,onSelect:function(){that.finishEditing(false)}};this.$datePicker.datepicker(defaultOptions);this.$datePicker.on("mousedown",function(event){event.stopPropagation()});this.hideDatepicker()};HandsontableDateEditorClass.prototype.destroyElements=function(){this.$datePicker.datepicker("destroy");this.$datePicker.remove()};HandsontableDateEditorClass.prototype.beginEditing=function(row,col,prop,useOriginalValue,suffix){HandsontableTextEditorClass.prototype.beginEditing.call(this,row,col,prop,useOriginalValue,suffix);this.showDatepicker()};HandsontableDateEditorClass.prototype.finishEditing=function(isCancelled,ctrlDown){this.hideDatepicker();HandsontableTextEditorClass.prototype.finishEditing.call(this,isCancelled,ctrlDown)};HandsontableDateEditorClass.prototype.showDatepicker=function(){var $td=$(this.instance.dateEditor.TD);var offset=$td.offset();this.datePickerStyle.top=(offset.top+$td.height())+"px";this.datePickerStyle.left=offset.left+"px";var dateOptions={defaultDate:this.originalValue||void 0};$.extend(dateOptions,this.cellProperties);this.$datePicker.datepicker("option",dateOptions);if(this.originalValue){this.$datePicker.datepicker("setDate",this.originalValue)}this.datePickerStyle.display="block"};HandsontableDateEditorClass.prototype.hideDatepicker=function(){this.datePickerStyle.display="none"};Handsontable.DateEditor=function(instance,td,row,col,prop,value,cellProperties){if(!instance.dateEditor){instance.dateEditor=new HandsontableDateEditorClass(instance)}instance.dateEditor.bindTemporaryEvents(td,row,col,prop,value,cellProperties);return function(isCancelled){instance.dateEditor.finishEditing(isCancelled)}};function HandsontableHandsontableEditorClass(instance){this.instance=instance;this.createElements();this.bindEvents()}Handsontable.helper.inherit(HandsontableHandsontableEditorClass,HandsontableTextEditorClass);HandsontableHandsontableEditorClass.prototype.createElements=function(){HandsontableTextEditorClass.prototype.createElements.call(this);var DIV=document.createElement("DIV");DIV.className="handsontableEditor";this.TEXTAREA_PARENT.appendChild(DIV);this.$htContainer=$(DIV)};HandsontableHandsontableEditorClass.prototype.bindTemporaryEvents=function(td,row,col,prop,value,cellProperties){var parent=this;var options={colHeaders:true,cells:function(){return{readOnly:true}},fillHandle:false,width:2000,afterOnCellMouseDown:function(){var sel=this.getSelected();parent.TEXTAREA.value=this.getDataAtCell(sel[0],sel[1]);parent.instance.destroyEditor()},beforeOnKeyDown:function(event){switch(event.keyCode){case 27:parent.instance.destroyEditor(true);break;case 13:var sel=this.getSelected();parent.TEXTAREA.value=this.getDataAtCell(sel[0],sel[1]);parent.instance.destroyEditor();break}}};if(cellProperties.handsontable){options=$.extend(options,cellProperties.handsontable)}this.$htContainer.handsontable(options);HandsontableTextEditorClass.prototype.bindTemporaryEvents.call(this,td,row,col,prop,value,cellProperties)};HandsontableHandsontableEditorClass.prototype.beginEditing=function(row,col,prop,useOriginalValue,suffix){var onBeginEditing=this.instance.getSettings().onBeginEditing;if(onBeginEditing&&onBeginEditing()===false){return }HandsontableTextEditorClass.prototype.beginEditing.call(this,row,col,prop,useOriginalValue,suffix);this.$htContainer.handsontable("render");this.$htContainer.handsontable("selectCell",0,0)};HandsontableHandsontableEditorClass.prototype.finishEditing=function(isCancelled,ctrlDown){if(this.$htContainer.handsontable("isListening")){this.instance.listen()}this.$htContainer.handsontable("destroy");HandsontableTextEditorClass.prototype.finishEditing.call(this,isCancelled,ctrlDown)};Handsontable.HandsontableEditor=function(instance,td,row,col,prop,value,cellProperties){if(!instance.handsontableEditor){instance.handsontableEditor=new HandsontableHandsontableEditorClass(instance)}instance.handsontableEditor.bindTemporaryEvents(td,row,col,prop,value,cellProperties);instance.registerEditor=instance.handsontableEditor;return function(isCancelled){instance.handsontableEditor.finishEditing(isCancelled)}};(function(Handsontable){function HandsontablePasswordEditorClass(instance){HandsontableTextEditorClass.call(this,instance)}Handsontable.helper.inherit(HandsontablePasswordEditorClass,HandsontableTextEditorClass);HandsontablePasswordEditorClass.prototype.createElements=function(){this.STATE_VIRGIN="STATE_VIRGIN";this.STATE_EDITING="STATE_EDITING";this.STATE_WAITING="STATE_WAITING";this.STATE_FINISHED="STATE_FINISHED";this.state=this.STATE_VIRGIN;this.waitingEvent=null;this.wtDom=new WalkontableDom();this.TEXTAREA=document.createElement("input");this.TEXTAREA.setAttribute("type","password");this.TEXTAREA.className="handsontableInput";this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.$textarea=$(this.TEXTAREA);this.TEXTAREA_PARENT=document.createElement("DIV");this.TEXTAREA_PARENT.className="handsontableInputHolder";this.textareaParentStyle=this.TEXTAREA_PARENT.style;this.textareaParentStyle.top=0;this.textareaParentStyle.left=0;this.textareaParentStyle.display="none";this.$body=$(document.body);this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);this.instance.rootElement[0].appendChild(this.TEXTAREA_PARENT)};Handsontable.PasswordEditor=function(instance,td,row,col,prop,value,cellProperties){if(!instance.passwordEditor){instance.passwordEditor=new HandsontablePasswordEditorClass(instance)}if(instance.passwordEditor.state===instance.passwordEditor.STATE_VIRGIN||instance.passwordEditor.state===instance.passwordEditor.STATE_FINISHED){instance.passwordEditor.bindTemporaryEvents(td,row,col,prop,value,cellProperties)}return function(isCancelled){instance.passwordEditor.finishEditing(isCancelled)}}})(Handsontable);Handsontable.NumericValidator=function(value,callback){callback(/^-?\d*\.?\d*$/.test(value))};var process=function(value,callback){var originalVal=value;var lowercaseVal=typeof originalVal==="string"?originalVal.toLowerCase():null;return function(source){var found=false;for(var s=0,slen=source.length;s<slen;s++){if(originalVal===source[s]){found=true;break}else{if(lowercaseVal===source[s].toLowerCase()){found=true;break}}}callback(found)}};Handsontable.AutocompleteValidator=function(value,callback){if(this.strict&&this.source){$.isFunction(this.source)?this.source(value,process(value,callback)):process(value,callback)(this.source)}else{callback(true)}};Handsontable.AutocompleteCell={editor:Handsontable.AutocompleteEditor,renderer:Handsontable.AutocompleteRenderer,validator:Handsontable.AutocompleteValidator};Handsontable.CheckboxCell={editor:Handsontable.CheckboxEditor,renderer:Handsontable.CheckboxRenderer};Handsontable.TextCell={editor:Handsontable.TextEditor,renderer:Handsontable.TextRenderer};Handsontable.NumericCell={editor:Handsontable.TextEditor,renderer:Handsontable.NumericRenderer,validator:Handsontable.NumericValidator,dataType:"number"};Handsontable.DateCell={editor:Handsontable.DateEditor,renderer:Handsontable.AutocompleteRenderer};Handsontable.HandsontableCell={editor:Handsontable.HandsontableEditor,renderer:Handsontable.AutocompleteRenderer};Handsontable.PasswordCell={editor:Handsontable.PasswordEditor,renderer:Handsontable.PasswordRenderer};Handsontable.cellTypes={text:Handsontable.TextCell,date:Handsontable.DateCell,numeric:Handsontable.NumericCell,checkbox:Handsontable.CheckboxCell,autocomplete:Handsontable.AutocompleteCell,handsontable:Handsontable.HandsontableCell,password:Handsontable.PasswordCell};Handsontable.cellLookup={renderer:{text:Handsontable.TextRenderer,numeric:Handsontable.NumericRenderer,checkbox:Handsontable.CheckboxRenderer,autocomplete:Handsontable.AutocompleteRenderer,password:Handsontable.PasswordRenderer},editor:{text:Handsontable.TextEditor,date:Handsontable.DateEditor,checkbox:Handsontable.CheckboxEditor,autocomplete:Handsontable.AutocompleteEditor,handsontable:Handsontable.HandsontableEditor,password:Handsontable.PasswordEditor},validator:{numeric:Handsontable.NumericValidator,autocomplete:Handsontable.AutocompleteValidator}};Handsontable.PluginHookClass=(function(){var Hooks=function(){return{beforeInitWalkontable:[],beforeInit:[],beforeRender:[],beforeChange:[],beforeRemoveCol:[],beforeRemoveRow:[],beforeValidate:[],beforeGet:[],beforeSet:[],beforeGetCellMeta:[],beforeAutofill:[],beforeKeyDown:[],afterInit:[],afterLoadData:[],afterUpdateSettings:[],afterRender:[],afterChange:[],afterValidate:[],afterGetCellMeta:[],afterGetColHeader:[],afterGetColWidth:[],afterDestroy:[],afterRemoveRow:[],afterCreateRow:[],afterRemoveCol:[],afterCreateCol:[],afterColumnResize:[],afterColumnMove:[],afterDeselect:[],afterSelection:[],afterSelectionByProp:[],afterSelectionEnd:[],afterSelectionEndByProp:[],afterCopyLimit:[],modifyCol:[]}};var legacy={onBeforeChange:"beforeChange",onChange:"afterChange",onCreateRow:"afterCreateRow",onCreateCol:"afterCreateCol",onSelection:"afterSelection",onCopyLimit:"afterCopyLimit",onSelectionEnd:"afterSelectionEnd",onSelectionByProp:"afterSelectionByProp",onSelectionEndByProp:"afterSelectionEndByProp"};function PluginHookClass(){this.hooks={once:Hooks(),persistent:Hooks()};this.legacy=legacy}var addHook=function(type){return function(key,fn){if(key in legacy){key=legacy[key]}if(typeof this.hooks[type][key]==="undefined"){this.hooks[type][key]=[]}if(fn instanceof Array){for(var i=0,len=fn.length;i<len;i++){this.hooks[type][key].push(fn[i])}}else{this.hooks[type][key].push(fn)}return this}};PluginHookClass.prototype.add=addHook("persistent");PluginHookClass.prototype.once=addHook("once");PluginHookClass.prototype.remove=function(key,fn){var status=false,hookTypes=["persistent","once"],type,x,lenx,i,leni;if(key in legacy){key=legacy[key]}for(x=0,lenx=hookTypes.length;x<lenx;x++){type=hookTypes[x];if(typeof this.hooks[type][key]!=="undefined"){for(i=0,leni=this.hooks[type][key].length;i<leni;i++){if(this.hooks[type][key][i]==fn){this.hooks[type][key].splice(i,1);status=true;break}}}}return status};PluginHookClass.prototype.run=function(instance,key,p1,p2,p3,p4,p5){var hookTypes=["persistent","once"],type,x,lenx,i,leni;if(key in legacy){key=legacy[key]}for(x=0,lenx=hookTypes.length;x<lenx;x++){type=hookTypes[x];if(typeof this.hooks[type][key]!=="undefined"){for(i=0,leni=this.hooks[type][key].length;i<leni;i++){this.hooks[type][key][i].call(instance,p1,p2,p3,p4,p5);if(type==="once"){this.hooks[type][key].splice(i,1);leni--;i--}}}}};PluginHookClass.prototype.execute=function(instance,key,p1,p2,p3,p4,p5){var hookTypes=["persistent","once"],type,x,lenx,i,leni,res;if(key in legacy){key=legacy[key]}for(x=0,lenx=hookTypes.length;x<lenx;x++){type=hookTypes[x];if(typeof this.hooks[type][key]!=="undefined"){for(i=0,leni=this.hooks[type][key].length;i<leni;i++){res=this.hooks[type][key][i].call(instance,p1,p2,p3,p4,p5);if(res!==void 0){p1=res}if(type==="once"){this.hooks[type][key].splice(i,1);leni--;i--}}}}return p1};return PluginHookClass})();Handsontable.PluginHooks=new Handsontable.PluginHookClass();(function(Handsontable){function HandsontableAutoColumnSize(){var plugin=this,sampleCount=5;this.beforeInit=function(){var instance=this;instance.autoColumnWidths=[];if(instance.getSettings().autoColumnSize!==false){if(!instance.autoColumnSizeTmp){instance.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null}}instance.addHook("beforeRender",htAutoColumnSize.determineColumnsWidth);instance.addHook("afterGetColWidth",htAutoColumnSize.getColWidth);instance.addHook("afterDestroy",htAutoColumnSize.afterDestroy);instance.determineColumnWidth=plugin.determineColumnWidth}else{instance.removeHook("beforeRender",htAutoColumnSize.determineColumnsWidth);instance.removeHook("afterGetColWidth",htAutoColumnSize.getColWidth);instance.removeHook("afterDestroy",htAutoColumnSize.afterDestroy);delete instance.determineColumnWidth;plugin.afterDestroy.call(instance)}};this.determineColumnWidth=function(col){var instance=this,tmp=instance.autoColumnSizeTmp;if(!tmp.container){createTmpContainer.call(tmp,instance)}tmp.container.className=instance.rootElement[0].className+" htAutoColumnSize";tmp.table.className=instance.$table[0].className;var rows=instance.countRows();var samples={};var maxLen=0;for(var r=0;r<rows;r++){var value=Handsontable.helper.stringify(instance.getDataAtCell(r,col));var len=value.length;if(len>maxLen){maxLen=len}if(!samples[len]){samples[len]={needed:sampleCount,strings:[]}}if(samples[len].needed){samples[len].strings.push({value:value,row:r});samples[len].needed--}}var settings=instance.getSettings();if(settings.colHeaders){instance.view.appendColHeader(col,tmp.theadTh)}instance.view.wt.wtDom.empty(tmp.tbody);var cellProperties=instance.getCellMeta(0,col);var renderer=Handsontable.helper.getCellMethod("renderer",cellProperties.renderer);for(var i in samples){if(samples.hasOwnProperty(i)){for(var j=0,jlen=samples[i].strings.length;j<jlen;j++){var tr=document.createElement("tr");var td=document.createElement("td");renderer(instance,td,samples[i].strings[j].row,col,instance.colToProp(col),samples[i].strings[j].value,cellProperties);r++;tr.appendChild(td);tmp.tbody.appendChild(tr)}}}var parent=instance.rootElement[0].parentNode;parent.appendChild(tmp.container);var width=instance.view.wt.wtDom.outerWidth(tmp.container);parent.removeChild(tmp.container);var maxWidth=instance.view.wt.wtViewport.getViewportWidth()-2;if(width>maxWidth){width=maxWidth}return width};this.determineColumnsWidth=function(){var instance=this;var settings=this.getSettings();if(settings.autoColumnSize||!settings.colWidths){var cols=this.countCols();for(var c=0;c<cols;c++){if(!instance._getColWidthFromSettings(c)){this.autoColumnWidths[c]=plugin.determineColumnWidth.call(instance,c)}}}};this.getColWidth=function(col,response){if(this.autoColumnWidths[col]&&this.autoColumnWidths[col]>response.width){response.width=this.autoColumnWidths[col]}};this.afterDestroy=function(){var instance=this;if(instance.autoColumnSizeTmp&&instance.autoColumnSizeTmp.container&&instance.autoColumnSizeTmp.container.parentNode){instance.autoColumnSizeTmp.container.parentNode.removeChild(instance.autoColumnSizeTmp.container)}};function createTmpContainer(instance){var d=document,tmp=this;tmp.table=d.createElement("table");tmp.theadTh=d.createElement("th");tmp.table.appendChild(d.createElement("thead")).appendChild(d.createElement("tr")).appendChild(tmp.theadTh);tmp.tableStyle=tmp.table.style;tmp.tableStyle.tableLayout="auto";tmp.tableStyle.width="auto";tmp.tbody=d.createElement("tbody");tmp.table.appendChild(tmp.tbody);tmp.container=d.createElement("div");tmp.container.className=instance.rootElement[0].className+" hidden";tmp.containerStyle=tmp.container.style;tmp.container.appendChild(tmp.table)}}var htAutoColumnSize=new HandsontableAutoColumnSize();Handsontable.PluginHooks.add("beforeInit",htAutoColumnSize.beforeInit);Handsontable.PluginHooks.add("afterUpdateSettings",htAutoColumnSize.beforeInit)})(Handsontable);function HandsontableColumnSorting(){var plugin=this;this.init=function(source){var instance=this;var sortingSettings=instance.getSettings().columnSorting;var sortingColumn,sortingOrder;instance.sortingEnabled=!!(sortingSettings);if(instance.sortingEnabled){instance.sortIndex=[];var loadedSortingState=loadSortingState.call(instance);if(typeof loadedSortingState!="undefined"){sortingColumn=loadedSortingState.sortColumn;sortingOrder=loadedSortingState.sortOrder}else{sortingColumn=sortingSettings.column;sortingOrder=sortingSettings.sortOrder}plugin.sortByColumn.call(instance,sortingColumn,sortingOrder);instance.sort=function(){var args=Array.prototype.slice.call(arguments);return plugin.sortByColumn.apply(instance,args)};if(typeof instance.getSettings().observeChanges=="undefined"){enableObserveChangesPlugin.call(instance)}if(source=="afterInit"){bindColumnSortingAfterClick.call(instance);instance.addHook("afterCreateRow",plugin.afterCreateRow);instance.addHook("afterRemoveRow",plugin.afterRemoveRow)}}else{delete instance.sort}};this.setSortingColumn=function(col,order){var instance=this;if(typeof col=="undefined"){delete instance.sortColumn;delete instance.sortOrder;return }else{if(instance.sortColumn===col&&typeof order=="undefined"){instance.sortOrder=!instance.sortOrder}else{instance.sortOrder=typeof order!="undefined"?order:true}}instance.sortColumn=col};this.sortByColumn=function(col,order){var instance=this;plugin.setSortingColumn.call(instance,col,order);instance.PluginHooks.run("beforeColumnSort",instance.sortColumn,instance.sortOrder);plugin.sort.call(instance);instance.render();saveSortingState.call(instance);instance.PluginHooks.run("afterColumnSort",instance.sortColumn,instance.sortOrder)};var saveSortingState=function(){var instance=this;var sortingState={};if(typeof instance.sortColumn!="undefined"){sortingState.sortColumn=instance.sortColumn}if(typeof instance.sortOrder!="undefined"){sortingState.sortOrder=instance.sortOrder}if(sortingState.hasOwnProperty("sortColumn")||sortingState.hasOwnProperty("sortOrder")){instance.PluginHooks.run("persistentStateSave","columnSorting",sortingState)}};var loadSortingState=function(){var instance=this;var storedState={};instance.PluginHooks.run("persistentStateLoad","columnSorting",storedState);return storedState.value};var bindColumnSortingAfterClick=function(){var instance=this;instance.rootElement.on("click.handsontable",".columnSorting",function(e){if(instance.view.wt.wtDom.hasClass(e.target,"columnSorting")){var col=getColumn(e.target);plugin.sortByColumn.call(instance,col)}});function countRowHeaders(){var THs=instance.view.TBODY.querySelector("tr").querySelectorAll("th");return THs.length}function getColumn(target){var TH=instance.view.wt.wtDom.closest(target,"TH");return instance.view.wt.wtDom.index(TH)-countRowHeaders()}};function enableObserveChangesPlugin(){var instance=this;instance.registerTimeout("enableObserveChanges",function(){instance.updateSettings({observeChanges:true})},0)}function defaultSort(sortOrder){return function(a,b){if(a[1]===b[1]){return 0}if(a[1]===null){return 1}if(b[1]===null){return -1}if(a[1]<b[1]){return sortOrder?-1:1}if(a[1]>b[1]){return sortOrder?1:-1}return 0}}function dateSort(sortOrder){return function(a,b){if(a[1]===b[1]){return 0}if(a[1]===null){return 1}if(b[1]===null){return -1}var aDate=new Date(a[1]);var bDate=new Date(b[1]);if(aDate<bDate){return sortOrder?-1:1}if(aDate>bDate){return sortOrder?1:-1}return 0}}this.sort=function(){var instance=this;if(typeof instance.sortOrder=="undefined"){return }instance.sortingEnabled=false;instance.sortIndex.length=0;var colOffset=this.colOffset();for(var i=0,ilen=this.countRows()-instance.getSettings()["minSpareRows"];i<ilen;i++){this.sortIndex.push([i,instance.getDataAtCell(i,this.sortColumn+colOffset)])}var colMeta=instance.getCellMeta(0,instance.sortColumn);var sortFunction;switch(colMeta.type){case"date":sortFunction=dateSort;break;default:sortFunction=defaultSort}this.sortIndex.sort(sortFunction(instance.sortOrder));for(var i=this.sortIndex.length;i<instance.countRows();i++){this.sortIndex.push([i,instance.getDataAtCell(i,this.sortColumn+colOffset)])}instance.sortingEnabled=true};this.translateRow=function(row){var instance=this;if(instance.sortingEnabled&&instance.sortIndex&&instance.sortIndex.length){return instance.sortIndex[row][0]}return row};this.onBeforeGetSet=function(getVars){var instance=this;getVars.row=plugin.translateRow.call(instance,getVars.row)};this.untranslateRow=function(row){if(sortingEnabled&&this.sortIndex&&this.sortIndex.length){for(var i=0;i<this.sortIndex.length;i++){if(this.sortIndex[i][0]==row){return i}}}};this.getColHeader=function(col,TH){if(this.getSettings().columnSorting){this.view.wt.wtDom.addClass(TH.querySelector(".colHeader"),"columnSorting")}};function isSorted(instance){return typeof instance.sortColumn!="undefined"}this.afterCreateRow=function(index,amount){var instance=this;if(!isSorted(instance)){return }instance.sortIndex.splice(index,0,[index,instance.getData()[index][this.sortColumn+instance.colOffset()]]);for(var i=0;i<instance.sortIndex.length;i++){if(i==index){continue}if(instance.sortIndex[i][0]>=index){instance.sortIndex[i][0]+=1}}saveSortingState.call(instance)};this.afterRemoveRow=function(index,amount){var instance=this;if(!isSorted(instance)){return }instance.sortIndex.splice(index,amount);for(var i=0;i<instance.sortIndex.length;i++){if(instance.sortIndex[i][0]>index){instance.sortIndex[i][0]-=amount}}saveSortingState.call(instance)};this.afterChangeSort=function(changes){var instance=this;var sortColumnChanged=false;var selection={};if(!changes){return }for(var i=0;i<changes.length;i++){if(changes[i][1]==instance.sortColumn){sortColumnChanged=true;selection.row=plugin.translateRow.call(instance,changes[i][0]);selection.col=changes[i][1];break}}if(sortColumnChanged){setTimeout(function(){plugin.sort.call(instance);instance.render();instance.selectCell(plugin.untranslateRow.call(instance,selection.row),selection.col)},0)}}}var htSortColumn=new HandsontableColumnSorting();Handsontable.PluginHooks.add("afterInit",function(){htSortColumn.init.call(this,"afterInit")});Handsontable.PluginHooks.add("afterUpdateSettings",function(){htSortColumn.init.call(this,"afterUpdateSettings")});Handsontable.PluginHooks.add("beforeGet",htSortColumn.onBeforeGetSet);Handsontable.PluginHooks.add("beforeSet",htSortColumn.onBeforeGetSet);Handsontable.PluginHooks.add("afterGetColHeader",htSortColumn.getColHeader);(function(Handsontable){function init(){var instance=this;var pluginEnabled=!!(instance.getSettings().contextMenu);if(pluginEnabled){createContextMenu.call(instance)}else{destroyContextMenu.call(instance)}}function createContextMenu(){var instance=this,selectorId=instance.rootElement[0].id,allItems={row_above:{name:"Insert row above",disabled:isDisabled},row_below:{name:"Insert row below",disabled:isDisabled},hsep1:"---------",col_left:{name:"Insert column on the left",disabled:isDisabled},col_right:{name:"Insert column on the right",disabled:isDisabled},hsep2:"---------",remove_row:{name:"Remove row",disabled:isDisabled},remove_col:{name:"Remove column",disabled:isDisabled},hsep3:"---------",undo:{name:"Undo",disabled:function(){return !instance.undoRedo||!instance.isUndoAvailable()}},redo:{name:"Redo",disabled:function(){return !instance.undoRedo||!instance.isRedoAvailable()}}},defaultOptions={selector:"#"+selectorId+" table, #"+selectorId+" div",trigger:"right",callback:onContextClick},options={},i,ilen,settings=instance.getSettings();function onContextClick(key){var corners=instance.getSelected();if(!corners){return }var selection={start:new Handsontable.SelectionPoint(),end:new Handsontable.SelectionPoint()};selection.start.row(Math.min(corners[0],corners[2]));selection.start.col(Math.min(corners[1],corners[3]));selection.end.row(Math.max(corners[0],corners[2]));selection.end.col(Math.max(corners[1],corners[3]));switch(key){case"row_above":instance.alter("insert_row",selection.start.row());break;case"row_below":instance.alter("insert_row",selection.end.row()+1);break;case"col_left":instance.alter("insert_col",selection.start.col());break;case"col_right":instance.alter("insert_col",selection.end.col()+1);break;case"remove_row":instance.alter(key,selection.start.row(),(selection.end.row()-selection.start.row())+1);break;case"remove_col":instance.alter(key,selection.start.col(),(selection.end.col()-selection.start.col())+1);break;case"undo":instance.undo();break;case"redo":instance.redo();break}}function isDisabled(key){if(instance.countRows()>=instance.getSettings().maxRows&&(key==="row_above"||key==="row_below")){return true}else{if(instance.countCols()>=instance.getSettings().maxCols&&(key==="col_left"||key==="col_right")){return true}else{return false}}}if(settings.contextMenu===true){options.items=allItems}else{if(Object.prototype.toString.apply(settings.contextMenu)==="[object Array]"){options.items={};for(i=0,ilen=settings.contextMenu.length;i<ilen;i++){var key=settings.contextMenu[i];if(typeof allItems[key]==="undefined"){throw new Error('Context menu key "'+key+'" is not recognised')}options.items[key]=allItems[key]}}else{if(Object.prototype.toString.apply(settings.contextMenu)==="[object Object]"){options=settings.contextMenu;if(options.items){for(i in options.items){if(options.items.hasOwnProperty(i)&&allItems[i]){if(typeof options.items[i]==="string"){options.items[i]=allItems[i]}else{options.items[i]=$.extend(true,allItems[i],options.items[i])}}}}else{options.items=allItems}if(options.callback){var handsontableCallback=defaultOptions.callback;var customCallback=options.callback;options.callback=function(key,options){handsontableCallback(key,options);customCallback(key,options)}}}}}if(!selectorId){throw new Error("Handsontable container must have an id")}$.contextMenu($.extend(true,defaultOptions,options))}function destroyContextMenu(){var id=this.rootElement[0].id;$.contextMenu("destroy","#"+id+" table, #"+id+" div")}Handsontable.PluginHooks.add("afterInit",init);Handsontable.PluginHooks.add("afterUpdateSettings",init);Handsontable.PluginHooks.add("afterDestroy",destroyContextMenu)})(Handsontable);Handsontable.PluginHooks.add("beforeGetCellMeta",function(row,col,cellProperties){var settings=this.getSettings(),data=this.getData(),i,ilen,a;cellProperties.isWritable=!cellProperties.readOnly;if(settings.autoComplete){for(i=0,ilen=settings.autoComplete.length;i<ilen;i++){if(settings.autoComplete[i].match(row,col,data)){if(typeof cellProperties.type==="undefined"){cellProperties.type=Handsontable.AutocompleteCell}else{if(typeof cellProperties.type.renderer==="undefined"){cellProperties.type.renderer=Handsontable.AutocompleteCell.renderer}if(typeof cellProperties.type.editor==="undefined"){cellProperties.type.editor=Handsontable.AutocompleteCell.editor}}for(a in settings.autoComplete[i]){if(settings.autoComplete[i].hasOwnProperty(a)&&a!=="match"&&typeof cellProperties[i]==="undefined"){if(a==="source"){cellProperties[a]=settings.autoComplete[i][a](row,col)}else{cellProperties[a]=settings.autoComplete[i][a]}}}break}}}});function HandsontableManualColumnMove(){var instance,pressed,startCol,endCol,startX,startOffset;var ghost=document.createElement("DIV"),ghostStyle=ghost.style;ghost.className="ghost";ghostStyle.position="absolute";ghostStyle.top="25px";ghostStyle.left=0;ghostStyle.width="10px";ghostStyle.height="10px";ghostStyle.backgroundColor="#CCC";ghostStyle.opacity=0.7;var saveManualColumnPositions=function(){var instance=this;instance.PluginHooks.run("persistentStateSave","manualColumnPositions",instance.manualColumnPositions)};var loadManualColumnPositions=function(){var instance=this;var storedState={};instance.PluginHooks.run("persistentStateLoad","manualColumnPositions",storedState);return storedState.value};var bindMoveColEvents=function(){var instance=this;instance.rootElement.on("mousemove.manualColumnMove",function(e){if(pressed){ghostStyle.left=startOffset+e.pageX-startX+6+"px";if(ghostStyle.display==="none"){ghostStyle.display="block"}}});instance.rootElement.on("mouseup.manualColumnMove",function(){if(pressed){if(startCol<endCol){endCol--}if(instance.getSettings().rowHeaders){startCol--;endCol--}instance.manualColumnPositions.splice(endCol,0,instance.manualColumnPositions.splice(startCol,1)[0]);$(".manualColumnMover.active").removeClass("active");pressed=false;instance.forceFullRender=true;instance.view.render();ghostStyle.display="none";saveManualColumnPositions.call(instance);instance.PluginHooks.run("afterColumnMove",startCol,endCol)}});instance.rootElement.on("mousedown.manualColumnMove",".manualColumnMover",function(e){var mover=e.currentTarget;var TH=instance.view.wt.wtDom.closest(mover,"TH");startCol=instance.view.wt.wtDom.index(TH)+instance.colOffset();pressed=true;startX=e.pageX;var TABLE=instance.$table[0];TABLE.parentNode.appendChild(ghost);ghostStyle.width=instance.view.wt.wtDom.outerWidth(TH)+"px";ghostStyle.height=instance.view.wt.wtDom.outerHeight(TABLE)+"px";startOffset=parseInt(instance.view.wt.wtDom.offset(TH).left-instance.view.wt.wtDom.offset(TABLE).left,10);ghostStyle.left=startOffset+6+"px"});instance.rootElement.on("mouseenter.manualColumnMove","td, th",function(){if(pressed){var active=instance.view.THEAD.querySelector(".manualColumnMover.active");if(active){instance.view.wt.wtDom.removeClass(active,"active")}endCol=instance.view.wt.wtDom.index(this)+instance.colOffset();var THs=instance.view.THEAD.querySelectorAll("th");var mover=THs[endCol].querySelector(".manualColumnMover");instance.view.wt.wtDom.addClass(mover,"active")}});instance.addHook("afterDestroy",unbindMoveColEvents)};var unbindMoveColEvents=function(){var instance=this;instance.rootElement.off("mouseup.manualColumnMove");instance.rootElement.off("mousemove.manualColumnMove");instance.rootElement.off("mousedown.manualColumnMove");instance.rootElement.off("mouseenter.manualColumnMove")};this.beforeInit=function(){this.manualColumnPositions=[]};this.init=function(source){var instance=this;var manualColMoveEnabled=!!(this.getSettings().manualColumnMove);if(manualColMoveEnabled){var initialManualColumnPositions=this.getSettings().manualColumnMove;var loadedManualColumnPositions=loadManualColumnPositions.call(instance);if(typeof loadedManualColumnPositions!="undefined"){this.manualColumnPositions=loadedManualColumnPositions}else{if(initialManualColumnPositions instanceof Array){this.manualColumnPositions=initialManualColumnPositions}else{this.manualColumnPositions=[]}}instance.forceFullRender=true;if(source=="afterInit"){bindMoveColEvents.call(this);if(this.manualColumnPositions.length>0){this.forceFullRender=true;this.render()}}}else{unbindMoveColEvents.call(this);this.manualColumnPositions=[]}};this.modifyCol=function(col){if(this.getSettings().manualColumnMove){if(typeof this.manualColumnPositions[col]==="undefined"){this.manualColumnPositions[col]=col}return this.manualColumnPositions[col]}return col};this.getColHeader=function(col,TH){if(this.getSettings().manualColumnMove){var DIV=document.createElement("DIV");DIV.className="manualColumnMover";TH.firstChild.appendChild(DIV)}}}var htManualColumnMove=new HandsontableManualColumnMove();Handsontable.PluginHooks.add("beforeInit",htManualColumnMove.beforeInit);Handsontable.PluginHooks.add("afterInit",function(){htManualColumnMove.init.call(this,"afterInit")});Handsontable.PluginHooks.add("afterUpdateSettings",function(){htManualColumnMove.init.call(this,"afterUpdateSettings")});Handsontable.PluginHooks.add("afterGetColHeader",htManualColumnMove.getColHeader);Handsontable.PluginHooks.add("modifyCol",htManualColumnMove.modifyCol);function HandsontableManualColumnResize(){var pressed,currentTH,currentCol,currentWidth,instance,newSize,startX,startWidth,startOffset,resizer=document.createElement("DIV"),handle=document.createElement("DIV"),line=document.createElement("DIV"),lineStyle=line.style;resizer.className="manualColumnResizer";handle.className="manualColumnResizerHandle";resizer.appendChild(handle);line.className="manualColumnResizerLine";resizer.appendChild(line);var $document=$(document);$document.mousemove(function(e){if(pressed){currentWidth=startWidth+(e.pageX-startX);newSize=setManualSize(currentCol,currentWidth);resizer.style.left=startOffset+currentWidth+"px"}});$document.mouseup(function(){if(pressed){instance.view.wt.wtDom.removeClass(resizer,"active");pressed=false;if(newSize!=startWidth){instance.forceFullRender=true;instance.view.render();saveManualColumnWidths.call(instance);instance.PluginHooks.run("afterColumnResize",currentCol,newSize)}refreshResizerPosition.call(instance,currentTH)}});var saveManualColumnWidths=function(){var instance=this;instance.PluginHooks.run("persistentStateSave","manualColumnWidths",instance.manualColumnWidths)};var loadManualColumnWidths=function(){var instance=this;var storedState={};instance.PluginHooks.run("persistentStateLoad","manualColumnWidths",storedState);return storedState.value};function refreshResizerPosition(TH){instance=this;currentTH=TH;var col=this.view.wt.wtTable.getCoords(TH)[1];if(col>=0){currentCol=col;var rootOffset=this.view.wt.wtDom.offset(this.rootElement[0]).left;var thOffset=this.view.wt.wtDom.offset(TH).left;startOffset=(thOffset-rootOffset)-6;var thStyle=this.view.wt.wtDom.getComputedStyle(TH);resizer.style.left=startOffset+parseInt(this.view.wt.wtDom.outerWidth(TH),10)+"px";this.rootElement[0].appendChild(resizer)}}function getColumnWidth(TH){var instance=this;var thOffset=instance.view.wt.wtDom.offset(TH).left-instance.view.wt.wtDom.offset(TH).left;var rootOffset=instance.view.wt.wtDom.offset(instance.rootElement[0]).left;var col=instance.view.wt.wtTable.getCoords(TH)[1];var thWidth=instance.getColWidth(col);var maxWidth=instance.view.maximumVisibleElementWidth(thOffset-rootOffset);return Math.min(thWidth,maxWidth)}function refreshLinePosition(){var instance=this;var thBorderWidth=2*parseInt(this.view.wt.wtDom.getComputedStyle(currentTH).borderWidth,10);startWidth=parseInt(this.view.wt.wtDom.outerWidth(currentTH),10);instance.view.wt.wtDom.addClass(resizer,"active");lineStyle.height=instance.view.wt.wtDom.outerHeight(instance.$table[0])+"px";pressed=instance}var bindManualColumnWidthEvents=function(){var instance=this;var dblclick=0;var autoresizeTimeout=null;this.rootElement.on("mouseenter.handsontable","th",function(e){if(!pressed){refreshResizerPosition.call(instance,e.currentTarget)}});this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(){if(autoresizeTimeout==null){autoresizeTimeout=setTimeout(function(){if(dblclick>=2){newSize=instance.determineColumnWidth.call(instance,currentCol);setManualSize(currentCol,newSize);instance.forceFullRender=true;instance.view.render();instance.PluginHooks.run("afterColumnResize",currentCol,newSize)}dblclick=0;autoresizeTimeout=null},500)}dblclick++});this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(e){startX=e.pageX;refreshLinePosition.call(instance);newSize=startWidth})};this.beforeInit=function(){this.manualColumnWidths=[]};this.init=function(source){var instance=this;var manualColumnWidthEnabled=!!(this.getSettings().manualColumnResize);if(manualColumnWidthEnabled){var initialColumnWidths=this.getSettings().manualColumnResize;var loadedManualColumnWidths=loadManualColumnWidths.call(instance);if(typeof loadedManualColumnWidths!="undefined"){this.manualColumnWidths=loadedManualColumnWidths}else{if(initialColumnWidths instanceof Array){this.manualColumnWidths=initialColumnWidths}else{this.manualColumnWidths=[]}}if(source=="afterInit"){bindManualColumnWidthEvents.call(this);instance.forceFullRender=true;instance.render()}}};var setManualSize=function(col,width){width=Math.max(width,20);col=instance.PluginHooks.execute("modifyCol",col);instance.manualColumnWidths[col]=width;return width};this.getColWidth=function(col,response){if(this.getSettings().manualColumnResize&&this.manualColumnWidths[col]){response.width=this.manualColumnWidths[col]}}}var htManualColumnResize=new HandsontableManualColumnResize();Handsontable.PluginHooks.add("beforeInit",htManualColumnResize.beforeInit);Handsontable.PluginHooks.add("afterInit",function(){htManualColumnResize.init.call(this,"afterInit")});Handsontable.PluginHooks.add("afterUpdateSettings",function(){htManualColumnResize.init.call(this,"afterUpdateSettings")});Handsontable.PluginHooks.add("afterGetColWidth",htManualColumnResize.getColWidth);(function HandsontableObserveChanges(){Handsontable.PluginHooks.add("afterLoadData",init);Handsontable.PluginHooks.add("afterUpdateSettings",init);function init(){var instance=this;var pluginEnabled=instance.getSettings().observeChanges;if(!instance.observer&&pluginEnabled){createObserver.call(instance);bindEvents.call(instance)}else{if(!pluginEnabled){destroy.call(instance)}}}function createObserver(){var instance=this;instance.observeChangesActive=true;instance.pauseObservingChanges=function(){instance.observeChangesActive=false};instance.resumeObservingChanges=function(){instance.observeChangesActive=true};instance.observer=jsonpatch.observe(instance.getData(),function(patches){if(instance.observeChangesActive){runHookForOperation.call(instance,patches);instance.render()}instance.runHooks("afterChangesObserved")})}function runHookForOperation(rawPatches){var instance=this;var patches=cleanPatches(rawPatches);for(var i=0,len=patches.length;i<len;i++){var patch=patches[i];var parsedPath=parsePath(patch.path);switch(patch.op){case"add":if(isNaN(parsedPath.col)){instance.runHooks("afterCreateRow",parsedPath.row)}else{instance.runHooks("afterCreateCol",parsedPath.col)}break;case"remove":if(isNaN(parsedPath.col)){instance.runHooks("afterRemoveRow",parsedPath.row,1)}else{instance.runHooks("afterRemoveCol",parsedPath.col,1)}break;case"replace":instance.runHooks("afterChange",[parsedPath.row,parsedPath.col,null,patch.value],"external");break}}function cleanPatches(rawPatches){var patches;patches=removeLengthRelatedPatches(rawPatches);patches=removeMultipleAddOrRemoveColPatches(patches);return patches}function removeMultipleAddOrRemoveColPatches(rawPatches){var newOrRemovedColumns=[];return rawPatches.filter(function(patch){var parsedPath=parsePath(patch.path);if(["add","remove"].indexOf(patch.op)!=-1&&!isNaN(parsedPath.col)){if(newOrRemovedColumns.indexOf(parsedPath.col)!=-1){return false}else{newOrRemovedColumns.push(parsedPath.col)}}return true})}function removeLengthRelatedPatches(rawPatches){return rawPatches.filter(function(patch){return !/[/]length/ig.test(patch.path)})}function parsePath(path){var match=path.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(match[1],10),col:/^\d*$/.test(match[2])?parseInt(match[2],10):match[2]}}}function destroy(){var instance=this;if(instance.observer){destroyObserver.call(instance);unbindEvents.call(instance)}}function destroyObserver(){var instance=this;jsonpatch.unobserve(instance.getData(),instance.observer);delete instance.observeChangesActive;delete instance.pauseObservingChanges;delete instance.resumeObservingChanges}function bindEvents(){var instance=this;instance.addHook("afterDestroy",destroy);instance.addHook("afterCreateRow",afterTableAlter);instance.addHook("afterRemoveRow",afterTableAlter);instance.addHook("afterCreateCol",afterTableAlter);instance.addHook("afterRemoveCol",afterTableAlter);instance.addHook("afterChange",function(changes,source){if(source!="loadData"){afterTableAlter.call(this)}})}function unbindEvents(){var instance=this;instance.removeHook("afterDestroy",destroy);instance.removeHook("afterCreateRow",afterTableAlter);instance.removeHook("afterRemoveRow",afterTableAlter);instance.removeHook("afterCreateCol",afterTableAlter);instance.removeHook("afterRemoveCol",afterTableAlter);instance.removeHook("afterChange",afterTableAlter)}function afterTableAlter(){var instance=this;instance.pauseObservingChanges();instance.addHookOnce("afterChangesObserved",function(){instance.resumeObservingChanges()})}})();function Storage(prefix){var savedKeys;var saveSavedKeys=function(){window.localStorage[prefix+"__persistentStateKeys"]=JSON.stringify(savedKeys)};var loadSavedKeys=function(){var keysJSON=window.localStorage[prefix+"__persistentStateKeys"];var keys=typeof keysJSON=="string"?JSON.parse(keysJSON):void 0;savedKeys=keys?keys:[]};var clearSavedKeys=function(){savedKeys=[];saveSavedKeys()};loadSavedKeys();this.saveValue=function(key,value){window.localStorage[prefix+"_"+key]=JSON.stringify(value);if(savedKeys.indexOf(key)==-1){savedKeys.push(key);saveSavedKeys()}};this.loadValue=function(key,defaultValue){key=typeof key!="undefined"?key:defaultValue;var value=window.localStorage[prefix+"_"+key];return typeof value=="undefined"?void 0:JSON.parse(value)};this.reset=function(key){window.localStorage.removeItem(prefix+"_"+key)};this.resetAll=function(){for(var index=0;index<savedKeys.length;index++){window.localStorage.removeItem(prefix+"_"+savedKeys[index])}clearSavedKeys()}}(function(StorageClass){function HandsontablePersistentState(){var plugin=this;this.init=function(){var instance=this,pluginSettings=instance.getSettings()["persistentState"];plugin.enabled=!!(pluginSettings);if(!plugin.enabled){removeHooks.call(instance);return }if(!instance.storage){instance.storage=new StorageClass(instance.rootElement[0].id)}instance.resetState=plugin.resetValue;addHooks.call(instance)};this.saveValue=function(key,value){var instance=this;instance.storage.saveValue(key,value)};this.loadValue=function(key,saveTo){var instance=this;saveTo.value=instance.storage.loadValue(key)};this.resetValue=function(key){var instance=this;if(typeof key!="undefined"){instance.storage.reset(key)}else{instance.storage.resetAll()}};var hooks={persistentStateSave:plugin.saveValue,persistentStateLoad:plugin.loadValue,persistentStateReset:plugin.resetValue};function addHooks(){var instance=this;for(var hookName in hooks){if(hooks.hasOwnProperty(hookName)&&!hookExists.call(instance,hookName)){instance.PluginHooks.add(hookName,hooks[hookName])}}}function removeHooks(){var instance=this;for(var hookName in hooks){if(hooks.hasOwnProperty(hookName)&&hookExists.call(instance,hookName)){instance.PluginHooks.remove(hookName,hooks[hookName])}}}function hookExists(hookName){var instance=this;return instance.PluginHooks.hooks.persistent.hasOwnProperty(hookName)}}var htPersistentState=new HandsontablePersistentState();Handsontable.PluginHooks.add("beforeInit",htPersistentState.init);Handsontable.PluginHooks.add("afterUpdateSettings",htPersistentState.init)})(Storage);(function(Handsontable){Handsontable.UndoRedo=function(instance){var plugin=this;this.instance=instance;this.doneActions=[];this.undoneActions=[];this.ignoreNewActions=false;instance.addHook("afterChange",function(changes,origin){if(changes){var action=new Handsontable.UndoRedo.ChangeAction(changes);plugin.done(action)}});instance.addHook("afterCreateRow",function(index,amount){var action=new Handsontable.UndoRedo.CreateRowAction(index,amount);plugin.done(action)});instance.addHook("beforeRemoveRow",function(index,amount){var originalData=plugin.instance.getData();index=(originalData.length+index)%originalData.length;var removedData=originalData.slice(index,index+amount);var action=new Handsontable.UndoRedo.RemoveRowAction(index,removedData);plugin.done(action)});instance.addHook("afterCreateCol",function(index,amount){var action=new Handsontable.UndoRedo.CreateColumnAction(index,amount);plugin.done(action)});instance.addHook("beforeRemoveCol",function(index,amount){var originalData=plugin.instance.getData();index=(plugin.instance.countCols()+index)%plugin.instance.countCols();var removedData=[];for(var i=0,len=originalData.length;i<len;i++){removedData[i]=originalData[i].slice(index,index+amount)}var headers;if(Handsontable.helper.isArray(instance.getSettings().colHeaders)){headers=instance.getSettings().colHeaders.slice(index,index+removedData.length)}var action=new Handsontable.UndoRedo.RemoveColumnAction(index,removedData,headers);plugin.done(action)})};Handsontable.UndoRedo.prototype.done=function(action){if(!this.ignoreNewActions){this.doneActions.push(action);this.undoneActions.length=0}};Handsontable.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var action=this.doneActions.pop();this.ignoreNewActions=true;action.undo(this.instance);this.ignoreNewActions=false;this.undoneActions.push(action)}};Handsontable.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var action=this.undoneActions.pop();this.ignoreNewActions=true;action.redo(this.instance);this.ignoreNewActions=true;this.doneActions.push(action)}};Handsontable.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0};Handsontable.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};Handsontable.UndoRedo.prototype.clear=function(){this.doneActions.length=0;this.undoneActions.length=0};Handsontable.UndoRedo.Action=function(){};Handsontable.UndoRedo.Action.prototype.undo=function(){};Handsontable.UndoRedo.Action.prototype.redo=function(){};Handsontable.UndoRedo.ChangeAction=function(changes){this.changes=changes};Handsontable.helper.inherit(Handsontable.UndoRedo.ChangeAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.ChangeAction.prototype.undo=function(instance){var data=$.extend(true,[],this.changes);for(var i=0,len=data.length;i<len;i++){data[i].splice(3,1)}instance.setDataAtRowProp(data,null,null,"undo")};Handsontable.UndoRedo.ChangeAction.prototype.redo=function(instance){var data=$.extend(true,[],this.changes);for(var i=0,len=data.length;i<len;i++){data[i].splice(2,1)}instance.setDataAtRowProp(data,null,null,"redo")};Handsontable.UndoRedo.CreateRowAction=function(index,amount){this.index=index;this.amount=amount};Handsontable.helper.inherit(Handsontable.UndoRedo.CreateRowAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.CreateRowAction.prototype.undo=function(instance){instance.alter("remove_row",this.index,this.amount)};Handsontable.UndoRedo.CreateRowAction.prototype.redo=function(instance){instance.alter("insert_row",this.index+1,this.amount)};Handsontable.UndoRedo.RemoveRowAction=function(index,data){this.index=index;this.data=data};Handsontable.helper.inherit(Handsontable.UndoRedo.RemoveRowAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.RemoveRowAction.prototype.undo=function(instance){var spliceArgs=[this.index,0];Array.prototype.push.apply(spliceArgs,this.data);Array.prototype.splice.apply(instance.getData(),spliceArgs);instance.render()};Handsontable.UndoRedo.RemoveRowAction.prototype.redo=function(instance){instance.alter("remove_row",this.index,this.data.length)};Handsontable.UndoRedo.CreateColumnAction=function(index,amount){this.index=index;this.amount=amount};Handsontable.helper.inherit(Handsontable.UndoRedo.CreateColumnAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.CreateColumnAction.prototype.undo=function(instance){instance.alter("remove_col",this.index,this.amount)};Handsontable.UndoRedo.CreateColumnAction.prototype.redo=function(instance){instance.alter("insert_col",this.index+1,this.amount)};Handsontable.UndoRedo.RemoveColumnAction=function(index,data,headers){this.index=index;this.data=data;this.amount=this.data[0].length;this.headers=headers};Handsontable.helper.inherit(Handsontable.UndoRedo.RemoveColumnAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.RemoveColumnAction.prototype.undo=function(instance){var row,spliceArgs;for(var i=0,len=instance.getData().length;i<len;i++){row=instance.getDataAtRow(i);spliceArgs=[this.index,0];Array.prototype.push.apply(spliceArgs,this.data[i]);Array.prototype.splice.apply(row,spliceArgs)}if(typeof this.headers!="undefined"){spliceArgs=[this.index,0];Array.prototype.push.apply(spliceArgs,this.headers);Array.prototype.splice.apply(instance.getSettings().colHeaders,spliceArgs)}instance.render()};Handsontable.UndoRedo.RemoveColumnAction.prototype.redo=function(instance){instance.alter("remove_col",this.index,this.amount)}})(Handsontable);(function(Handsontable){function init(){var instance=this;var pluginEnabled=typeof instance.getSettings().undo=="undefined"||instance.getSettings().undo;if(pluginEnabled){if(!instance.undoRedo){instance.undoRedo=new Handsontable.UndoRedo(instance);exposeUndoRedoMethods(instance);instance.addHook("beforeKeyDown",onBeforeKeyDown);instance.addHook("afterChange",onAfterChange)}}else{if(instance.undoRedo){delete instance.undoRedo;removeExposedUndoRedoMethods(instance);instance.removeHook("beforeKeyDown",onBeforeKeyDown);instance.removeHook("afterChange",onAfterChange)}}}function onBeforeKeyDown(event){var instance=this;var ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;if(ctrlDown){if(event.keyCode===89||(event.shiftKey&&event.keyCode===90)){instance.undoRedo.redo();event.stopImmediatePropagation()}else{if(event.keyCode===90){instance.undoRedo.undo();event.stopImmediatePropagation()}}}}function onAfterChange(changes,source){var instance=this;if(source=="loadData"){return instance.undoRedo.clear()}}function exposeUndoRedoMethods(instance){instance.undo=function(){return instance.undoRedo.undo()};instance.redo=function(){return instance.undoRedo.redo()};instance.isUndoAvailable=function(){return instance.undoRedo.isUndoAvailable()};instance.isRedoAvailable=function(){return instance.undoRedo.isRedoAvailable()};instance.clearUndo=function(){return instance.undoRedo.clear()}}function removeExposedUndoRedoMethods(instance){delete instance.undo;delete instance.redo;delete instance.isUndoAvailable;delete instance.isRedoAvailable;delete instance.clearUndo}Handsontable.PluginHooks.add("afterInit",init);Handsontable.PluginHooks.add("afterUpdateSettings",init)})(Handsontable);(function($){autoResize.defaults={onResize:function(){},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500};autoResize.cloneCSSProperties=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","padding"];autoResize.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden",overflowX:"hidden",overflowY:"hidden",border:"1px solid black",padding:"0.49em"};autoResize.resizableFilterSelector="textarea,input:not(input[type]),input[type=text],input[type=password]";autoResize.AutoResizer=AutoResizer;$.fn.autoResize=autoResize;function autoResize(config){this.filter(autoResize.resizableFilterSelector).each(function(){new AutoResizer($(this),config)});return this}function AutoResizer(el,config){if(this.clones){return }this.config=$.extend({},autoResize.defaults,config);this.el=el;this.nodeName=el[0].nodeName.toLowerCase();this.previousScrollTop=null;if(config.maxWidth==="original"){config.maxWidth=el.width()}if(config.minWidth==="original"){config.minWidth=el.width()}if(config.maxHeight==="original"){config.maxHeight=el.height()}if(config.minHeight==="original"){config.minHeight=el.height()}if(this.nodeName==="textarea"){el.css({resize:"none",overflowY:"none"})}el.data("AutoResizer",this);this.createClone();this.injectClone();this.bind()}AutoResizer.prototype={bind:function(){var check=$.proxy(function(){this.check();return true},this);this.unbind();this.el.bind("keyup.autoResize",check).bind("change.autoResize",check);this.check(null,true)},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var el=this.el,self=this,config=this.config;this.clones=$();if(config.minHeight!=="original"||config.maxHeight!=="original"){this.hClone=el.clone().height("auto");this.clones=this.clones.add(this.hClone)}if(config.minWidth!=="original"||config.maxWidth!=="original"){this.wClone=$("<div/>").width("auto").css({whiteSpace:"nowrap","float":"left"});this.clones=this.clones.add(this.wClone)}$.each(autoResize.cloneCSSProperties,function(i,p){self.clones.css(p,el.css(p))});this.clones.removeAttr("name").removeAttr("id").attr("tabIndex",-1).css(autoResize.cloneCSSValues).css("overflowY","scroll")},check:function(e,immediate){var config=this.config,wClone=this.wClone,hClone=this.hClone,el=this.el,value=el.val();if(wClone){wClone.text(value);var cloneWidth=wClone.outerWidth(),newWidth=(cloneWidth+config.extraSpace)>=config.minWidth?cloneWidth+config.extraSpace:config.minWidth,currentWidth=el.width();newWidth=Math.min(newWidth,config.maxWidth);if((newWidth<currentWidth&&newWidth>=config.minWidth)||(newWidth>=config.minWidth&&newWidth<=config.maxWidth)){config.onResize.call(el);el.scrollLeft(0);config.animate&&!immediate?el.stop(1,1).animate({width:newWidth},config.animate):el.width(newWidth)}}if(hClone){if(newWidth){hClone.width(newWidth)}hClone.height(0).val(value).scrollTop(10000);var scrollTop=hClone[0].scrollTop+config.extraSpace;if(this.previousScrollTop===scrollTop){return }this.previousScrollTop=scrollTop;if(scrollTop>=config.maxHeight){scrollTop=config.maxHeight}if(scrollTop<config.minHeight){scrollTop=config.minHeight}if(scrollTop==config.maxHeight&&newWidth==config.maxWidth){el.css("overflowY","scroll")}else{el.css("overflowY","hidden")}config.onResize.call(el);config.animate&&!immediate?el.stop(1,1).animate({height:scrollTop},config.animate):el.height(scrollTop)}},destroy:function(){this.unbind();this.el.removeData("AutoResizer");this.clones.remove();delete this.el;delete this.hClone;delete this.wClone;delete this.clones},injectClone:function(){(autoResize.cloneContainer||(autoResize.cloneContainer=$("<arclones/>").appendTo("body"))).empty().append(this.clones)}}})(jQuery);(function(global){function countQuotes(str){return str.split('"').length-1}global.SheetClip={parse:function(str){var r,rlen,rows,arr=[],a=0,c,clen,multiline,last;rows=str.split("\n");if(rows.length>1&&rows[rows.length-1]===""){rows.pop()}for(r=0,rlen=rows.length;r<rlen;r+=1){rows[r]=rows[r].split("\t");for(c=0,clen=rows[r].length;c<clen;c+=1){if(!arr[a]){arr[a]=[]}if(multiline&&c===0){last=arr[a].length-1;arr[a][last]=arr[a][last]+"\n"+rows[r][0];if(multiline&&(countQuotes(rows[r][0])&1)){multiline=false;arr[a][last]=arr[a][last].substring(0,arr[a][last].length-1).replace(/""/g,'"')}}else{if(c===clen-1&&rows[r][c].indexOf('"')===0){arr[a].push(rows[r][c].substring(1).replace(/""/g,'"'));multiline=true}else{arr[a].push(rows[r][c].replace(/""/g,'"'));multiline=false}}}if(!multiline){a+=1}}return arr},stringify:function(arr){var r,rlen,c,clen,str="",val;for(r=0,rlen=arr.length;r<rlen;r+=1){for(c=0,clen=arr[r].length;c<clen;c+=1){if(c>0){str+="\t"}val=arr[r][c];if(typeof val==="string"){if(val.indexOf("\n")>-1){str+='"'+val.replace(/"/g,'""')+'"'}else{str+=val}}else{if(val===null||val===void 0){str+=""}else{str+=val}}}str+="\n"}return str}}}(window));var CopyPaste=(function(){var instance;return{getInstance:function(){if(!instance){instance=new CopyPasteClass()}return instance}}})();function CopyPasteClass(){var that=this,style,parent;this.copyCallbacks=[];this.cutCallbacks=[];this.pasteCallbacks=[];var listenerElement=document.documentElement;parent=document.body;if(document.getElementById("CopyPasteDiv")){this.elDiv=document.getElementById("CopyPasteDiv");this.elTextarea=this.elDiv.firstChild}else{this.elDiv=document.createElement("DIV");this.elDiv.id="CopyPasteDiv";style=this.elDiv.style;style.position="fixed";style.top=0;style.left=0;parent.appendChild(this.elDiv);this.elTextarea=document.createElement("TEXTAREA");this.elTextarea.className="copyPaste";style=this.elTextarea.style;style.width="1px";style.height="1px";this.elDiv.appendChild(this.elTextarea);if(typeof style.opacity!=="undefined"){style.opacity=0}else{
/*@cc_on @if (@_jscript)
       if(typeof style.filter === 'string') {
       style.filter = 'alpha(opacity=0)';
       }
       @end @*/
}}this._bindEvent(listenerElement,"keydown",function(event){var isCtrlDown=false;if(event.metaKey){isCtrlDown=true}else{if(event.ctrlKey&&navigator.userAgent.indexOf("Mac")===-1){isCtrlDown=true}}if(isCtrlDown){if(document.activeElement!==that.elTextarea&&(that.getSelectionText()!=""||["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.nodeName)!=-1)){return }that.selectNodeText(that.elTextarea);setTimeout(function(){that.selectNodeText(that.elTextarea)},0)}if(isCtrlDown&&(event.keyCode===67||event.keyCode===86||event.keyCode===88)){if(event.keyCode===88){setTimeout(function(){that.triggerCut(event)},0)}else{if(event.keyCode===86){setTimeout(function(){that.triggerPaste(event)},0)}}}})}CopyPasteClass.prototype.selectNodeText=function(el){el.select()};CopyPasteClass.prototype.getSelectionText=function(){var text="";if(window.getSelection){text=window.getSelection().toString()}else{if(document.selection&&document.selection.type!="Control"){text=document.selection.createRange().text}}return text};CopyPasteClass.prototype.copyable=function(str){if(typeof str!=="string"&&str.toString===void 0){throw new Error("copyable requires string parameter")}this.elTextarea.value=str};CopyPasteClass.prototype.onCut=function(fn){this.cutCallbacks.push(fn)};CopyPasteClass.prototype.onPaste=function(fn){this.pasteCallbacks.push(fn)};CopyPasteClass.prototype.removeCallback=function(fn){var i,ilen;for(i=0,ilen=this.copyCallbacks.length;i<ilen;i++){if(this.copyCallbacks[i]===fn){this.copyCallbacks.splice(i,1);return true}}for(i=0,ilen=this.cutCallbacks.length;i<ilen;i++){if(this.cutCallbacks[i]===fn){this.cutCallbacks.splice(i,1);return true}}for(i=0,ilen=this.pasteCallbacks.length;i<ilen;i++){if(this.pasteCallbacks[i]===fn){this.pasteCallbacks.splice(i,1);return true}}return false};CopyPasteClass.prototype.triggerCut=function(event){var that=this;if(that.cutCallbacks){setTimeout(function(){for(var i=0,ilen=that.cutCallbacks.length;i<ilen;i++){that.cutCallbacks[i](event)}},50)}};CopyPasteClass.prototype.triggerPaste=function(event,str){var that=this;if(that.pasteCallbacks){setTimeout(function(){var val=(str||that.elTextarea.value).replace(/\n$/,"");for(var i=0,ilen=that.pasteCallbacks.length;i<ilen;i++){that.pasteCallbacks[i](val,event)}},50)}};CopyPasteClass.prototype._bindEvent=(function(){if(window.jQuery){return function(elem,type,cb){$(elem).on(type+".copypaste",cb)}}else{return function(elem,type,cb){elem.addEventListener(type,cb,false)}}})();var jsonpatch;(function(jsonpatch){var objOps={add:function(obj,key){obj[key]=this.value;return true},remove:function(obj,key){delete obj[key];return true},replace:function(obj,key){obj[key]=this.value;return true},move:function(obj,key,tree){var temp={op:"_get",path:this.from};apply(tree,[temp]);apply(tree,[{op:"remove",path:this.from}]);apply(tree,[{op:"add",path:this.path,value:temp.value}]);return true},copy:function(obj,key,tree){var temp={op:"_get",path:this.from};apply(tree,[temp]);apply(tree,[{op:"add",path:this.path,value:temp.value}]);return true},test:function(obj,key){return(JSON.stringify(obj[key])===JSON.stringify(this.value))},_get:function(obj,key){this.value=obj[key]}};var arrOps={add:function(arr,i){arr.splice(i,0,this.value)},remove:function(arr,i){arr.splice(i,1)},replace:function(arr,i){arr[i]=this.value},move:objOps.move,copy:objOps.copy,test:objOps.test,_get:objOps._get};var observeOps={"new":function(patches,path){var patch={op:"add",path:path+"/"+this.name,value:this.object[this.name]};patches.push(patch)},deleted:function(patches,path){var patch={op:"remove",path:path+"/"+this.name};patches.push(patch)},updated:function(patches,path){var patch={op:"replace",path:path+"/"+this.name,value:this.object[this.name]};patches.push(patch)}};function markPaths(observer,node){for(var key in node){if(node.hasOwnProperty(key)){var kid=node[key];if(kid instanceof Object){Object.unobserve(kid,observer);kid.____Path=node.____Path+"/"+key;markPaths(observer,kid)}}}}function clearPaths(observer,node){delete node.____Path;Object.observe(node,observer);for(var key in node){if(node.hasOwnProperty(key)){var kid=node[key];if(kid instanceof Object){clearPaths(observer,kid)}}}}var beforeDict=[];jsonpatch.intervals;function unobserve(root,observer){if(Object.observe){Object.unobserve(root,observer);markPaths(observer,root)}else{clearTimeout(observer.next)}}jsonpatch.unobserve=unobserve;function observe(obj,callback){var patches=[];var root=obj;var observer;if(Object.observe){observer=function(arr){if(!root.___Path){Object.unobserve(root,observer);root.____Path="";markPaths(observer,root);var a=0,alen=arr.length;while(a<alen){if(arr[a].name!="____Path"){observeOps[arr[a].type].call(arr[a],patches,arr[a].object.____Path)}a++}clearPaths(observer,root)}if(callback){callback(patches)}observer.patches=patches;patches=[]}}else{observer={};var mirror;for(var i=0,ilen=beforeDict.length;i<ilen;i++){if(beforeDict[i].obj===obj){mirror=beforeDict[i];break}}if(!mirror){mirror={obj:obj};beforeDict.push(mirror)}mirror.value=JSON.parse(JSON.stringify(obj));if(callback){observer.callback=callback;observer.next=null;var intervals=this.intervals||[100,1000,10000,60000];var currentInterval=0;var dirtyCheck=function(){generate(observer)};var fastCheck=function(){clearTimeout(observer.next);observer.next=setTimeout(function(){dirtyCheck();currentInterval=0;observer.next=setTimeout(slowCheck,intervals[currentInterval++])},0)};var slowCheck=function(){dirtyCheck();if(currentInterval==intervals.length){currentInterval=intervals.length-1}observer.next=setTimeout(slowCheck,intervals[currentInterval++])};if(typeof window!=="undefined"){if(window.addEventListener){window.addEventListener("mousedown",fastCheck);window.addEventListener("mouseup",fastCheck);window.addEventListener("keydown",fastCheck)}else{window.attachEvent("onmousedown",fastCheck);window.attachEvent("onmouseup",fastCheck);window.attachEvent("onkeydown",fastCheck)}}observer.next=setTimeout(slowCheck,intervals[currentInterval++])}}observer.patches=patches;observer.object=obj;return _observe(observer,obj,patches)}jsonpatch.observe=observe;function _observe(observer,obj,patches){if(Object.observe){Object.observe(obj,observer);for(var key in obj){if(obj.hasOwnProperty(key)){var v=obj[key];if(v&&typeof (v)==="object"){_observe(observer,v,patches)}}}}return observer}function generate(observer){if(Object.observe){Object.deliverChangeRecords(observer)}else{var mirror;for(var i=0,ilen=beforeDict.length;i<ilen;i++){if(beforeDict[i].obj===observer.object){mirror=beforeDict[i];break}}_generate(mirror.value,observer.object,observer.patches,"")}var temp=observer.patches;if(temp.length>0){observer.patches=[];if(observer.callback){observer.callback(temp)}}return temp}jsonpatch.generate=generate;var _objectKeys;if(Object.keys){_objectKeys=Object.keys}else{_objectKeys=function(obj){var keys=[];for(var o in obj){if(obj.hasOwnProperty(o)){keys.push(o)}}return keys}}function _generate(mirror,obj,patches,path){var newKeys=_objectKeys(obj);var oldKeys=_objectKeys(mirror);var changed=false;var deleted=false;for(var t=0;t<oldKeys.length;t++){var key=oldKeys[t];var oldVal=mirror[key];if(obj.hasOwnProperty(key)){var newVal=obj[key];if(oldVal instanceof Object){_generate(oldVal,newVal,patches,path+"/"+key)}else{if(oldVal!=newVal){changed=true;patches.push({op:"replace",path:path+"/"+key,value:newVal});mirror[key]=newVal}}}else{patches.push({op:"remove",path:path+"/"+key});delete mirror[key];deleted=true}}if(!deleted&&newKeys.length==oldKeys.length){return }for(var t=0;t<newKeys.length;t++){var key=newKeys[t];if(!mirror.hasOwnProperty(key)){patches.push({op:"add",path:path+"/"+key,value:obj[key]});mirror[key]=JSON.parse(JSON.stringify(obj[key]))}}}var _isArray;if(Array.isArray){_isArray=Array.isArray}else{_isArray=function(obj){return obj.push&&typeof obj.length==="number"}}function apply(tree,patches,listen){var result=false,p=0,plen=patches.length,patch;while(p<plen){patch=patches[p];var keys=patch.path.split("/");var obj=tree;var t=1;var len=keys.length;while(true){if(_isArray(obj)){var index=parseInt(keys[t],10);t++;if(t>=len){result=arrOps[patch.op].call(patch,obj,index,tree);break}obj=obj[index]}else{var key=keys[t];if(key.indexOf("~")!=-1){key=key.replace("~1","/").replace("~0","~")}t++;if(t>=len){result=objOps[patch.op].call(patch,obj,key,tree);break}obj=obj[key]}}p++}return result}jsonpatch.apply=apply})(jsonpatch||(jsonpatch={}));if(typeof exports!=="undefined"){exports.apply=jsonpatch.apply;exports.observe=jsonpatch.observe;exports.unobserve=jsonpatch.unobserve;exports.generate=jsonpatch.generate}function WalkontableBorder(instance,settings){var style;this.instance=instance;this.settings=settings;this.wtDom=this.instance.wtDom;this.main=document.createElement("div");style=this.main.style;style.position="absolute";style.top=0;style.left=0;for(var i=0;i<5;i++){var DIV=document.createElement("DIV");DIV.className="wtBorder "+(settings.className||"");style=DIV.style;style.backgroundColor=settings.border.color;style.height=settings.border.width+"px";style.width=settings.border.width+"px";this.main.appendChild(DIV)}this.top=this.main.childNodes[0];this.left=this.main.childNodes[1];this.bottom=this.main.childNodes[2];this.right=this.main.childNodes[3];this.topStyle=this.top.style;this.leftStyle=this.left.style;this.bottomStyle=this.bottom.style;this.rightStyle=this.right.style;this.corner=this.main.childNodes[4];this.corner.className+=" corner";this.cornerStyle=this.corner.style;this.cornerStyle.width="5px";this.cornerStyle.height="5px";this.cornerStyle.border="2px solid #FFF";this.disappear();if(!instance.wtTable.bordersHolder){instance.wtTable.bordersHolder=document.createElement("div");instance.wtTable.bordersHolder.className="htBorders";instance.wtTable.hider.appendChild(instance.wtTable.bordersHolder)}instance.wtTable.bordersHolder.appendChild(this.main);var down=false;var $body=$(document.body);$body.on("mousedown.walkontable."+instance.guid,function(){down=true});$body.on("mouseup.walkontable."+instance.guid,function(){down=false});$(this.main.childNodes).on("mouseenter",function(event){if(!down||!instance.getSetting("hideBorderOnMouseDownOver")){return }event.preventDefault();event.stopImmediatePropagation();var bounds=this.getBoundingClientRect();var $this=$(this);$this.hide();var isOutside=function(event){if(event.clientY<Math.floor(bounds.top)){return true}if(event.clientY>Math.ceil(bounds.top+bounds.height)){return true}if(event.clientX<Math.floor(bounds.left)){return true}if(event.clientX>Math.ceil(bounds.left+bounds.width)){return true}};$body.on("mousemove.border."+instance.guid,function(event){if(isOutside(event)){$body.off("mousemove.border."+instance.guid);$this.show()}})})}WalkontableBorder.prototype.appear=function(corners){var isMultiple,fromTD,toTD,fromOffset,toOffset,containerOffset,top,minTop,left,minLeft,height,width;if(this.disabled){return }var instance=this.instance,fromRow,fromColumn,toRow,toColumn,hideTop=false,hideLeft=false,hideBottom=false,hideRight=false,i,ilen,s;if(!instance.wtTable.isRowInViewport(corners[0])){hideTop=true}if(!instance.wtTable.isRowInViewport(corners[2])){hideBottom=true}ilen=instance.wtTable.rowStrategy.countVisible();for(i=0;i<ilen;i++){s=instance.wtTable.rowFilter.visibleToSource(i);if(s>=corners[0]&&s<=corners[2]){fromRow=s;break}}for(i=ilen-1;i>=0;i--){s=instance.wtTable.rowFilter.visibleToSource(i);if(s>=corners[0]&&s<=corners[2]){toRow=s;break}}if(hideTop&&hideBottom){hideLeft=true;hideRight=true}else{if(!instance.wtTable.isColumnInViewport(corners[1])){hideLeft=true}if(!instance.wtTable.isColumnInViewport(corners[3])){hideRight=true}ilen=instance.wtTable.columnStrategy.countVisible();for(i=0;i<ilen;i++){s=instance.wtTable.columnFilter.visibleToSource(i);if(s>=corners[1]&&s<=corners[3]){fromColumn=s;break}}for(i=ilen-1;i>=0;i--){s=instance.wtTable.columnFilter.visibleToSource(i);if(s>=corners[1]&&s<=corners[3]){toColumn=s;break}}}if(fromRow!==void 0&&fromColumn!==void 0){isMultiple=(fromRow!==toRow||fromColumn!==toColumn);fromTD=instance.wtTable.getCell([fromRow,fromColumn]);toTD=isMultiple?instance.wtTable.getCell([toRow,toColumn]):fromTD;fromOffset=this.wtDom.offset(fromTD);toOffset=isMultiple?this.wtDom.offset(toTD):fromOffset;containerOffset=this.wtDom.offset(instance.wtTable.TABLE);minTop=fromOffset.top;height=toOffset.top+this.wtDom.outerHeight(toTD)-minTop;minLeft=fromOffset.left;width=toOffset.left+this.wtDom.outerWidth(toTD)-minLeft;top=minTop-containerOffset.top-1;left=minLeft-containerOffset.left-1;var style=this.wtDom.getComputedStyle(fromTD);if(parseInt(style.borderTopWidth,10)>0){top+=1;height-=1}if(parseInt(style.borderLeftWidth,10)>0){left+=1;width-=1}}else{this.disappear();return }if(hideTop){this.topStyle.display="none"}else{this.topStyle.top=top+"px";this.topStyle.left=left+"px";this.topStyle.width=width+"px";this.topStyle.display="block"}if(hideLeft){this.leftStyle.display="none"}else{this.leftStyle.top=top+"px";this.leftStyle.left=left+"px";this.leftStyle.height=height+"px";this.leftStyle.display="block"}var delta=Math.floor(this.settings.border.width/2);if(hideBottom){this.bottomStyle.display="none"}else{this.bottomStyle.top=top+height-delta+"px";this.bottomStyle.left=left+"px";this.bottomStyle.width=width+"px";this.bottomStyle.display="block"}if(hideRight){this.rightStyle.display="none"}else{this.rightStyle.top=top+"px";this.rightStyle.left=left+width-delta+"px";this.rightStyle.height=height+1+"px";this.rightStyle.display="block"}if(hideBottom||hideRight||!this.hasSetting(this.settings.border.cornerVisible)){this.cornerStyle.display="none"}else{this.cornerStyle.top=top+height-4+"px";this.cornerStyle.left=left+width-4+"px";this.cornerStyle.display="block"}};WalkontableBorder.prototype.disappear=function(){this.topStyle.display="none";this.leftStyle.display="none";this.bottomStyle.display="none";this.rightStyle.display="none";this.cornerStyle.display="none"};WalkontableBorder.prototype.hasSetting=function(setting){if(typeof setting==="function"){return setting()}return !!setting};function WalkontableCellFilter(){this.offset=0;this.total=0;this.fixedCount=0}WalkontableCellFilter.prototype.source=function(n){return n};WalkontableCellFilter.prototype.offsetted=function(n){return n+this.offset};WalkontableCellFilter.prototype.unOffsetted=function(n){return n-this.offset};WalkontableCellFilter.prototype.fixed=function(n){if(n<this.fixedCount){return n-this.offset}else{return n}};WalkontableCellFilter.prototype.unFixed=function(n){if(n<this.fixedCount){return n+this.offset}else{return n}};WalkontableCellFilter.prototype.visibleToSource=function(n){return this.source(this.offsetted(this.fixed(n)))};WalkontableCellFilter.prototype.sourceToVisible=function(n){return this.source(this.unOffsetted(this.unFixed(n)))};function WalkontableCellStrategy(){}WalkontableCellStrategy.prototype.getSize=function(index){return this.cellSizes[index]};WalkontableCellStrategy.prototype.getContainerSize=function(proposedSize){return typeof this.containerSizeFn==="function"?this.containerSizeFn(proposedSize):this.containerSizeFn};WalkontableCellStrategy.prototype.countVisible=function(){return this.cellCount};WalkontableCellStrategy.prototype.isLastIncomplete=function(){return this.remainingSize>0};function WalkontableClassNameCache(){this.cache=[]}WalkontableClassNameCache.prototype.add=function(r,c,cls){if(!this.cache[r]){this.cache[r]=[]}if(!this.cache[r][c]){this.cache[r][c]=[]}this.cache[r][c][cls]=true};WalkontableClassNameCache.prototype.test=function(r,c,cls){return(this.cache[r]&&this.cache[r][c]&&this.cache[r][c][cls])};function WalkontableColumnFilter(){this.countTH=0}WalkontableColumnFilter.prototype=new WalkontableCellFilter();WalkontableColumnFilter.prototype.readSettings=function(instance){this.offset=instance.wtSettings.settings.offsetColumn;this.total=instance.getSetting("totalColumns");this.fixedCount=instance.getSetting("fixedColumnsLeft");this.countTH=instance.getSetting("rowHeaders").length};WalkontableColumnFilter.prototype.offsettedTH=function(n){return n-this.countTH};WalkontableColumnFilter.prototype.unOffsettedTH=function(n){return n+this.countTH};WalkontableColumnFilter.prototype.visibleRowHeadedColumnToSourceColumn=function(n){return this.visibleToSource(this.offsettedTH(n))};WalkontableColumnFilter.prototype.sourceColumnToVisibleRowHeadedColumn=function(n){return this.unOffsettedTH(this.sourceToVisible(n))};function WalkontableColumnStrategy(containerSizeFn,sizeAtIndex,strategy){var size,i=0;this.containerSizeFn=containerSizeFn;this.cellSizesSum=0;this.cellSizes=[];this.cellStretch=[];this.cellCount=0;this.remainingSize=0;this.strategy=strategy;while(true){size=sizeAtIndex(i);if(size===void 0){break}if(this.cellSizesSum>=this.getContainerSize(this.cellSizesSum+size)){break}this.cellSizes.push(size);this.cellSizesSum+=size;this.cellCount++;i++}var containerSize=this.getContainerSize(this.cellSizesSum);this.remainingSize=this.cellSizesSum-containerSize}WalkontableColumnStrategy.prototype=new WalkontableCellStrategy();WalkontableColumnStrategy.prototype.getSize=function(index){return this.cellSizes[index]+(this.cellStretch[index]||0)};WalkontableColumnStrategy.prototype.stretch=function(){var containerSize=this.getContainerSize(this.cellSizesSum),i=0;this.remainingSize=this.cellSizesSum-containerSize;this.cellStretch.length=0;if(this.strategy==="all"){if(this.remainingSize<0){var ratio=containerSize/this.cellSizesSum;var newSize;while(i<this.cellCount-1){newSize=Math.floor(ratio*this.cellSizes[i]);this.remainingSize+=newSize-this.cellSizes[i];this.cellStretch[i]=newSize-this.cellSizes[i];i++}this.cellStretch[this.cellCount-1]=-this.remainingSize;this.remainingSize=0}}else{if(this.strategy==="last"){if(this.remainingSize<0){this.cellStretch[this.cellCount-1]=-this.remainingSize;this.remainingSize=0}}}};function Walkontable(settings){var that=this,originalHeaders=[];this.guid="wt_"+(window.Handsontable?Handsontable.helper.randomString():"");this.wtSettings=new WalkontableSettings(this,settings);this.wtDom=new WalkontableDom();this.wtTable=new WalkontableTable(this);this.wtScroll=new WalkontableScroll(this);this.wtScrollbars=new WalkontableScrollbars(this);this.wtViewport=new WalkontableViewport(this);this.wtWheel=new WalkontableWheel(this);this.wtEvent=new WalkontableEvent(this);if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var c=0,clen=this.wtTable.THEAD.childNodes[0].childNodes.length;c<clen;c++){originalHeaders.push(this.wtTable.THEAD.childNodes[0].childNodes[c].innerHTML)}if(!this.getSetting("columnHeaders").length){this.update("columnHeaders",[function(column,TH){that.wtDom.fastInnerText(TH,originalHeaders[column])}])}}this.selections={};var selectionsSettings=this.getSetting("selections");if(selectionsSettings){for(var i in selectionsSettings){if(selectionsSettings.hasOwnProperty(i)){this.selections[i]=new WalkontableSelection(this,selectionsSettings[i])}}}this.drawn=false;this.drawInterrupted=false}Walkontable.prototype.draw=function(selectionsOnly){this.drawInterrupted=false;if(!selectionsOnly&&!this.wtDom.isVisible(this.wtTable.TABLE)){this.drawInterrupted=true;return }this.getSetting("beforeDraw",!selectionsOnly);selectionsOnly=selectionsOnly&&this.getSetting("offsetRow")===this.lastOffsetRow&&this.getSetting("offsetColumn")===this.lastOffsetColumn;if(this.drawn){this.scrollVertical(0);this.scrollHorizontal(0)}this.lastOffsetRow=this.getSetting("offsetRow");this.lastOffsetColumn=this.getSetting("offsetColumn");this.wtTable.draw(selectionsOnly);this.getSetting("onDraw",!selectionsOnly);return this};Walkontable.prototype.update=function(settings,value){return this.wtSettings.update(settings,value)};Walkontable.prototype.scrollVertical=function(delta){return this.wtScroll.scrollVertical(delta)};Walkontable.prototype.scrollHorizontal=function(delta){return this.wtScroll.scrollHorizontal(delta)};Walkontable.prototype.scrollViewport=function(coords){this.wtScroll.scrollViewport(coords);return this};Walkontable.prototype.getViewport=function(){return[this.wtTable.rowFilter.visibleToSource(0),this.wtTable.columnFilter.visibleToSource(0),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]};Walkontable.prototype.getSetting=function(key,param1,param2,param3){return this.wtSettings.getSetting(key,param1,param2,param3)};Walkontable.prototype.hasSetting=function(key){return this.wtSettings.has(key)};Walkontable.prototype.destroy=function(){$(document.body).off("."+this.guid);this.wtScrollbars.destroy();clearTimeout(this.wheelTimeout);clearTimeout(this.dblClickTimeout)};function WalkontableDom(){}WalkontableDom.prototype.closest=function(elem,nodeNames,until){while(elem!=null&&elem!==until){if(elem.nodeType===1&&nodeNames.indexOf(elem.nodeName)>-1){return elem}elem=elem.parentNode}return null};WalkontableDom.prototype.isChildOf=function(child,parent){var node=child.parentNode;while(node!=null){if(node==parent){return true}node=node.parentNode}return false};WalkontableDom.prototype.index=function(elem){var i=0;while(elem=elem.previousSibling){++i}return i};if(document.documentElement.classList){WalkontableDom.prototype.hasClass=function(ele,cls){return ele.classList.contains(cls)};WalkontableDom.prototype.addClass=function(ele,cls){ele.classList.add(cls)};WalkontableDom.prototype.removeClass=function(ele,cls){ele.classList.remove(cls)}}else{WalkontableDom.prototype.hasClass=function(ele,cls){return ele.className.match(new RegExp("(\\s|^)"+cls+"(\\s|$)"))};WalkontableDom.prototype.addClass=function(ele,cls){if(!this.hasClass(ele,cls)){ele.className+=" "+cls}};WalkontableDom.prototype.removeClass=function(ele,cls){if(this.hasClass(ele,cls)){var reg=new RegExp("(\\s|^)"+cls+"(\\s|$)");ele.className=ele.className.replace(reg," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}}WalkontableDom.prototype.removeTextNodes=function(elem,parent){if(elem.nodeType===3){parent.removeChild(elem)}else{if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(elem.nodeName)>-1){var childs=elem.childNodes;for(var i=childs.length-1;i>=0;i--){this.removeTextNodes(childs[i],elem)}}}};WalkontableDom.prototype.empty=function(element){var child;while(child=element.lastChild){element.removeChild(child)}};WalkontableDom.prototype.HTML_CHARACTERS=/(<(.*)>|&(.*);)/;WalkontableDom.prototype.fastInnerHTML=function(element,content){if(this.HTML_CHARACTERS.test(content)){element.innerHTML=content}else{this.fastInnerText(element,content)}};if(document.createTextNode("test").textContent){WalkontableDom.prototype.fastInnerText=function(element,content){var child=element.firstChild;if(child&&child.nodeType===3&&child.nextSibling===null){child.textContent=content}else{this.empty(element);element.appendChild(document.createTextNode(content))}}}else{WalkontableDom.prototype.fastInnerText=function(element,content){var child=element.firstChild;if(child&&child.nodeType===3&&child.nextSibling===null){child.data=content}else{this.empty(element);element.appendChild(document.createTextNode(content))}}}WalkontableDom.prototype.isVisible=function(elem){try{if(!elem.offsetParent){return false}}catch(e){return false}if(elem.offsetWidth>0){return true}var next=elem;while(next!==document.documentElement){if(next===null){return false}else{if(next.nodeType===11){return true}else{if(next.style.display==="none"){return false}}}next=next.parentNode}return true};WalkontableDom.prototype.offset=function(elem){if(this.hasCaptionProblem()&&elem.firstChild&&elem.firstChild.nodeName==="CAPTION"){var box=elem.getBoundingClientRect();return{top:box.top+(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),left:box.left+(window.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0)}}var offsetLeft=elem.offsetLeft,offsetTop=elem.offsetTop,lastElem=elem;while(elem=elem.offsetParent){if(elem===document.body){break}offsetLeft+=elem.offsetLeft;offsetTop+=elem.offsetTop;lastElem=elem}if(lastElem&&lastElem.style.position==="fixed"){offsetLeft+=window.pageXOffset||document.documentElement.scrollLeft;offsetTop+=window.pageYOffset||document.documentElement.scrollTop}return{left:offsetLeft,top:offsetTop}};WalkontableDom.prototype.getComputedStyle=function(elem){return elem.currentStyle||document.defaultView.getComputedStyle(elem)};WalkontableDom.prototype.outerWidth=function(elem){return elem.offsetWidth};WalkontableDom.prototype.outerHeight=function(elem){if(this.hasCaptionProblem()&&elem.firstChild&&elem.firstChild.nodeName==="CAPTION"){return elem.offsetHeight+elem.firstChild.offsetHeight}else{return elem.offsetHeight}};(function(){var hasCaptionProblem;function detectCaptionProblem(){var TABLE=document.createElement("TABLE");TABLE.style.borderSpacing=0;TABLE.style.borderWidth=0;TABLE.style.padding=0;var TBODY=document.createElement("TBODY");TABLE.appendChild(TBODY);TBODY.appendChild(document.createElement("TR"));TBODY.firstChild.appendChild(document.createElement("TD"));TBODY.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var CAPTION=document.createElement("CAPTION");CAPTION.innerHTML="c<br>c<br>c<br>c";CAPTION.style.padding=0;CAPTION.style.margin=0;TABLE.insertBefore(CAPTION,TBODY);document.body.appendChild(TABLE);hasCaptionProblem=(TABLE.offsetHeight<2*TABLE.lastChild.offsetHeight);document.body.removeChild(TABLE)}WalkontableDom.prototype.hasCaptionProblem=function(){if(hasCaptionProblem===void 0){detectCaptionProblem()}return hasCaptionProblem};WalkontableDom.prototype.getCaretPosition=function(el){if(el.selectionStart){return el.selectionStart}else{if(document.selection){el.focus();var r=document.selection.createRange();if(r==null){return 0}var re=el.createTextRange(),rc=re.duplicate();re.moveToBookmark(r.getBookmark());rc.setEndPoint("EndToStart",re);return rc.text.length}}return 0};WalkontableDom.prototype.setCaretPosition=function(el,pos){if(el.setSelectionRange){el.focus();el.setSelectionRange(pos,pos)}else{if(el.createTextRange){var range=el.createTextRange();range.collapse(true);range.moveEnd("character",pos);range.moveStart("character",pos);range.select()}}}})();function WalkontableEvent(instance){var that=this;this.instance=instance;this.wtDom=this.instance.wtDom;var dblClickOrigin=[null,null,null,null];this.instance.dblClickTimeout=null;var onMouseDown=function(event){var cell=that.parentCell(event.target);if(cell.TD&&cell.TD.nodeName==="TD"){if(that.instance.hasSetting("onCellMouseDown")){that.instance.getSetting("onCellMouseDown",event,cell.coords,cell.TD)}}else{if(that.wtDom.hasClass(event.target,"corner")){that.instance.getSetting("onCellCornerMouseDown",event,event.target)}}if(event.button!==2){if(cell.TD&&cell.TD.nodeName==="TD"){dblClickOrigin.shift();dblClickOrigin.push(cell.TD)}else{if(that.wtDom.hasClass(event.target,"corner")){dblClickOrigin.shift();dblClickOrigin.push(event.target)}}}};var lastMouseOver;var onMouseOver=function(event){if(that.instance.hasSetting("onCellMouseOver")){var TABLE=that.instance.wtTable.TABLE;var TD=that.wtDom.closest(event.target,["TD","TH"],TABLE);if(TD&&TD!==lastMouseOver&&that.wtDom.isChildOf(TD,TABLE)){lastMouseOver=TD;if(TD.nodeName==="TD"){that.instance.getSetting("onCellMouseOver",event,that.instance.wtTable.getCoords(TD),TD)}}}};var onMouseUp=function(event){if(event.button!==2){var cell=that.parentCell(event.target);if(cell.TD&&cell.TD.nodeName==="TD"){dblClickOrigin.shift();dblClickOrigin.push(cell.TD)}else{dblClickOrigin.shift();dblClickOrigin.push(event.target)}if(dblClickOrigin[3]!==null&&dblClickOrigin[3]===dblClickOrigin[2]){if(that.instance.dblClickTimeout&&dblClickOrigin[2]===dblClickOrigin[1]&&dblClickOrigin[1]===dblClickOrigin[0]){if(cell.TD){that.instance.getSetting("onCellDblClick",event,cell.coords,cell.TD)}else{if(that.wtDom.hasClass(event.target,"corner")){that.instance.getSetting("onCellCornerDblClick",event,cell.coords,cell.TD)}}clearTimeout(that.instance.dblClickTimeout);that.instance.dblClickTimeout=null}else{clearTimeout(that.instance.dblClickTimeout);that.instance.dblClickTimeout=setTimeout(function(){that.instance.dblClickTimeout=null},500)}}}};$(this.instance.wtTable.parent).on("mousedown",onMouseDown);$(this.instance.wtTable.TABLE).on("mouseover",onMouseOver);$(this.instance.wtTable.parent).on("mouseup",onMouseUp)}WalkontableEvent.prototype.parentCell=function(elem){var cell={};var TABLE=this.instance.wtTable.TABLE;var TD=this.wtDom.closest(elem,["TD","TH"],TABLE);if(TD&&this.wtDom.isChildOf(TD,TABLE)){cell.coords=this.instance.wtTable.getCoords(TD);cell.TD=TD}else{if(this.wtDom.hasClass(elem,"wtBorder")&&this.wtDom.hasClass(elem,"current")&&!this.wtDom.hasClass(elem,"corner")){cell.coords=this.instance.selections.current.selected[0];cell.TD=this.instance.wtTable.getCell(cell.coords)}}return cell};function walkontableRangesIntersect(){var from=arguments[0];var to=arguments[1];for(var i=1,ilen=arguments.length/2;i<ilen;i++){if(from<=arguments[2*i+1]&&to>=arguments[2*i]){return true}}return false}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(elt){var len=this.length>>>0;var from=Number(arguments[1])||0;from=(from<0)?Math.ceil(from):Math.floor(from);if(from<0){from+=len}for(;from<len;from++){if(from in this&&this[from]===elt){return from}}return -1}}window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback,element){return window.setTimeout(callback,1000/60)}})();window.cancelRequestAnimFrame=(function(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout})();if(!window.getComputedStyle){(function(){var elem;var styleObj={getPropertyValue:function getPropertyValue(prop){if(prop=="float"){prop="styleFloat"}return elem.currentStyle[prop.toUpperCase()]||null}};window.getComputedStyle=function(el){elem=el;return styleObj}})()}function WalkontableRowFilter(){}WalkontableRowFilter.prototype=new WalkontableCellFilter();WalkontableRowFilter.prototype.readSettings=function(instance){this.offset=instance.wtSettings.settings.offsetRow;this.total=instance.getSetting("totalRows");this.fixedCount=instance.getSetting("fixedRowsTop")};function WalkontableRowStrategy(containerSizeFn,sizeAtIndex){this.containerSizeFn=containerSizeFn;this.sizeAtIndex=sizeAtIndex;this.cellSizesSum=0;this.cellSizes=[];this.cellCount=0;this.remainingSize=-Infinity}WalkontableRowStrategy.prototype=new WalkontableCellStrategy();WalkontableRowStrategy.prototype.add=function(i,TD,reverse){if(this.remainingSize<0){var size=this.sizeAtIndex(i,TD);if(size===void 0){return }var containerSize=this.getContainerSize(this.cellSizesSum+size);if(reverse){this.cellSizes.unshift(size)}else{this.cellSizes.push(size)}this.cellSizesSum+=size;this.cellCount++;this.remainingSize=this.cellSizesSum-containerSize;if(reverse&&this.remainingSize>0){while(this.cellCount>0&&this.cellSizes[this.cellCount-1]<this.remainingSize){this.cellSizesSum-=this.cellSizes[this.cellCount-1];this.cellCount--;this.cellSizes.length=this.cellCount}}}};WalkontableRowStrategy.prototype.remove=function(){var size=this.cellSizes.pop();this.cellSizesSum-=size;this.cellCount--;this.remainingSize+=size};function WalkontableScroll(instance){this.instance=instance}WalkontableScroll.prototype.scrollVertical=function(delta){if(!this.instance.drawn){throw new Error("scrollVertical can only be called after table was drawn to DOM")}var instance=this.instance,newOffset,offset=instance.getSetting("offsetRow"),fixedCount=instance.getSetting("fixedRowsTop"),total=instance.getSetting("totalRows"),maxSize=instance.wtViewport.getViewportHeight();if(total>0){newOffset=this.scrollLogicVertical(delta,offset,total,fixedCount,maxSize,function(row){if(row-offset<fixedCount&&row-offset>=0){return instance.getSetting("rowHeight",row-offset)}else{return instance.getSetting("rowHeight",row)}},function(isReverse){instance.wtTable.verticalRenderReverse=isReverse})}else{newOffset=0}if(newOffset!==offset){this.instance.wtScrollbars.vertical.scrollTo(newOffset)}return instance};WalkontableScroll.prototype.scrollHorizontal=function(delta){if(!this.instance.drawn){throw new Error("scrollHorizontal can only be called after table was drawn to DOM")}var instance=this.instance,newOffset,offset=instance.getSetting("offsetColumn"),fixedCount=instance.getSetting("fixedColumnsLeft"),total=instance.getSetting("totalColumns"),maxSize=instance.wtViewport.getViewportWidth();if(total>0){newOffset=this.scrollLogicHorizontal(delta,offset,total,fixedCount,maxSize,function(col){if(col-offset<fixedCount&&col-offset>=0){return instance.getSetting("columnWidth",col-offset)}else{return instance.getSetting("columnWidth",col)}})}else{newOffset=0}if(newOffset!==offset){this.instance.wtScrollbars.horizontal.scrollTo(newOffset)}return instance};WalkontableScroll.prototype.scrollLogicVertical=function(delta,offset,total,fixedCount,maxSize,cellSizeFn,setReverseRenderFn){var newOffset=offset+delta;if(newOffset>=total-fixedCount){newOffset=total-fixedCount-1;setReverseRenderFn(true)}if(newOffset<0){newOffset=0}return newOffset};WalkontableScroll.prototype.scrollLogicHorizontal=function(delta,offset,total,fixedCount,maxSize,cellSizeFn){var newOffset=offset+delta,sum=0,col;if(newOffset>fixedCount){if(newOffset>=total-fixedCount){newOffset=total-fixedCount-1}col=newOffset;while(sum<maxSize&&col<total){sum+=cellSizeFn(col);col++}if(sum<maxSize){while(newOffset>0){sum+=cellSizeFn(newOffset-1);if(sum<maxSize){newOffset--}else{break}}}}else{if(newOffset<0){newOffset=0}}return newOffset};WalkontableScroll.prototype.scrollViewport=function(coords){var offsetRow=this.instance.getSetting("offsetRow"),offsetColumn=this.instance.getSetting("offsetColumn"),lastVisibleRow=this.instance.wtTable.getLastVisibleRow(),totalRows=this.instance.getSetting("totalRows"),totalColumns=this.instance.getSetting("totalColumns"),fixedRowsTop=this.instance.getSetting("fixedRowsTop"),fixedColumnsLeft=this.instance.getSetting("fixedColumnsLeft");if(coords[0]<0||coords[0]>totalRows-1){throw new Error("row "+coords[0]+" does not exist")}else{if(coords[1]<0||coords[1]>totalColumns-1){throw new Error("column "+coords[1]+" does not exist")}}if(coords[0]>lastVisibleRow){this.scrollVertical(coords[0]-fixedRowsTop-offsetRow);this.instance.wtTable.verticalRenderReverse=true}else{if(coords[0]===lastVisibleRow&&this.instance.wtTable.rowStrategy.isLastIncomplete()){this.scrollVertical(coords[0]-fixedRowsTop-offsetRow);this.instance.wtTable.verticalRenderReverse=true}else{if(coords[0]-fixedRowsTop<offsetRow){this.scrollVertical(coords[0]-fixedRowsTop-offsetRow)}else{this.scrollVertical(0)}}}if(this.instance.wtTable.isColumnBeforeViewport(coords[1])){this.instance.wtScrollbars.horizontal.scrollTo(coords[1]-fixedColumnsLeft)}else{if(this.instance.wtTable.isColumnAfterViewport(coords[1])||(this.instance.wtTable.getLastVisibleColumn()===coords[1]&&!this.instance.wtTable.isLastColumnFullyVisible())){var sum=0;for(var i=0;i<fixedColumnsLeft;i++){sum+=this.instance.getSetting("columnWidth",i)}var scrollTo=coords[1];sum+=this.instance.getSetting("columnWidth",scrollTo);var available=this.instance.wtViewport.getViewportWidth();if(sum<available){var next=this.instance.getSetting("columnWidth",scrollTo-1);while(sum+next<available&&scrollTo>=fixedColumnsLeft){scrollTo--;sum+=next}}this.instance.wtScrollbars.horizontal.scrollTo(scrollTo-fixedColumnsLeft)}}return this.instance};function WalkontableScrollbar(){}WalkontableScrollbar.prototype.init=function(){var that=this;this.$table=$(this.instance.wtTable.TABLE);this.slider=document.createElement("DIV");this.sliderStyle=this.slider.style;this.sliderStyle.position="absolute";this.sliderStyle.top="0";this.sliderStyle.left="0";this.sliderStyle.display="none";this.slider.className="dragdealer "+this.type;this.handle=document.createElement("DIV");this.handleStyle=this.handle.style;this.handle.className="handle";this.slider.appendChild(this.handle);this.container=this.instance.wtTable.parent;this.container.appendChild(this.slider);var firstRun=true;this.dragTimeout=null;var dragDelta;var dragRender=function(){that.onScroll(dragDelta)};this.dragdealer=new Dragdealer(this.slider,{vertical:(this.type==="vertical"),horizontal:(this.type==="horizontal"),slide:false,speed:100,animationCallback:function(x,y){if(firstRun){firstRun=false;return }that.skipRefresh=true;dragDelta=that.type==="vertical"?y:x;if(that.dragTimeout===null){that.dragTimeout=setInterval(dragRender,100);dragRender()}},callback:function(x,y){that.skipRefresh=false;clearInterval(that.dragTimeout);that.dragTimeout=null;dragDelta=that.type==="vertical"?y:x;that.onScroll(dragDelta)}});this.skipRefresh=false};WalkontableScrollbar.prototype.onScroll=function(delta){if(this.instance.drawn){this.readSettings();if(this.total>this.visibleCount){var newOffset=Math.round(this.handlePosition*this.total/this.sliderSize);if(delta===1){if(this.type==="vertical"){this.instance.scrollVertical(Infinity).draw()}else{this.instance.scrollHorizontal(Infinity).draw()}}else{if(newOffset!==this.offset){if(this.type==="vertical"){this.instance.scrollVertical(newOffset-this.offset).draw()}else{this.instance.scrollHorizontal(newOffset-this.offset).draw()}}else{this.refresh()}}}}};WalkontableScrollbar.prototype.getHandleSizeRatio=function(viewportCount,totalCount){if(!totalCount||viewportCount>totalCount||viewportCount==totalCount){return 1}return 1/totalCount};WalkontableScrollbar.prototype.prepare=function(){if(this.skipRefresh){return }var ratio=this.getHandleSizeRatio(this.visibleCount,this.total);if(((ratio===1||isNaN(ratio))&&this.scrollMode==="auto")||this.scrollMode==="none"){this.visible=false}else{this.visible=true}};WalkontableScrollbar.prototype.refresh=function(){if(this.skipRefresh){return }else{if(!this.visible){this.sliderStyle.display="none";return }}var ratio,sliderSize,handleSize,handlePosition,visibleCount=this.visibleCount,tableWidth=this.instance.wtViewport.getWorkspaceWidth(),tableHeight=this.instance.wtViewport.getWorkspaceHeight();if(tableWidth===Infinity){tableWidth=this.instance.wtViewport.getWorkspaceActualWidth()}if(tableHeight===Infinity){tableHeight=this.instance.wtViewport.getWorkspaceActualHeight()}if(this.type==="vertical"){if(this.instance.wtTable.rowStrategy.isLastIncomplete()){visibleCount--}sliderSize=tableHeight-2;this.sliderStyle.top=this.instance.wtDom.offset(this.$table[0]).top-this.instance.wtDom.offset(this.container).top+"px";this.sliderStyle.left=tableWidth-1+"px";this.sliderStyle.height=Math.max(sliderSize,0)+"px"}else{sliderSize=tableWidth-2;this.sliderStyle.left=this.instance.wtDom.offset(this.$table[0]).left-this.instance.wtDom.offset(this.container).left+"px";this.sliderStyle.top=tableHeight-1+"px";this.sliderStyle.width=Math.max(sliderSize,0)+"px"}ratio=this.getHandleSizeRatio(visibleCount,this.total);handleSize=Math.round(sliderSize*ratio);if(handleSize<10){handleSize=15}handlePosition=Math.floor(sliderSize*(this.offset/this.total));if(handleSize+handlePosition>sliderSize){handlePosition=sliderSize-handleSize}if(this.type==="vertical"){this.handleStyle.height=handleSize+"px";this.handleStyle.top=handlePosition+"px"}else{this.handleStyle.width=handleSize+"px";this.handleStyle.left=handlePosition+"px"}this.sliderStyle.display="block"};WalkontableScrollbar.prototype.destroy=function(){clearInterval(this.dragdealer.interval)};var WalkontableVerticalScrollbar=function(instance){this.instance=instance;this.type="vertical";this.init()};WalkontableVerticalScrollbar.prototype=new WalkontableScrollbar();WalkontableVerticalScrollbar.prototype.scrollTo=function(cell){this.instance.update("offsetRow",cell)};WalkontableVerticalScrollbar.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollV");this.offset=this.instance.getSetting("offsetRow");this.total=this.instance.getSetting("totalRows");this.visibleCount=this.instance.wtTable.rowStrategy.countVisible();if(this.visibleCount>1&&this.instance.wtTable.rowStrategy.isLastIncomplete()){this.visibleCount--}this.handlePosition=parseInt(this.handleStyle.top,10);this.sliderSize=parseInt(this.sliderStyle.height,10);this.fixedCount=this.instance.getSetting("fixedRowsTop")};var WalkontableHorizontalScrollbar=function(instance){this.instance=instance;this.type="horizontal";this.init()};WalkontableHorizontalScrollbar.prototype=new WalkontableScrollbar();WalkontableHorizontalScrollbar.prototype.scrollTo=function(cell){this.instance.update("offsetColumn",cell)};WalkontableHorizontalScrollbar.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollH");this.offset=this.instance.getSetting("offsetColumn");this.total=this.instance.getSetting("totalColumns");this.visibleCount=this.instance.wtTable.columnStrategy.countVisible();if(this.visibleCount>1&&this.instance.wtTable.columnStrategy.isLastIncomplete()){this.visibleCount--}this.handlePosition=parseInt(this.handleStyle.left,10);this.sliderSize=parseInt(this.sliderStyle.width,10);this.fixedCount=this.instance.getSetting("fixedColumnsLeft")};WalkontableHorizontalScrollbar.prototype.getHandleSizeRatio=function(viewportCount,totalCount){if(!totalCount||viewportCount>totalCount||viewportCount==totalCount){return 1}return viewportCount/totalCount};function WalkontableScrollbarNative(){this.lastWindowScrollPosition=NaN}WalkontableScrollbarNative.prototype.init=function(){this.fixedContainer=this.instance.wtTable.TABLE.parentNode.parentNode.parentNode;this.fixed=this.instance.wtTable.TABLE.parentNode.parentNode;this.TABLE=this.instance.wtTable.TABLE;this.$scrollHandler=$(window);var that=this;this.$scrollHandler.on("scroll.walkontable",function(){if(!that.instance.wtTable.parent.parentNode){that.destroy();return }that.onScroll()});this.readSettings()};WalkontableScrollbarNative.prototype.onScroll=function(){this.readSettings();if(this.windowScrollPosition===this.lastWindowScrollPosition){return }this.lastWindowScrollPosition=this.windowScrollPosition;var scrollDelta;var newOffset=0;if(this.windowScrollPosition>this.tableParentOffset){scrollDelta=this.windowScrollPosition-this.tableParentOffset;newOffset=Math.ceil(scrollDelta/20,10);newOffset=Math.min(newOffset,this.total)}this.instance.update("offsetRow",newOffset);this.instance.draw()};WalkontableScrollbarNative.prototype.prepare=function(){};WalkontableScrollbarNative.prototype.availableSize=function(){var availableSize;if(this.windowScrollPosition>this.tableParentOffset){if(this.instance.wtTable.getLastVisibleRow()===this.total-1){availableSize=this.instance.wtDom.outerHeight(this.TABLE)}else{availableSize=this.windowSize}}else{availableSize=this.windowSize-(this.tableParentOffset-this.windowScrollPosition)}return availableSize};WalkontableScrollbarNative.prototype.refresh=function(){var last=this.getLastCell();this.measureBefore=this.offset*this.cellSize;this.measureInside=this.getTableSize();if(last===-1){this.measureAfter=0}else{this.measureAfter=(this.total-last-1)*this.cellSize}this.applyToDOM()};WalkontableScrollbarNative.prototype.destroy=function(){this.$scrollHandler.off("scroll.walkontable")};var WalkontableVerticalScrollbarNative=function(instance){this.instance=instance;this.type="vertical";this.cellSize=20;this.init()};WalkontableVerticalScrollbarNative.prototype=new WalkontableScrollbarNative();WalkontableVerticalScrollbarNative.prototype.getLastCell=function(){return this.instance.wtTable.getLastVisibleRow()};WalkontableVerticalScrollbarNative.prototype.getTableSize=function(){return this.instance.wtDom.outerHeight(this.TABLE)};WalkontableVerticalScrollbarNative.prototype.applyToDOM=function(){if(this.windowScrollPosition>this.tableParentOffset){this.fixed.style.position="fixed";this.fixed.style.top="0";this.fixed.style.left=this.tableParentOtherOffset}else{this.fixed.style.position="relative"}var debug=false;if(debug){}else{this.fixedContainer.style.paddingTop=this.measureBefore+"px";this.fixedContainer.style.paddingBottom=(this.measureInside+this.measureAfter)+"px"}};WalkontableVerticalScrollbarNative.prototype.scrollTo=function(cell){this.$scrollHandler.scrollTop(this.tableParentOffset+cell*this.cellSize)};WalkontableVerticalScrollbarNative.prototype.readSettings=function(){var offset=this.instance.wtDom.offset(this.fixedContainer);this.tableParentOffset=offset.top;this.tableParentOtherOffset=offset.left;this.windowSize=this.$scrollHandler.height();this.windowScrollPosition=this.$scrollHandler.scrollTop();this.offset=this.instance.getSetting("offsetRow");this.total=this.instance.getSetting("totalRows")};var WalkontableHorizontalScrollbarNative=function(instance){this.instance=instance;this.type="horizontal";this.cellSize=50;this.init()};WalkontableHorizontalScrollbarNative.prototype=new WalkontableScrollbarNative();WalkontableHorizontalScrollbarNative.prototype.getLastCell=function(){return this.instance.wtTable.getLastVisibleColumn()};WalkontableHorizontalScrollbarNative.prototype.getTableSize=function(){return this.instance.wtDom.outerWidth(this.TABLE)};WalkontableHorizontalScrollbarNative.prototype.applyToDOM=function(){if(this.windowScrollPosition>this.tableParentOffset){this.fixed.style.position="fixed";this.fixed.style.left="0";this.fixed.style.top=this.tableParentOtherOffset}else{this.fixed.style.position="relative"}var debug=false;if(debug){}else{this.fixedContainer.style.paddingLeft=this.measureBefore+"px";this.fixedContainer.style.paddingRight=(this.measureInside+this.measureAfter)+"px"}};WalkontableHorizontalScrollbarNative.prototype.scrollTo=function(cell){this.$scrollHandler.scrollLeft(this.tableParentOffset+cell*this.cellSize)};WalkontableHorizontalScrollbarNative.prototype.readSettings=function(){var offset=this.instance.wtDom.offset(this.fixedContainer);this.tableParentOffset=offset.left;this.tableParentOtherOffset=offset.top;this.windowSize=this.$scrollHandler.width();this.windowScrollPosition=this.$scrollHandler.scrollLeft();this.offset=this.instance.getSetting("offsetColumn");this.total=this.instance.getSetting("totalColumns")};function WalkontableScrollbars(instance){switch(instance.getSetting("scrollbarModelV")){case"dragdealer":this.vertical=new WalkontableVerticalScrollbar(instance);break;case"native":this.vertical=new WalkontableVerticalScrollbarNative(instance);break}switch(instance.getSetting("scrollbarModelH")){case"dragdealer":this.horizontal=new WalkontableHorizontalScrollbar(instance);break;case"native":this.horizontal=new WalkontableHorizontalScrollbarNative(instance);break}}WalkontableScrollbars.prototype.destroy=function(){this.vertical.destroy();this.horizontal.destroy()};WalkontableScrollbars.prototype.refresh=function(){this.horizontal.readSettings();this.vertical.readSettings();this.horizontal.prepare();this.vertical.prepare();this.horizontal.refresh();this.vertical.refresh()};function WalkontableSelection(instance,settings){this.instance=instance;this.settings=settings;this.selected=[];if(settings.border){this.border=new WalkontableBorder(instance,settings)}}WalkontableSelection.prototype.add=function(coords){this.selected.push(coords)};WalkontableSelection.prototype.clear=function(){this.selected.length=0};WalkontableSelection.prototype.getCorners=function(){var minRow,minColumn,maxRow,maxColumn,i,ilen=this.selected.length;if(ilen>0){minRow=maxRow=this.selected[0][0];minColumn=maxColumn=this.selected[0][1];if(ilen>1){for(i=1;i<ilen;i++){if(this.selected[i][0]<minRow){minRow=this.selected[i][0]}else{if(this.selected[i][0]>maxRow){maxRow=this.selected[i][0]}}if(this.selected[i][1]<minColumn){minColumn=this.selected[i][1]}else{if(this.selected[i][1]>maxColumn){maxColumn=this.selected[i][1]}}}}}return[minRow,minColumn,maxRow,maxColumn]};WalkontableSelection.prototype.draw=function(){var corners,r,c,source_r,source_c;var visibleRows=this.instance.wtTable.rowStrategy.countVisible(),visibleColumns=this.instance.wtTable.columnStrategy.countVisible();if(this.selected.length){corners=this.getCorners();for(r=0;r<visibleRows;r++){for(c=0;c<visibleColumns;c++){source_r=this.instance.wtTable.rowFilter.visibleToSource(r);source_c=this.instance.wtTable.columnFilter.visibleToSource(c);if(source_r>=corners[0]&&source_r<=corners[2]&&source_c>=corners[1]&&source_c<=corners[3]){this.instance.wtTable.currentCellCache.add(r,c,this.settings.className)}else{if(source_r>=corners[0]&&source_r<=corners[2]){this.instance.wtTable.currentCellCache.add(r,c,this.settings.highlightRowClassName)}else{if(source_c>=corners[1]&&source_c<=corners[3]){this.instance.wtTable.currentCellCache.add(r,c,this.settings.highlightColumnClassName)}}}}}this.border&&this.border.appear(corners)}else{this.border&&this.border.disappear()}};function WalkontableSettings(instance,settings){var that=this;this.instance=instance;this.defaults={table:void 0,scrollH:"auto",scrollV:"auto",scrollbarModelH:"dragdealer",scrollbarModelV:"dragdealer",stretchH:"hybrid",currentRowClassName:null,currentColumnClassName:null,data:void 0,offsetRow:0,offsetColumn:0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,width:null,height:null,cellRenderer:function(row,column,TD){var cellData=that.getSetting("data",row,column);that.instance.wtDom.fastInnerText(TD,cellData===void 0||cellData===null?"":cellData)},columnWidth:50,selections:null,hideBorderOnMouseDownOver:false,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,scrollbarWidth:10,scrollbarHeight:10};this.settings={};for(var i in this.defaults){if(this.defaults.hasOwnProperty(i)){if(settings[i]!==void 0){this.settings[i]=settings[i]}else{if(this.defaults[i]===void 0){throw new Error('A required setting "'+i+'" was not provided')}else{this.settings[i]=this.defaults[i]}}}}}WalkontableSettings.prototype.update=function(settings,value){if(value===void 0){for(var i in settings){if(settings.hasOwnProperty(i)){this.settings[i]=settings[i]}}}else{this.settings[settings]=value}return this.instance};WalkontableSettings.prototype.getSetting=function(key,param1,param2,param3){if(this[key]){return this[key](param1,param2,param3)}else{return this._getSetting(key,param1,param2,param3)}};WalkontableSettings.prototype._getSetting=function(key,param1,param2,param3){if(typeof this.settings[key]==="function"){return this.settings[key](param1,param2,param3)}else{if(param1!==void 0&&Object.prototype.toString.call(this.settings[key])==="[object Array]"){return this.settings[key][param1]}else{return this.settings[key]}}};WalkontableSettings.prototype.has=function(key){return !!this.settings[key]};WalkontableSettings.prototype.rowHeight=function(row){var visible_r=this.instance.wtTable.rowFilter.sourceToVisible(row);var size=this.instance.wtTable.rowStrategy.getSize(visible_r);if(size!==void 0){return size}return 20};function WalkontableTable(instance){this.instance=instance;this.TABLE=this.instance.getSetting("table");this.wtDom=this.instance.wtDom;this.wtDom.removeTextNodes(this.TABLE);var parent=this.TABLE.parentNode;if(!parent||parent.nodeType!==1||!this.wtDom.hasClass(parent,"wtHolder")){var spreader=document.createElement("DIV");spreader.className="wtSpreader";if(parent){parent.insertBefore(spreader,this.TABLE)}spreader.appendChild(this.TABLE)}this.spreader=this.TABLE.parentNode;parent=this.spreader.parentNode;if(!parent||parent.nodeType!==1||!this.wtDom.hasClass(parent,"wtHolder")){var hider=document.createElement("DIV");hider.className="wtHider";if(parent){parent.insertBefore(hider,this.spreader)}hider.appendChild(this.spreader)}this.hider=this.spreader.parentNode;this.hiderStyle=this.hider.style;this.hiderStyle.position="relative";parent=this.hider.parentNode;if(!parent||parent.nodeType!==1||!this.wtDom.hasClass(parent,"wtHolder")){var holder=document.createElement("DIV");holder.style.position="relative";holder.className="wtHolder";if(parent){parent.insertBefore(holder,this.hider)}holder.appendChild(this.hider)}this.parent=this.hider.parentNode;this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0];if(!this.TBODY){this.TBODY=document.createElement("TBODY");this.TABLE.appendChild(this.TBODY)}this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0];if(!this.THEAD){this.THEAD=document.createElement("THEAD");this.TABLE.insertBefore(this.THEAD,this.TBODY)}this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0];if(!this.COLGROUP){this.COLGROUP=document.createElement("COLGROUP");this.TABLE.insertBefore(this.COLGROUP,this.THEAD)}if(this.instance.getSetting("columnHeaders").length){if(!this.THEAD.childNodes.length){var TR=document.createElement("TR");this.THEAD.appendChild(TR)}}this.colgroupChildrenLength=this.COLGROUP.childNodes.length;this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0;this.tbodyChildrenLength=this.TBODY.childNodes.length;this.oldCellCache=new WalkontableClassNameCache();this.currentCellCache=new WalkontableClassNameCache();this.rowFilter=new WalkontableRowFilter();this.columnFilter=new WalkontableColumnFilter();this.verticalRenderReverse=false}WalkontableTable.prototype.refreshHiderDimensions=function(){var height=this.instance.wtViewport.getWorkspaceHeight();var width=this.instance.wtViewport.getWorkspaceWidth();var spreaderStyle=this.spreader.style;if(height!==Infinity||width!==Infinity){if(height===Infinity){height=this.instance.wtViewport.getWorkspaceActualHeight()}if(width===Infinity){width=this.instance.wtViewport.getWorkspaceActualWidth()}this.hiderStyle.overflow="hidden";spreaderStyle.position="absolute";spreaderStyle.top="0";spreaderStyle.left="0";if(this.instance.getSetting("scrollbarModelV")==="dragdealer"){spreaderStyle.height="4000px"}if(this.instance.getSetting("scrollbarModelH")==="dragdealer"){spreaderStyle.width="4000px"}if(height<0){height=0}this.hiderStyle.height=height+"px";this.hiderStyle.width=width+"px"}else{spreaderStyle.position="relative";spreaderStyle.width="auto";spreaderStyle.height="auto"}};WalkontableTable.prototype.refreshStretching=function(){var instance=this.instance,stretchH=instance.getSetting("stretchH"),totalRows=instance.getSetting("totalRows"),totalColumns=instance.getSetting("totalColumns"),offsetColumn=instance.getSetting("offsetColumn");var containerWidthFn=function(cacheWidth){return that.instance.wtViewport.getViewportWidth(cacheWidth)};var that=this;var columnWidthFn=function(i){var source_c=that.columnFilter.visibleToSource(i);if(source_c<totalColumns){return instance.getSetting("columnWidth",source_c)}};if(stretchH==="hybrid"){if(offsetColumn>0){stretchH="last"}else{stretchH="none"}}var containerHeightFn=function(cacheHeight){return that.instance.wtViewport.getViewportHeight(cacheHeight)};var rowHeightFn=function(i,TD){var source_r=that.rowFilter.visibleToSource(i);if(source_r<totalRows){if(that.verticalRenderReverse&&i===0){return that.wtDom.outerHeight(TD)-1}else{return that.wtDom.outerHeight(TD)}}};this.columnStrategy=new WalkontableColumnStrategy(containerWidthFn,columnWidthFn,stretchH);this.rowStrategy=new WalkontableRowStrategy(containerHeightFn,rowHeightFn)};WalkontableTable.prototype.adjustAvailableNodes=function(){var displayTds,rowHeaders=this.instance.getSetting("rowHeaders"),displayThs=rowHeaders.length,columnHeaders=this.instance.getSetting("columnHeaders"),TR,TD,c;while(this.colgroupChildrenLength<displayThs){this.COLGROUP.appendChild(document.createElement("COL"));this.colgroupChildrenLength++}this.refreshStretching();displayTds=this.columnStrategy.cellCount;while(this.colgroupChildrenLength<displayTds+displayThs){this.COLGROUP.appendChild(document.createElement("COL"));this.colgroupChildrenLength++}while(this.colgroupChildrenLength>displayTds+displayThs){this.COLGROUP.removeChild(this.COLGROUP.lastChild);this.colgroupChildrenLength--}TR=this.THEAD.firstChild;if(columnHeaders.length){if(!TR){TR=document.createElement("TR");this.THEAD.appendChild(TR)}this.theadChildrenLength=TR.childNodes.length;while(this.theadChildrenLength<displayTds+displayThs){TR.appendChild(document.createElement("TH"));this.theadChildrenLength++}while(this.theadChildrenLength>displayTds+displayThs){TR.removeChild(TR.lastChild);this.theadChildrenLength--}}else{if(TR){this.wtDom.empty(TR)}}for(c=0;c<this.colgroupChildrenLength;c++){if(c<displayThs){this.wtDom.addClass(this.COLGROUP.childNodes[c],"rowHeader")}else{this.wtDom.removeClass(this.COLGROUP.childNodes[c],"rowHeader")}}if(columnHeaders.length){TR=this.THEAD.firstChild;if(displayThs){TD=TR.firstChild;for(c=0;c<displayThs;c++){rowHeaders[c](-displayThs+c,TD);TD=TD.nextSibling}}}for(c=0;c<displayTds;c++){if(columnHeaders.length){columnHeaders[0](this.columnFilter.visibleToSource(c),TR.childNodes[displayThs+c])}}};WalkontableTable.prototype.adjustColumns=function(TR,desiredCount){var count=TR.childNodes.length;while(count<desiredCount){var TD=document.createElement("TD");TR.appendChild(TD);count++}while(count>desiredCount){TR.removeChild(TR.lastChild);count--}};WalkontableTable.prototype.draw=function(selectionsOnly){this.rowFilter.readSettings(this.instance);this.columnFilter.readSettings(this.instance);if(!selectionsOnly){this.tableOffset=this.wtDom.offset(this.TABLE);this._doDraw()}else{this.instance.wtScrollbars.refresh()}this.refreshPositions(selectionsOnly);this.instance.drawn=true;return this};WalkontableTable.prototype._doDraw=function(){var r=0,source_r,c,source_c,offsetRow=this.instance.getSetting("offsetRow"),totalRows=this.instance.getSetting("totalRows"),totalColumns=this.instance.getSetting("totalColumns"),displayTds,rowHeaders=this.instance.getSetting("rowHeaders"),displayThs=rowHeaders.length,TR,TD,TH,adjusted=false,workspaceWidth,mustBeInViewport;if(this.verticalRenderReverse){mustBeInViewport=offsetRow}this.instance.wtViewport.resetSettings();var noPartial=false;if(this.verticalRenderReverse){if(offsetRow===totalRows-this.rowFilter.fixedCount-1){noPartial=true}else{this.instance.update("offsetRow",offsetRow+1);this.rowFilter.readSettings(this.instance)}}if(totalColumns>0){source_r=this.rowFilter.visibleToSource(r);var first=true;while(source_r<totalRows&&source_r>=0){if(r>=this.tbodyChildrenLength||(this.verticalRenderReverse&&r>=this.rowFilter.fixedCount)){TR=document.createElement("TR");for(c=0;c<displayThs;c++){TR.appendChild(document.createElement("TH"))}if(this.verticalRenderReverse&&r>=this.rowFilter.fixedCount){this.TBODY.insertBefore(TR,this.TBODY.childNodes[this.rowFilter.fixedCount]||this.TBODY.firstChild)}else{this.TBODY.appendChild(TR)}this.tbodyChildrenLength++}else{if(r===0){TR=this.TBODY.firstChild}else{TR=TR.nextSibling}}TH=TR.firstChild;for(c=0;c<displayThs;c++){if(TH.nodeName=="TD"){TD=TH;TH=document.createElement("TH");TR.insertBefore(TH,TD);TR.removeChild(TD)}rowHeaders[c](source_r,TH);TH=TH.nextSibling}if(first){first=false;this.adjustAvailableNodes();adjusted=true;displayTds=this.columnStrategy.cellCount;this.adjustColumns(TR,displayTds+displayThs);workspaceWidth=this.instance.wtViewport.getWorkspaceWidth();this.columnStrategy.stretch();for(c=0;c<displayTds;c++){this.COLGROUP.childNodes[c+displayThs].style.width=this.columnStrategy.getSize(c)+"px"}}else{this.adjustColumns(TR,displayTds+displayThs)}for(c=0;c<displayTds;c++){source_c=this.columnFilter.visibleToSource(c);if(c===0){TD=TR.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(source_c)]}else{TD=TD.nextSibling}if(TD.nodeName=="TH"){TH=TD;TD=document.createElement("TD");TR.insertBefore(TD,TH);TR.removeChild(TH)}TD.className="";TD.removeAttribute("style");this.instance.getSetting("cellRenderer",source_r,source_c,TD)}offsetRow=this.instance.getSetting("offsetRow");if(this.verticalRenderReverse&&noPartial){if(-this.wtDom.outerHeight(TR.firstChild)<this.rowStrategy.remainingSize){this.TBODY.removeChild(TR);this.instance.update("offsetRow",offsetRow+1);this.tbodyChildrenLength--;this.rowFilter.readSettings(this.instance);break}else{this.rowStrategy.add(r,TD,this.verticalRenderReverse)}}else{this.rowStrategy.add(r,TD,this.verticalRenderReverse);if(this.rowStrategy.isLastIncomplete()){if(this.verticalRenderReverse&&!this.isRowInViewport(mustBeInViewport)){this.verticalRenderReverse=false;this.instance.update("offsetRow",mustBeInViewport);this.draw();return }break}}if(this.verticalRenderReverse&&r>=this.rowFilter.fixedCount){if(offsetRow===0){break}this.instance.update("offsetRow",offsetRow-1);this.rowFilter.readSettings(this.instance)}else{r++}source_r=this.rowFilter.visibleToSource(r)}}if(!adjusted){this.adjustAvailableNodes()}r=this.rowStrategy.countVisible();while(this.tbodyChildrenLength>r){this.TBODY.removeChild(this.TBODY.lastChild);this.tbodyChildrenLength--}this.instance.wtScrollbars.refresh();if(workspaceWidth!==this.instance.wtViewport.getWorkspaceWidth()){this.columnStrategy.stretch();for(c=0;c<this.columnStrategy.cellCount;c++){this.COLGROUP.childNodes[c+displayThs].style.width=this.columnStrategy.getSize(c)+"px"}}this.verticalRenderReverse=false};WalkontableTable.prototype.refreshPositions=function(selectionsOnly){this.refreshHiderDimensions();this.refreshSelections(selectionsOnly)};WalkontableTable.prototype.refreshSelections=function(selectionsOnly){var vr,r,vc,c,s,slen,classNames=[],visibleRows=this.rowStrategy.countVisible(),visibleColumns=this.columnStrategy.countVisible();this.oldCellCache=this.currentCellCache;this.currentCellCache=new WalkontableClassNameCache();if(this.instance.selections){for(r in this.instance.selections){if(this.instance.selections.hasOwnProperty(r)){this.instance.selections[r].draw();if(this.instance.selections[r].settings.className){classNames.push(this.instance.selections[r].settings.className)}if(this.instance.selections[r].settings.highlightRowClassName){classNames.push(this.instance.selections[r].settings.highlightRowClassName)}if(this.instance.selections[r].settings.highlightColumnClassName){classNames.push(this.instance.selections[r].settings.highlightColumnClassName)}}}}slen=classNames.length;for(vr=0;vr<visibleRows;vr++){for(vc=0;vc<visibleColumns;vc++){r=this.rowFilter.visibleToSource(vr);c=this.columnFilter.visibleToSource(vc);for(s=0;s<slen;s++){if(this.currentCellCache.test(vr,vc,classNames[s])){this.wtDom.addClass(this.getCell([r,c]),classNames[s])}else{if(selectionsOnly&&this.oldCellCache.test(vr,vc,classNames[s])){this.wtDom.removeClass(this.getCell([r,c]),classNames[s])}}}}}};WalkontableTable.prototype.getCell=function(coords){if(this.isRowBeforeViewport(coords[0])){return -1}else{if(this.isRowAfterViewport(coords[0])){return -2}else{if(this.isColumnBeforeViewport(coords[1])){return -3}else{if(this.isColumnAfterViewport(coords[1])){return -4}else{return this.TBODY.childNodes[this.rowFilter.sourceToVisible(coords[0])].childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(coords[1])]}}}}};WalkontableTable.prototype.getCoords=function(TD){return[this.rowFilter.visibleToSource(this.wtDom.index(TD.parentNode)),this.columnFilter.visibleRowHeadedColumnToSourceColumn(TD.cellIndex)]};WalkontableTable.prototype.getLastVisibleRow=function(){return this.rowFilter.visibleToSource(this.rowStrategy.cellCount-1)};WalkontableTable.prototype.getLastVisibleColumn=function(){return this.columnFilter.visibleToSource(this.columnStrategy.cellCount-1)};WalkontableTable.prototype.isRowBeforeViewport=function(r){return(this.rowFilter.sourceToVisible(r)<this.rowFilter.fixedCount&&r>=this.rowFilter.fixedCount)};WalkontableTable.prototype.isRowAfterViewport=function(r){return(r>this.getLastVisibleRow())};WalkontableTable.prototype.isColumnBeforeViewport=function(c){return(this.columnFilter.sourceToVisible(c)<this.columnFilter.fixedCount&&c>=this.columnFilter.fixedCount)};WalkontableTable.prototype.isColumnAfterViewport=function(c){return(c>this.getLastVisibleColumn())};WalkontableTable.prototype.isRowInViewport=function(r){return(!this.isRowBeforeViewport(r)&&!this.isRowAfterViewport(r))};WalkontableTable.prototype.isColumnInViewport=function(c){return(!this.isColumnBeforeViewport(c)&&!this.isColumnAfterViewport(c))};WalkontableTable.prototype.isLastRowFullyVisible=function(){return(this.getLastVisibleRow()===this.instance.getSetting("totalRows")-1&&!this.rowStrategy.isLastIncomplete())};WalkontableTable.prototype.isLastColumnFullyVisible=function(){return(this.getLastVisibleColumn()===this.instance.getSetting("totalColumns")-1&&!this.columnStrategy.isLastIncomplete())};function WalkontableViewport(instance){this.instance=instance;this.resetSettings()}WalkontableViewport.prototype.getWorkspaceHeight=function(proposedHeight){var height=this.instance.getSetting("height");if(height===Infinity||height===void 0||height===null||height<1){if(this.instance.wtScrollbars.vertical instanceof WalkontableScrollbarNative){height=this.instance.wtScrollbars.vertical.availableSize()}else{height=Infinity}}if(height!==Infinity){if(proposedHeight>=height){height-=this.instance.getSetting("scrollbarHeight")}else{if(this.instance.wtScrollbars.horizontal.visible){height-=this.instance.getSetting("scrollbarHeight")}}}return height};WalkontableViewport.prototype.getWorkspaceWidth=function(proposedWidth){var width=this.instance.getSetting("width");if(width===Infinity||width===void 0||width===null||width<1){if(this.instance.wtScrollbars.horizontal instanceof WalkontableScrollbarNative){width=this.instance.wtScrollbars.horizontal.availableSize()}else{width=Infinity}}if(width!==Infinity){if(proposedWidth>=width){width-=this.instance.getSetting("scrollbarWidth")}else{if(this.instance.wtScrollbars.vertical.visible){width-=this.instance.getSetting("scrollbarWidth")}}}return width};WalkontableViewport.prototype.getWorkspaceActualHeight=function(){return this.instance.wtDom.outerHeight(this.instance.wtTable.TABLE)};WalkontableViewport.prototype.getWorkspaceActualWidth=function(){return this.instance.wtDom.outerWidth(this.instance.wtTable.TABLE)||this.instance.wtDom.outerWidth(this.instance.wtTable.TBODY)||this.instance.wtDom.outerWidth(this.instance.wtTable.THEAD)};WalkontableViewport.prototype.getViewportHeight=function(proposedHeight){var containerHeight=this.getWorkspaceHeight(proposedHeight);if(containerHeight===Infinity){return containerHeight}if(isNaN(this.columnHeaderHeight)){var cellOffset=this.instance.wtDom.offset(this.instance.wtTable.TBODY),tableOffset=this.instance.wtTable.tableOffset;this.columnHeaderHeight=cellOffset.top-tableOffset.top}if(this.columnHeaderHeight>0){return containerHeight-this.columnHeaderHeight}else{return containerHeight}};WalkontableViewport.prototype.getViewportWidth=function(proposedWidth){var containerWidth=this.getWorkspaceWidth(proposedWidth);if(containerWidth===Infinity){return containerWidth}if(isNaN(this.rowHeaderWidth)){var TR=this.instance.wtTable.TBODY?this.instance.wtTable.TBODY.firstChild:null;if(TR){var TD=TR.firstChild;this.rowHeaderWidth=0;while(TD&&TD.nodeName==="TH"){this.rowHeaderWidth+=this.instance.wtDom.outerWidth(TD);TD=TD.nextSibling}}}if(this.rowHeaderWidth>0){return containerWidth-this.rowHeaderWidth}else{return containerWidth}};WalkontableViewport.prototype.resetSettings=function(){this.rowHeaderWidth=NaN;this.columnHeaderHeight=NaN};function WalkontableWheel(instance){if(instance.getSetting("scrollbarModelV")==="native"||instance.getSetting("scrollbarModelH")==="native"){return }$(instance.wtTable.spreader).on("mousewheel",function(event,delta,deltaX,deltaY){if(!deltaX&&!deltaY&&delta){deltaY=delta}if(!deltaX&&!deltaY){return }if(deltaY>0&&instance.getSetting("offsetRow")===0){return }else{if(deltaY<0&&instance.wtTable.isLastRowFullyVisible()){return }else{if(deltaX<0&&instance.getSetting("offsetColumn")===0){return }else{if(deltaX>0&&instance.wtTable.isLastColumnFullyVisible()){return }}}}clearTimeout(instance.wheelTimeout);instance.wheelTimeout=setTimeout(function(){if(deltaY){if(instance.wtScrollbars.vertical.visible){instance.scrollVertical(-Math.ceil(deltaY)).draw()}}else{if(deltaX){if(instance.wtScrollbars.horizontal.visible){instance.scrollHorizontal(Math.ceil(deltaX)).draw()}}}},0);event.preventDefault()})}var Cursor={x:0,y:0,init:function(){this.setEvent("mouse");this.setEvent("touch")},setEvent:function(type){var moveHandler=document["on"+type+"move"]||function(){};document["on"+type+"move"]=function(e){moveHandler(e);Cursor.refresh(e)}},refresh:function(e){if(!e){e=window.event}if(e.type=="mousemove"){this.set(e)}else{if(e.touches){this.set(e.touches[0])}}},set:function(e){if(e.pageX||e.pageY){this.x=e.pageX;this.y=e.pageY}else{if(e.clientX||e.clientY){this.x=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;this.y=e.clientY+document.body.scrollTop+document.documentElement.scrollTop}}}};Cursor.init();var Position={get:function(obj){var curtop=0,curleft=0;if(obj.offsetParent){do{curleft+=obj.offsetLeft;curtop+=obj.offsetTop}while((obj=obj.offsetParent))}return[curleft,curtop]}};var Dragdealer=function(wrapper,options){if(typeof (wrapper)=="string"){wrapper=document.getElementById(wrapper)}if(!wrapper){return }var handle=wrapper.getElementsByTagName("div")[0];if(!handle||handle.className.search(/(^|\s)handle(\s|$)/)==-1){return }this.init(wrapper,handle,options||{});this.setup()};Dragdealer.prototype={init:function(wrapper,handle,options){this.wrapper=wrapper;this.handle=handle;this.options=options;this.disabled=this.getOption("disabled",false);this.horizontal=this.getOption("horizontal",true);this.vertical=this.getOption("vertical",false);this.slide=this.getOption("slide",true);this.steps=this.getOption("steps",0);this.snap=this.getOption("snap",false);this.loose=this.getOption("loose",false);this.speed=this.getOption("speed",10)/100;this.xPrecision=this.getOption("xPrecision",0);this.yPrecision=this.getOption("yPrecision",0);this.callback=options.callback||null;this.animationCallback=options.animationCallback||null;this.bounds={left:options.left||0,right:-(options.right||0),top:options.top||0,bottom:-(options.bottom||0),x0:0,x1:0,xRange:0,y0:0,y1:0,yRange:0};this.value={prev:[-1,-1],current:[options.x||0,options.y||0],target:[options.x||0,options.y||0]};this.offset={wrapper:[0,0],mouse:[0,0],prev:[-999999,-999999],current:[0,0],target:[0,0]};this.change=[0,0];this.activity=false;this.dragging=false;this.tapping=false},getOption:function(name,defaultValue){return this.options[name]!==undefined?this.options[name]:defaultValue},setup:function(){this.setWrapperOffset();this.setBoundsPadding();this.setBounds();this.setSteps();this.addListeners()},setWrapperOffset:function(){this.offset.wrapper=Position.get(this.wrapper)},setBoundsPadding:function(){if(!this.bounds.left&&!this.bounds.right){this.bounds.left=Position.get(this.handle)[0]-this.offset.wrapper[0];this.bounds.right=-this.bounds.left}if(!this.bounds.top&&!this.bounds.bottom){this.bounds.top=Position.get(this.handle)[1]-this.offset.wrapper[1];this.bounds.bottom=-this.bounds.top}},setBounds:function(){this.bounds.x0=this.bounds.left;this.bounds.x1=this.wrapper.offsetWidth+this.bounds.right;this.bounds.xRange=(this.bounds.x1-this.bounds.x0)-this.handle.offsetWidth;this.bounds.y0=this.bounds.top;this.bounds.y1=this.wrapper.offsetHeight+this.bounds.bottom;this.bounds.yRange=(this.bounds.y1-this.bounds.y0)-this.handle.offsetHeight;this.bounds.xStep=1/(this.xPrecision||Math.max(this.wrapper.offsetWidth,this.handle.offsetWidth));this.bounds.yStep=1/(this.yPrecision||Math.max(this.wrapper.offsetHeight,this.handle.offsetHeight))},setSteps:function(){if(this.steps>1){this.stepRatios=[];for(var i=0;i<=this.steps-1;i++){this.stepRatios[i]=i/(this.steps-1)}}},addListeners:function(){var self=this;this.wrapper.onselectstart=function(){return false};this.handle.onmousedown=this.handle.ontouchstart=function(e){self.handleDownHandler(e)};this.wrapper.onmousedown=this.wrapper.ontouchstart=function(e){self.wrapperDownHandler(e)};var mouseUpHandler=document.onmouseup||function(){};document.onmouseup=function(e){mouseUpHandler(e);self.documentUpHandler(e)};var touchEndHandler=document.ontouchend||function(){};document.ontouchend=function(e){touchEndHandler(e);self.documentUpHandler(e)};var resizeHandler=window.onresize||function(){};window.onresize=function(e){resizeHandler(e);self.documentResizeHandler(e)};this.wrapper.onmousemove=function(e){self.activity=true};this.wrapper.onclick=function(e){return !self.activity};this.interval=setInterval(function(){self.animate()},25);self.animate(false,true)},handleDownHandler:function(e){this.activity=false;Cursor.refresh(e);this.preventDefaults(e,true);this.startDrag()},wrapperDownHandler:function(e){Cursor.refresh(e);this.preventDefaults(e,true);this.startTap()},documentUpHandler:function(e){this.stopDrag();this.stopTap()},documentResizeHandler:function(e){this.setWrapperOffset();this.setBounds();this.update()},enable:function(){this.disabled=false;this.handle.className=this.handle.className.replace(/\s?disabled/g,"")},disable:function(){this.disabled=true;this.handle.className+=" disabled"},setStep:function(x,y,snap){this.setValue(this.steps&&x>1?(x-1)/(this.steps-1):0,this.steps&&y>1?(y-1)/(this.steps-1):0,snap)},setValue:function(x,y,snap){this.setTargetValue([x,y||0]);if(snap){this.groupCopy(this.value.current,this.value.target)}},startTap:function(target){if(this.disabled){return }this.tapping=true;this.setWrapperOffset();this.setBounds();if(target===undefined){target=[Cursor.x-this.offset.wrapper[0]-(this.handle.offsetWidth/2),Cursor.y-this.offset.wrapper[1]-(this.handle.offsetHeight/2)]}this.setTargetOffset(target)},stopTap:function(){if(this.disabled||!this.tapping){return }this.tapping=false;this.setTargetValue(this.value.current);this.result()},startDrag:function(){if(this.disabled){return }this.setWrapperOffset();this.setBounds();this.offset.mouse=[Cursor.x-Position.get(this.handle)[0],Cursor.y-Position.get(this.handle)[1]];this.dragging=true},stopDrag:function(){if(this.disabled||!this.dragging){return }this.dragging=false;var target=this.groupClone(this.value.current);if(this.slide){var ratioChange=this.change;target[0]+=ratioChange[0]*4;target[1]+=ratioChange[1]*4}this.setTargetValue(target);this.result()},feedback:function(){var value=this.value.current;if(this.snap&&this.steps>1){value=this.getClosestSteps(value)}if(!this.groupCompare(value,this.value.prev)){if(typeof (this.animationCallback)=="function"){this.animationCallback(value[0],value[1])}this.groupCopy(this.value.prev,value)}},result:function(){if(typeof (this.callback)=="function"){this.callback(this.value.target[0],this.value.target[1])}},animate:function(direct,first){if(direct&&!this.dragging){return }if(this.dragging){var prevTarget=this.groupClone(this.value.target);var offset=[Cursor.x-this.offset.wrapper[0]-this.offset.mouse[0],Cursor.y-this.offset.wrapper[1]-this.offset.mouse[1]];this.setTargetOffset(offset,this.loose);this.change=[this.value.target[0]-prevTarget[0],this.value.target[1]-prevTarget[1]]}if(this.dragging||first){this.groupCopy(this.value.current,this.value.target)}if(this.dragging||this.glide()||first){this.update();this.feedback()}},glide:function(){var diff=[this.value.target[0]-this.value.current[0],this.value.target[1]-this.value.current[1]];if(!diff[0]&&!diff[1]){return false}if(Math.abs(diff[0])>this.bounds.xStep||Math.abs(diff[1])>this.bounds.yStep){this.value.current[0]+=diff[0]*this.speed;this.value.current[1]+=diff[1]*this.speed}else{this.groupCopy(this.value.current,this.value.target)}return true},update:function(){if(!this.snap){this.offset.current=this.getOffsetsByRatios(this.value.current)}else{this.offset.current=this.getOffsetsByRatios(this.getClosestSteps(this.value.current))}this.show()},show:function(){if(!this.groupCompare(this.offset.current,this.offset.prev)){if(this.horizontal){this.handle.style.left=String(this.offset.current[0])+"px"}if(this.vertical){this.handle.style.top=String(this.offset.current[1])+"px"}this.groupCopy(this.offset.prev,this.offset.current)}},setTargetValue:function(value,loose){var target=loose?this.getLooseValue(value):this.getProperValue(value);this.groupCopy(this.value.target,target);this.offset.target=this.getOffsetsByRatios(target)},setTargetOffset:function(offset,loose){var value=this.getRatiosByOffsets(offset);var target=loose?this.getLooseValue(value):this.getProperValue(value);this.groupCopy(this.value.target,target);this.offset.target=this.getOffsetsByRatios(target)},getLooseValue:function(value){var proper=this.getProperValue(value);return[proper[0]+((value[0]-proper[0])/4),proper[1]+((value[1]-proper[1])/4)]},getProperValue:function(value){var proper=this.groupClone(value);proper[0]=Math.max(proper[0],0);proper[1]=Math.max(proper[1],0);proper[0]=Math.min(proper[0],1);proper[1]=Math.min(proper[1],1);if((!this.dragging&&!this.tapping)||this.snap){if(this.steps>1){proper=this.getClosestSteps(proper)}}return proper},getRatiosByOffsets:function(group){return[this.getRatioByOffset(group[0],this.bounds.xRange,this.bounds.x0),this.getRatioByOffset(group[1],this.bounds.yRange,this.bounds.y0)]},getRatioByOffset:function(offset,range,padding){return range?(offset-padding)/range:0},getOffsetsByRatios:function(group){return[this.getOffsetByRatio(group[0],this.bounds.xRange,this.bounds.x0),this.getOffsetByRatio(group[1],this.bounds.yRange,this.bounds.y0)]},getOffsetByRatio:function(ratio,range,padding){return Math.round(ratio*range)+padding},getClosestSteps:function(group){return[this.getClosestStep(group[0]),this.getClosestStep(group[1])]},getClosestStep:function(value){var k=0;var min=1;for(var i=0;i<=this.steps-1;i++){if(Math.abs(this.stepRatios[i]-value)<min){min=Math.abs(this.stepRatios[i]-value);k=i}}return this.stepRatios[k]},groupCompare:function(a,b){return a[0]==b[0]&&a[1]==b[1]},groupCopy:function(a,b){a[0]=b[0];a[1]=b[1]},groupClone:function(a){return[a[0],a[1]]},preventDefaults:function(e,selection){if(!e){e=window.event}if(e.preventDefault){e.preventDefault()}e.returnValue=false;if(selection&&document.selection){document.selection.empty()}},cancelEvent:function(e){if(!e){e=window.event}if(e.stopPropagation){e.stopPropagation()}e.cancelBubble=true}};if(!jQuery.browser){(function(){var matched,browser;jQuery.uaMatch=function(ua){ua=ua.toLowerCase();var match=/(chrome)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[];return{browser:match[1]||"",version:match[2]||"0"}};matched=jQuery.uaMatch(navigator.userAgent);browser={};if(matched.browser){browser[matched.browser]=true;browser.version=matched.version}if(browser.chrome){browser.webkit=true}else{if(browser.webkit){browser.safari=true}}jQuery.browser=browser})();
/* Copyright (c) 2013 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.1.3
 *
 * Requires: 1.2.2+
 */
}(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{if(typeof exports==="object"){module.exports=factory}else{factory(jQuery)}}}(function($){var toFix=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"];var toBind="onwheel" in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];var lowestDelta,lowestDeltaXY;if($.event.fixHooks){for(var i=toFix.length;i;){$.event.fixHooks[toFix[--i]]=$.event.mouseHooks}}$.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var i=toBind.length;i;){this.addEventListener(toBind[--i],handler,false)}}else{this.onmousewheel=handler}},teardown:function(){if(this.removeEventListener){for(var i=toBind.length;i;){this.removeEventListener(toBind[--i],handler,false)}}else{this.onmousewheel=null}}};$.fn.extend({mousewheel:function(fn){return fn?this.bind("mousewheel",fn):this.trigger("mousewheel")},unmousewheel:function(fn){return this.unbind("mousewheel",fn)}});function handler(event){var orgEvent=event||window.event,args=[].slice.call(arguments,1),delta=0,deltaX=0,deltaY=0,absDelta=0,absDeltaXY=0,fn;event=$.event.fix(orgEvent);event.type="mousewheel";if(orgEvent.wheelDelta){delta=orgEvent.wheelDelta}if(orgEvent.detail){delta=orgEvent.detail*-1}if(orgEvent.deltaY){deltaY=orgEvent.deltaY*-1;delta=deltaY}if(orgEvent.deltaX){deltaX=orgEvent.deltaX;delta=deltaX*-1}if(orgEvent.wheelDeltaY!==undefined){deltaY=orgEvent.wheelDeltaY}if(orgEvent.wheelDeltaX!==undefined){deltaX=orgEvent.wheelDeltaX*-1}absDelta=Math.abs(delta);if(!lowestDelta||absDelta<lowestDelta){lowestDelta=absDelta}absDeltaXY=Math.max(Math.abs(deltaY),Math.abs(deltaX));if(!lowestDeltaXY||absDeltaXY<lowestDeltaXY){lowestDeltaXY=absDeltaXY}fn=delta>0?"floor":"ceil";delta=Math[fn](delta/lowestDelta);deltaX=Math[fn](deltaX/lowestDeltaXY);deltaY=Math[fn](deltaY/lowestDeltaXY);args.unshift(event,delta,deltaX,deltaY);return($.event.dispatch||$.event.handle).apply(this,args)}}));if(!Array.prototype.filter){Array.prototype.filter=function(fun,thisp){if(typeof this==="undefined"||this===null){throw new TypeError()}if(typeof fun!=="function"){throw new TypeError()}thisp=thisp||this;if(isNodeList(thisp)){thisp=convertNodeListToArray(thisp)}var len=thisp.length,res=[],i,val;for(i=0;i<len;i+=1){if(thisp.hasOwnProperty(i)){val=thisp[i];if(fun.call(thisp,val,i,thisp)){res.push(val)}}}return res;function isNodeList(object){return/NodeList/i.test(object.item)}function convertNodeListToArray(nodeList){var array=[];for(var i=0,len=nodeList.length;i<len;i++){array[i]=nodeList[i]}return array}}}})(jQuery,window,Handsontable);!function(B){var C=function(E,D){this.$element=B(E);this.options=B.extend({},B.fn.typeahead.defaults,D);this.matcher=this.options.matcher||this.matcher;this.sorter=this.options.sorter||this.sorter;this.highlighter=this.options.highlighter||this.highlighter;this.updater=this.options.updater||this.updater;this.source=this.options.source;this.$menu=B(this.options.menu);this.shown=false;this.listen()};C.prototype={constructor:C,select:function(){var D=this.$menu.find(".active").attr("data-value");this.$element.val(this.updater(D)).change();return this.hide()},updater:function(D){return D},show:function(){var D=B.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});this.$menu.insertAfter(this.$element).css({top:D.top+D.height,left:D.left}).show();this.shown=true;return this},hide:function(){this.$menu.hide();this.shown=false;return this},lookup:function(E){var D;this.query=this.$element.val();if(!this.query||this.query.length<this.options.minLength){return this.shown?this.hide():this}D=B.isFunction(this.source)?this.source(this.query,B.proxy(this.process,this)):this.source;return D?this.process(D):this},process:function(D){var E=this;D=B.grep(D,function(F){return E.matcher(F)});D=this.sorter(D);if(!D.length){return this.shown?this.hide():this}return this.render(D.slice(0,this.options.items)).show()},matcher:function(D){return ~D.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(F){var G=[],E=[],D=[],H;while(H=F.shift()){if(!H.toLowerCase().indexOf(this.query.toLowerCase())){G.push(H)}else{if(~H.indexOf(this.query)){E.push(H)}else{D.push(H)}}}return G.concat(E,D)},highlighter:function(D){var E=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return D.replace(new RegExp("("+E+")","ig"),function(F,G){return"<strong>"+G+"</strong>"})},render:function(D){var E=this;D=B(D).map(function(F,G){F=B(E.options.item).attr("data-value",G);F.find("a").html(E.highlighter(G));return F[0]});D.first().addClass("active");this.$menu.html(D);return this},next:function(E){var F=this.$menu.find(".active").removeClass("active"),D=F.next();if(!D.length){D=B(this.$menu.find("li")[0])}D.addClass("active")},prev:function(E){var F=this.$menu.find(".active").removeClass("active"),D=F.prev();if(!D.length){D=this.$menu.find("li").last()}D.addClass("active")},listen:function(){this.$element.on("focus",B.proxy(this.focus,this)).on("blur",B.proxy(this.blur,this)).on("keypress",B.proxy(this.keypress,this)).on("keyup",B.proxy(this.keyup,this));if(this.eventSupported("keydown")){this.$element.on("keydown",B.proxy(this.keydown,this))}this.$menu.on("click",B.proxy(this.click,this)).on("mouseenter","li",B.proxy(this.mouseenter,this)).on("mouseleave","li",B.proxy(this.mouseleave,this))},eventSupported:function(D){var E=D in this.$element;if(!E){this.$element.setAttribute(D,"return;");E=typeof this.$element[D]==="function"}return E},move:function(D){if(!this.shown){return }switch(D.keyCode){case 9:case 13:case 27:D.preventDefault();break;case 38:D.preventDefault();this.prev();break;case 40:D.preventDefault();this.next();break}D.stopPropagation()},keydown:function(D){this.suppressKeyPressRepeat=~B.inArray(D.keyCode,[40,38,9,13,27]);this.move(D)},keypress:function(D){if(this.suppressKeyPressRepeat){return }this.move(D)},keyup:function(D){switch(D.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown){return }this.select();break;case 27:if(!this.shown){return }this.hide();break;default:this.lookup()}D.stopPropagation();D.preventDefault()},focus:function(D){this.focused=true},blur:function(D){this.focused=false;if(!this.mousedover&&this.shown){this.hide()}},click:function(D){D.stopPropagation();D.preventDefault();this.select();this.$element.focus()},mouseenter:function(D){this.mousedover=true;this.$menu.find(".active").removeClass("active");B(D.currentTarget).addClass("active")},mouseleave:function(D){this.mousedover=false;if(!this.focused&&this.shown){this.hide()}}};var A=B.fn.typeahead;B.fn.typeahead=function(D){return this.each(function(){var G=B(this),F=G.data("typeahead"),E=typeof D=="object"&&D;if(!F){G.data("typeahead",(F=new C(this,E)))}if(typeof D=="string"){F[D]()}})};B.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1};B.fn.typeahead.Constructor=C;B.fn.typeahead.noConflict=function(){B.fn.typeahead=A;return this};B(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(E){var D=B(this);if(D.data("typeahead")){return }D.typeahead(D.data())})}(window.jQuery);(function(){var G,P="1.4.7",H={},F="en",K=null,E=(typeof module!=="undefined"&&module.exports);function L(Q){this._n=Q}function A(U,R,Q){var T=Math.pow(10,R),S;S=(Math.round(U*T)/T).toFixed(R);if(Q){var V=new RegExp("0{1,"+Q+"}$");S=S.replace(V,"")}return S}function C(S,R){var Q;if(R.indexOf("$")>-1){Q=J(S,R)}else{if(R.indexOf("%")>-1){Q=I(S,R)}else{if(R.indexOf(":")>-1){Q=O(S,R)}else{Q=B(S,R)}}}return Q}function D(R,X){if(X.indexOf(":")>-1){R._n=N(X)}else{if(X===K){R._n=0}else{var V=X;if(H[F].delimiters.decimal!=="."){X=X.replace(/\./g,"").replace(H[F].delimiters.decimal,".")}var Z=new RegExp(H[F].abbreviations.thousand+"(?:\\)|(\\"+H[F].currency.symbol+")?(?:\\))?)?$"),U=new RegExp(H[F].abbreviations.million+"(?:\\)|(\\"+H[F].currency.symbol+")?(?:\\))?)?$"),T=new RegExp(H[F].abbreviations.billion+"(?:\\)|(\\"+H[F].currency.symbol+")?(?:\\))?)?$"),S=new RegExp(H[F].abbreviations.trillion+"(?:\\)|(\\"+H[F].currency.symbol+")?(?:\\))?)?$");var W=["KB","MB","GB","TB","PB","EB","ZB","YB"],Y=false;for(var Q=0;Q<=W.length;Q++){Y=(X.indexOf(W[Q])>-1)?Math.pow(1024,Q+1):false;if(Y){break}}R._n=((Y)?Y:1)*((V.match(Z))?Math.pow(10,3):1)*((V.match(U))?Math.pow(10,6):1)*((V.match(T))?Math.pow(10,9):1)*((V.match(S))?Math.pow(10,12):1)*((X.indexOf("%")>-1)?0.01:1)*Number(((X.indexOf("(")>-1)?"-":"")+X.replace(/[^0-9\.-]+/g,""));R._n=(Y)?Math.ceil(R._n):R._n}}return R._n}function J(U,T){var R=(T.indexOf("$")<=1)?true:false;var S="";if(T.indexOf(" $")>-1){S=" ";T=T.replace(" $","")}else{if(T.indexOf("$ ")>-1){S=" ";T=T.replace("$ ","")}else{T=T.replace("$","")}}var Q=C(U,T);if(R){if(Q.indexOf("(")>-1||Q.indexOf("-")>-1){Q=Q.split("");Q.splice(1,0,H[F].currency.symbol+S);Q=Q.join("")}else{Q=H[F].currency.symbol+S+Q}}else{if(Q.indexOf(")")>-1){Q=Q.split("");Q.splice(-1,0,S+H[F].currency.symbol);Q=Q.join("")}else{Q=Q+S+H[F].currency.symbol}}return Q}function I(T,S){var R="";if(S.indexOf(" %")>-1){R=" ";S=S.replace(" %","")}else{S=S.replace("%","")}T._n=T._n*100;var Q=C(T,S);if(Q.indexOf(")")>-1){Q=Q.split("");Q.splice(-1,0,R+"%");Q=Q.join("")}else{Q=Q+R+"%"}return Q}function O(U,S){var Q=Math.floor(U._n/60/60),R=Math.floor((U._n-(Q*60*60))/60),T=Math.round(U._n-(Q*60*60)-(R*60));return Q+":"+((R<10)?"0"+R:R)+":"+((T<10)?"0"+T:T)}function N(Q){var R=Q.split(":"),S=0;if(R.length===3){S=S+(Number(R[0])*60*60);S=S+(Number(R[1])*60);S=S+Number(R[2])}else{if(R.lenght===2){S=S+(Number(R[0])*60);S=S+Number(R[1])}}return Number(S)}function B(S,c){var e=false,V=false,f="",h="",R="",l=Math.abs(S._n);if(S._n===0&&K!==null){return K}else{if(c.indexOf("(")>-1){e=true;c=c.slice(1,-1)}if(c.indexOf("a")>-1){if(c.indexOf(" a")>-1){f=" ";c=c.replace(" a","")}else{c=c.replace("a","")}if(l>=Math.pow(10,12)){f=f+H[F].abbreviations.trillion;S._n=S._n/Math.pow(10,12)}else{if(l<Math.pow(10,12)&&l>=Math.pow(10,9)){f=f+H[F].abbreviations.billion;S._n=S._n/Math.pow(10,9)}else{if(l<Math.pow(10,9)&&l>=Math.pow(10,6)){f=f+H[F].abbreviations.million;S._n=S._n/Math.pow(10,6)}else{if(l<Math.pow(10,6)&&l>=Math.pow(10,3)){f=f+H[F].abbreviations.thousand;S._n=S._n/Math.pow(10,3)}}}}}if(c.indexOf("b")>-1){if(c.indexOf(" b")>-1){h=" ";c=c.replace(" b","")}else{c=c.replace("b","")}var W=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],U,a;for(var Q=0;Q<=W.length;Q++){U=Math.pow(1024,Q);a=Math.pow(1024,Q+1);if(S._n>=U&&S._n<a){h=h+W[Q];if(U>0){S._n=S._n/U}break}}}if(c.indexOf("o")>-1){if(c.indexOf(" o")>-1){R=" ";c=c.replace(" o","")}else{c=c.replace("o","")}R=R+H[F].ordinal(S._n)}if(c.indexOf("[.]")>-1){V=true;c=c.replace("[.]",".")}var b=S._n.toString().split(".")[0],X=c.split(".")[1],Y=c.indexOf(","),Z="",T=false;if(X){if(X.indexOf("[")>-1){X=X.replace("]","");X=X.split("[");Z=A(S._n,(X[0].length+X[1].length),X[1].length)}else{Z=A(S._n,X.length)}b=Z.split(".")[0];if(Z.split(".")[1].length){Z=H[F].delimiters.decimal+Z.split(".")[1]}else{Z=""}if(V&&Number(Z)===0){Z=""}}else{b=A(S._n,null)}if(b.indexOf("-")>-1){b=b.slice(1);T=true}if(Y>-1){b=b.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+H[F].delimiters.thousands)}if(c.indexOf(".")===0){b=""}return((e&&T)?"(":"")+((!e&&T)?"-":"")+b+Z+((R)?R:"")+((f)?f:"")+((h)?h:"")+((e&&T)?")":"")}}G=function(Q){if(G.isNumeral(Q)){Q=Q.value()}else{if(!Number(Q)){Q=0}}return new L(Number(Q))};G.version=P;G.isNumeral=function(Q){return Q instanceof L};G.language=function(R,Q){if(!R){return F}if(R&&!Q){F=R}if(Q||!H[R]){M(R,Q)}return G};G.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(R){var Q=R%10;return(~~(R%100/10)===1)?"th":(Q===1)?"st":(Q===2)?"nd":(Q===3)?"rd":"th"},currency:{symbol:"$"}});G.zeroFormat=function(Q){if(typeof (Q)==="string"){K=Q}else{K=null}};function M(R,Q){H[R]=Q}G.fn=L.prototype={clone:function(){return G(this)},format:function(Q){return C(this,Q?Q:G.defaultFormat)},unformat:function(Q){return D(this,Q?Q:G.defaultFormat)},value:function(){return this._n},valueOf:function(){return this._n},set:function(Q){this._n=Number(Q);return this},add:function(Q){this._n=this._n+Number(Q);return this},subtract:function(Q){this._n=this._n-Number(Q);return this},multiply:function(Q){this._n=this._n*Number(Q);return this},divide:function(Q){this._n=this._n/Number(Q);return this},difference:function(Q){var R=this._n-Number(Q);if(R<0){R=-R}return R}};if(E){module.exports=G}if(typeof ender==="undefined"){this["numeral"]=G}if(typeof define==="function"&&define.amd){define([],function(){return G})}}).call(this);
/*
 * jQuery contextMenu - Plugin for simple contextMenu handling
 *
 * Version: 1.6.5
 *
 * Authors: Rodney Rehm, Addy Osmani (patches for FF)
 * Web: http://medialize.github.com/jQuery-contextMenu/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *   GPL v3 http://opensource.org/licenses/GPL-3.0
 *
 */
(function(C,D){C.support.htmlMenuitem=("HTMLMenuItemElement" in window);C.support.htmlCommand=("HTMLCommandElement" in window);C.support.eventSelectstart=("onselectstart" in document.documentElement);if(!C.ui||!C.ui.widget){var Q=C.cleanData;C.cleanData=function(S){for(var T=0,U;(U=S[T])!=null;T++){try{C(U).triggerHandler("remove")}catch(V){}}Q(S)}}var P=null,B=false,N=C(window),H=0,G={},L={},K={},I={selector:null,appendTo:null,trigger:"right",autoHide:false,delay:200,reposition:true,determinePosition:function(S){if(C.ui&&C.ui.position){S.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none")}else{var T=this.offset();T.top+=this.outerHeight();T.left+=this.outerWidth()/2-S.outerWidth()/2;S.css(T)}},position:function(U,Y,X){var W=this,V;if(!Y&&!X){U.determinePosition.call(this,U.$menu);return }else{if(Y==="maintain"&&X==="maintain"){V=U.$menu.position()}else{V={top:X,left:Y}}}var S=N.scrollTop()+N.height(),Z=N.scrollLeft()+N.width(),a=U.$menu.height(),T=U.$menu.width();if(V.top+a>S){V.top-=a}if(V.left+T>Z){V.left-=T}U.$menu.css(V)},positionSubmenu:function(S){if(C.ui&&C.ui.position){S.css("display","block").position({my:"left top",at:"right top",of:this,collision:"flipfit fit"}).css("display","")}else{var T={top:0,left:this.outerWidth()};S.css(T)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:C.noop,hide:C.noop},callback:null,items:{}},J={timer:null,pageX:null,pageY:null},E=function(U){var T=0,S=U;while(true){T=Math.max(T,parseInt(S.css("z-index"),10)||0);S=S.parent();if(!S||!S.length||"html body".indexOf(S.prop("nodeName").toLowerCase())>-1){break}}return T},R={abortevent:function(S){S.preventDefault();S.stopImmediatePropagation()},contextmenu:function(U){var T=C(this);U.preventDefault();U.stopImmediatePropagation();if(U.data.trigger!="right"&&U.originalEvent){return }if(T.hasClass("context-menu-active")){return }if(!T.hasClass("context-menu-disabled")){P=T;if(U.data.build){var S=U.data.build(P,U);if(S===false){return }U.data=C.extend(true,{},I,U.data,S||{});if(!U.data.items||C.isEmptyObject(U.data.items)){if(window.console){(console.error||console.log)("No items specified to show in contextMenu")}throw new Error("No Items sepcified")}U.data.$trigger=P;F.create(U.data)}F.show.call(T,U.data,U.pageX,U.pageY)}},click:function(S){S.preventDefault();S.stopImmediatePropagation();C(this).trigger(C.Event("contextmenu",{data:S.data,pageX:S.pageX,pageY:S.pageY}))},mousedown:function(T){var S=C(this);if(P&&P.length&&!P.is(S)){P.data("contextMenu").$menu.trigger("contextmenu:hide")}if(T.button==2){P=S.data("contextMenuActive",true)}},mouseup:function(T){var S=C(this);if(S.data("contextMenuActive")&&P&&P.length&&P.is(S)&&!S.hasClass("context-menu-disabled")){T.preventDefault();T.stopImmediatePropagation();P=S;S.trigger(C.Event("contextmenu",{data:T.data,pageX:T.pageX,pageY:T.pageY}))}S.removeData("contextMenuActive")},mouseenter:function(U){var T=C(this),S=C(U.relatedTarget),V=C(document);if(S.is(".context-menu-list")||S.closest(".context-menu-list").length){return }if(P&&P.length){return }J.pageX=U.pageX;J.pageY=U.pageY;J.data=U.data;V.on("mousemove.contextMenuShow",R.mousemove);J.timer=setTimeout(function(){J.timer=null;V.off("mousemove.contextMenuShow");P=T;T.trigger(C.Event("contextmenu",{data:J.data,pageX:J.pageX,pageY:J.pageY}))},U.data.delay)},mousemove:function(S){J.pageX=S.pageX;J.pageY=S.pageY},mouseleave:function(T){var S=C(T.relatedTarget);if(S.is(".context-menu-list")||S.closest(".context-menu-list").length){return }try{clearTimeout(J.timer)}catch(T){}J.timer=null},layerClick:function(V){var X=C(this),Z=X.data("contextMenuRoot"),T=false,U=V.button,a=V.pageX,Y=V.pageY,W,S,b;V.preventDefault();V.stopImmediatePropagation();setTimeout(function(){var f,e,d;var c=((Z.trigger=="left"&&U===0)||(Z.trigger=="right"&&U===2));if(document.elementFromPoint){Z.$layer.hide();W=document.elementFromPoint(a-N.scrollLeft(),Y-N.scrollTop());Z.$layer.show()}if(Z.reposition&&c){if(document.elementFromPoint){if(Z.$trigger.is(W)||Z.$trigger.has(W).length){Z.position.call(Z.$trigger,Z,a,Y);return }}else{S=Z.$trigger.offset();f=C(window);S.top+=f.scrollTop();if(S.top<=V.pageY){S.left+=f.scrollLeft();if(S.left<=V.pageX){S.bottom=S.top+Z.$trigger.outerHeight();if(S.bottom>=V.pageY){S.right=S.left+Z.$trigger.outerWidth();if(S.right>=V.pageX){Z.position.call(Z.$trigger,Z,a,Y);return }}}}}}if(W&&c){Z.$trigger.one("contextmenu:hidden",function(){C(W).contextMenu({x:a,y:Y})})}Z.$menu.trigger("contextmenu:hide")},50)},keyStop:function(T,S){if(!S.isInput){T.preventDefault()}T.stopPropagation()},key:function(W){var U=P.data("contextMenu")||{};switch(W.keyCode){case 9:case 38:R.keyStop(W,U);if(U.isInput){if(W.keyCode==9&&W.shiftKey){W.preventDefault();U.$selected&&U.$selected.find("input, textarea, select").blur();U.$menu.trigger("prevcommand");return }else{if(W.keyCode==38&&U.$selected.find("input, textarea, select").prop("type")=="checkbox"){W.preventDefault();return }}}else{if(W.keyCode!=9||W.shiftKey){U.$menu.trigger("prevcommand");return }}case 40:R.keyStop(W,U);if(U.isInput){if(W.keyCode==9){W.preventDefault();U.$selected&&U.$selected.find("input, textarea, select").blur();U.$menu.trigger("nextcommand");return }else{if(W.keyCode==40&&U.$selected.find("input, textarea, select").prop("type")=="checkbox"){W.preventDefault();return }}}else{U.$menu.trigger("nextcommand");return }break;case 37:R.keyStop(W,U);if(U.isInput||!U.$selected||!U.$selected.length){break}if(!U.$selected.parent().hasClass("context-menu-root")){var V=U.$selected.parent().parent();U.$selected.trigger("contextmenu:blur");U.$selected=V;return }break;case 39:R.keyStop(W,U);if(U.isInput||!U.$selected||!U.$selected.length){break}var T=U.$selected.data("contextMenu")||{};if(T.$menu&&U.$selected.hasClass("context-menu-submenu")){U.$selected=null;T.$selected=null;T.$menu.trigger("nextcommand");return }break;case 35:case 36:if(U.$selected&&U.$selected.find("input, textarea, select").length){return }else{(U.$selected&&U.$selected.parent()||U.$menu).children(":not(.disabled, .not-selectable)")[W.keyCode==36?"first":"last"]().trigger("contextmenu:focus");W.preventDefault();return }break;case 13:R.keyStop(W,U);if(U.isInput){if(U.$selected&&!U.$selected.is("textarea, select")){W.preventDefault();return }break}U.$selected&&U.$selected.trigger("mouseup");return ;case 32:case 33:case 34:R.keyStop(W,U);return ;case 27:R.keyStop(W,U);U.$menu.trigger("contextmenu:hide");return ;default:var S=(String.fromCharCode(W.keyCode)).toUpperCase();if(U.accesskeys[S]){U.accesskeys[S].$node.trigger(U.accesskeys[S].$menu?"contextmenu:focus":"mouseup");return }break}W.stopPropagation();U.$selected&&U.$selected.trigger(W)},prevItem:function(W){W.stopPropagation();var V=C(this).data("contextMenu")||{};if(V.$selected){var S=V.$selected;V=V.$selected.parent().data("contextMenu")||{};V.$selected=S}var U=V.$menu.children(),T=!V.$selected||!V.$selected.prev().length?U.last():V.$selected.prev(),Y=T;while(T.hasClass("disabled")||T.hasClass("not-selectable")){if(T.prev().length){T=T.prev()}else{T=U.last()}if(T.is(Y)){return }}if(V.$selected){R.itemMouseleave.call(V.$selected.get(0),W)}R.itemMouseenter.call(T.get(0),W);var X=T.find("input, textarea, select");if(X.length){X.focus()}},nextItem:function(W){W.stopPropagation();var V=C(this).data("contextMenu")||{};if(V.$selected){var S=V.$selected;V=V.$selected.parent().data("contextMenu")||{};V.$selected=S}var U=V.$menu.children(),T=!V.$selected||!V.$selected.next().length?U.first():V.$selected.next(),Y=T;while(T.hasClass("disabled")||T.hasClass("not-selectable")){if(T.next().length){T=T.next()}else{T=U.first()}if(T.is(Y)){return }}if(V.$selected){R.itemMouseleave.call(V.$selected.get(0),W)}R.itemMouseenter.call(T.get(0),W);var X=T.find("input, textarea, select");if(X.length){X.focus()}},focusInput:function(W){var V=C(this).closest(".context-menu-item"),U=V.data(),T=U.contextMenu,S=U.contextMenuRoot;S.$selected=T.$selected=V;S.isInput=T.isInput=true},blurInput:function(W){var V=C(this).closest(".context-menu-item"),U=V.data(),T=U.contextMenu,S=U.contextMenuRoot;S.isInput=T.isInput=false},menuMouseenter:function(T){var S=C(this).data().contextMenuRoot;S.hovering=true},menuMouseleave:function(T){var S=C(this).data().contextMenuRoot;if(S.$layer&&S.$layer.is(T.relatedTarget)){S.hovering=false}},itemMouseenter:function(W){var V=C(this),U=V.data(),T=U.contextMenu,S=U.contextMenuRoot;S.hovering=true;if(W&&S.$layer&&S.$layer.is(W.relatedTarget)){W.preventDefault();W.stopImmediatePropagation()}(T.$menu?T:S).$menu.children(".hover").trigger("contextmenu:blur");if(V.hasClass("disabled")||V.hasClass("not-selectable")){T.$selected=null;return }V.trigger("contextmenu:focus")},itemMouseleave:function(W){var V=C(this),U=V.data(),T=U.contextMenu,S=U.contextMenuRoot;if(S!==T&&S.$layer&&S.$layer.is(W.relatedTarget)){S.$selected&&S.$selected.trigger("contextmenu:blur");W.preventDefault();W.stopImmediatePropagation();S.$selected=T.$selected=T.$node;return }V.trigger("contextmenu:blur")},itemClick:function(X){var W=C(this),V=W.data(),U=V.contextMenu,S=V.contextMenuRoot,T=V.contextMenuKey,Y;if(!U.items[T]||W.is(".disabled, .context-menu-submenu, .context-menu-separator, .not-selectable")){return }X.preventDefault();X.stopImmediatePropagation();if(C.isFunction(S.callbacks[T])&&Object.prototype.hasOwnProperty.call(S.callbacks,T)){Y=S.callbacks[T]}else{if(C.isFunction(S.callback)){Y=S.callback}else{return }}if(Y.call(S.$trigger,T,S)!==false){S.$menu.trigger("contextmenu:hide")}else{if(S.$menu.parent().length){F.update.call(S.$trigger,S)}}},inputClick:function(S){S.stopImmediatePropagation()},hideMenu:function(U,T){var S=C(this).data("contextMenuRoot");F.hide.call(S.$trigger,S,T&&T.force)},focusItem:function(W){W.stopPropagation();var V=C(this),U=V.data(),T=U.contextMenu,S=U.contextMenuRoot;V.addClass("hover").siblings(".hover").trigger("contextmenu:blur");T.$selected=S.$selected=V;if(T.$node){S.positionSubmenu.call(T.$node,T.$menu)}},blurItem:function(W){W.stopPropagation();var V=C(this),U=V.data(),T=U.contextMenu,S=U.contextMenuRoot;V.removeClass("hover");T.$selected=null}},F={show:function(V,T,X){var S=C(this),W,U={};C("#context-menu-layer").trigger("mousedown");V.$trigger=S;if(V.events.show.call(S,V)===false){P=null;return }F.update.call(S,V);V.position.call(S,V,T,X);if(V.zIndex){U.zIndex=E(S)+V.zIndex}F.layer.call(V.$menu,V,U.zIndex);V.$menu.find("ul").css("zIndex",U.zIndex+1);V.$menu.css(U)[V.animation.show](V.animation.duration,function(){S.trigger("contextmenu:visible")});S.data("contextMenu",V).addClass("context-menu-active");C(document).off("keydown.contextMenu").on("keydown.contextMenu",R.key);if(V.autoHide){C(document).on("mousemove.contextMenuAutoHide",function(Y){var Z=S.offset();Z.right=Z.left+S.outerWidth();Z.bottom=Z.top+S.outerHeight();if(V.$layer&&!V.hovering&&(!(Y.pageX>=Z.left&&Y.pageX<=Z.right)||!(Y.pageY>=Z.top&&Y.pageY<=Z.bottom))){V.$menu.trigger("contextmenu:hide")}})}},hide:function(T,U){var S=C(this);if(!T){T=S.data("contextMenu")||{}}if(!U&&T.events&&T.events.hide.call(S,T)===false){return }S.removeData("contextMenu").removeClass("context-menu-active");if(T.$layer){setTimeout((function(W){return function(){W.remove()}})(T.$layer),10);try{delete T.$layer}catch(V){T.$layer=null}}P=null;T.$menu.find(".hover").trigger("contextmenu:blur");T.$selected=null;C(document).off(".contextMenuAutoHide").off("keydown.contextMenu");T.$menu&&T.$menu[T.animation.hide](T.animation.duration,function(){if(T.build){T.$menu.remove();C.each(T,function(W,X){switch(W){case"ns":case"selector":case"build":case"trigger":return true;default:T[W]=D;try{delete T[W]}catch(Y){}return true}})}setTimeout(function(){S.trigger("contextmenu:hidden")},10)})},create:function(T,S){if(S===D){S=T}T.$menu=C('<ul class="context-menu-list"></ul>').addClass(T.className||"").data({contextMenu:T,contextMenuRoot:S});C.each(["callbacks","commands","inputs"],function(V,U){T[U]={};if(!S[U]){S[U]={}}});S.accesskeys||(S.accesskeys={});C.each(T.items,function(W,X){var b=C('<li class="context-menu-item"></li>').addClass(X.className||""),U=null,a=null;b.on("click",C.noop);X.$node=b.data({contextMenu:T,contextMenuRoot:S,contextMenuKey:W});if(X.accesskey){var Y=M(X.accesskey);for(var V=0,Z;Z=Y[V];V++){if(!S.accesskeys[Z]){S.accesskeys[Z]=X;X._name=X.name.replace(new RegExp("("+Z+")","i"),'<span class="context-menu-accesskey">$1</span>');break}}}if(typeof X=="string"){b.addClass("context-menu-separator not-selectable")}else{if(X.type&&K[X.type]){K[X.type].call(b,X,T,S);C.each([T,S],function(d,c){c.commands[W]=X;if(C.isFunction(X.callback)){c.callbacks[W]=X.callback}})}else{if(X.type=="html"){b.addClass("context-menu-html not-selectable")}else{if(X.type){U=C("<label></label>").appendTo(b);C("<span></span>").html(X._name||X.name).appendTo(U);b.addClass("context-menu-input");T.hasTypes=true;C.each([T,S],function(d,c){c.commands[W]=X;c.inputs[W]=X})}else{if(X.items){X.type="sub"}}}switch(X.type){case"text":a=C('<input type="text" value="1" name="" value="">').attr("name","context-menu-input-"+W).val(X.value||"").appendTo(U);break;case"textarea":a=C('<textarea name=""></textarea>').attr("name","context-menu-input-"+W).val(X.value||"").appendTo(U);if(X.height){a.height(X.height)}break;case"checkbox":a=C('<input type="checkbox" value="1" name="" value="">').attr("name","context-menu-input-"+W).val(X.value||"").prop("checked",!!X.selected).prependTo(U);break;case"radio":a=C('<input type="radio" value="1" name="" value="">').attr("name","context-menu-input-"+X.radio).val(X.value||"").prop("checked",!!X.selected).prependTo(U);break;case"select":a=C('<select name="">').attr("name","context-menu-input-"+W).appendTo(U);if(X.options){C.each(X.options,function(c,d){C("<option></option>").val(c).text(d).appendTo(a)});a.val(X.selected)}break;case"sub":C("<span></span>").html(X._name||X.name).appendTo(b);X.appendTo=X.$node;F.create(X,S);b.data("contextMenu",X).addClass("context-menu-submenu");X.callback=null;break;case"html":C(X.html).appendTo(b);break;default:C.each([T,S],function(d,c){c.commands[W]=X;if(C.isFunction(X.callback)){c.callbacks[W]=X.callback}});C("<span></span>").html(X._name||X.name||"").appendTo(b);break}if(X.type&&X.type!="sub"&&X.type!="html"){a.on("focus",R.focusInput).on("blur",R.blurInput);if(X.events){a.on(X.events,T)}}if(X.icon){b.addClass("icon icon-"+X.icon)}}}X.$input=a;X.$label=U;b.appendTo(T.$menu);if(!T.hasTypes&&C.support.eventSelectstart){b.on("selectstart.disableTextSelect",R.abortevent)}});if(!T.$node){T.$menu.css("display","none").addClass("context-menu-root")}T.$menu.appendTo(T.appendTo||document.body)},resize:function(S,T){S.css({position:"absolute",display:"block"});S.data("width",Math.ceil(S.width())+1);S.css({position:"static",minWidth:"0px",maxWidth:"100000px"});S.find("> li > ul").each(function(){F.resize(C(this),true)});if(!T){S.find("ul").andSelf().css({position:"",display:"",minWidth:"",maxWidth:""}).width(function(){return C(this).data("width")})}},update:function(U,T){var S=this;if(T===D){T=U;F.resize(U.$menu)}U.$menu.children().each(function(){var V=C(this),W=V.data("contextMenuKey"),Y=U.items[W],X=(C.isFunction(Y.disabled)&&Y.disabled.call(S,W,T))||Y.disabled===true;V[X?"addClass":"removeClass"]("disabled");if(Y.type){V.find("input, select, textarea").prop("disabled",X);switch(Y.type){case"text":case"textarea":Y.$input.val(Y.value||"");break;case"checkbox":case"radio":Y.$input.val(Y.value||"").prop("checked",!!Y.selected);break;case"select":Y.$input.val(Y.selected||"");break}}if(Y.$menu){F.update.call(S,Y,T)}})},layer:function(T,U){var S=T.$layer=C('<div id="context-menu-layer" style="position:fixed; z-index:'+U+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:N.height(),width:N.width(),display:"block"}).data("contextMenuRoot",T).insertBefore(this).on("contextmenu",R.abortevent).on("mousedown",R.layerClick);if(!C.support.fixedPosition){S.css({position:"absolute",height:C(document).height()})}return S}};function M(W){var U=W.split(/\s+/),V=[];for(var T=0,S;S=U[T];T++){S=S[0].toUpperCase();V.push(S)}return V}C.fn.contextMenu=function(S){if(S===D){this.first().trigger("contextmenu")}else{if(S.x&&S.y){this.first().trigger(C.Event("contextmenu",{pageX:S.x,pageY:S.y}))}else{if(S==="hide"){var T=this.data("contextMenu").$menu;T&&T.trigger("contextmenu:hide")}else{if(S==="destroy"){C.contextMenu("destroy",{context:this})}else{if(C.isPlainObject(S)){S.context=this;C.contextMenu("create",S)}else{if(S){this.removeClass("context-menu-disabled")}else{if(!S){this.addClass("context-menu-disabled")}}}}}}}return this};C.contextMenu=function(W,a){if(typeof W!="string"){a=W;W="create"}if(typeof a=="string"){a={selector:a}}else{if(a===D){a={}}}var U=C.extend(true,{},I,a||{});var V=C(document);var Y=V;var Z=false;if(!U.context||!U.context.length){U.context=document}else{Y=C(U.context).first();U.context=Y.get(0);Z=U.context!==document}switch(W){case"create":if(!U.selector){throw new Error("No selector specified")}if(U.selector.match(/.context-menu-(list|item|input)($|\s)/)){throw new Error('Cannot bind to selector "'+U.selector+'" as it contains a reserved className')}if(!U.build&&(!U.items||C.isEmptyObject(U.items))){throw new Error("No Items sepcified")}H++;U.ns=".contextMenu"+H;if(!Z){G[U.selector]=U.ns}L[U.ns]=U;if(!U.trigger){U.trigger="right"}if(!B){V.on({"contextmenu:hide.contextMenu":R.hideMenu,"prevcommand.contextMenu":R.prevItem,"nextcommand.contextMenu":R.nextItem,"contextmenu.contextMenu":R.abortevent,"mouseenter.contextMenu":R.menuMouseenter,"mouseleave.contextMenu":R.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",R.inputClick).on({"mouseup.contextMenu":R.itemClick,"contextmenu:focus.contextMenu":R.focusItem,"contextmenu:blur.contextMenu":R.blurItem,"contextmenu.contextMenu":R.abortevent,"mouseenter.contextMenu":R.itemMouseenter,"mouseleave.contextMenu":R.itemMouseleave},".context-menu-item");B=true}Y.on("contextmenu"+U.ns,U.selector,U,R.contextmenu);if(Z){Y.on("remove"+U.ns,function(){C(this).contextMenu("destroy")})}switch(U.trigger){case"hover":Y.on("mouseenter"+U.ns,U.selector,U,R.mouseenter).on("mouseleave"+U.ns,U.selector,U,R.mouseleave);break;case"left":Y.on("click"+U.ns,U.selector,U,R.click);break}if(!U.build){F.create(U)}break;case"destroy":var S;if(Z){var T=U.context;C.each(L,function(b,d){if(d.context!==T){return true}S=C(".context-menu-list").filter(":visible");if(S.length&&S.data().contextMenuRoot.$trigger.is(C(d.context).find(d.selector))){S.trigger("contextmenu:hide",{force:true})}try{if(L[d.ns].$menu){L[d.ns].$menu.remove()}delete L[d.ns]}catch(c){L[d.ns]=null}C(d.context).off(d.ns);return true})}else{if(!U.selector){V.off(".contextMenu .contextMenuAutoHide");C.each(L,function(b,c){C(c.context).off(c.ns)});G={};L={};H=0;B=false;C("#context-menu-layer, .context-menu-list").remove()}else{if(G[U.selector]){S=C(".context-menu-list").filter(":visible");if(S.length&&S.data().contextMenuRoot.$trigger.is(U.selector)){S.trigger("contextmenu:hide",{force:true})}try{if(L[G[U.selector]].$menu){L[G[U.selector]].$menu.remove()}delete L[G[U.selector]]}catch(X){L[G[U.selector]]=null}V.off(G[U.selector])}}}break;case"html5":if((!C.support.htmlCommand&&!C.support.htmlMenuitem)||(typeof a=="boolean"&&a)){C('menu[type="context"]').each(function(){if(this.id){C.contextMenu({selector:"[contextmenu="+this.id+"]",items:C.contextMenu.fromMenu(this)})}}).css("display","none")}break;default:throw new Error('Unknown operation "'+W+'"')}return this};C.contextMenu.setInputValues=function(S,T){if(T===D){T={}}C.each(S.inputs,function(U,V){switch(V.type){case"text":case"textarea":V.value=T[U]||"";break;case"checkbox":V.selected=T[U]?true:false;break;case"radio":V.selected=(T[V.radio]||"")==V.value?true:false;break;case"select":V.selected=T[U]||"";break}})};C.contextMenu.getInputValues=function(S,T){if(T===D){T={}}C.each(S.inputs,function(U,V){switch(V.type){case"text":case"textarea":case"select":T[U]=V.$input.val();break;case"checkbox":T[U]=V.$input.prop("checked");break;case"radio":if(V.$input.prop("checked")){T[V.radio]=V.value}break}});return T};function O(S){return(S.id&&C('label[for="'+S.id+'"]').val())||S.name}function A(U,T,S){if(!S){S=0}T.each(function(){var V=C(this),Y=this,Z=this.nodeName.toLowerCase(),W,X;if(Z=="label"&&V.find("input, textarea, select").length){W=V.text();V=V.children().first();Y=V.get(0);Z=Y.nodeName.toLowerCase()}switch(Z){case"menu":X={name:V.attr("label"),items:{}};S=A(X.items,V.children(),S);break;case"a":case"button":X={name:V.text(),disabled:!!V.attr("disabled"),callback:(function(){return function(){V.click()}})()};break;case"menuitem":case"command":switch(V.attr("type")){case D:case"command":case"menuitem":X={name:V.attr("label"),disabled:!!V.attr("disabled"),callback:(function(){return function(){V.click()}})()};break;case"checkbox":X={type:"checkbox",disabled:!!V.attr("disabled"),name:V.attr("label"),selected:!!V.attr("checked")};break;case"radio":X={type:"radio",disabled:!!V.attr("disabled"),name:V.attr("label"),radio:V.attr("radiogroup"),value:V.attr("id"),selected:!!V.attr("checked")};break;default:X=D}break;case"hr":X="-------";break;case"input":switch(V.attr("type")){case"text":X={type:"text",name:W||O(Y),disabled:!!V.attr("disabled"),value:V.val()};break;case"checkbox":X={type:"checkbox",name:W||O(Y),disabled:!!V.attr("disabled"),selected:!!V.attr("checked")};break;case"radio":X={type:"radio",name:W||O(Y),disabled:!!V.attr("disabled"),radio:!!V.attr("name"),value:V.val(),selected:!!V.attr("checked")};break;default:X=D;break}break;case"select":X={type:"select",name:W||O(Y),disabled:!!V.attr("disabled"),selected:V.val(),options:{}};V.children().each(function(){X.options[this.value]=C(this).text()});break;case"textarea":X={type:"textarea",name:W||O(Y),disabled:!!V.attr("disabled"),value:V.val()};break;case"label":break;default:X={type:"html",html:V.clone(true)};break}if(X){S++;U["key"+S]=X}});return S}C.contextMenu.fromMenu=function(T){var U=C(T),S={};A(S,U.children());return S};C.contextMenu.defaults=I;C.contextMenu.types=K;C.contextMenu.handle=R;C.contextMenu.op=F;C.contextMenu.menus=L})(jQuery);var ZCSheetView=new function(){this.columnHeaders;this.columnDetails;this.data;this.dateFormat;this.viewDetailsmap;this.viewLinkName;this.columnHeadersWidth;this.rowList=[];this.recLinkIDList=new Array();this.rowHeadersList=new Array();this.columnLabelList;this.isDeleteRecord;this.isEditRecord;this.noDataAvailable;this.isfocusElem=false;this.maxLenthErrorList=[];this.custActionList;this.sheetReportConditionFormateMap;this.lookupDropDownDiv;this.isMultiSelectOptions=false;this.initVariables=function(){ZCSheetView.hasActiveLookupOptionReq=false;ZCSheetView.hasMoreRecords=true;ZCSheetView.noOfRecordsAvailable=200};this.showView=function(){window.onbeforeunload=R;function R(){if(!$.browser.msie){var X=$("span[elname=zc-saveViewRecsEl]").attr("status");if(X==="enable"){return i18n.spreadsheetcnfm1}}}var F={};var Q={};Q.name="Replace Value";Q.disabled=function(){return(ZCSheetView.isEditRecord&&!ZCSheetView.noDataAvailable)?false:true};var U={};U.name="Delete Row";U.disabled=function(){return(ZCSheetView.isDeleteRecord&&!ZCSheetView.noDataAvailable)?false:true};F.replace=Q;F.hsep2="---------";F.delete_row=U;if(ZCSheetView.custActionList.length>0){F.hsep3="---------"}for(var S=0;S<ZCSheetView.custActionList.length;S++){var T=ZCSheetView.custActionList[S];var K=T[2].displayName;var W={};W.name=K;F[K]=W}var H=(200*(ZCSheetView.columnHeaders.length))+50;var I=$("#zc-component").width();if(H>I){$("#sheetviewmaincont").css("width",(H)+1)}var M=ZCApp.getRespArr(ZCSheetView.sheetReportConditionFormateMap);$("#sheetviewmaincont").handsontable({licenseKey:"4de59-e480d-90345-f4c3a-29e47",data:ZCSheetView.data,colHeaders:ZCSheetView.columnHeaders,rowHeaders:ZCSheetView.rowHeadersList,columns:ZCSheetView.columnDetails,colWidths:ZCSheetView.columnHeadersWidth,stretchH:"all",fixedRowsTop:0,manualColumnResize:true,onmousewheel:null,cells:function(Y,X,Z){},contextMenu:{callback:function(Y,X){if(Y==="delete_row"){ZCSheetView.deleteRecords()}else{if(Y==="replace"){ZCSheetView.showReplaceRecordsDialog()}}},items:F},beforeChange:function(d,b){if(b==="edit"||b==="paste"||b==="undo"||b==="redo"||b==="autofill"){for(k=0;k<d.length;k++){var c=d[k];var Z=c[1];var a=c[3]+"";var Y=ZCSheetView.viewDetailsmap[Z];var X=Y.maxLenght;if(X!==null&&X>=0&&a.length>X){d[k][3]=a.substring(0,X);ZCSheetView.maxLenthErrorList.push(Z)}}}},afterChange:function(n,X){if(X==="loadData"){if(ZCSheetView.noDataAvailable){var e=$(".htCore").find("tr");var d=$("#nodatatrelement");e.after(d)}$(".dragdealer.horizontal").remove();$(".dragdealer.vertical").remove()}if(X==="edit"||X==="paste"||X==="undo"||X==="redo"||X==="autofill"){for(k=0;k<n.length;k++){var q=n[k];var b=q[2];var Y=q[3];var o=q[0];var a=q[1];var m=ZCSheetView.columnLabelList.indexOf(a);var h=$("#sheetviewmaincont").handsontable("getCell",o,m);if($(h).hasClass("htInvalid")){var Z="<div id='tooltip' class='tooltip_up'>Enter a vaild number</div>";$(h).attr("title","Enter a vaild number");ZCSheetView.showToolTip($(h),"Right")}else{$(h).unbind("mouseenter")}if(!$(h).hasClass("htInvalid")&&parseInt(ZCSheetView.maxLenthErrorList.indexOf(a))!==-1){var f=ZCSheetView.viewDetailsmap[a];var p=f.maxLenght;var c=q[3]+"";$(h).addClass("htInvalid");var l="Maximum length of this cell is "+p;var Z="<div id='tooltip' class='tooltip_up'>"+l+"</div>";$(h).attr("title",l);ZCSheetView.showToolTip($(h),"Right")}if(b!==Y){ZCView.toggleViewMenu(ZCSheetView.viewLinkName,"show","enable");if($.inArray(q[0],(ZCSheetView.rowList))===-1){ZCSheetView.rowList.push(q[0])}}}ZCSheetView.maxLenthErrorList=[];$("input[elname=zc-selectAllRecsEl]").prop("checked",false);$("input[elname=zc-recSelectionEl]").prop("checked",false)}},afterRender:function(Y){setTimeout(function(){$("#sheetviewmaincont").css("width",$(".htCore").width());$(".wtHider").css("width",$(".htCore").width());if(X>getWindowWidth()){$("#zc-listviewheader").css("width",($(".htCore").width()))}},500);var X=0;$(".htCore thead th").each(function(a,d){var f=$("[elname=rowfirstheader] th")[a];$(f).width($(d).width());var c=$("#zc-listviewheader").find(".zc-searchrow td")[a];$(c).width($(d).width());var b=$("#zc-viewcontainer_"+ZCSheetView.viewLinkName).find(".zc-searchrow td")[a];$(b).width($(d).width());X+=$(d).width()});$("#zc-listviewheader").width(X);$("#zc-viewcontainer_"+ZCSheetView.viewLinkName).width(X);var Z=$("colgroup col")[1];$(Z).addClass("rowHeader");$("body").unbind("mousedown").bind("mousedown",function(b){var a=$("div[elname='hidepopupdiv']");$(a).each(function(f,h){if($(this).is(":visible")){var l=$(this).closest("td");$(this).hide();var d=parseInt($(l).attr("fieldtype"));if(d===ZCConstants.SINGLE_SELECT){ZCSheetView.setCellValueForSingleSel(parseInt($(l).attr("row")),parseInt($(l).attr("col")),$(l).attr("name"))}else{if(d===ZCConstants.MULTI_SELECT){ZCSheetView.setCellValueForMultiSel(parseInt($(l).attr("row")),parseInt($(l).attr("col")),$(l).attr("name"))}}}});var c=$("input[elname='hidepopupinput']");$(c).each(function(d,f){if($(this).is(":visible")){var h=$(this).closest("td");ZCSheetView.updateDateVal(parseInt($(h).attr("row")),parseInt($(h).attr("col")),$(h).attr("name"))}})});$(document).unbind("keydown").bind("keydown",function(d){var c=(d.ctrlKey||d.metaKey)&&!d.altKey;var a=83;var b=$("span[elname=zc-saveViewRecsEl]").attr("status");if(c&&d.keyCode===a&&b==="enable"){ZCSheetView.saveRecord();d.preventDefault()}});return true},enterMoves:function(X){var Z=$("#sheetviewmaincont").handsontable("getSelected");var a=Z[0];var Y=Z[1];var c=$("#sheetviewmaincont").handsontable("getCell",a,Y);var b=$(c).find("div[elname=outerdiv]");if($(b).length>0){if($(b).hasClass("cal_field")){$(b).click()}else{$(b).dblclick()}return{row:0,col:0}}else{return{row:1,col:0}}},afterSelection:function(l,s,o,n){var Y=$(this.getCell(l,s));if(Y.find(".multisel_outer_wrapper").length==0){var q=Y.outerWidth(false)+15;var Z=Y.outerHeight(false)+15;var f=$("#sheetviewmaincont").position();var b=$(window).scrollLeft();var p=$(window).scrollTop();var h=f.left;var X=Y.position().left;var v=Y.position().left+q;var e=getWindowWidth()+b;var y=b-h;if(y>X){$(window).scrollLeft(X)}else{if(v>e){$(window).scrollLeft(v-(getWindowWidth()-h))}}var u=f.top;var d=Y.offset().top;var m=d+Z;var a=getWindowHeight();var w=p+u;if(m>a){if((a+$(window).scrollTop())<m){$(window).scrollTop(m-a)}}else{if(w>d){$(window).scrollTop(w-d)}}}if($(Y).hasClass("htNumeric")){$("#sheetviewmaincont").find(".handsontableInput").css("text-align","right")}else{$("#sheetviewmaincont").find(".handsontableInput").css("text-align","left")}},cells:function(f,Y,X){var e={};var c=f+"-"+Y;var a=M[c];if(a!==undefined&&a!==""&&a!==null){var d=1000;if(ZCSheetView.columnDetails[Y]!=undefined){var b=ZCSheetView.columnDetails[Y].data;var Z=ZCSheetView.viewDetailsmap[b];if(Z!=undefined){d=parseInt(Z.viewCompType)}}if(d===ZCConstants.DATE||d===ZCConstants.DATE_TIME){e.renderer=ZCSheetView.CustomRendererDateTime}else{if(d===50||d===ZCConstants.SINGLE_SELECT||d===ZCConstants.INLINE_SINGLE_SELECT){if(d===50||d===ZCConstants.SINGLE_SELECT){if(d===50){e.renderer=ZCSheetView.CustomRendererZohoCRMUsers}}else{e.renderer=ZCSheetView.CustomRendererSingleSel}}else{if(d===25){e.renderer=ZCSheetView.CustomRendererZohoCRM}else{if(d===ZCConstants.MULTI_SELECT){e.renderer=ZCSheetView.CustomRendererMultiSel}else{if(d===ZCConstants.URL){e.renderer=ZCSheetView.CustomRendererUrl}else{if(d===ZCConstants.IMAGE||d===36){e.renderer=ZCSheetView.CustomRendererImage}else{if(d===ZCConstants.FILE_UPLOAD){e.renderer=ZCSheetView.CustomRendererFileUpload}else{if(d===ZCConstants.RICH_TEXT_AREA){e.renderer=ZCSheetView.CustomRendererRichText}else{e.renderer=ZCSheetView.conditionalFormatRenderer}}}}}}}}}return e},});var L="<span class='right_click_menu_icon_wrapper'><span class='right_click_menu_icon replace_icon'></span></span><span class='right_click_menu_text'>Replace Value</span>";var V=$(".context-menu-list").find("span:contains('Replace Value')").parent();$(V).attr({dialogelname:"zc-replace-dialog",dialoghtmlkey:"replaceDialogHtml",elname:"zc-showReplaceDialog"});V.html(L);var P="<span class='right_click_menu_icon_wrapper'><span class='right_click_menu_icon delete_row_icon'></span></span><span class='right_click_menu_text'>Delete Row</span>";var G=$(".context-menu-list").find("span:contains('Delete Row')").parent();G.html(P);for(var S=0;S<ZCSheetView.custActionList.length;S++){var T=ZCSheetView.custActionList[S];var K=T[2].displayName;var J=T[0].functionID;var E=[];if(T.length>3){E=T[T.length-1].customActionRecIdList}var N="<span class='right_click_menu_icon_wrapper'><span class='right_click_menu_icon delete_row_icon'></span></span><span class='right_click_menu_text'>"+K+"</span>";var O=$(".context-menu-list").find("span:contains('"+K+"')").parent();$(O).attr({customactionrecidlist:E,elname:"zc-custaction-el",functionid:J,});ZCSheetView.callCustomAction(O);O.html(N)}$("#sheetviewmaincont").bind("mousedown",function(Y){if(Y.which==3||(navigator.userAgent.indexOf("Mac")!=-1&&Y.ctrlKey&&Y.which==1)){var X=$("#sheetviewmaincont").handsontable("getSelected");var a=X[0];var Z=ZCSheetView.recLinkIDList[a];$(".context-menu-list").find("li[elname=zc-custaction-el]").each(function(b,d){var c=$(d).attr("customactionrecidlist");$(d).attr("reclinkid",Z);if(c.indexOf(Z)===-1){$(d).css("display","none")}else{$(d).css("display","")}})}});$(".htCore tbody th").bind("click",function(Y){var a=$(this).html();var Z=ZCSheetView.recLinkIDList[a-1];var X=$("#sheetviewmaincont").handsontable("getInstance");if($(this).parent("tr").find("td").hasClass("tdbgcolor")){$(this).parent("tr").find("td").removeClass("tdbgcolor");$(this).removeAttr("reclinkid");$(this).removeAttr("elname")}else{$(this).parent("tr").find("td").addClass("tdbgcolor");$(this).attr("reclinkid",Z);$(this).attr("elname","zc-recSelectionEl")}if($(".htCore tbody").find("th[elname=zc-recSelectionEl]").length>0){$("a[elname=zc-deleteRecordEl]").attr("actionstatus","enable");$("a[elname=zc-deleteRecordEl]").removeClass("zc-view-menu-group-disabled")}else{$("a[elname=zc-deleteRecordEl]").attr("actionstatus","disable");$("a[elname=zc-deleteRecordEl]").addClass("zc-view-menu-group-disabled")}})};$.event.special.mousewheel={setup:function(){}};this.callCustomAction=function(E){$(E).bind("click",function(F){ZCView.doCustAction(this,ZCSheetView.viewLinkName);return false})};this.conditionalFormatRenderer=function(Q,K,S,H,G,O,R){var N=S+"-"+H;var F=ZCApp.getRespArr(ZCSheetView.sheetReportConditionFormateMap);var J=F[N];if(J!==undefined&&J!==""&&J!==null){$(K).attr("style",J)}var P=1000;if(ZCSheetView.columnDetails[H]!=undefined){var M=ZCSheetView.columnDetails[H].isEncrypted;var L=ZCSheetView.columnDetails[H].data;var I=ZCSheetView.viewDetailsmap[L];if(I!=undefined){P=parseInt(I.viewCompType)}if(M){if(O!==""&&O!==null){var E=Handsontable.helper.stringify(O);$(K).empty().append(E);return $(K)}else{Handsontable.TextCell.renderer.apply(this,arguments)}}}if(P==ZCConstants.NUMBER||P==ZCConstants.DECIMAL||P==ZCConstants.CURRENCY||P==ZCConstants.PERCENTAGE){Handsontable.NumericCell.renderer.apply(this,arguments);$(K).addClass("htNumeric")}else{Handsontable.TextCell.renderer.apply(this,arguments)}return K};this.saveRecord=function(){var R=$("#sheetviewmaincont").handsontable("getInstance");var T="<data>";for(var M=0;M<ZCSheetView.rowList.length;M++){currrow=R.getDataAtRow(ZCSheetView.rowList[M]);T=T+'<record Id="'+currrow.RECORD_LINK_ID+'">';for(var U in currrow){if(currrow.hasOwnProperty(U)){if(U==="RECORD_LINK_ID"){continue}var H=this.viewDetailsmap[U];if(!H.readOnly){var E=parseInt(H.viewCompType);T=T+'<field label="'+U+'">';if(E===ZCConstants.CHECK_BOX){var V=currrow[U]?"zc_checked":"zc_unchecked";T=T+"<value><![CDATA["+V+"]]></value>"}else{if(E===ZCConstants.SINGLE_SELECT){var S=currrow[U];var V=ZCSheetView.parseJSON(S,true);T=T+"<value><![CDATA["+V+"]]></value>"}else{if(E===ZCConstants.MULTI_SELECT){T=ZCSheetView.handelMultiSelectValue(T,currrow[U])}else{if(E===ZCConstants.DATE||E===ZCConstants.DATE_TIME){var G=currrow[U];var O=$("#dateInputEl_"+G[0]).val();T=T+"<value><![CDATA["+encodeURIComponent(O)+"]]></value>"}else{if(E===50){var N=currrow[U];var L=$("#"+N[3]).attr("extValue");T=T+"<value><![CDATA["+encodeURIComponent(L)+"]]></value>"}else{if(E===25){var N=currrow[U];var L=$("#"+N[3]).val();var K=$("#"+N[4]).val();T=T+"<value><![CDATA["+encodeURIComponent(L)+"]]></value></field>";T=T+'<field label="'+N[2]+'"><value><![CDATA['+K+"]]></value>"}else{T=T+"<value><![CDATA["+encodeURIComponent(currrow[U])+"]]></value>"}}}}}}T=T+"</field>"}}}T=T+"</record>"}T=T+"</data>";var F=ZCView.viewArr[this.viewLinkName];var J=ZCUtil.getFromMap(F,"viewFormID");var P="formID="+J+"&viewID="+ZCUtil.getFromMap(F,"viewID")+"&";if(!ZCUtil.isNull(ZCUtil.getFromMap(F,"privateLink"))){P=P+"&privateLink="+ZCUtil.getFromMap(F,"privateLink")+"&"}var I=ZCUtil.getFromMap(F,"linkedView");if(!ZCUtil.isNull(I)){P=P+"&linkedView="+I}P=P+"&data="+T+"&viewLinkName="+this.viewLinkName+"&formLinkName="+ZCUtil.getFromMap(F,"viewFormName");var Q="/gridRecordAction.do";ZCUtil.sendRequest(Q,P,"json","ZCSheetView.handleGridRecAction","",i18n.saverec)};this.handelMultiSelectValue=function(F,E){var F=F;$.each(E,function(G,H){var I=ZCSheetView.parseJSON(H,true);F=F+"<value><![CDATA["+encodeURIComponent(I)+"]]></value>"});return F};this.handleGridRecAction=function(W,M,O){var T=ZCUtil.getFromMap(M,"viewLinkName");var H=ZCView.viewArr[T];var R=ZCView.getViewCont(T);var E=ZCForm.getMsgFromResponse(W,"");var K=E.succMsg;var L=E.fieldErrObj;var I=E.successMsgDuration;ZCView.clearViewErrors(R);if(!ZCUtil.isNull(K)&&L===undefined){if(!ZCUtil.isNull(I)){ZCView.showView(H,K,"",I)}else{ZCView.showView(H,K,"")}}else{var L=E.fieldErrObj;var N=E.successList;var U=E.errorList;var S=$(R).find("div[elName=zc-delactionsdiv]").clone(true);var P=(N)?N.length+" "+i18n.recsuccmsg:"";var G=(U)?U.length+" "+i18n.recfailmsg:"";ZCView.setActionRespInDiv(S,N,U,P,G);var V=(ZCUtil.isNull(U)&&ZCUtil.isNull(N))?null:$(S).html();if(!ZCUtil.isNull(L)){ZCSheetView.showRecErrors(R,L);var J="position=absolute, closeParent=false";var Q=i18n.headererrormsg;var F=i18n.viewinvalidmsg;ZCApp.showErrorDialog(Q,F,J)}else{ZCView.showView(H,"",V)}}};this.showRecErrors=function(G,H){var E=$(G).find("table[elName=zc-viewtable]");var F=$("div[elName=zc-gridview-err-div]").find("tr[elName=zc-rec-err]");$.each(H,function(J,I){$.each(I,function(K,L){$.each(L,function(N,P){var Q=P.lableName;var R=P.errorMSg;var T=ZCSheetView.recLinkIDList.indexOf(K);var S=ZCSheetView.columnLabelList.indexOf(Q);var U=$("#sheetviewmaincont").handsontable("getInstance");var O=U.getCell(T,S);$(O).addClass("htInvalid");var M="<div id='tooltip' class='tooltip_up'>"+R+"</div>";$(O).attr("title",R);ZCSheetView.showToolTip($(O),"Right")})})})};this.deleteRecords=function(){var O=$("#sheetviewmaincont").handsontable("getInstance");var P=$("#sheetviewmaincont").handsontable("getSelected");var K=P[0];var S=P[2];var G="";var T=0;for(var K=K;K<=S;K++){var R=O.getDataAtRow(K);var F=R.RECORD_LINK_ID;G=G+F+",";T++}var E=ZCView.viewArr[ZCSheetView.viewLinkName];var N="viewLinkName="+ZCSheetView.viewLinkName+"&sharedBy="+ZCApp.sharedByDisp+"&appLinkName="+ZCApp.appLinkName+"&formID="+ZCUtil.getFromMap(E,"viewFormID")+"&privateLink="+ZCUtil.getFromMap(E,"privateLink");var L=ZCUtil.getFromMap(E,"linkedView");if(!ZCUtil.isNull(L)){N=N+"&linkedView="+L}N=N+"&deletegroup="+G;var I="/deleterecordaction.do";var H=i18n.delete1;var J=i18n.deleteinfomsg;var M=i18n.delerrormsg;var Q=i18n.deleterecord;Q=replaceParams(i18n.reallywantto,new Array(H,T));if(T>0){ZCView.showConfirmPopUp(Q,function(){ZCView.commitDelDupl(I,"delete",N)})}else{ZCView.showAlertPopUp(M);return false}};this.showReplaceRecordsDialog=function(){var F=ZCSheetView.viewLinkName;var H=$("li[elname=zc-showReplaceDialog]");var J=$(H).attr("dialogHTMLKey");var I=ZCView.getViewCont(F);var E=$(H).attr("dialogElName");if(ZCApp.htmlArr[F+"-"+J]===null||ZCApp.htmlArr[F+"-"+J]===undefined){var G=$("div[elName="+E+"]");if(G.html()!==null){ZCApp.htmlArr[F+"-"+J]=$(G).html();$(G).remove()}}ZCUtil.showInDialog(ZCApp.htmlArr[F+"-"+J],"closeButton=no, modal=yes")};this.replaceRecords=function(){ZCApp.setLoadingMsg($("#zc-loading"),i18n.replacing);ZCApp.showLoading("zc-loading");var V=$("#sheetviewmaincont").handsontable("getSelected");var T=$("#sheetviewmaincont").handsontable("getInstance");var E=V[0];var U=V[1];var R=V[2];var Q=V[3];var I=$("div[elName=zc-replace-dialog-div]");var W=$(I).find("input[name=replacevalue]").val();var L=[];for(var U=U;U<=Q;U++){for(var E=E;E<=R;E++){var G=T.getDataAtRow(E);var J=G.RECORD_LINK_ID;var S=ZCSheetView.columnLabelList[U];var M=ZCSheetView.viewDetailsmap[S];if(!M.readOnly){var H=parseInt(M.viewCompType);if(H===ZCConstants.TEXT||H===ZCConstants.TEXT_AREA||H===ZCConstants.EMAIL||H===ZCConstants.NUMBER||H===ZCConstants.CURRENCY||H===ZCConstants.PERCENTAGE){var O=[];O.push(E);O.push(U);O.push(W);L.push(O)}else{if(H===ZCConstants.INLINE_SINGLE_SELECT||H===ZCConstants.SINGLE_SELECT||H===ZCConstants.MULTI_SELECT){var K=$("#sheetviewmaincont").handsontable("getCell",E,U);var P=$(K).find("li[filter='"+W+"']");if(P.length>0){var F=$(P).attr("displayval");$(K).find("div[elname=disvalcont]").html(F);var O=[];O.push(E);O.push(U);if(H===ZCConstants.MULTI_SELECT){var N=[];N.push(W);O.push(N)}else{O.push(W)}L.push(O)}}else{if(H===ZCConstants.CHECK_BOX){var W=W.toLowerCase();if(W==="true"||W==="false"){var O=[];O.push(E);O.push(U);O.push(W);L.push(O)}}}}}}E=V[0]}setTimeout(function(){T.setDataAtCell(L,"");ZCApp.hideLoading("zc-loading");closeDialog()},100)};this.CustomRendererUrl=function(L,I,N,H,E,K,M){if(K!==""&&K!==null){var F=Handsontable.helper.stringify(K);F="<a target='_blank' href='"+F+"'>"+F+"</a>";I.innerHTML=F;var G=$(I);var J=$(F);J.on("mousedown",function(O){O.stopPropagation()});G.empty().append(J);return I}else{Handsontable.TextCell.renderer.apply(this,arguments)}};this.CustomRendererEncryptionField=function(E,L,J,F,K,H,G){if(H!==""&&H!==null){var I=Handsontable.helper.stringify(H);$(L).empty().append(I);return $(L)}else{Handsontable.TextCell.renderer.apply(this,arguments)}};this.CustomRendererImage=function(M,I,O,H,E,L,N){if(L!==""&&L!==null){var F=Handsontable.helper.stringify(L);var J=(F.toString().indexOf("<a")==0);if(F.toString().indexOf("<img")!=-1){F=F.replace("<img ","<img style='cursor:pointer;' onclick='ZCView.imgView(this,"+J+");' ")}I.innerHTML=F;var G=$(I);var K=$(F);K.on("mousedown",function(P){P.stopPropagation()});G.empty().append(K);return I}else{Handsontable.TextCell.renderer.apply(this,arguments)}};this.CustomRendererFileUpload=function(L,I,N,H,E,K,M){if(K!==""&&K!==null&&K.length>0){var F="<a href='"+K[1]+"'>"+K[0]+"</a>";I.innerHTML=F;var G=$(I);var J=$(F);J.on("mousedown",function(O){O.stopPropagation()});G.empty().append(J);return I}else{Handsontable.TextCell.renderer.apply(this,arguments)}};this.CustomRendererDateTime=function(P,K,R,J,F,O,Q){if(O!==""&&O!==null){var M=O[0];var H=O[1];var L=O[2];var I="<input elname='hidepopupinput' type='text' style='display:none;margin-left:-3px' id='dateInputEl_"+M+"' fieldtype='"+H+"' value='"+L+"'>";I=I+"<div elname='outerdiv' id='dateButtonEl_"+M+"' class='htAutocomplete cal_field'>";if(L!==""){I=I+L+"<div class='cal_icon1'></div></div>"}else{I=I+"&nbsp; <div class='cal_icon1'></div></div>"}var E=Handsontable.helper.stringify(I);K.innerHTML=E;var G=$(K);var N=$(E);var G=$(K);$(G).attr({row:R,col:J,name:"dateInputEl_"+M});N.on("mousedown",function(S){S.stopPropagation()});G.empty().append(N);ZCView.showCalendar($("#dateInputEl_"+M));$("#dateInputEl_"+M).width(G.width());$("#dateInputEl_"+M).height(20);$("#dateButtonEl_"+M).click(function(S){setTimeout(function(){$("#sheetviewmaincont").handsontable("selectCell",R,J);$("#dateInputEl_"+M).show();$("#dateInputEl_"+M).prop("tabIndex",0).focus();$("#dateButtonEl_"+M).hide();S.stopPropagation()},20)});$("#dateInputEl_"+M).keydown(function(S){if(S.which===13||S.which===ZCConstants.TAB||S.which===ZCConstants.ESCAPE){ZCSheetView.updateDateVal(R,J,"dateInputEl_"+M);S.stopPropagation()}});$("#dateInputEl_"+M).focusout(function(S){$("#dateInputEl_"+M).hide();$("#dateButtonEl_"+M).show();ZCSheetView.updateDateVal(R,J,"dateInputEl_"+M);S.stopPropagation()});return K}else{Handsontable.TextCell.renderer.apply(this,arguments)}};this.updateDateVal=function(M,H,F){var I=$("#"+F);var K=$("#sheetviewmaincont").handsontable("getInstance");var G=$(I).val();var L=$(I).attr("id");var J=$(I).attr("fieldType");var E=[L,J,G];K.setDataAtCell(M,H,E)};this.CustomRendererRichText=function(K,I,M,H,E,J,L){if(J!==""&&J!==null){var F=Handsontable.helper.stringify(J);I.innerHTML=F;var G=$(I);G.on("mousedown",function(N){N.stopPropagation()});return I}else{Handsontable.TextCell.renderer.apply(this,arguments)}};this.CustomRendererSubform=function(K,I,M,H,E,J,L){if(J!==""&&J!==null){var F=Handsontable.helper.stringify(J);I.innerHTML=F;var G=$(I);G.on("mousedown",function(N){N.stopPropagation()});return I}else{Handsontable.TextCell.renderer.apply(this,arguments)}};this.CustomRendererZohoCRM=function(Y,N,I,G,F,U,R){if(U!==""&&U!==null){var L=U[0];var a=U[1];var T=U[2];var S=U[3];var E=U[4];var P=U[5];var V=U[6];var Z=ZCSheetView.recLinkIDList[I];var X=ZCSheetView.columnLabelList[G];var Q="crmField_"+X+"_"+Z;var K="outerdiv_"+X+"_"+Z;var M="cleardiv_"+X+"_"+Z;var b="<input type='hidden' setdataatcell='true' id="+S+" value='"+L+"'><input type='hidden' id="+E+" value='"+a+"'>";var O="<div id='"+K+"'  class='multisel_outer_wrapper'><div ondblclick='ZCSheetView.showExternalPopup(\""+V+'", "'+S+"\")' id='crmField_"+X+"_"+Z+"' class='htAutocomplete'>";if(L!==""){O=O+L+"</div><div id='"+M+"' class='clear_value'></div>"+b+"</div>"}else{O=O+"&nbsp; </div><div id='"+M+"' class='clear_value'></div>"+b+"</div>"}var J=Handsontable.helper.stringify(O);N.innerHTML=J;var H=$(N);var W=$(J);W.on("mousedown",function(c){c.stopPropagation()});H.empty().append(W);$("#"+K).click(function(c){$("#sheetviewmaincont").handsontable("selectCell",I,G)});$("#"+M).click(function(c){$("#"+Q).html("&nbsp;");$("#"+S).val("");ZCSheetView.updateZohoCrmVal(S);c.stopPropagation()});$("#"+S).attr({row:I,col:G,fieldIdValue:a,extLabelName:T,labelNameId:S,extLabelNameId:E,exModuleStr:P,urlString:V});return N}else{Handsontable.TextCell.renderer.apply(this,arguments)}};this.CustomRendererZohoCRMUsers=function(a,Q,K,I,F,W,T){if(W!==""&&W!==null){var O=W[0];var V=W[1];var Z=W[2];var H=W[3];var U=W[4];var L=W[5];var E=W[6];var b=ZCSheetView.recLinkIDList[K];var Y=ZCSheetView.columnLabelList[I];var S="crmField_"+Y+"_"+b;var N="outerdiv_"+Y+"_"+b;var P="cleardiv_"+Y+"_"+b;var G="sheet";var c="<input type='hidden' extValue='"+O+"' formLinkName='"+L+"' setdataatcell='true' id="+H+" value='"+E+"'>";var R="<div id='"+N+"'  class='multisel_outer_wrapper'><div ondblclick='ZCEvalApp.showExternalModuleLookup(\""+V+'", "'+Z+'","'+H+'", "'+U+'",'+b+', "'+G+"\")' id='"+S+"' class='htAutocomplete'>";if(E!==""){R=R+E+"</div><div id='"+P+"' class='clear_value'></div>"+c+"</div>"}else{R=R+"&nbsp; </div><div id='"+P+"' class='clear_value'></div>"+c+"</div>"}var M=Handsontable.helper.stringify(R);Q.innerHTML=M;var J=$(Q);var X=$(M);X.on("mousedown",function(d){d.stopPropagation()});J.empty().append(X);$("#"+N).click(function(d){$("#sheetviewmaincont").handsontable("selectCell",K,I)});$("#"+P).click(function(d){$("#"+S).html("&nbsp;");$("#"+H).val("");$("#"+H).attr("extValue","");ZCSheetView.updateZohoCrmUserVal(H);d.stopPropagation()});$("#"+H).attr({row:K,col:I,serviceType:V,moduleType:Z,crmlabelName:H,fsfield:U,formLinkName:L,});return Q}else{Handsontable.TextCell.renderer.apply(this,arguments)}};this.updateZohoCrmVal=function(K){var O=parseInt($("#"+K).attr("row"));var F=parseInt($("#"+K).attr("col"));var G=$("#"+K).attr("extLabelName");var K=$("#"+K).attr("labelNameId");var L=$("#"+K).attr("extlabelnameid");var N=$("#"+L).val();var H=$("#"+K).attr("exModuleStr");var I=$("#"+K).attr("urlString");var E=$("#"+K).val();var J=[E,N,G,K,L,H,I];if(E!==""){$("#crmField_"+K).html("&nbsp;")}else{$("#crmField_"+K).html(E)}var M=$("#sheetviewmaincont").handsontable("getInstance");M.setDataAtCell(O,F,J)};this.updateZohoCrmUserVal=function(M){var P=parseInt($("#"+M).attr("row"));var H=parseInt($("#"+M).attr("col"));var G=$("#"+M).attr("serviceType");var N=$("#"+M).attr("moduleType");var F=$("#"+M).attr("crmlabelName");var J=$("#"+M).attr("fsfield");var K=$("#"+M).attr("formLinkName");var E=$("#"+M).val();var I=$("#"+M).attr("extValue");var L=[I,G,N,F,J,K,E];if(I!==""){$("#"+M).html("&nbsp;")}else{$("#"+M).html(I)}var O=$("#sheetviewmaincont").handsontable("getInstance");O.setDataAtCell(P,H,L)};this.CustomRendererSingleSel=function(f,M,K,I,H,Z,X){var U=arguments[6];var N=U.dataList;var S=U.valueList;var Q=U.hiddenDataList;var e=U.hiddenValueList;var Y=U.formCompID;var L="";var h=ZCSheetView.recLinkIDList[K];var d=ZCSheetView.columnLabelList[I];var l="singleSel_"+d+"_"+h;var a="singleSelDiv_"+d+"_"+h;var W="singleSelOuterDiv_"+d+"_"+h;var G=ZCConstants.SINGLE_SELECT;var d=ZCSheetView.columnDetails[I].data;var P=ZCSheetView.viewDetailsmap[d];if(P!=undefined){G=parseInt(P.viewCompType)}var T="";var E="";if(G==ZCConstants.SINGLE_SELECT&&Z!=""&&Z!=null){var R=JSON.parse(Z);T=R.value+"";E=R.text}else{T=Z}if(Q!=null&&e!=null){for(var c=0;c<Q.length;c++){var V=e[c];if(V.indexOf("&#39;")!==-1||V.indexOf("&amp;")!==-1){if(V.indexOf("&#39;")!==-1){V=V.replace("&#39;","'")}else{V=V.replace("&amp;","&")}}if(T!==""&&T!==null&&T===V){L=Q[c]}}}for(var c=0;c<N.length;c++){var V=S[c];if(V.indexOf("&#39;")!==-1||V.indexOf("&amp;")!==-1){if(V.indexOf("&#39;")!==-1){V=V.replace("&#39;","'")}else{V=V.replace("&amp;","&")}}if(T!==""&&T!==null&&T===V){L=N[c]}}if(L==""&&E!==""&&E!==null){L=E}if(L===""||L===null){L=" -Select- "}var O="<div id="+W+" class='multisel_outer_wrapper' elname='outerdiv' formCompId='"+Y+"'><div elname='disvalcont' id='singleSelDiv_"+d+"_"+h+"' class='htAutocomplete multisel_wrapper'>"+L+"<div class='custom_drop_double_arrow_img'></div></div></div>";M.innerHTML=O;var J=$(M);var F=12;$(J).attr({row:K,col:I,name:l,fieldtype:F,});var J=$(M);var b=$(O);b.on("mousedown",function(m){m.preventDefault()});J.empty().append(b);$(M).css("overflow","visible");$("#"+W).dblclick(function(m){ZCSheetView.initVariables();ZCSheetView.SingleSelOptionPopulate(M,K,I,T,N,S)});$("#"+W).click(function(m){$("#sheetviewmaincont").handsontable("selectCell",K,I)});return M};this.SingleSelOptionPopulate=function(J,H,G,T,K,O){var I="";var X=ZCSheetView.recLinkIDList[H];var W=ZCSheetView.columnLabelList[G];var Y="singleSel_"+W+"_"+X;var U="singleSelDiv_"+W+"_"+X;var R="singleSelOuterDiv_"+W+"_"+X;ZCSheetView.isMultiSelectOptions=false;var L="<div elname='hidepopupdiv' class='custom_multiselect' id='"+Y+"' onscroll='ZCSheetView.loadLookupValues(this,"+X+","+H+","+G+");'><ul>";var P="";for(var V=0;V<K.length;V++){var S=O[V];if(S.indexOf("&#39;")!==-1||S.indexOf("&amp;")!==-1){if(S.indexOf("&#39;")!==-1){S=S.replace("&#39;","'")}else{S=S.replace("&amp;","&")}}if(T!==""&&T!==null&&T===S){I=K[V];P=P+"<li  class='selected' displayval='"+K[V]+"' filter='"+O[V]+"'>"+K[V]+"</li>"}else{P=P+"<li  displayval='"+K[V]+"' filter='"+O[V]+"'>"+K[V]+"</li>"}}if(I==""&&T!==""&&T!==null){I=T}if(I===""){I=" -Select- ";L=L+"<li  class='selected' displayval=' -Select- ' filter='-Select-'> -Select- </li>"}else{L=L+"<li displayval=' -Select- ' filter='-Select-'> -Select- </li>"}L=L+P+"</ul></div>";$("#"+R).append(L);var E=$("#"+Y);var Q=$("#"+U);var N=$("#"+R);$(E).css("top",$(N).height()+2);$(Q).width(($(J).width()-20));var F=$(N).offset().top;var M=getWindowHeight();if((M-F)<=300&&$(E).height>=300){$(E).css("top",$(N).height()-300)}$(E).find("li:first").prop("tabIndex",0).focus();$(E).mousedown(function(Z){Z.stopPropagation()});$(E).find("li").keydown(function(Z){var a=Z.keyCode;if(a===ZCConstants.TAB||a===ZCConstants.ESCAPE){ZCSheetView.setCellValueForSingleSel(H,G,Y);$(E).remove()}else{if(a===ZCConstants.DOWN){$(this).next().prop("tabIndex",0).focus();return false}else{if(a===ZCConstants.UP){$(this).prev().focus()}else{if(a===ZCConstants.SPACE||a===ZCConstants.ENTER){ZCSheetView.setValueForSingleSel(Z,this,Y,U);ZCSheetView.setCellValueForSingleSel(H,G,Y);$(E).remove();return false}}}}Z.stopPropagation()});$(E).find("li").mousedown(function(Z){mouseDowned=true;$(this).prop("tabindex",0).focus();ZCSheetView.setValueForSingleSel(Z,this,Y,U);ZCSheetView.setCellValueForSingleSel(H,G,Y);$(E).remove()})};this.setValueForSingleSel=function(H,G,J,I){var F=$("#"+J).find("ul");$(F).find(".selected").each(function(){$(this).removeClass("selected")});$(G).addClass("selected");var E="";if($(G).hasClass("selected")){E=E+$(G).attr("displayval")+","}if(E!==""){E=E.substring(0,E.length-1)}else{E=" -Select- "}$("#"+I).text(E)};this.setCellValueForSingleSel=function(Q,F,E){var P=ZCConstants.SINGLE_SELECT;var I=ZCSheetView.columnDetails[F].data;var G=ZCSheetView.viewDetailsmap[I];var O=$("#sheetviewmaincont").handsontable("getInstance");if(G!=undefined){P=parseInt(G.viewCompType)}var L=$("#"+E).find("ul");var K={};var H="";var J=$(L).find(".selected");if(P==ZCConstants.SINGLE_SELECT){if($(J).length!=0){K.text=($(J).attr("displayval"));K.value=($(J).attr("filter"))}else{var M=O.getDataAtCell(Q,F);var N=JSON.parse(M);K=N}}else{H=($(J).attr("filter"))}(P==ZCConstants.SINGLE_SELECT)?O.setDataAtCell(Q,F,JSON.stringify(K)):O.setDataAtCell(Q,F,H);$("#"+E).remove()};this.loadLookupValues=function(I,G,P,H){var O=$(I).scrollTop()+$(I).innerHeight()>=$(I)[0].scrollHeight;if(O&&!ZCSheetView.hasActiveLookupOptionReq&&ZCSheetView.hasMoreRecords){ZCSheetView.hasActiveLookupOptionReq=true;ZCSheetView.lookupDropDownDiv=I;var L=$(I).parent(".multisel_outer_wrapper").attr("formCompId");var F="/LoadLookupValues.do";var E=ZCView.viewArr[ZCSheetView.viewLinkName];var N=ZCUtil.getFromMap(E,"viewFormID");var K=ZCUtil.getFromMap(E,"viewType");var J="sharedBy="+ZCApp.sharedByDisp+"&formCompId="+L+"&appnedRows="+true+"&noOfRecsInCache="+ZCSheetView.noOfRecordsAvailable+"&formid="+N+"&viewType="+K;var M="row="+P+"&col="+H;ZCApp.showLoading("zc-loading");ZCSheetView.timeout=setTimeout('ZCUtil.sendRequest("'+F+'","'+J+'",'+null+',"ZCSheetView.appendOptions","'+M+'",'+null+","+false+")",1000)}};this.appendOptions=function(E,L,F){ZCApp.hideLoading("zc-loading");var U=$(ZCSheetView.lookupDropDownDiv).find("ul li").length;var X=$(ZCSheetView.lookupDropDownDiv).attr("id");var P=$(ZCSheetView.lookupDropDownDiv).prev().attr("id");var O=ZCUtil.getParamsAsMap(F);var J=parseInt(O.row[0]);var G=parseInt(O.col[0]);var H=JSON.parse(E);var W=$("#sheetviewmaincont").handsontable("getInstance");var Y=W.getDataAtCell(J,G);var T=[];if(ZCSheetView.isMultiSelectOptions){for(var R=0;R<Y.length;R++){var Q=ZCSheetView.parseJSON(Y[R],true);T.push(Q)}}else{T.push(ZCSheetView.parseJSON(Y,true))}var M="";for(var S=0;S<H.length;S++){var K="";var I=H[S].text;var V=H[S].value;if(T.includes(V)){K="class='selected'"}if(ZCSheetView.isMultiSelectOptions){M=M+"<li "+K+"displayval='"+I+"' filter='"+V+"'><span>&#10003;</span>"+I+"</li>"}else{M=M+"<li "+K+"displayval='"+I+"' filter='"+V+"'>"+I+"</li>"}}$(ZCSheetView.lookupDropDownDiv).find("ul").append(M);var N=$(ZCSheetView.lookupDropDownDiv).find("ul li").length-U;if(N<200){ZCSheetView.hasMoreRecords=false}ZCSheetView.hasActiveLookupOptionReq=false;ZCSheetView.noOfRecordsAvailable+=N;$(ZCSheetView.lookupDropDownDiv).find("li").keydown(function(Z){var a=Z.keyCode;if(a===ZCConstants.TAB||a===ZCConstants.ESCAPE){ZCSheetView.setCellValueForSingleSel(J,G,X);$(ZCSheetView.lookupDropDownDiv).remove()}else{if(a===ZCConstants.DOWN){$(this).next().prop("tabIndex",0).focus();return false}else{if(a===ZCConstants.UP){$(this).prev().focus()}else{if(a===ZCConstants.SPACE||a===ZCConstants.ENTER){ZCSheetView.setValueForSingleSel(Z,this,X,P);ZCSheetView.setCellValueForSingleSel(J,G,X);$(ZCSheetView.lookupDropDownDiv).remove();return false}}}}Z.stopPropagation()});$(ZCSheetView.lookupDropDownDiv).find("li").unbind("mousedown").bind("mousedown",function(Z){if(ZCSheetView.isMultiSelectOptions){$(this).prop("tabindex",0).focus();ZCSheetView.setValueForMultiSel(Z,this,X,P,J,G)}else{$(this).prop("tabindex",0).focus();ZCSheetView.setValueForSingleSel(Z,this,X,P);ZCSheetView.setCellValueForSingleSel(J,G,X);$(ZCSheetView.lookupDropDownDiv).remove()}})};this.CustomRendererMultiSel=function(c,K,I,G,F,V,T){var Q=arguments[6];var L=Q.dataList;var P=Q.valueList;var N=Q.hiddenDataList;var b=Q.hiddenValueList;var U=Q.formCompID;var J="";var d=ZCSheetView.recLinkIDList[I];var a=ZCSheetView.columnLabelList[G];var h="multiSel_"+a+"_"+d;var W="multiSelDiv_"+a+"_"+d;var S="multiSelOuterDiv_"+a+"_"+d;if(N!=null&&b!=null){for(var Z=0;Z<N.length;Z++){var O=V;if(O!==null&&O!=="9999999999"&&O.length>0){for(var Y=0;Y<O.length;Y++){var f=ZCSheetView.parseJSON(O[Y],true);var R=b[Z];if(R.indexOf("&#39;")!==-1||R.indexOf("&amp;")!==-1){if(R.indexOf("&#39;")!==-1){R=R.replace("&#39;","'")}else{R=R.replace("&amp;","&")}}if(f!==""&&f!==null&&f===R){J=J+N[Z]+","}}}}}var O=V;for(var Z=0;Z<L.length;Z++){if(O!==null&&O!=="9999999999"&&O.length>0){for(var Y=0;Y<O.length;Y++){var f=ZCSheetView.parseJSON(O[Y],true);var R=P[Z];if(R.indexOf("&#39;")!==-1||R.indexOf("&amp;")!==-1){if(R.indexOf("&#39;")!==-1){R=R.replace("&#39;","'")}else{R=R.replace("&amp;","&")}}if(f!==""&&f!==null&&f===R){J=J+L[Z]+","}}}}for(var Y=0;Y<O.length;Y++){var f=ZCSheetView.parseJSON(O[Y],false);if(J.indexOf(f)==-1){J=J+f+","}}if(J!==""){J=J.substring(0,J.length-1)}else{J=" -Select- "}var M="<div id="+S+" class='multisel_outer_wrapper' elname='outerdiv' formCompID="+U+"><div elname='disvalcont' id='"+W+"' class='htAutocomplete multisel_wrapper'>"+J+"<div class='custom_drop_double_arrow_img'></div></div></div>";K.innerHTML=M;var H=$(K);var E=13;$(H).attr({row:I,col:G,name:h,fieldtype:E});var X=$(M);X.on("mousedown",function(l){l.preventDefault()});H.empty().append(X);$(K).css("overflow","visible");$("#multiSel_"+a+"_"+d).css("top",$("#"+S).height()+2);$("#multiSelDiv_"+a+"_"+d).width((H.width()-20));var e=false;$("#"+S).dblclick(function(l){ZCSheetView.initVariables();ZCSheetView.MultiSelOptionPopulate(K,I,G,V,L,P)});$("#"+S).click(function(l){$("#sheetviewmaincont").handsontable("selectCell",I,G)});return K};this.parseJSON=function(H,G){try{var F="";if(typeof (H)=="object"){F=(G)?H.value+"":H.text+""}else{F=(typeof (JSON.parse(H))=="object")?(G)?JSON.parse(H).value+"":JSON.parse(H).text+"":H+""}return F}catch(E){return H+""}};this.MultiSelOptionPopulate=function(J,H,G,U,K,P){var I="";var Z=ZCSheetView.recLinkIDList[H];var Y=ZCSheetView.columnLabelList[G];var b="multiSel_"+Y+"_"+Z;var V="multiSelDiv_"+Y+"_"+Z;var S="multiSelOuterDiv_"+Y+"_"+Z;ZCSheetView.isMultiSelectOptions=true;var L="<div elname='hidepopupdiv' class='custom_multiselect'  id='"+b+"' onscroll='ZCSheetView.loadLookupValues(this,"+Z+","+H+","+G+");'><ul>";var O=U;for(var X=0;X<K.length;X++){var T="";var O=U;if(O!==null&&O!=="9999999999"&&O.length>0){for(var W=0;W<O.length;W++){var a=ZCSheetView.parseJSON(O[W],true);var R=P[X];if(R.indexOf("&#39;")!==-1||R.indexOf("&amp;")!==-1){if(R.indexOf("&#39;")!==-1){R=R.replace("&#39;","'")}else{R=R.replace("&amp;","&")}}if(a!==""&&a!==null&&a===R){T="selected='selected'"}}}if(T!==""){I=I+K[X]+",";L=L+"<li  class='selected' displayval='"+K[X]+"' filter='"+P[X]+"'><span>&#10003;</span>"+K[X]+"</li>"}else{L=L+"<li  displayval='"+K[X]+"' filter='"+P[X]+"'><span>&#10003;</span>"+K[X]+"</li>"}}L=L+"</ul></div>";$("#"+S).append(L);var E=$("#"+b);var Q=$("#"+V);var N=$("#"+S);$(E).css("top",$(N).height()+2);$(Q).width(($(J).width()-20));var F=$(N).offset().top;var M=getWindowHeight();if((M-F)<=300&&$(E).height>=300){$(E).css("top",$(N).height()-300)}$(E).find("li:first").prop("tabIndex",0).focus();$(E).mousedown(function(c){c.stopPropagation()});$(E).find("li").keydown(function(c){var d=c.keyCode;if(d===ZCConstants.TAB||d===ZCConstants.ESCAPE){ZCSheetView.setCellValueForMultiSel(H,G,b);$(E).remove()}else{if(d===ZCConstants.DOWN){$(this).next().prop("tabIndex",0).focus();return false}else{if(d===ZCConstants.UP){$(this).prev().focus()}else{if(d===ZCConstants.SPACE){ZCSheetView.setValueForMultiSel(c,this,b,V,H,G);return false}else{if(d===ZCConstants.ENTER){ZCSheetView.setCellValueForMultiSel(H,G,b)}}}}}c.stopPropagation()});$(E).find("li").mousedown(function(c){$(this).prop("tabindex",0).focus();ZCSheetView.setValueForMultiSel(c,this,b,V,H,G)})};this.setValueForMultiSel=function(E,J,F,N,S,H){var P=$("#sheetviewmaincont").handsontable("getInstance");var O=P.getDataAtCell(S,H);var R=[];var I=[];for(var L=0;L<O.length;L++){R.push(ZCSheetView.parseJSON(O[L],false));I.push(ZCSheetView.parseJSON(O[L],true))}var M=$("#"+F).find("ul");if($(J).hasClass("selected")){$(J).removeClass("selected")}else{$(J).addClass("selected")}var K="";$(M).find(".selected").each(function(){K=K+$(this).attr("displayval")+","});for(var Q=0;Q<I.length;Q++){var G=$(M).find("li[filter='"+I[Q]+"']").length!=0;if(!G){K=K+R[Q]+","}}if(K!==""){K=K.substring(0,K.length-1)}else{K=" -Select- "}$("#"+N).text(K);E.stopPropagation()};this.setCellValueForMultiSel=function(Q,H,F){var N=$("#sheetviewmaincont").handsontable("getInstance");var M=N.getDataAtCell(Q,H);var P=[];var I=[];for(var K=0;K<M.length;K++){P.push(ZCSheetView.parseJSON(M[K],false));I.push(ZCSheetView.parseJSON(M[K],true))}var L=$("#"+F).find("ul");var J=[];$(L).find(".selected").each(function(){var R={};R.text=$(this).attr("displayval");R.value=$(this).attr("filter");J.push(R)});for(var O=0;O<I.length;O++){var G=$(L).find("li[filter='"+I[O]+"']").length!=0;if(!G){var E={};E.text=P[O];E.value=I[O];J.push(E)}}N.setDataAtCell(Q,H,J);$("#"+F).remove()};this.CustomActionRenderer=function(Q,J,S,I,F,P,R){var N=arguments[6];var O=N.actionName;var L=N.functionID;var H=[];H=N.customActionRecIdList;var M=ZCSheetView.recLinkIDList[S];var K="";if(H.indexOf(M)!==-1){K="<a functionid='"+L+"' recLinkID='"+M+"'  style='cursor:pointer;font-weight:normal; font-size:11px;' class='zc-formbutton' elname='zc-custaction-el' href='javascript:;'> "+O+" </a>"}else{K="<a style='opacity :0.4;font-weight:normal; font-size:11px;' class='zc-formbutton' href='javascript:;'> "+O+" </a>"}var E=Handsontable.helper.stringify(K);J.innerHTML=E;var G=$(J);G.on("mousedown",function(T){T.stopPropagation()});return J};this.CustomRendererCheckbox=function(O,J,R,I,G,N,P){var K=ZCSheetView.recLinkIDList[R];var L="<input type='checkbox'/>";var Q={row:R,col:0};var E={row:R,col:(ZCSheetView.columnHeaders.length-1)};var F=Handsontable.helper.stringify(L);J.innerHTML=F;var H=$(J);H.on("mousedown",function(S){S.stopPropagation()});$(J).attr("align","center");var M=$("#sheetviewmaincont").handsontable("getInstance");$(J).find("input").click(function(V){var U=$(this).is(":checked");$(this).prop("checked",U);var S=ZCView.getElementOrValue("zcActionTypeBulk",ZCSheetView.viewLinkName);if(U){for(var T=0;T<=(ZCSheetView.columnHeaders.length-1);T++){var W=M.getCell(R,T);$(W).addClass("tdbgcolor")}$(S).removeClass("zc-view-menu-group-disabled").attr("actionStatus","enable")}else{for(var T=0;T<=(ZCSheetView.columnHeaders.length-1);T++){var W=M.getCell(R,T);$(W).removeClass("tdbgcolor")}$(S).addClass("zc-view-menu-group-disabled").attr("actionStatus","disable")}});return J};var C=null;this.postMessageCallback=function(F,E){var H=JSON.parse(F.data);if(H.pbname!=null&&H.pbname!="null"&&H.pbname!=undefined&&H.pbname!="undefined"&&H.pbname!=""){docid(E).value=H.pbname;docid("crmField_"+E).innerHTML=H.fldId}else{if(H.fldName!=null&&H.fldName!="null"&&H.fldName!=undefined&&H.fldName!="undefined"&&H.fldName!=""){docid(E).value=H.fldName;docid("crmField_"+E).innerHTML=H.fldId}}var G=C.attr("extlabelnameid");docid(G).value=H.fldId;docid(E).setAttribute("fieldidvalue",H.fldId);this.updateZohoCrmVal(E);closeDialog();CRMLookupCallBack();A=undefined;D=undefined};var A,D;var B=false;var C=null;this.showExternalPopup=function(I,F){var G=false;C=$("input[id='"+F+"']");var E=C.attr("disabled");if(E!=="disabled"){ExternalFieldName=F;var H=C.attr("exmodulestr");if(docid("CRMPopupIframe")!=null){closeDialog()}ZCApp.setLoadingMsg($("#zc-loading"),i18n.pleasewait+" ...");ZCApp.showLoading("zc-loading");I=I+"&service=zcreator";ZCUtil.showInDialog("<span id='CRMPopup'><div class='zc-imgpreview_outerdiv'><center id='iframeTitle'>"+i18n.ZohoCRM+" - "+H+" "+i18n.NameLookup+"</center></div><br/><div class='zc-imgpreview_src'><iframe id='CRMPopupIframe' src="+I+" width='700' height='560' style='border:none;'></iframe></div></span>");$(oDialog).hide();$(oDialog).find("#iframeTitle").css("margin","17px");$(oDialog).find(".zc-dialog-close").css("margin-top","17px");$(oDialog).find(".zc-dialog-close-old span").css("color","black");$(oDialog).find(".zc-imgpreview_src").css("margin-top","-25px");A=F;D=I;if(!G){G=true;if(window.addEventListener){window.addEventListener("message",function(J){ZCSheetView.messageListener(J)},false)}else{window.attachEvent("onmessage",function(J){ZCSheetView.messageListener(J)})}}$("#CRMPopupIframe").on("load",function(){ZCApp.hideLoading("zc-loading");$(oDialog).show();var J=window.location.href;J=J.substring(0,J.indexOf("//")+2)+location.host;docid("CRMPopupIframe").contentWindow.postMessage(J,integrationCRMUrl)})}};this.messageListener=function(E){if(A!=undefined&&D!=undefined&&E.origin==integrationCRMUrl){ZCSheetView.postMessageCallback(E,A)}};this.showToolTip=function(E,H){var F=$(E).attr("title");var G=(H==="left")?"Right":"Left";$(E).attr("title","");$(E).mouseenter(function(K){$("#tooltip").remove();var J=$(E).position().left;var L=$(E).position().top+$(E).height()+10;var I="top : "+L+"px; left :"+J+"px;z-index:99999;position:absolute;";tooltip="<div id='tooltip' class='tooltip_up'>"+F+"</div>";$(E).append(tooltip);$("#tooltip").hide();$("#tooltip").css({top:L,left:J,"z-index":"99999"});$("#tooltip").css({display:"block",opacity:0});$("#tooltip").stop().animate({opacity:1,top:L-8},200)});$(E).bind("mouseleave mousedown",function(){$("#tooltip").fadeOut(300,function(){$(this).remove()})})};this.animateScrollTop=function(E){$("html, body").animate({scrollTop:E},1000,"easeOutQuint")};this.animateScrollLeft=function(E){$("html, body").animate({scrollLeft:E},1000,"easeOutQuint")}}();var RecordComment=new function(){this.formId=null;this.viewLinkName=null;this.privateLink=null;this.addComment=function(){var A=$(".comment_wrapper").find("ul");if(A.length>0){A.addClass("comment_list");A.prepend('<li class="post_cmmnt"><textarea id=addcommentText placeholder="Post your comment here..."></textarea><div class="mT10" style="text-align:right;"><input type="button" value="Add Comment" class="cmnt_btn" onclick=\'RecordComment.saveComment()\'></div></li>')}};this.saveComment=function(){$.ajax({url:"/recordComment.do",data:{sharedBy:ZCApp.sharedByDisp,appLinkName:ZCApp.appLinkName,viewLinkName:RecordComment.viewLinkName,comment:$("#addcommentText").val(),formId:RecordComment.formId,recid:currentRecordLinkId,addedUser:ZCApp.loginUser,privateLink:RecordComment.privateLink,},type:"POST",async:false,success:function(B,A,D){$("#addcommentText").val("");if(B.comment!==undefined){var C=$(".comment_wrapper").find("ul");$(C).find("li:first").after('<li><div  class="comment_text" >'+B.comment+'</div><div class="mT10"> <span class="name"> '+B.addedUserDisp+' </span><span class="date_time">'+B.date+' </span></div><div class="clearBoth"></div></li>')}},error:function(B,A,C){}})}}();(function(){function N(A){for(var C,e=A.css("color"),h,A=A[0],n=!1;A&&!h&&!n;){try{C=$(A).css("background-color")}catch(m){C="transparent"}"transparent"!==C&&"rgba(0, 0, 0, 0)"!==C&&(h=C);n=A.body;A=A.parentNode}var A=/rgb[a]*\((\d+),\s*(\d+),\s*(\d+)/,n=/#([AaBbCcDdEeFf\d]{2})([AaBbCcDdEeFf\d]{2})([AaBbCcDdEeFf\d]{2})/,B;C=void 0;(C=e.match(A))?B={r:parseInt(C[1],10),g:parseInt(C[2],10),b:parseInt(C[3],10)}:(C=e.match(n))&&(B={r:parseInt(C[1],16),g:parseInt(C[2],16),b:parseInt(C[3],16)});var l;h?(C=void 0,(C=h.match(A))?l={r:parseInt(C[1],10),g:parseInt(C[2],10),b:parseInt(C[3],10)}:(C=h.match(n))&&(l={r:parseInt(C[1],16),g:parseInt(C[2],16),b:parseInt(C[3],16)})):l=B?127<Math.max.apply(null,[B.r,B.g,B.b])?{r:0,g:0,b:0}:{r:255,g:255,b:255}:{r:255,g:255,b:255};C=function(a){return"rgb("+[a.r,a.g,a.b].join(", ")+")"};B&&l?(A=Math.max.apply(null,[B.r,B.g,B.b]),B=Math.max.apply(null,[l.r,l.g,l.b]),B=Math.round(B+-0.75*(B-A)),B={r:B,g:B,b:B}):B?(B=Math.max.apply(null,[B.r,B.g,B.b]),A=1,127<B&&(A=-1),B=Math.round(B+96*A),B={r:B,g:B,b:B}):B={r:191,g:191,b:191};return{color:e,"background-color":l?C(l):h,"decor-color":C(B)}}function R(A,B){this.x=A;this.y=B;this.reverse=function(){return new this.constructor(-1*this.x,-1*this.y)};this._length=null;this.getLength=function(){this._length||(this._length=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)));return this._length};var C=function(a){return Math.round(a/Math.abs(a))};this.resizeTo=function(c){if(0===this.x&&0===this.y){this._length=0}else{if(0===this.x){this._length=c,this.y=c*C(this.y)}else{if(0===this.y){this._length=c,this.x=c*C(this.x)}else{var e=Math.abs(this.y/this.x),d=Math.sqrt(Math.pow(c,2)/(1+Math.pow(e,2))),e=e*d;this._length=c;this.x=d*C(this.x);this.y=e*C(this.y)}}}return this};this.angleTo=function(a){var c=this.getLength()*a.getLength();return 0===c?0:Math.acos(Math.min(Math.max((this.x*a.x+this.y*a.y)/c,-1),1))/Math.PI}}function T(A,B){this.x=A;this.y=B;this.getVectorToCoordinates=function(C,a){return new R(C-this.x,a-this.y)};this.getVectorFromCoordinates=function(C,a){return this.getVectorToCoordinates(C,a).reverse()};this.getVectorToPoint=function(C){return new R(C.x-this.x,C.y-this.y)};this.getVectorFromPoint=function(C){return this.getVectorToPoint(C).reverse()}}function J(q,B,s,h,p){this.data=q;this.context=B;if(q.length){for(var o=q.length,m,A,C=0;C<o;C++){m=q[C];A=m.x.length;s.call(B,m);for(var n=1;n<A;n++){h.call(B,m,n)}p.call(B,m)}}this.changed=function(){};this.startStrokeFn=s;this.addToStrokeFn=h;this.endStrokeFn=p;this.inStroke=!1;this._stroke=this._lastPoint=null;this.startStroke=function(c){if(c&&"number"==typeof c.x&&"number"==typeof c.y){this._stroke={x:[c.x],y:[c.y]};this.data.push(this._stroke);this._lastPoint=c;this.inStroke=!0;var e=this._stroke,d=this.startStrokeFn,f=this.context;setTimeout(function(){d.call(f,e)},3);return c}return null};this.addToStroke=function(c){if(this.inStroke&&"number"===typeof c.x&&"number"===typeof c.y&&4<Math.abs(c.x-this._lastPoint.x)+Math.abs(c.y-this._lastPoint.y)){var e=this._stroke.x.length;this._stroke.x.push(c.x);this._stroke.y.push(c.y);this._lastPoint=c;var d=this._stroke,l=this.addToStrokeFn,f=this.context;setTimeout(function(){l.call(f,d,e)},3);return c}return null};this.endStroke=function(){var c=this.inStroke;this.inStroke=!1;this._lastPoint=null;if(c){var e=this._stroke,d=this.endStrokeFn,l=this.context,f=this.changed;setTimeout(function(){d.call(l,e);f.call(l)},3);return !0}return null}}function L(y,e,z){var q=this.$parent=$(y),y=this.eventTokens={};this.events=new H(this);var v=$.fn[X]("globalEvents"),u={width:"ratio",height:"ratio",sizeRatio:4,color:"#000","background-color":"#fff","decor-color":"#eee",lineWidth:0,minFatFingerCompensation:-10,showUndoButton:!1,data:[]};$.extend(u,N(q));e&&$.extend(u,e);this.settings=u;for(var s in z){z.hasOwnProperty(s)&&z[s].call(this,s)}this.events.publish(X+".initializing");this.$controlbarUpper=$('<div style="padding:0 !important;margin:0 !important;width: 100% !important; height: 0 !important;margin-top:-1em !important;margin-bottom:1em !important;"></div>').appendTo(q);this.isCanvasEmulator=!1;z=this.canvas=this.initializeCanvas(u);e=$(z);this.$controlbarLower=$('<div style="padding:0 !important;margin:0 !important;width: 100% !important; height: 0 !important;margin-top:-1.5em !important;margin-bottom:1.5em !important;"></div>').appendTo(q);this.canvasContext=z.getContext("2d");e.data(X+".this",this);q=(q=u.lineWidth)?q:Math.max(Math.round(z.width/400),2);u.lineWidth=q;this.lineCurveThreshold=3*u.lineWidth;u.cssclass&&""!=$.trim(u.cssclass)&&e.addClass(u.cssclass);this.fatFingerCompensation=0;var q=function(c){var h,f,l=function(a){a=a.changedTouches&&0<a.changedTouches.length?a.changedTouches[0]:a;return new T(Math.round(a.pageX+h),Math.round(a.pageY+f)+c.fatFingerCompensation)},n=new E(750,function(){c.dataEngine.endStroke()});this.drawEndHandler=function(p){try{p.preventDefault()}catch(d){}n.clear();c.dataEngine.endStroke()};this.drawStartHandler=function(d){d.preventDefault();var a=$(c.canvas).offset();h=-1*a.left;f=-1*a.top;c.dataEngine.startStroke(l(d));n.kick()};this.drawMoveHandler=function(a){a.preventDefault();c.dataEngine.inStroke&&(c.dataEngine.addToStroke(l(a)),n.kick())};return this}.call({},this),C=q.drawEndHandler,m=q.drawStartHandler,A=q.drawMoveHandler,o=this.canvas,e=$(o);this.isCanvasEmulator?(e.bind("mousemove."+X,A),e.bind("mouseup."+X,C),e.bind("mousedown."+X,m)):(o.ontouchstart=function(a){o.onmousedown=void 0;o.onmouseup=void 0;o.onmousemove=void 0;this.fatFingerCompensation=u.minFatFingerCompensation&&-3*u.lineWidth>u.minFatFingerCompensation?-3*u.lineWidth:u.minFatFingerCompensation;m(a);o.ontouchend=C;o.ontouchstart=m;o.ontouchmove=A},o.onmousedown=function(a){o.ontouchstart=void 0;o.ontouchend=void 0;o.ontouchmove=void 0;m(a);o.onmousedown=m;o.onmouseup=C;o.onmousemove=A});y[X+".windowmouseup"]=v.subscribe(X+".windowmouseup",q.drawEndHandler);this.events.publish(X+".attachingEventHandlers");var B=this,y=u.width.toString(10),AA=X;if("ratio"===y||"%"===y.split("")[y.length-1]){this.eventTokens[AA+".parentresized"]=v.subscribe(AA+".parentresized",function(c,f,d){return function(){var AD=f.width();if(AD!==d){for(var AG in c){c.hasOwnProperty(AG)&&(v.unsubscribe(c[AG]),delete c[AG])}var AH=B.settings;B.$parent.children().remove();for(AG in B){B.hasOwnProperty(AG)&&delete B[AG]}AG=AH.data;var AD=1*AD/d,AE=[],n,AB,AF,AC,w,a;AB=0;for(AF=AG.length;AB<AF;AB++){a=AG[AB];n={x:[],y:[]};AC=0;for(w=a.x.length;AC<w;AC++){n.x.push(a.x[AC]*AD),n.y.push(a.y[AC]*AD)}AE.push(n)}AH.data=AE;f[AA](AH)}}}(this.eventTokens,this.$parent,this.$parent.width(),1*this.canvas.width/this.canvas.height))}this.resetCanvas(u.data);this.events.publish(X+".initialized");return this}var X="jSignature",E=function(A,C){var B;this.kick=function(){clearTimeout(B);B=setTimeout(C,A)};this.clear=function(){clearTimeout(B)};return this},H=function(A){this.topics={};this.context=A?A:this;this.publish=function(w,y,o,u){if(this.topics[w]){var v=this.topics[w],q=Array.prototype.slice.call(arguments,1),C=[],m,s,n,B;s=0;for(n=v.length;s<n;s++){B=v[s],m=B[0],B[1]&&(B[0]=function(){},C.push(s)),m.apply(this.context,q)}s=0;for(n=C.length;s<n;s++){v.splice(C[s],1)}}};this.subscribe=function(B,C,c){this.topics[B]?this.topics[B].push([C,c]):this.topics[B]=[[C,c]];return{topic:B,callback:C}};this.unsubscribe=function(B){if(this.topics[B.topic]){for(var C=this.topics[B.topic],c=0,e=C.length;c<e;c++){C[c][0]===B.callback&&C.splice(c,1)}}}},D=function(A){var B=this.canvasContext,e=A.x[0],A=A.y[0],C=this.settings.lineWidth,f=B.fillStyle;B.fillStyle=B.strokeStyle;B.fillRect(e+C/-2,A+C/-2,C,C);B.fillStyle=f},I=function(AB,AC){var z=new T(AB.x[AC-1],AB.y[AC-1]),u=new T(AB.x[AC],AB.y[AC]),AA=z.getVectorToPoint(u);if(1<AC){var v=new T(AB.x[AC-2],AB.y[AC-2]),o=v.getVectorToPoint(z),q;if(o.getLength()>this.lineCurveThreshold){q=2<AC?(new T(AB.x[AC-3],AB.y[AC-3])).getVectorToPoint(v):new R(0,0);var y=0.35*o.getLength(),s=o.angleTo(q.reverse()),B=AA.angleTo(o.reverse());q=(new R(q.x+o.x,q.y+o.y)).resizeTo(Math.max(0.05,s)*y);var m=(new R(o.x+AA.x,o.y+AA.y)).reverse().resizeTo(Math.max(0.05,B)*y),o=this.canvasContext,y=v.x,B=v.y,s=z.x,AD=z.y,C=v.x+q.x,v=v.y+q.y;q=z.x+m.x;m=z.y+m.y;o.beginPath();o.moveTo(y,B);o.bezierCurveTo(C,v,q,m,s,AD);o.stroke()}}AA.getLength()<=this.lineCurveThreshold&&(AA=this.canvasContext,v=z.x,z=z.y,q=u.x,u=u.y,AA.beginPath(),AA.moveTo(v,z),AA.lineTo(q,u),AA.stroke())},F=function(p){var q=p.x.length-1;if(0<q){var n=new T(p.x[q],p.y[q]),C=new T(p.x[q-1],p.y[q-1]),o=C.getVectorToPoint(n);if(o.getLength()>this.lineCurveThreshold){if(1<q){var p=(new T(p.x[q-2],p.y[q-2])).getVectorToPoint(C),h=(new R(p.x+o.x,p.y+o.y)).resizeTo(o.getLength()/2),o=this.canvasContext,p=C.x,q=C.y,A=n.x,B=n.y,m=C.x+h.x,C=C.y+h.y,h=n.x,n=n.y;o.beginPath();o.moveTo(p,q);o.bezierCurveTo(m,C,h,n,A,B)}else{o=this.canvasContext,p=C.x,C=C.y,q=n.x,n=n.y,o.beginPath(),o.moveTo(p,C),o.lineTo(q,n)}o.stroke()}}};L.prototype.resetCanvas=function(z){var AA=this.canvas,v=this.settings,y=this.canvasContext,u=this.isCanvasEmulator,m=AA.width,q=AA.height;y.clearRect(0,0,m+30,q+30);y.shadowColor=y.fillStyle=v["background-color"];u&&y.fillRect(0,0,m+30,q+30);y.lineWidth=Math.ceil(parseInt(v.lineWidth,10));y.lineCap=y.lineJoin="round";y.strokeStyle=v["decor-color"];y.shadowOffsetX=0;y.shadowOffsetY=0;var s=Math.round(q/5),B=1.5*s,o=q-s,m=m-1.5*s,q=q-s;y.beginPath();y.moveTo(B,o);y.lineTo(m,q);y.stroke();y.strokeStyle=v.color;u||(y.shadowColor=y.strokeStyle,y.shadowOffsetX=0.5*y.lineWidth,y.shadowOffsetY=-0.6*y.lineWidth,y.shadowBlur=0);z||(z=[]);y=this.dataEngine=new J(z,this,D,I,F);v.data=z;$(AA).data(X+".data",z).data(X+".settings",v);var e=this.$parent,AB=this.events,C=X;y.changed=function(){AB.publish(C+".change");e.trigger("change")};y.changed();return !0};L.prototype.initializeCanvas=function(A){var B=document.createElement("canvas"),h=$(B);A.width===A.height&&"ratio"===A.height&&(A.width="100%");h.css("margin",0).css("padding",0).css("border","none").css("height","ratio"===A.height||!A.height?1:A.height.toString(10)).css("width","ratio"===A.width||!A.width?1:A.width.toString(10));h.appendTo(this.$parent);"ratio"===A.height?h.css("height",Math.round(h.width()/A.sizeRatio)):"ratio"===A.width&&h.css("width",Math.round(h.height()*A.sizeRatio));h.addClass(X);B.width=h.width();B.height=h.height();A=B;if(A.getContext){A=!1}else{var h=A.ownerDocument.parentWindow,e=h.FlashCanvas?A.ownerDocument.parentWindow.FlashCanvas:"undefined"===typeof FlashCanvas?void 0:FlashCanvas;if(e){A=e.initElement(A);e=1;h&&(h.screen&&h.screen.deviceXDPI&&h.screen.logicalXDPI)&&(e=1*h.screen.deviceXDPI/h.screen.logicalXDPI);if(1!==e){try{$(A).children("object").get(0).resize(Math.ceil(A.width*e),Math.ceil(A.height*e)),A.getContext("2d").scale(e,e)}catch(C){}}A=!0}else{throw Error("Canvas element does not support 2d context. jSignature cannot proceed.")}}this.isCanvasEmulator=A;B.onselectstart=function(a){a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation();return !1};return B};var P=window,V=function(A,B){var e=new Image,C=this;e.onload=function(){C.getContext("2d").drawImage(e,0,0,e.width<C.width?e.width:C.width,e.height<C.height?e.height:C.height)};e.src="data:"+B+","+A},b=function(A){this.find("canvas."+X).add(this.filter("canvas."+X)).data(X+".this").resetCanvas(A);return this},W=function(A,B){if(void 0===B&&("string"===typeof A&&"data:"===A.substr(0,5))&&(B=A.slice(5).split(",")[0],A=A.slice(6+B.length),B===A)){return }var C=this.find("canvas."+X).add(this.filter("canvas."+X));if(Q.hasOwnProperty(B)){0!==C.length&&Q[B].call(C[0],A,B,function(a){return function(){return a.resetCanvas.apply(a,arguments)}}(C.data(X+".this")))}else{throw Error(X+" is unable to find import plugin with for format '"+String(B)+"'")}return this},Y=new H,Z=X,S,U=function(){Y.publish(Z+".parentresized")};$(P).bind("resize."+Z,function(){S&&clearTimeout(S);S=setTimeout(U,500)}).bind("mouseup."+Z,function(){Y.publish(Z+".windowmouseup")});var G={},O={"default":function(){return this.toDataURL()},"native":function(A){return A},image:function(){var A=this.toDataURL();if("string"===typeof A&&4<A.length&&"data:"===A.slice(0,5)&&-1!==A.indexOf(",")){var B=A.indexOf(",");return[A.slice(5,B),A.substr(B+1)]}return[]}},Q={"native":function(A,B,C){C(A)},image:V,"image/png;base64":V,"image/jpeg;base64":V,"image/jpg;base64":V},M={"export":O,"import":Q,instance:G},K={init:function(A){return this.each(function(){var B,C=!1;for(B=this.parentNode;B&&!C;){C=B.body,B=B.parentNode}!C||new L(this,A,G)})},getSettings:function(){return this.find("canvas."+X).add(this.filter("canvas."+X)).data(X+".this").settings},clear:b,reset:b,addPlugin:function(A,B,C){M.hasOwnProperty(A)&&(M[A][B]=C);return this},listPlugins:function(A){var B=[];if(M.hasOwnProperty(A)){var A=M[A],C;for(C in A){A.hasOwnProperty(C)&&B.push(C)}}return B},getData:function(A){var B=this.find("canvas."+X).add(this.filter("canvas."+X));void 0===A&&(A="default");if(0!==B.length&&O.hasOwnProperty(A)){return O[A].call(B.get(0),B.data(X+".data"))}},importData:W,setData:W,globalEvents:function(){return Y},events:function(){return this.find("canvas."+X).add(this.filter("canvas."+X)).data(X+".this").events}};$.fn[X]=function(A){if(!A||"object"===typeof A){return K.init.apply(this,arguments)}if("string"===typeof A&&K[A]){return K[A].apply(this,Array.prototype.slice.call(arguments,1))}$.error("Method "+String(A)+" does not exist on jQuery."+X)}})();(function(){$.fn.jSignature("addPlugin","instance","UndoButton",function(A){this.events.subscribe("jSignature.attachingEventHandlers",function(){if(this.settings[A]){var B=this.settings[A];"function"!==typeof B&&(B=function(){var H=$('<input type="button" value="Undo last stroke" style="position:absolute;display:none;margin:0 !important;top:auto" />').appendTo(this.$controlbarLower),G=H.width();H.css("left",Math.round((this.canvas.width-G)/2));G!==H.width()&&H.width(G);return H});var C=B.call(this),D=this;D.events.subscribe("jSignature.change",function(){D.dataEngine.data.length?C.show():C.hide()});var E=this,F=(this.events.topics.hasOwnProperty("jSignature.undo")?A:"jSignature")+".undo";C.bind("click",function(){E.events.publish(F)});E.events.subscribe(F,function(){var G=E.dataEngine.data;G.length&&(G.pop(),E.resetCanvas(G))})}})})})();(function(){for(var B={},C={},D="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWX".split(""),K=D.length/2,A=K-1;-1<A;A--){B[D[A]]=D[A+K],C[D[A+K]]=D[A]}var E=function(N){for(var N=N.split(""),M=N.length,L=1;L<M;L++){N[L]=B[N[L]]}return N.join("")},G=function(N){for(var P=[],M=0,Q=1,R=N.length,S,L,O=0;O<R;O++){S=Math.round(N[O]),L=S-M,M=S,0>L&&0<Q?(Q=-1,P.push("Z")):0<L&&0>Q&&(Q=1,P.push("Y")),S=Math.abs(L),S>=K?P.push(E(S.toString(K))):P.push(S.toString(K))}return P.join("")},I=function(Q){for(var O=[],Q=Q.split(""),M=Q.length,P,R=1,S=[],L=0,N=0;N<M;N++){P=Q[N],P in B||"Z"===P||"Y"===P?(0!==S.length&&(S=parseInt(S.join(""),K)*R+L,O.push(S),L=S),"Z"===P?(R=-1,S=[]):"Y"===P?(R=1,S=[]):S=[P]):S.push(C[P])}O.push(parseInt(S.join(""),K)*R+L);return O},F=function(O){for(var M=[],L=O.length,N,P=0;P<L;P++){N=O[P],M.push(G(N.x)),M.push(G(N.y))}return M.join("_")},J=function(O){for(var M=[],O=O.split("_"),L=O.length/2,N=0;N<L;N++){M.push({x:I(O[2*N]),y:I(O[2*N+1])})}return M},D=function(L){return["image/jsignature;base30",F(L)]},A=function(N,M,L){"string"===typeof N&&("image/jsignature;base30"===N.substring(0,23).toLowerCase()&&(N=N.substring(24)),L(J(N)))};if(null==this.jQuery){throw Error("We need jQuery for some of the functionality. jQuery is not detected. Failing to initialize...")}var H=this.jQuery.fn.jSignature;H("addPlugin","export","base30",D);H("addPlugin","export","image/jsignature;base30",D);H("addPlugin","import","base30",A);H("addPlugin","import","image/jsignature;base30",A);this.jSignatureDebug&&(this.jSignatureDebug.base30={remapTailChars:E,compressstrokeleg:G,uncompressstrokeleg:I,compressstrokes:F,uncompressstrokes:J,charmap:B})}).call("undefined"!==typeof window?window:this);(function(){function B(N,O){this.x=N;this.y=O;this.reverse=function(){return new this.constructor(-1*this.x,-1*this.y)};this._length=null;this.getLength=function(){this._length||(this._length=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)));return this._length};var P=function(Q){return Math.round(Q/Math.abs(Q))};this.resizeTo=function(Q){if(0===this.x&&0===this.y){this._length=0}else{if(0===this.x){this._length=Q,this.y=Q*P(this.y)}else{if(0===this.y){this._length=Q,this.x=Q*P(this.x)}else{var R=Math.abs(this.y/this.x),S=Math.sqrt(Math.pow(Q,2)/(1+Math.pow(R,2))),R=R*S;this._length=Q;this.x=S*P(this.x);this.y=R*P(this.y)}}}return this};this.angleTo=function(Q){var R=this.getLength()*Q.getLength();return 0===R?0:Math.acos(Math.min(Math.max((this.x*Q.x+this.y*Q.y)/R,-1),1))/Math.PI}}function D(N,O){this.x=N;this.y=O;this.getVectorToCoordinates=function(P,Q){return new B(P-this.x,Q-this.y)};this.getVectorFromCoordinates=function(P,Q){return this.getVectorToCoordinates(P,Q).reverse()};this.getVectorToPoint=function(P){return new B(P.x-this.x,P.y-this.y)};this.getVectorFromPoint=function(P){return this.getVectorToPoint(P).reverse()}}function E(N,O){var P=Math.pow(10,O);return Math.round(N*P)/P}function M(N,P,R){var P=P+1,S=new D(N.x[P-1],N.y[P-1]),Q=new D(N.x[P],N.y[P]),Q=S.getVectorToPoint(Q),O=new D(N.x[P-2],N.y[P-2]),S=O.getVectorToPoint(S);return S.getLength()>R?(R=2<P?(new D(N.x[P-3],N.y[P-3])).getVectorToPoint(O):new B(0,0),N=0.35*S.getLength(),O=S.angleTo(R.reverse()),P=Q.angleTo(S.reverse()),R=(new B(R.x+S.x,R.y+S.y)).resizeTo(Math.max(0.05,O)*N),Q=(new B(S.x+Q.x,S.y+Q.y)).reverse().resizeTo(Math.max(0.05,P)*N),Q=new B(S.x+Q.x,S.y+Q.y),["c",E(R.x,2),E(R.y,2),E(Q.x,2),E(Q.y,2),E(S.x,2),E(S.y,2)]):["l",E(S.x,2),E(S.y,2)]}function A(N,P){var R=N.x.length-1,S=new D(N.x[R],N.y[R]),Q=new D(N.x[R-1],N.y[R-1]),S=Q.getVectorToPoint(S);if(1<R&&S.getLength()>P){var R=(new D(N.x[R-2],N.y[R-2])).getVectorToPoint(Q),Q=S.angleTo(R.reverse()),O=0.35*S.getLength(),R=(new B(R.x+S.x,R.y+S.y)).resizeTo(Math.max(0.05,Q)*O);return["c",E(R.x,2),E(R.y,2),E(S.x,2),E(S.y,2),E(S.x,2),E(S.y,2)]}return["l",E(S.x,2),E(S.y,2)]}function G(N,O,P){for(var O=["M",E(N.x[0]-O,2),E(N.y[0]-P,2)],P=1,Q=N.x.length-1;P<Q;P++){O.push.apply(O,M(N,P,1))}0<Q?O.push.apply(O,A(N,P,1)):0===Q&&O.push.apply(O,["l",1,1]);return O.join(" ")}function I(Y){var U=['<?xml version="1.0" encoding="UTF-8" standalone="no"?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'],V,W=Y.length,Q,S=[],T=[],R=Q=V=0,O=0,N=[];if(0!==W){for(V=0;V<W;V++){R=Y[V];O=[];Q={x:[],y:[]};for(var P=void 0,X=void 0,P=0,X=R.x.length;P<X;P++){O.push({x:R.x[P],y:R.y[P]})}O=simplify(O,0.7,!0);P=0;for(X=O.length;P<X;P++){Q.x.push(O[P].x),Q.y.push(O[P].y)}N.push(Q);S=S.concat(Q.x);T=T.concat(Q.y)}Y=Math.min.apply(null,S)-1;W=Math.max.apply(null,S)+1;S=Math.min.apply(null,T)-1;T=Math.max.apply(null,T)+1;R=0>Y?0:Y;O=0>S?0:S;V=W-Y;Q=T-S}U.push('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+V.toString()+'" height="'+Q.toString()+'">');V=0;for(W=N.length;V<W;V++){Q=N[V],U.push('<path fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="'+G(Q,R,O)+'"/>')}U.push("</svg>");return U.join("")}function K(N){return[C,I(N)]}function H(N){return[F,J(I(N))]}var L=window;"use strict";("undefined"!=typeof exports?exports:L).simplify=function(AB,w,y){w=void 0!==w?w*w:1;if(!y){for(var z=AB.length,W,Z=AB[0],f=[Z],y=1;y<z;y++){W=AB[y];var X=W.x-Z.x,U=W.y-Z.y;X*X+U*U>w&&(f.push(W),Z=W)}AB=(Z!==W&&f.push(W),f)}W=AB;var y=W.length,z=new ("undefined"!=typeof Uint8Array?Uint8Array:Array)(y),Z=0,f=y-1,V,T,AA=[],Y=[],Q=[];for(z[Z]=z[f]=1;f;){U=0;for(X=Z+1;X<f;X++){V=W[X];var o=W[Z],R=W[f],S=o.x,P=o.y,o=R.x-S,O=R.y-P,N=void 0;if(0!==o||0!==O){N=((V.x-S)*o+(V.y-P)*O)/(o*o+O*O),1<N?(S=R.x,P=R.y):0<N&&(S+=o*N,P+=O*N)}V=(o=V.x-S,O=V.y-P,o*o+O*O);V>U&&(T=X,U=V)}U>w&&(z[T]=1,AA.push(Z),Y.push(T),AA.push(T),Y.push(f));Z=AA.pop();f=Y.pop()}for(X=0;X<y;X++){z[X]&&Q.push(W[X])}return AB=Q,AB};if("function"!==typeof J){var J=function(V){var S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),T,U,R,Q,P=0,O=0,N="",N=[];do{T=V.charCodeAt(P++),U=V.charCodeAt(P++),R=V.charCodeAt(P++),Q=T<<16|U<<8|R,T=Q>>18&63,U=Q>>12&63,R=Q>>6&63,Q&=63,N[O++]=S[T]+S[U]+S[R]+S[Q]}while(P<V.length);N=N.join("");V=V.length%3;return(V?N.slice(0,V-3):N)+"===".slice(V||3)}}var C="image/svg+xml",F="image/svg+xml;base64";if("undefined"===typeof $){throw Error("We need jQuery for some of the functionality. jQuery is not detected. Failing to initialize...")}L=$.fn.jSignature;L("addPlugin","export","svg",K);L("addPlugin","export",C,K);L("addPlugin","export","svgbase64",H);L("addPlugin","export",F,H)})();(function(){function N(A){for(var C,e=A.css("color"),h,A=A[0],n=!1;A&&!h&&!n;){try{C=$(A).css("background-color")}catch(m){C="transparent"}"transparent"!==C&&"rgba(0, 0, 0, 0)"!==C&&(h=C);n=A.body;A=A.parentNode}var A=/rgb[a]*\((\d+),\s*(\d+),\s*(\d+)/,n=/#([AaBbCcDdEeFf\d]{2})([AaBbCcDdEeFf\d]{2})([AaBbCcDdEeFf\d]{2})/,B;C=void 0;(C=e.match(A))?B={r:parseInt(C[1],10),g:parseInt(C[2],10),b:parseInt(C[3],10)}:(C=e.match(n))&&(B={r:parseInt(C[1],16),g:parseInt(C[2],16),b:parseInt(C[3],16)});var l;h?(C=void 0,(C=h.match(A))?l={r:parseInt(C[1],10),g:parseInt(C[2],10),b:parseInt(C[3],10)}:(C=h.match(n))&&(l={r:parseInt(C[1],16),g:parseInt(C[2],16),b:parseInt(C[3],16)})):l=B?127<Math.max.apply(null,[B.r,B.g,B.b])?{r:0,g:0,b:0}:{r:255,g:255,b:255}:{r:255,g:255,b:255};C=function(a){return"rgb("+[a.r,a.g,a.b].join(", ")+")"};B&&l?(A=Math.max.apply(null,[B.r,B.g,B.b]),B=Math.max.apply(null,[l.r,l.g,l.b]),B=Math.round(B+-0.75*(B-A)),B={r:B,g:B,b:B}):B?(B=Math.max.apply(null,[B.r,B.g,B.b]),A=1,127<B&&(A=-1),B=Math.round(B+96*A),B={r:B,g:B,b:B}):B={r:191,g:191,b:191};return{color:e,"background-color":l?C(l):h,"decor-color":C(B)}}function R(A,B){this.x=A;this.y=B;this.reverse=function(){return new this.constructor(-1*this.x,-1*this.y)};this._length=null;this.getLength=function(){this._length||(this._length=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)));return this._length};var C=function(a){return Math.round(a/Math.abs(a))};this.resizeTo=function(c){if(0===this.x&&0===this.y){this._length=0}else{if(0===this.x){this._length=c,this.y=c*C(this.y)}else{if(0===this.y){this._length=c,this.x=c*C(this.x)}else{var e=Math.abs(this.y/this.x),d=Math.sqrt(Math.pow(c,2)/(1+Math.pow(e,2))),e=e*d;this._length=c;this.x=d*C(this.x);this.y=e*C(this.y)}}}return this};this.angleTo=function(a){var c=this.getLength()*a.getLength();return 0===c?0:Math.acos(Math.min(Math.max((this.x*a.x+this.y*a.y)/c,-1),1))/Math.PI}}function T(A,B){this.x=A;this.y=B;this.getVectorToCoordinates=function(C,a){return new R(C-this.x,a-this.y)};this.getVectorFromCoordinates=function(C,a){return this.getVectorToCoordinates(C,a).reverse()};this.getVectorToPoint=function(C){return new R(C.x-this.x,C.y-this.y)};this.getVectorFromPoint=function(C){return this.getVectorToPoint(C).reverse()}}function J(q,B,s,h,p){this.data=q;this.context=B;if(q.length){for(var o=q.length,m,A,C=0;C<o;C++){m=q[C];A=m.x.length;s.call(B,m);for(var n=1;n<A;n++){h.call(B,m,n)}p.call(B,m)}}this.changed=function(){};this.startStrokeFn=s;this.addToStrokeFn=h;this.endStrokeFn=p;this.inStroke=!1;this._stroke=this._lastPoint=null;this.startStroke=function(c){if(c&&"number"==typeof c.x&&"number"==typeof c.y){this._stroke={x:[c.x],y:[c.y]};this.data.push(this._stroke);this._lastPoint=c;this.inStroke=!0;var e=this._stroke,d=this.startStrokeFn,f=this.context;setTimeout(function(){d.call(f,e)},3);return c}return null};this.addToStroke=function(c){if(this.inStroke&&"number"===typeof c.x&&"number"===typeof c.y&&4<Math.abs(c.x-this._lastPoint.x)+Math.abs(c.y-this._lastPoint.y)){var e=this._stroke.x.length;this._stroke.x.push(c.x);this._stroke.y.push(c.y);this._lastPoint=c;var d=this._stroke,l=this.addToStrokeFn,f=this.context;setTimeout(function(){l.call(f,d,e)},3);return c}return null};this.endStroke=function(){var c=this.inStroke;this.inStroke=!1;this._lastPoint=null;if(c){var e=this._stroke,d=this.endStrokeFn,l=this.context,f=this.changed;setTimeout(function(){d.call(l,e);f.call(l)},3);return !0}return null}}function L(y,e,z){var q=this.$parent=$(y),y=this.eventTokens={};this.events=new H(this);var v=$.fn[X]("globalEvents"),u={width:"ratio",height:"ratio",sizeRatio:4,color:"#000","background-color":"#fff","decor-color":"#eee",lineWidth:0,minFatFingerCompensation:-10,showUndoButton:!1,data:[]};$.extend(u,N(q));e&&$.extend(u,e);this.settings=u;for(var s in z){z.hasOwnProperty(s)&&z[s].call(this,s)}this.events.publish(X+".initializing");this.$controlbarUpper=$('<div style="padding:0 !important;margin:0 !important;width: 100% !important; height: 0 !important;margin-top:-1em !important;margin-bottom:1em !important;"></div>').appendTo(q);this.isCanvasEmulator=!1;z=this.canvas=this.initializeCanvas(u);e=$(z);this.$controlbarLower=$('<div style="padding:0 !important;margin:0 !important;width: 100% !important; height: 0 !important;margin-top:-1.5em !important;margin-bottom:1.5em !important;"></div>').appendTo(q);this.canvasContext=z.getContext("2d");e.data(X+".this",this);q=(q=u.lineWidth)?q:Math.max(Math.round(z.width/400),2);u.lineWidth=q;this.lineCurveThreshold=3*u.lineWidth;u.cssclass&&""!=$.trim(u.cssclass)&&e.addClass(u.cssclass);this.fatFingerCompensation=0;var q=function(c){var h,f,l=function(a){a=a.changedTouches&&0<a.changedTouches.length?a.changedTouches[0]:a;return new T(Math.round(a.pageX+h),Math.round(a.pageY+f)+c.fatFingerCompensation)},n=new E(750,function(){c.dataEngine.endStroke()});this.drawEndHandler=function(p){try{p.preventDefault()}catch(d){}n.clear();c.dataEngine.endStroke()};this.drawStartHandler=function(d){d.preventDefault();var a=$(c.canvas).offset();h=-1*a.left;f=-1*a.top;c.dataEngine.startStroke(l(d));n.kick()};this.drawMoveHandler=function(a){a.preventDefault();c.dataEngine.inStroke&&(c.dataEngine.addToStroke(l(a)),n.kick())};return this}.call({},this),C=q.drawEndHandler,m=q.drawStartHandler,A=q.drawMoveHandler,o=this.canvas,e=$(o);this.isCanvasEmulator?(e.bind("mousemove."+X,A),e.bind("mouseup."+X,C),e.bind("mousedown."+X,m)):(o.ontouchstart=function(a){o.onmousedown=void 0;o.onmouseup=void 0;o.onmousemove=void 0;this.fatFingerCompensation=u.minFatFingerCompensation&&-3*u.lineWidth>u.minFatFingerCompensation?-3*u.lineWidth:u.minFatFingerCompensation;m(a);o.ontouchend=C;o.ontouchstart=m;o.ontouchmove=A},o.onmousedown=function(a){o.ontouchstart=void 0;o.ontouchend=void 0;o.ontouchmove=void 0;m(a);o.onmousedown=m;o.onmouseup=C;o.onmousemove=A});y[X+".windowmouseup"]=v.subscribe(X+".windowmouseup",q.drawEndHandler);this.events.publish(X+".attachingEventHandlers");var B=this,y=u.width.toString(10),AA=X;if("ratio"===y||"%"===y.split("")[y.length-1]){this.eventTokens[AA+".parentresized"]=v.subscribe(AA+".parentresized",function(c,f,d){return function(){var AD=f.width();if(AD!==d){for(var AG in c){c.hasOwnProperty(AG)&&(v.unsubscribe(c[AG]),delete c[AG])}var AH=B.settings;B.$parent.children().remove();for(AG in B){B.hasOwnProperty(AG)&&delete B[AG]}AG=AH.data;var AD=1*AD/d,AE=[],n,AB,AF,AC,w,a;AB=0;for(AF=AG.length;AB<AF;AB++){a=AG[AB];n={x:[],y:[]};AC=0;for(w=a.x.length;AC<w;AC++){n.x.push(a.x[AC]*AD),n.y.push(a.y[AC]*AD)}AE.push(n)}AH.data=AE;f[AA](AH)}}}(this.eventTokens,this.$parent,this.$parent.width(),1*this.canvas.width/this.canvas.height))}this.resetCanvas(u.data);this.events.publish(X+".initialized");return this}var X="jSignature",E=function(A,C){var B;this.kick=function(){clearTimeout(B);B=setTimeout(C,A)};this.clear=function(){clearTimeout(B)};return this},H=function(A){this.topics={};this.context=A?A:this;this.publish=function(w,y,o,u){if(this.topics[w]){var v=this.topics[w],q=Array.prototype.slice.call(arguments,1),C=[],m,s,n,B;s=0;for(n=v.length;s<n;s++){B=v[s],m=B[0],B[1]&&(B[0]=function(){},C.push(s)),m.apply(this.context,q)}s=0;for(n=C.length;s<n;s++){v.splice(C[s],1)}}};this.subscribe=function(B,C,c){this.topics[B]?this.topics[B].push([C,c]):this.topics[B]=[[C,c]];return{topic:B,callback:C}};this.unsubscribe=function(B){if(this.topics[B.topic]){for(var C=this.topics[B.topic],c=0,e=C.length;c<e;c++){C[c][0]===B.callback&&C.splice(c,1)}}}},D=function(A){var B=this.canvasContext,e=A.x[0],A=A.y[0],C=this.settings.lineWidth,f=B.fillStyle;B.fillStyle=B.strokeStyle;B.fillRect(e+C/-2,A+C/-2,C,C);B.fillStyle=f},I=function(AB,AC){var z=new T(AB.x[AC-1],AB.y[AC-1]),u=new T(AB.x[AC],AB.y[AC]),AA=z.getVectorToPoint(u);if(1<AC){var v=new T(AB.x[AC-2],AB.y[AC-2]),o=v.getVectorToPoint(z),q;if(o.getLength()>this.lineCurveThreshold){q=2<AC?(new T(AB.x[AC-3],AB.y[AC-3])).getVectorToPoint(v):new R(0,0);var y=0.35*o.getLength(),s=o.angleTo(q.reverse()),B=AA.angleTo(o.reverse());q=(new R(q.x+o.x,q.y+o.y)).resizeTo(Math.max(0.05,s)*y);var m=(new R(o.x+AA.x,o.y+AA.y)).reverse().resizeTo(Math.max(0.05,B)*y),o=this.canvasContext,y=v.x,B=v.y,s=z.x,AD=z.y,C=v.x+q.x,v=v.y+q.y;q=z.x+m.x;m=z.y+m.y;o.beginPath();o.moveTo(y,B);o.bezierCurveTo(C,v,q,m,s,AD);o.stroke()}}AA.getLength()<=this.lineCurveThreshold&&(AA=this.canvasContext,v=z.x,z=z.y,q=u.x,u=u.y,AA.beginPath(),AA.moveTo(v,z),AA.lineTo(q,u),AA.stroke())},F=function(p){var q=p.x.length-1;if(0<q){var n=new T(p.x[q],p.y[q]),C=new T(p.x[q-1],p.y[q-1]),o=C.getVectorToPoint(n);if(o.getLength()>this.lineCurveThreshold){if(1<q){var p=(new T(p.x[q-2],p.y[q-2])).getVectorToPoint(C),h=(new R(p.x+o.x,p.y+o.y)).resizeTo(o.getLength()/2),o=this.canvasContext,p=C.x,q=C.y,A=n.x,B=n.y,m=C.x+h.x,C=C.y+h.y,h=n.x,n=n.y;o.beginPath();o.moveTo(p,q);o.bezierCurveTo(m,C,h,n,A,B)}else{o=this.canvasContext,p=C.x,C=C.y,q=n.x,n=n.y,o.beginPath(),o.moveTo(p,C),o.lineTo(q,n)}o.stroke()}}};L.prototype.resetCanvas=function(z){var AA=this.canvas,v=this.settings,y=this.canvasContext,u=this.isCanvasEmulator,m=AA.width,q=AA.height;y.clearRect(0,0,m+30,q+30);y.shadowColor=y.fillStyle=v["background-color"];u&&y.fillRect(0,0,m+30,q+30);y.lineWidth=Math.ceil(parseInt(v.lineWidth,10));y.lineCap=y.lineJoin="round";y.strokeStyle=v["decor-color"];y.shadowOffsetX=0;y.shadowOffsetY=0;var s=Math.round(q/5),B=1.5*s,o=q-s,m=m-1.5*s,q=q-s;y.beginPath();y.moveTo(B,o);y.lineTo(m,q);y.stroke();y.strokeStyle=v.color;u||(y.shadowColor=y.strokeStyle,y.shadowOffsetX=0.5*y.lineWidth,y.shadowOffsetY=-0.6*y.lineWidth,y.shadowBlur=0);z||(z=[]);y=this.dataEngine=new J(z,this,D,I,F);v.data=z;$(AA).data(X+".data",z).data(X+".settings",v);var e=this.$parent,AB=this.events,C=X;y.changed=function(){AB.publish(C+".change");e.trigger("change")};y.changed();return !0};L.prototype.initializeCanvas=function(A){var B=document.createElement("canvas"),h=$(B);A.width===A.height&&"ratio"===A.height&&(A.width="100%");h.css("margin",0).css("padding",0).css("border","none").css("height","ratio"===A.height||!A.height?1:A.height.toString(10)).css("width","ratio"===A.width||!A.width?1:A.width.toString(10));h.appendTo(this.$parent);"ratio"===A.height?h.css("height",Math.round(h.width()/A.sizeRatio)):"ratio"===A.width&&h.css("width",Math.round(h.height()*A.sizeRatio));h.addClass(X);B.width=h.width();B.height=h.height();A=B;if(A.getContext){A=!1}else{var h=A.ownerDocument.parentWindow,e=h.FlashCanvas?A.ownerDocument.parentWindow.FlashCanvas:"undefined"===typeof FlashCanvas?void 0:FlashCanvas;if(e){A=e.initElement(A);e=1;h&&(h.screen&&h.screen.deviceXDPI&&h.screen.logicalXDPI)&&(e=1*h.screen.deviceXDPI/h.screen.logicalXDPI);if(1!==e){try{$(A).children("object").get(0).resize(Math.ceil(A.width*e),Math.ceil(A.height*e)),A.getContext("2d").scale(e,e)}catch(C){}}A=!0}else{throw Error("Canvas element does not support 2d context. jSignature cannot proceed.")}}this.isCanvasEmulator=A;B.onselectstart=function(a){a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation();return !1};return B};var P=window,V=function(A,B){var e=new Image,C=this;e.onload=function(){C.getContext("2d").drawImage(e,0,0,e.width<C.width?e.width:C.width,e.height<C.height?e.height:C.height)};e.src="data:"+B+","+A},b=function(A){this.find("canvas."+X).add(this.filter("canvas."+X)).data(X+".this").resetCanvas(A);return this},W=function(A,B){if(void 0===B&&("string"===typeof A&&"data:"===A.substr(0,5))&&(B=A.slice(5).split(",")[0],A=A.slice(6+B.length),B===A)){return }var C=this.find("canvas."+X).add(this.filter("canvas."+X));if(Q.hasOwnProperty(B)){0!==C.length&&Q[B].call(C[0],A,B,function(a){return function(){return a.resetCanvas.apply(a,arguments)}}(C.data(X+".this")))}else{throw Error(X+" is unable to find import plugin with for format '"+String(B)+"'")}return this},Y=new H,Z=X,S,U=function(){Y.publish(Z+".parentresized")};$(P).bind("resize."+Z,function(){S&&clearTimeout(S);S=setTimeout(U,500)}).bind("mouseup."+Z,function(){Y.publish(Z+".windowmouseup")});var G={},O={"default":function(){return this.toDataURL()},"native":function(A){return A},image:function(){var A=this.toDataURL();if("string"===typeof A&&4<A.length&&"data:"===A.slice(0,5)&&-1!==A.indexOf(",")){var B=A.indexOf(",");return[A.slice(5,B),A.substr(B+1)]}return[]}},Q={"native":function(A,B,C){C(A)},image:V,"image/png;base64":V,"image/jpeg;base64":V,"image/jpg;base64":V},M={"export":O,"import":Q,instance:G},K={init:function(A){return this.each(function(){var B,C=!1;for(B=this.parentNode;B&&!C;){C=B.body,B=B.parentNode}!C||new L(this,A,G)})},getSettings:function(){return this.find("canvas."+X).add(this.filter("canvas."+X)).data(X+".this").settings},clear:b,reset:b,addPlugin:function(A,B,C){M.hasOwnProperty(A)&&(M[A][B]=C);return this},listPlugins:function(A){var B=[];if(M.hasOwnProperty(A)){var A=M[A],C;for(C in A){A.hasOwnProperty(C)&&B.push(C)}}return B},getData:function(A){var B=this.find("canvas."+X).add(this.filter("canvas."+X));void 0===A&&(A="default");if(0!==B.length&&O.hasOwnProperty(A)){return O[A].call(B.get(0),B.data(X+".data"))}},importData:W,setData:W,globalEvents:function(){return Y},events:function(){return this.find("canvas."+X).add(this.filter("canvas."+X)).data(X+".this").events}};$.fn[X]=function(A){if(!A||"object"===typeof A){return K.init.apply(this,arguments)}if("string"===typeof A&&K[A]){return K[A].apply(this,Array.prototype.slice.call(arguments,1))}$.error("Method "+String(A)+" does not exist on jQuery."+X)}})();(function(){$.fn.jSignature("addPlugin","instance","UndoButton",function(A){this.events.subscribe("jSignature.attachingEventHandlers",function(){if(this.settings[A]){var B=this.settings[A];"function"!==typeof B&&(B=function(){var H=$('<input type="button" value="Undo last stroke" style="position:absolute;display:none;margin:0 !important;top:auto" />').appendTo(this.$controlbarLower),G=H.width();H.css("left",Math.round((this.canvas.width-G)/2));G!==H.width()&&H.width(G);return H});var C=B.call(this),D=this;D.events.subscribe("jSignature.change",function(){D.dataEngine.data.length?C.show():C.hide()});var E=this,F=(this.events.topics.hasOwnProperty("jSignature.undo")?A:"jSignature")+".undo";C.bind("click",function(){E.events.publish(F)});E.events.subscribe(F,function(){var G=E.dataEngine.data;G.length&&(G.pop(),E.resetCanvas(G))})}})})})();(function(){for(var B={},C={},D="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWX".split(""),K=D.length/2,A=K-1;-1<A;A--){B[D[A]]=D[A+K],C[D[A+K]]=D[A]}var E=function(N){for(var N=N.split(""),M=N.length,L=1;L<M;L++){N[L]=B[N[L]]}return N.join("")},G=function(N){for(var P=[],M=0,Q=1,R=N.length,S,L,O=0;O<R;O++){S=Math.round(N[O]),L=S-M,M=S,0>L&&0<Q?(Q=-1,P.push("Z")):0<L&&0>Q&&(Q=1,P.push("Y")),S=Math.abs(L),S>=K?P.push(E(S.toString(K))):P.push(S.toString(K))}return P.join("")},I=function(Q){for(var O=[],Q=Q.split(""),M=Q.length,P,R=1,S=[],L=0,N=0;N<M;N++){P=Q[N],P in B||"Z"===P||"Y"===P?(0!==S.length&&(S=parseInt(S.join(""),K)*R+L,O.push(S),L=S),"Z"===P?(R=-1,S=[]):"Y"===P?(R=1,S=[]):S=[P]):S.push(C[P])}O.push(parseInt(S.join(""),K)*R+L);return O},F=function(O){for(var M=[],L=O.length,N,P=0;P<L;P++){N=O[P],M.push(G(N.x)),M.push(G(N.y))}return M.join("_")},J=function(O){for(var M=[],O=O.split("_"),L=O.length/2,N=0;N<L;N++){M.push({x:I(O[2*N]),y:I(O[2*N+1])})}return M},D=function(L){return["image/jsignature;base30",F(L)]},A=function(N,M,L){"string"===typeof N&&("image/jsignature;base30"===N.substring(0,23).toLowerCase()&&(N=N.substring(24)),L(J(N)))};if(null==this.jQuery){throw Error("We need jQuery for some of the functionality. jQuery is not detected. Failing to initialize...")}var H=this.jQuery.fn.jSignature;H("addPlugin","export","base30",D);H("addPlugin","export","image/jsignature;base30",D);H("addPlugin","import","base30",A);H("addPlugin","import","image/jsignature;base30",A);this.jSignatureDebug&&(this.jSignatureDebug.base30={remapTailChars:E,compressstrokeleg:G,uncompressstrokeleg:I,compressstrokes:F,uncompressstrokes:J,charmap:B})}).call("undefined"!==typeof window?window:this);(function(){function B(N,O){this.x=N;this.y=O;this.reverse=function(){return new this.constructor(-1*this.x,-1*this.y)};this._length=null;this.getLength=function(){this._length||(this._length=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)));return this._length};var P=function(Q){return Math.round(Q/Math.abs(Q))};this.resizeTo=function(Q){if(0===this.x&&0===this.y){this._length=0}else{if(0===this.x){this._length=Q,this.y=Q*P(this.y)}else{if(0===this.y){this._length=Q,this.x=Q*P(this.x)}else{var R=Math.abs(this.y/this.x),S=Math.sqrt(Math.pow(Q,2)/(1+Math.pow(R,2))),R=R*S;this._length=Q;this.x=S*P(this.x);this.y=R*P(this.y)}}}return this};this.angleTo=function(Q){var R=this.getLength()*Q.getLength();return 0===R?0:Math.acos(Math.min(Math.max((this.x*Q.x+this.y*Q.y)/R,-1),1))/Math.PI}}function D(N,O){this.x=N;this.y=O;this.getVectorToCoordinates=function(P,Q){return new B(P-this.x,Q-this.y)};this.getVectorFromCoordinates=function(P,Q){return this.getVectorToCoordinates(P,Q).reverse()};this.getVectorToPoint=function(P){return new B(P.x-this.x,P.y-this.y)};this.getVectorFromPoint=function(P){return this.getVectorToPoint(P).reverse()}}function E(N,O){var P=Math.pow(10,O);return Math.round(N*P)/P}function M(N,P,R){var P=P+1,S=new D(N.x[P-1],N.y[P-1]),Q=new D(N.x[P],N.y[P]),Q=S.getVectorToPoint(Q),O=new D(N.x[P-2],N.y[P-2]),S=O.getVectorToPoint(S);return S.getLength()>R?(R=2<P?(new D(N.x[P-3],N.y[P-3])).getVectorToPoint(O):new B(0,0),N=0.35*S.getLength(),O=S.angleTo(R.reverse()),P=Q.angleTo(S.reverse()),R=(new B(R.x+S.x,R.y+S.y)).resizeTo(Math.max(0.05,O)*N),Q=(new B(S.x+Q.x,S.y+Q.y)).reverse().resizeTo(Math.max(0.05,P)*N),Q=new B(S.x+Q.x,S.y+Q.y),["c",E(R.x,2),E(R.y,2),E(Q.x,2),E(Q.y,2),E(S.x,2),E(S.y,2)]):["l",E(S.x,2),E(S.y,2)]}function A(N,P){var R=N.x.length-1,S=new D(N.x[R],N.y[R]),Q=new D(N.x[R-1],N.y[R-1]),S=Q.getVectorToPoint(S);if(1<R&&S.getLength()>P){var R=(new D(N.x[R-2],N.y[R-2])).getVectorToPoint(Q),Q=S.angleTo(R.reverse()),O=0.35*S.getLength(),R=(new B(R.x+S.x,R.y+S.y)).resizeTo(Math.max(0.05,Q)*O);return["c",E(R.x,2),E(R.y,2),E(S.x,2),E(S.y,2),E(S.x,2),E(S.y,2)]}return["l",E(S.x,2),E(S.y,2)]}function G(N,O,P){for(var O=["M",E(N.x[0]-O,2),E(N.y[0]-P,2)],P=1,Q=N.x.length-1;P<Q;P++){O.push.apply(O,M(N,P,1))}0<Q?O.push.apply(O,A(N,P,1)):0===Q&&O.push.apply(O,["l",1,1]);return O.join(" ")}function I(Y){var U=['<?xml version="1.0" encoding="UTF-8" standalone="no"?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'],V,W=Y.length,Q,S=[],T=[],R=Q=V=0,O=0,N=[];if(0!==W){for(V=0;V<W;V++){R=Y[V];O=[];Q={x:[],y:[]};for(var P=void 0,X=void 0,P=0,X=R.x.length;P<X;P++){O.push({x:R.x[P],y:R.y[P]})}O=simplify(O,0.7,!0);P=0;for(X=O.length;P<X;P++){Q.x.push(O[P].x),Q.y.push(O[P].y)}N.push(Q);S=S.concat(Q.x);T=T.concat(Q.y)}Y=Math.min.apply(null,S)-1;W=Math.max.apply(null,S)+1;S=Math.min.apply(null,T)-1;T=Math.max.apply(null,T)+1;R=0>Y?0:Y;O=0>S?0:S;V=W-Y;Q=T-S}U.push('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+V.toString()+'" height="'+Q.toString()+'">');V=0;for(W=N.length;V<W;V++){Q=N[V],U.push('<path fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="'+G(Q,R,O)+'"/>')}U.push("</svg>");return U.join("")}function K(N){return[C,I(N)]}function H(N){return[F,J(I(N))]}var L=window;"use strict";("undefined"!=typeof exports?exports:L).simplify=function(AB,w,y){w=void 0!==w?w*w:1;if(!y){for(var z=AB.length,W,Z=AB[0],f=[Z],y=1;y<z;y++){W=AB[y];var X=W.x-Z.x,U=W.y-Z.y;X*X+U*U>w&&(f.push(W),Z=W)}AB=(Z!==W&&f.push(W),f)}W=AB;var y=W.length,z=new ("undefined"!=typeof Uint8Array?Uint8Array:Array)(y),Z=0,f=y-1,V,T,AA=[],Y=[],Q=[];for(z[Z]=z[f]=1;f;){U=0;for(X=Z+1;X<f;X++){V=W[X];var o=W[Z],R=W[f],S=o.x,P=o.y,o=R.x-S,O=R.y-P,N=void 0;if(0!==o||0!==O){N=((V.x-S)*o+(V.y-P)*O)/(o*o+O*O),1<N?(S=R.x,P=R.y):0<N&&(S+=o*N,P+=O*N)}V=(o=V.x-S,O=V.y-P,o*o+O*O);V>U&&(T=X,U=V)}U>w&&(z[T]=1,AA.push(Z),Y.push(T),AA.push(T),Y.push(f));Z=AA.pop();f=Y.pop()}for(X=0;X<y;X++){z[X]&&Q.push(W[X])}return AB=Q,AB};if("function"!==typeof J){var J=function(V){var S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),T,U,R,Q,P=0,O=0,N="",N=[];do{T=V.charCodeAt(P++),U=V.charCodeAt(P++),R=V.charCodeAt(P++),Q=T<<16|U<<8|R,T=Q>>18&63,U=Q>>12&63,R=Q>>6&63,Q&=63,N[O++]=S[T]+S[U]+S[R]+S[Q]}while(P<V.length);N=N.join("");V=V.length%3;return(V?N.slice(0,V-3):N)+"===".slice(V||3)}}var C="image/svg+xml",F="image/svg+xml;base64";if("undefined"===typeof $){throw Error("We need jQuery for some of the functionality. jQuery is not detected. Failing to initialize...")}L=$.fn.jSignature;L("addPlugin","export","svg",K);L("addPlugin","export",C,K);L("addPlugin","export","svgbase64",H);L("addPlugin","export",F,H)})();var ZCPageLiveUtil={isinited:false,initParams:function(){if(!$P.isinited){$P.bindParams()}},bindParams:{},setPrivateLink:function(A){$P.pvLink=A},counterUtil:function(A,B){$({someValue:0}).animate({someValue:B},{duration:1000,easing:"swing",step:function(){A.text(Math.ceil(this.someValue))},complete:function(){A.text(Math.ceil(B))}})},handleBtnExecute:function(C){var F="";var H="";var B=null;var D=ZCView.getViewCont(ZCApp.currZCComp);C=ZCForm.getMsgFromResponse(C,"");var E;var A=C.errorList;var G=C.successList;if(C.successmsg){E=C.successmsg}if(C.generatedjs){evaluateJs(C.generatedjs)}if(!ZCUtil.isNull(A)){B=A;ZCView.showInfo(B,"")}if(!ZCUtil.isNull(E)&&E!="zc_success"){ZCApp.showFadingMsg(E,0,2000)}ZCView.showInfo(B,"")},handleCustomBtnClick:function(){var J=$(this).parent();var D=J.attr("config");D=JSON.parse(D);var C=JSON.parse(D.url);var B={};B.sharedBy=ZCApp.sharedBy;B.pageId=C.pageId;B.elementId=C.elementId;B.viewLinkName=ZCApp.currZCComp;var K=[];var H=$(".zcpage-formElementContainer");var I;var A={};for(var F=0;(I=H[F]);F++){I=$(I);var E=I.find("input[type='text']");var G={};G.name=E.attr("name");G.value=E.val();A[G.name]=G.value}B.args=JSON.stringify(A);if($P.pvLink){B.privateLink=$P.pvLink}return ZCUtil.sendRequest("/executePageAction.do",jQuery.param(B),"json","ZCPageLiveUtil.handleBtnExecute",ZCUtil.getParamsAsMap("viewLinkName="+ZCApp.currZCComp),i18n.loadingdot)},getShadowClr:function(A){A=A.replace(/rgb\(|\)/g,"").split(",");A[0]=parseInt(A[0],10);A[1]=parseInt(A[1],10);A[2]=parseInt(A[2],10);shClr="rgba(";A.forEach(function(B){B=B<30?0:B-30;shClr=shClr+B+","});return shClr+"1)"},handleElementLoading:function(){var E=$(".elemContainment").find(".zpelement-wrapper");var W;for(var U=0;(W=E[U]);U++){W=$(W);if(W.hasClass("badge")){var P=W.find("h1");var c=P.attr("data-count");ZCPageLiveUtil.counterUtil.call(ZCPageLiveUtil,P,c)}else{if(W.hasClass("progressbar")){var O=W.find(".zpAlignPos");var X=O.attr("config");ZCPageLivePb.loadPb(O,X)}else{if(W.hasClass("chart")){var O=W.find(".zpAlignPos");O.css("height","350px");var R=O.css("width");O.css("width",R);var X=O.attr("config");ZCPageChart.loadZCChart(O[0],X)}else{if(W.hasClass("form")||W.hasClass("report")){var C=W.find(".zpAlignPos");var K=C.attr("config");K=JSON.parse(K);var b=K.elemType==="form"?"form":"view";var M="/"+ZCApp.sharedByDisp+"/"+K.appLinkName+"/"+b+"-embed/"+K.compLinkName;M=M+"?"+jQuery.param(K.urlAttr);var J=K.searchString;if(J!==undefined&&J.length>0){M=M+"&"+J}var a=$("<iframe></iframe>");var Q=(K.height&&K.height!="")?K.height:"650px";var R=(K.width&&K.width!="")?K.width:"100%";a.attr("src",M);a.css("width",R);a.css("height",Q);C.append(a)}else{if(W.hasClass("zcbutton")){var C=W.find(".zpAlignPos");var K=C.attr("config");K=JSON.parse(K);var D=K.actiontype;if(D!=="customaction"){var F=$("<a></a>");F.attr("href",K.url);F.attr("target",K.open);var Z=C.html().trim();F.html(Z);F.css("text-decoration","none");C.html(F)}else{C.children().bind("click",ZCPageLiveUtil.handleCustomBtnClick)}}else{if(W.hasClass("pageField")){var G='<div id="zcpage-progressbar-template" class="zcpage-progress"><div class="progress-bar progress-bar-default" data-minval="" data-maxvalue="" style="width: 60%">&lt;req count &gt; %</div> </div>';var A=W.find("table");A.addClass("table table-striped table-bordered");var V=A.find('th[data-distype ="progressbar"]');var I;for(var U=0;(I=V[U]);U++){var Y=$(I).index();var L=A.find("tr");var H;for(var T=0;(H=L[T]);T++){var N=$(H).find("td").eq(Y);var S=N.html();var B=$(G);B.children(".progress-bar-default").css("width",S+"%");N.html(B)}}}}}}}}}$(".zcpage-field-calTimeIcon").click(function(){var d=$(this).closest("tr").find("input[displaytype='date']");var f;for(var e=0;(f=d[e]);e++){f=$(f);f.focus();f.closest("tr").find("input[displaytype='date']").datepicker({dateFormat:$P.appDateFormat,changeMonth:true,changeYear:true})}})}};$P=ZCPageLiveUtil;var ZCPageChart={loadZCChart:function(B,A,D){A=JSON.parse(A);ZCPageChart.charttype=ZCPageChart.getChartTypeFromText(A.charttype);var C=ZCPageChart.getZCChart(A,D);$ZC.charts(B,C)},getZCChart:function(B,A){var F={};F.canvas={theme:"elegant ",title:{text:""},subtitle:{show:false},background:{color:"#FFFFFF"}};F.metadata={columns:[],axes:{x:[0],y:[[1]],clr:[2],tooltip:["<span style='font-weight:bold;'>{{val(2)}}</span>","{{val(0)}} : {{val(1)}}"]}};var H={};H.theme1=["#f04836","#efa21b","#48a3e8","#5de1b5","#bf2ae7","#ec3fa3","#FB7060","#FBBB4A","#7CC5FB","#8AFBD6","#DC6CFA","#FB72C2","#F43621","#ED9B0A","#3098E6","#47E6B1","#BC16E9","#EB2297"];H.theme2=["#79b5e3","#69e85c","#63cfd8","#7e89ae","#3edca7","#c543eb","#92CCF9","#88FC7C","#8EF1FA","#A3B1DE","#63F9C7","#D96BF9","#62ABE3","#51E741","#4ECFDA","#6A7BB3","#28DFA1","#BF28EB"];H.theme3=["#f4b380","#da6eef","#ffbf61","#edab76","#ee6ca6","#e7d276","#FCC79C","#EB8FFC","#FECA7C","#FBC092","#F986B9","#FDEA96","#F3A262","#D754F0","#F6AF45","#EC9754","#ED4F95","#E1C652"];H.theme4=["#fb7c57","#edab76","#ffc27c","#07c197","#68e179","#7aa8d8","#F89577","#FAC398","#FACB96","#10EAB8","#85F896","#98C4F0","#EC623A","#E69758","#EEAA5B","#10B28D","#4DCD60","#5C94CC"];var D={};D.dataindex="0";if(!B.xTitle||B.xTitle.length===0){D.columnname="X title"}else{D.columnname=B.xTitle}D.datatype="ordinal";var G={};G.dataindex="1";if(!B.yTitle||B.yTitle.length===0){G.columnname="Y title"}else{G.columnname=B.yTitle}G.datatype="numeric";G.numeric={format:{thousandSeperator:",",signEnabled:false}};F.metadata.columns.push(D);F.metadata.columns.push(G);var E={};E.datatype="ordinal";F.metadata.columns.push(E);F.seriesdata={chartdata:ZCPageChart.getChartData(B)};if(B.stackedGrp){F.seriesdata.stackGroup=B.stackedGrp}F.chart={axes:ZCPageChart.getAxisConfig(B),plot:ZCPageChart.getPlotConfig(B,A)};var C=B.theme;var I=B.legendPos.split(".");F.legend={colorPallete:{type:"multicolor",options:{multicolor:"countries",monochrome:{baseColor:"#ff0000"}}},hAlign:I[0],vAlign:I[1],enabled:B.legendPos!="none"};if(C!==undefined){if(C.substring(0,1)=="#"){F.legend.colorPallete.type="monochrome";F.legend.colorPallete.options.monochrome.baseColor=C}else{F.legend.colors=H[C]}F.canvas.background.color=B.bgColor}F.tooltip={zindex:9999};return F},getChartData:function(W){var F=ZCPageChart.getZCChartType(W);var C=W.plotdata;var K=W.seriesName;var D=W.compareData;var A,X=[];if(W.stackGroup){var I=0;var J=C.length/W.stackGroup;var L=J;var H=0;var P=K.length/W.stackGroup;var E=P;var V=[];for(var S=0;S<W.stackGroup;S++){var M=C.slice(I,J);var B=K.slice(H,P);var G=D.slice(I,J),U={},O,R;var N=[];for(var T=0;(A=B[T]);T++){N.push(H+T);var Q={};Q.type=F;Q.yaxiscolumnorder=[0];Q.seriesname=A[0].replace(/&#x20;/g," ");if(A[0]=="ID"){Q.seriesname="Total Records"}Q.data=ZCPageChart.getDataForGroupSeries(M,G,A[1]);X.push(Q)}I=I+L;J=J+L;H=E+H;P=E+P;V.push(N)}W.stackedGrp=V}else{for(var T=0;(A=K[T]);T++){var Q={};Q.type=F;Q.yaxiscolumnorder=[0];Q.seriesname=A;if(A=="ID"){Q.seriesname="Total Records"}Q.data=ZCPageChart.getDataForSeries(T+1,C);X.push(Q)}}return X},getDataForSeries:function(A,F){var E=[];var G;for(var C=0;(G=F[C]);C++){if(G[0]||G[0]===null||G[0]===""){var D=[];if(G[0]===null||G[0]===""){D.push("Unknown")}else{D.push(G[0])}var B=G[A];D.push(ZCPageChart.validateColumnData(B));E.push(D)}}return E},getDataForGroupSeries:function(C,I,A){var H=[];var J;var F;var G;for(var E=0;(J=C[E]);E++){var B=[];B.push(J[0]);F=0;for(var D=1;D<I[E].length;D++){if(I[E][D]==A){F=D;break}}if(F>0){G=J[F]}else{G=0}B.push(ZCPageChart.validateColumnData(G));H.push(B)}return H},validateColumnData:function(A){if(!A){A=0}return A},getPlotConfig:function(C,G){var F={};var B=F.plotoptions={};var E=ZCPageChart.getZCChartType(C);B[E]={};if(E=="bar"){B[E].maxBandWidth=50}var A=ZCPageChart.isStackedChart(C);if(A.isStack){B[E].stacked={enabled:true};if(A.isPercent){B[E].stacked.showAs="percent"}}var D=ZCPageChart.charttype;if(D=="pie_2"||D=="pie_3"){B[E]={innerRadius:"50%"};if(D=="pie_3"){B[E].startAngle=-1.57;B[E].endAngle=1.57}}if(G){F.animation={enabled:false}}return F},isStackedChart:function(B){var C=ZCPageChart.charttype;var A={};switch(C){case"column_2":case"bar_2":case"area_2":case"web_2":case"area_2":A.isStack=true;break;case"column_3":case"bar_3":A.isStack=true;A.isPercent=true;break;default:A.isStack=false}return A},getAxisConfig:function(A){var B=ZCPageChart.getZCChartType(A);var C={};if(B==="web"){C={xaxis:{grid:{color:"black"},tickmark:{color:"black"}},yaxis:[{ticklabel:{fontColor:"transparent"},grid:{color:"grey"}}]}}else{if(ZCPageChart.charttype.split("_")[0]==="bar"){C={xaxis:{label:{text:A.xTitle},ticklabel:{rotation:"auto",marginTop:0,marginBottom:0}},yaxis:[{label:{text:A.yTitle}}]};C.rotated=true}else{C={xaxis:{label:{text:A.xTitle},ticklabel:{rotation:"auto"}},yaxis:[{label:{text:A.yTitle}}]}}}return C},getZCChartType:function(A){var B=ZCPageChart.charttype.split("_")[0];if(B==="column"){return"bar"}return B},getChartTypeFromText:function(B){var A=B;switch(B){case"Column":A="column_1";break;case"Stacked Column":A="column_2";break;case"Stacked Percentage Column":A="column_3";break;case"Bar":A="bar_1";break;case"Stacked Bar":A="bar_2";break;case"Stacked Percentage Bar":A="bar_3";break;case"Line":A="line_1";break;case"Scatter":A="scatter_1";break;case"Area":A="area_1";break;case"Stacked Area":A="area_2";break;case"Web":A="web_1";break;case"Stacked Web":A="web_2";break;case"Pie":A="pie_1";break;case"Donut":A="pie_2";break;case"Semi Donut":A="pie_3";break;case"Funnel":A="funnel_1";break}return A}};var ZCPageLivePb={loadPb:function(I,C){C=JSON.parse(C);var B=$(ZCPageLivePb.getWrapper());I.append(B);B.find("[data-opt='title']").text(C.title);B.find("[data-opt='datatext']").text(C.datatext+":"+C.dataVal);B.find("[data-opt='maxtext']").text(C.maxText+":"+C.maxVal);B.find("[data-opt='holder']").css("height","100px");var A=C.configObj;var E=B.children();E[0].setAttribute("style",A.titleStyle);E[1].setAttribute("style",A.pbStyle);E[2].setAttribute("style",A.dataTextStyle);E[3].setAttribute("style",A.maxValTextStyle);colorOpt=E[1].style.backgroundColor;C.colorOpt=colorOpt;var F=B.find('[data-opt="holder"]');var G=C.type;if(G===1){var K=E[1].style.height;if(K.trim.length===0){B.find("[data-opt='holder']").css("height","")}var J=$(ZCPageLivePb.getProgressBarConfig());var H=0;if(parseInt(C.maxVal)!==0){H=(parseInt(C.dataVal)/parseInt(C.maxVal))*100}J.find(".zcpage-progress-bar").css("width",H+"%").html(H+"%").css("background-color",colorOpt);F.append(J)}else{if(G===2){var D=ZCPageLivePb.getCirCularConfig(C);$ZC.charts(F[0],D)}else{if(G===3){var D=ZCPageLivePb.getGaugeConfig(C);$ZC.charts(F[0],D)}}}E[1].setAttribute("style","")},getWrapper:function(){var A='<div class=" zcpage-pb-edittemplate" id="zcpage-pb-edittemplate" ><div data-attr="title"><b data-opt="title"></b></div><div data-opt="holder" style="width=100%;padding:5px;margin-right:10px;"></div><div data-attr="dataText"><span data-opt="datatext">Data value Text </span></div><div data-attr="maxValText"><span data-opt="maxtext">Max value Text </span></div></div>';return A},getProgressBarConfig:function(){var A='<div class="zcpage-progress"><div class="zcpage-progress-bar" ></div> </div>';return A},getGaugeConfig:function(A){var C={plotoptions:{dial:{maxRange:A.maxVal,outerPadding:0}}};var B=ZCPageLivePb.getDefaultConfig(A);B.chart.plot=C;return B},getCirCularConfig:function(A){var C={plotoptions:{dial:{outerPadding:0,startAngle:-3.14,endAngle:3.14,innerRadius:"85%",maxRange:A.maxVal,needle:{show:false,width:10,padding:5},minmaxlabels:{show:false},datalabels:{fontSize:"25"}}}};var B=ZCPageLivePb.getDefaultConfig(A);B.chart.plot=C;return B},getDefaultConfig:function(B){var A={canvas:{subtitle:{show:false},title:{show:false},border:{show:false},shadow:{show:false}},chart:{plot:{}},seriesdata:{chartdata:[{type:18,yaxiscolumnorder:[0],data:[[["",B.dataVal]]]}]},metadata:{axes:{x:[0],y:[[1]],tooltip:[0,1]},columns:[{dataindex:0,datatype:"ordinal"},{dataindex:1,datatype:"numeric",numeric:{}}]}};if(B.colorOpt.trim().length>0){A.seriesdata.chartdata[0].color=B.colorOpt}return A}};function LiveDeskApi(){}LiveDeskApi.init=function(){this.scode=1;this.smsg="Available";this.setdomain=window.location.host;this.serverurl=document.location.protocol+"//livedesk.zoho.com";this.newserverurl=document.location.protocol+"//salesiq.zoho.com";this.screenname="";this.isLiveMode=false;this.sharedByDisp="";this.WMS_IDLE=4;this.WMS_ONLINE=1;this.WMS_BUSY=3;this.appLinkName="";LDUserIdleApi.init();LiveDeskApi.loadPostMessage()};var browser_title=document.title;LiveDeskApi.setServerURL=function(A){this.serverurl=A};LiveDeskApi.setNewServerURL=function(A){this.newserverurl=A};LiveDeskApi.setScreenName=function(A){this.screenname=A};LiveDeskApi.setAppLinkName=function(A){this.appLinkName=A};LiveDeskApi.checkMode=function(A){this.isLiveMode=A};LiveDeskApi.setSharedByDisp=function(A){this.sharedByDisp=A};LiveDeskApi.setStatus=function(A,B){this.scode=A;this.smsg=B};LiveDeskApi.sendPostMessage=function(A){try{var C=document.getElementById("liveChatFrame");if(C.contentWindow.postMessage){C.contentWindow.postMessage(JSON.stringify(A),"*")}else{alert("Your browser does not support the postMessage method!")}}catch(B){}return false};LiveDeskApi.loadPostMessage=function(){if(window.addEventListener){addEventListener("message",LiveDeskApi.handlePostMessage,false)}else{attachEvent("onmessage",LiveDeskApi.handlePostMessage)}};LiveDeskApi.handlePostMessage=function(D){try{if(D.origin==LiveDeskApi.serverurl||D.origin==LiveDeskApi.newserverurl){var C=D.data;var E=JSON.parse(C);if(E.MODE=="INVITESUPPORTREP"){LiveDeskApi.handleAddAgentChat(E.CHID,E.VISITORID,E.VISITORNAME,E.SENDER,E.SENDERNAME,E.DEPARTMENT,E.NOTES)}else{if(E.MODE=="NEWVISITOR"){LiveDeskApi.handleNewVisitor(E.VISITORID,E.NAME,E.EMAILID,E.QUESTION,E.EMBED,E.DEPARTMENT,E.WAITINGTIME)}else{if(E.MODE=="VISITORMSG"){LiveDeskApi.handleVisitorMessage(E.CHID,E.MSG,E.SENDER,E.ZUID,E.DNAME)}else{if(E.MODE=="INVITETRANSFERCHAT"){LiveDeskApi.handleTransferChat(E.CHID,E.VISITORID,E.VISITORNAME,E.SENDER,E.SENDERNAME,E.DEPARTMENT,E.NOTE)}else{if(E.MODE=="USERPRESENCE"){var A=E.SCODE;var B=E.SMSG;LiveDeskApi.setStatus(A,B);LiveDeskApi.handleAvailabilityChange(E.SCODE,E.SMSG)}else{if(E.MODE=="HANDLEPICKUP"){LiveDeskApi.handlePickUP(E.VISITORID)}else{if(E.MODE=="HANDLETRANSFERACCEPT"){LiveDeskApi.handleTransferAccept(E.VISITORID)}else{if(E.MODE=="HANDLETRANSFERREJECT"){LiveDeskApi.handleTransferReject(E.VISITORID)}else{if(E.MODE=="CBHANDLER"){LiveDeskApi.handleAction(E.ACTION,E.CPARAMS)}}}}}}}}}}}catch(F){}};function LDUserIdleApi(){}LDUserIdleApi.updateIdle=function(){try{if(LDUserIdleApi.prevscode==LiveDeskApi.WMS_IDLE||LDUserIdleApi.updating||LiveDeskApi.scode==LiveDeskApi.WMS_IDLE||LiveDeskApi.scode==LiveDeskApi.WMS_BUSY){return }var A=LiveDeskApi.smsg;if(A=="Available"||A=="Busy"||A=="Idle"){A="Idle"}else{A=A}LDUserIdleApi.prevscode=LiveDeskApi.scode;LDUserIdleApi.setUpdating(true)}catch(B){}LiveDeskApi.setStatus(LiveDeskApi.WMS_IDLE,A)};LDUserIdleApi.init=function(){LDUserIdleApi.idletime=(2*60*1000);LDUserIdleApi.idletimer=-1;if(LDUserIdleApi.prevscode==undefined){LDUserIdleApi.prevscode=1}if(LDUserIdleApi.updating==undefined){LDUserIdleApi.updating=false}if($.browser.msie){document.attachEvent("onkeydown",LDUserIdleApi.active);document.attachEvent("onclick",LDUserIdleApi.active);document.attachEvent("onkeypress",LDUserIdleApi.active);window.attachEvent("onscroll",LDUserIdleApi.active);document.attachEvent("onmouseout",LDUserIdleApi.active);document.attachEvent("onmouseenter",LDUserIdleApi.active)}else{document.addEventListener("keydown",LDUserIdleApi.active,true);document.addEventListener("keypress",LDUserIdleApi.active,true);document.addEventListener("mouseout",LDUserIdleApi.active,true);document.addEventListener("mouseenter",LDUserIdleApi.active,true);window.addEventListener("scroll",LDUserIdleApi.active,true);document.addEventListener("click",LDUserIdleApi.active,true)}};LDUserIdleApi.setTime=function(A){LDUserIdleApi.idletime=A};LDUserIdleApi.getTime=function(){return LDUserIdleApi.idletime};LDUserIdleApi.setStatus=function(A){if(A==LiveDeskApi.WMS_IDLE){LDUserIdleApi.init()}else{LDUserIdleApi.init();LDUserIdleApi.active()}};LDUserIdleApi.setUpdating=function(A){if(A){LDUserIdleApi.updating=true;setTimeout(function(){LDUserIdleApi.updating=false},10000)}else{LDUserIdleApi.updating=false}};LDUserIdleApi.active=function(){try{clearTimeout(LDUserIdleApi.idletimer);LDUserIdleApi.idletimer=setTimeout(function(){LDUserIdleApi.updateIdle()},LDUserIdleApi.getTime());if(LiveDeskApi.scode==LiveDeskApi.WMS_IDLE&&LDUserIdleApi.updating==false){var A=LiveDeskApi.smsg;if(A=="Idle"&&LDUserIdleApi.prevscode==LiveDeskApi.WMS_ONLINE){A="Available"}else{if(A=="Idle"&&LDUserIdleApi.prevscode==LiveDeskApi.WMS_BUSY){A="Busy"}}LDUserIdleApi.setUpdating(true);LiveDeskApi.setStatus(LDUserIdleApi.prevscode,A)}}catch(B){}};LiveDeskApi.setAgentAvailable=function(){var A={};A.MODE="SetStatus";A.STATUS="Available";A.SCODE="1";A.SMSG="Available";LiveDeskApi.sendPostMessage(A)};LiveDeskApi.setAgentBusy=function(){var A={};A.MODE="SetStatus";A.STATUS="Busy";A.SCODE="3";A.SMSG="Busy";LiveDeskApi.sendPostMessage(A)};LiveDeskApi.setAgentIdle=function(){var A={};A.MODE="SetStatus";A.STATUS="Idle";A.SCODE="4";A.SMSG="Idle";LiveDeskApi.handleAvailabilityChange(LiveDeskApi.WMS_IDLE,"Idle");LiveDeskApi.sendPostMessage(A)};LiveDeskApi.getAvailability=function(){var A={};A.SCODE=this.scode;A.SMSG=this.smsg;return A};LiveDeskApi.acceptTransferChat=function(A,D,B){var C={};C.MODE="TransferChat";C.STATUS="Accept";C.CHID=A;C.VISITORID=D;C.SENDER=B;LiveDeskApi.sendPostMessage(C)};LiveDeskApi.rejectTransferChat=function(A,D,B){var C={};C.MODE="TransferChat";C.STATUS="Reject";C.CHID=A;C.VISITORID=D;C.SENDER=B;LiveDeskApi.sendPostMessage(C)};LiveDeskApi.pickupVisitorChat=function(B){var A={};A.MODE="PickUP";A.VISITORID=B;LiveDeskApi.sendPostMessage(A)};LiveDeskApi.handleAvailabilityChange=function(A,B){if(A=="1"){$("#chatstatus").removeClass("chatInActiveIcon chatAvailableIcon chatBusyIcon").addClass("chatAvailableIcon")}else{if(A==4){$("#chatstatus").removeClass("chatInActiveIcon chatAvailableIcon chatBusyIcon").addClass("chatIdleIcon")}else{$("#chatstatus").removeClass("chatInActiveIcon chatAvailableIcon chatBusyIcon").addClass("chatBusyIcon")}}};LiveDeskApi.handleNewVisitor=function(G,E,C,B,A,D,F){var H={};H.visitorid=G;H.name=E;H.emailid=C;H.question=B;H.chatname=A;H.department=D;H.secstogo=F;addNotification(H)};function addNotification(H){if($("#exist_"+H.visitorid).length){return }$("#liveChatFloat").hide();if($("#chatContainer").is(":visible")){return false}var A=jQuery("#chatNotifier").find("[id^=notify_]").length+1;if(jQuery("#tab_Chat.selectedTab").length==0){var I=jQuery("#chatNotifier");createChatNotificationLayer(I);var G=H.secstogo;G=parseInt(G)-1;var B=H.question;B=(B)?B.replace(/\n/g,"<br/>"):B;var D='<div class="p10" id="notify_'+H.visitorid+'">';D+='<div class="fleft">';if(H.name){D+='<div class="poptxt bld">'+H.name;var F=H.visitorAdditionalInfo;if(F!=""){var C={};try{C=JSON.parse(F)}catch(E){C={}}if(C.hasOwnProperty("Account Name")){D+="&nbsp;|&nbsp;"+C["Account Name"]}}D+="</div>"}if(H.emailid){D+='<div class="poptxt mt10"><img src="/appcreator/images/account_mail_icon.png" class="chatemail"/>&nbsp;'+H.emailid+"</div>"}if(jQuery("#department_head").length!=0){D+='<div class="poptxt mt5"><img src="/appcreator/images/account_mail_icon.png" class="chatacc"/>&nbsp;'+H.department+"</div>"}D+="</div>";D+='<div class="fright">';D+="<a id=exist_"+H.visitorid+' class="chtclose" href="javascript:;" onClick="closeNotification(\''+H.visitorid+"','chat')\" title=\"decline\">X</a>";D+="</div>";D+='<div style="clear:both;"></div>';D+='<div class="question" title="'+B+'"><span class="">"'+((B.length>150)?B.substring(0,150)+"...":B)+'"</span></div>';D+='<div class="fleft mt10">';D+='<input type="button" onclick="acceptChat(\''+H.visitorid+'\')" value="Pick up" class="chatbtn mr5 zc-live-primary-btn"><input type="button" class="decline ml2 zc-live-secondary-btn" onclick="closeNotification(\''+H.visitorid+"','chat')\" value=\"Decline\">";D+="</div>";D+='<div class="fright ml20 mt10"><div id="timer_'+H.visitorid+'" class="chattimer">'+G+'</div></div><div class="clboth"></div>';if(jQuery("#chat_notifier").children().length>=1){jQuery("#chat_notifier").children().addClass("dotedbdr")}jQuery("#chat_notifier").append(D);I.slideDown(1000);updateTimer(H.visitorid,G);toggleClearAll();changeTitle(A)}else{changeTitle(A);var G=H.secstogo;G=parseInt(G)-1;setTimeout(changeTitle,G*1000)}}var browsertitletimeout;function updateTimer(B,A){if(jQuery("#timer_"+B).length!=1){return }A=parseInt(A);if(A<11){jQuery("#timer_"+B).addClass("alerttimer")}jQuery("#timer_"+B).text(A+" seconds");if(A==0){jQuery("#notify_"+B).remove();closeNotificationContainer();LiveDeskApi.getMissedCount();$("#liveChatFloat").show();if(jQuery("#chat_notifier").children().length==0){return }}A=A-1;setTimeout('updateTimer("'+B+'",'+(A)+")",1000)}function closeNotificationContainer(){if(jQuery("#chat_body_container div").children().length==0){jQuery("#chatNotifier").slideUp()}toggleClearAll();if(browsertitletimeout){clearTimeout(browsertitletimeout);document.title=browser_title}changeTitle()}function acceptChat(C){if(!LiveDeskApi.isLiveMode){var B=new Date();B.setTime(B.getTime()+(365*24*3600*1000));var A="zc_"+LiveDeskApi.appLinkName+"_"+LiveDeskApi.sharedByDisp+"_ChatFrameVisible="+escape("true")+";expires="+B.toGMTString()+";path=/;";document.cookie=A;var D="/"+LiveDeskApi.sharedByDisp+"/"+LiveDeskApi.appLinkName;window.open(D,"_blank")}$("#chatContainer").slideDown();jQuery("#notify_"+C).remove();LiveDeskApi.pickupVisitorChat(C);closeNotification(C,"chat");ZCApp.hideAndStopPropogation(this)}function closeNotification(A,B){if(B=="chat"){jQuery("[id='notify_"+A+"']").remove();LiveDeskApi.endSound()}else{jQuery("[id='chatnotification_"+A+"_"+B+"']").remove()}closeNotificationContainer()}function createChatNotificationLayer(A){jQuery("#chatNotifier").css("right","0px");if(jQuery("#ztinotifier").children().length!=0){jQuery("#chatNotifier").css("right",(jQuery("#ztinotifier").width()+(($.browser.msie)?100:170))+"px")}if(jQuery("#chat_body_container").length>0){return }var B='<div class="chtheader"><span class="headtxt">Visitor Waiting</span></div>';B+='<div id="chat_body_container" style="max-height:520px;overflow-y:auto;overflow-x:none;">';B+='<div id="chat_notifier"></div>';B+='<div id="chat_notification"></div>';B+="</div>";B+='<div class="" id="chat_clear_all" style="display:none;border-top:1px dotted #E1E1E1;"><a class="clearall" href="javascript:;" onClick="clearAllNotification()">Clear All</a></div>';A.html(B)}function toggleClearAll(){if(jQuery("#chat_body_container > div").children().length>1||(jQuery("#chat_notifier").children().length==1&&jQuery("#chat_notification").children().length)){jQuery("#chat_clear_all").show()}else{jQuery("#chat_clear_all").hide()}}function clearAllNotification(){jQuery("#chat_body_container").find("#chat_notifier,#chat_notification").empty();closeNotificationContainer()}function changeTitle(A){A=A||jQuery("#chatNotifier").find("[id^=notify_]").length;var B="No visitors";if(A==0){jQuery("#chatNotifier").find("span.headtxt").text("No visitors");document.title=browser_title;return }else{if(A==1){B=A+"  Visitor Waiting";jQuery("#chatNotifier").find("span.headtxt").text(B)}else{B=A+" Visitors Waiting";jQuery("#chatNotifier").find("span.headtxt").text(B)}}if(browsertitletimeout){clearTimeout(browsertitletimeout)}changeBrowserTitle(A+" Live visitor(s) Waiting",browser_title)}function changeBrowserTitle(A,B){document.title=A;browsertitletimeout=setTimeout('changeBrowserTitle("'+B+'","'+A+'")',1000)}function closeNotification(A,B){if(B=="chat"){jQuery("[id='notify_"+A+"']").remove();LiveDeskApi.endSound()}else{jQuery("[id='chatnotification_"+A+"_"+B+"']").remove()}closeNotificationContainer()}LiveDeskApi.handleVisitorMessage=function(B,D,C,A,E){};LiveDeskApi.handleAddAgentChat=function(B,G,A,D,F,C,E){};LiveDeskApi.handleTransferChat=function(B,G,A,D,F,C,E){};LiveDeskApi.handlePickUP=function(A){closeNotification(A,"chat");document.title=browser_title};LiveDeskApi.handleTransferAccept=function(A){closeNotification(A,"chat")};LiveDeskApi.handleTransferReject=function(A){};LiveDeskApi.handleAction=function(B,C){if(B.indexOf("BUTTON")!=-1){$("#customize_Button").closePopup();document.getElementById("frame_Button").src=document.getElementById("frame_Button").src;document.getElementById("frame_Float").src=document.getElementById("frame_Float").src}else{if(B.indexOf("FLOAT")!=-1){$("#customize_Float").closePopup();document.getElementById("frame_Button").src=document.getElementById("frame_Button").src;document.getElementById("frame_Float").src=document.getElementById("frame_Float").src}else{if(B.indexOf("WINDOW")!=-1){$("#customize_Window").closePopup();document.getElementById("frame_Window").src=document.getElementById("frame_Window").src}else{if(B=="CLOSEACCEPTTRANSCHAT"||B=="REJECTEDCLOSETRANSCHAT"){}else{if(B=="ACCEPTTRANSFERCHAT"||B=="INVITETRANSFERCHAT"){var A="empty"}else{if(B=="REJECTTRANSFERCHAT"){var A="empty"}else{if(B=="INVITESUPPORTREP"){var A="empty"}else{if(B=="MISSEDCOUNT"){$("#chat_missed_count").text(C.missedcount);if(C.missedcount>0){$("#chat_missed_count").show()}else{$("#chat_missed_count").hide()}}else{if(B=="CURRENTURL"){var A="empty"}else{if(B=="SHOWRESONSEMSG"){var A="empty"}}}}}}}}}}if(B=="ACCEPTTRANSFERCHAT"||B=="REJECTTRANSFERCHAT"){var A="empty"}};LiveDeskApi.endSound=function(){var A={};A.MODE="ENDSOUND";LiveDeskApi.sendPostMessage(A)};LiveDeskApi.enableSound=function(){var A={};A.MODE="ENABLESOUND";LiveDeskApi.sendPostMessage(A)};LiveDeskApi.muteSound=function(){var A={};A.MODE="MUTESOUND";LiveDeskApi.sendPostMessage(A)};LiveDeskApi.getMissedCount=function(){var A={};A.MODE="GETMISSEDCOUNT";LiveDeskApi.sendPostMessage(A)};LiveDeskApi.getCurrentURL=function(){var A={};A.MODE="GETCURRENTURL";LiveDeskApi.sendPostMessage(A)};LiveDeskApi.init();var Upgrade=new function(){this.sharedByDisp="";this.redirectUpgradePage=function(A,B){var C={};if(A!==undefined){C.subscriptionaccessfrom=A}showLoading();$.ajax({type:"GET",url:"/userhome/"+Upgrade.sharedByDisp+"/showPlan",data:C,success:function(E,D,F){hideLoading();if(B){window.open(E.storeurl,"_blank")}else{window.location.href=E.storeurl}}})};this.redirectToUpgradePage=function(D,A,C){if(ZCGlobal.isOnPremiseVersion){getLicenseContent()}else{var B={};if(A!==undefined){B.subscriptionaccessfrom=A}B.fromupgradepopup=true;$.ajax({type:"GET",beforeSend:function(){if(C){LIB._startLoading()}else{showLoading()}},url:"/userhome/"+D+"/showPlan",data:B,success:function(F,E,G){if(C){LIB._stopLoading()}else{hideLoading()}window.location.href=F.storeurl}})}};this.upgradePopup=function(C){var A=getCookie(C+"-upgradeprompt");if(A!=""){return }else{var E=new Date();E.setDate(E.getDate()+15);var B=C+"-upgradeprompt";var D="true";D=escape(D)+";expires="+E.toUTCString()+";path=/";document.cookie=B+"="+D}$("body").freeze(function(F){var G='<div class="upgrade-container"><div class="upgrade-header"><div class="content-heading pull-left">'+i18n["zc.onboarding.upgradeheading"]+'</div><div class="flRight appNameClose"><a id="upgradeClose" class="CrepopupClose" href="javascript:;"></a></div></div><div class="upgrade-content"><p>'+i18n["zc.onboarding.upgradedesc1"]+"<p>"+i18n["zc.onboarding.upgradedesc2"]+'</p></div><div class="upgrade-footer"><a class="btn primary-btn" zctlbl="reminder-popup-dashboard" href="javascript:void(0);" onclick="Upgrade.redirectUpgradePage(\'FREE_UPGRADE_POPUP\');">'+i18n["zc.onboarding.upgradebutton"]+"</a></div></div>";F.append(G);$(".upgrade-container").find("a#upgradeClose").click(function(H){$("body").unfreeze();H.preventDefault()});$(F).find(".upgrade-container").animate({top:0},1000)})}};$.upgradepopup={_p:"",create:function(B){var C=B.value;var A=B.type!==undefined?B.type:"addons";function D(){this.settings=B==undefined?{}:B;this.popup=null;this.freezer=null}D.prototype.open=function(){var F=this;var I=function(){if(F.settings.sharedby===undefined){$.error("Syntax Error :  Usage :- \n$.upgradepopup.create({\n\taction: addon name (TEXT),\n\tsharedby: sharedBy,\n\tdata: Ajax request extra params [csrf]\n});");return false}F.settings.data=F.settings.data===undefined?{}:F.settings.data;F.settings.upgradeType=F.settings.upgradeType===undefined?"addons":F.settings.upgradeType;F.settings.action=F.settings.action===undefined?"users":F.settings.action;F.settings.isEditMode=F.settings.isEditMode===undefined?false:true;F.settings.trackingpage=F.settings.action+"-"+F.settings.currentpage;F.settings.isTemplate=true;F.settings.isDashboard=F.settings.isDashboard===undefined?false:F.settings.isDashboard};var H=function(){F.settings.data.zcaction=F.settings.action;F.settings.data.type=A;F.settings.data[F.settings.secretKey]=F.settings.secretVal;$.ajax({url:"/userhome/"+F.settings.sharedby+"/upgradepopup",type:"POST",data:F.settings.data,success:function(L,K,M){if(L.result!==undefined){if(L.result==="success"){F.popup=$('<div class="zs_widget zc-dem-store-upgradepopup"></div>');F.settings.isTemplate=$(F.popup).find(".pricing_upgrade_outer_table").length===1;F.settings.successLabel=L.label;F.settings.title=L.title;F.settings.message=L.message;F.settings.previousCount=L.previousCount;F.settings.currentCount=L.currentCount;J();E(L);G(L.code)}else{if(L.result==="redirection"){if(isCreatorPlusAcc){window.open(L.storeurl,"_blank")}else{window.location.href=L.storeurl}}else{if(F.settings.template!==undefined&&L.result!=="skip"){F.settings.template()}}}}else{if(L!=undefined){if(F.settings.template!==undefined){F.settings.template()}else{iCustomizePopup({body:L,containerClass:"zc-dem-upgrade-plan",parentClass:"zc-dem-upgrade-popup-container"});if(!B.isDashboard){$(".zc-dem-upgrade-popup-wrapper").zcScrollPane({autoReinit:true})}if(B.successCallBk!=undefined){B.successCallBk()}}}}}})};var E=function(L){var K={serviceId:901,customId:L.customid,secretKey:F.settings.secretKey,secretVal:F.settings.secretVal,itemList:[{code:L.code,action:"upgrade",type:F.settings.upgradeType}],settings:{upgradeTitle:F.settings.title,upgradeInfo:F.settings.message,successTitle:"License Upgraded Successfully",successActionLabel:F.settings.successLabel,successSecondaryAction:"disable"}};if(L.discountArr!=undefined&&L.discountArr.length>0){var M={};M.discounts=L.discountArr;M.title="Special year-end offer";K.settings.applyPromotion=M;K.settings.onFailure="closePopup"}zs_widget.init(K)};var G=function(K){zs_store=(function(){return{onSuccess:function(M){var L=M[K];var N=F.settings.previousCount+L;if(F.settings.action==="files"){var P=L*3*1024;var O=F.settings.previousCount/(1024*1024);N=P+O}var Q={};Q.status="success";Q.maximumCount=N;Q.currentCount=F.settings.currentCount;Q.action=F.settings.action;F.settings.success(Q);$.upgradepopup.remove()},onCancel:function(){$.upgradepopup.remove()}}}())};var J=function(){$(F.popup).show();F.freezer=$.upgradepopup.freeze(F.settings.isEditMode,F.settings.isDashboard).append(F.popup)};I();H()};D.prototype.load=function(F){var E=this;if(F){$(E.popup).find(".upgradeloading").show()}else{$(E.popup).find(".upgradeloading").hide()}};D.prototype.close=function(){var E=this;if(E.settings.close!==undefined){E.settings.close()}$(E.popup).find(".upgradeloading").hide();$.upgradepopup.defreeze(E.freezer)};_p=new D();_p.open()},freeze:function(B,C){var A;if(C){A=$('<div class="upgradepopup_zcOverlay"><div class="upgradepopup_centerLay"></div></div>')}else{A=$('<div class="upgradepopup_zcOverlay"><div class="upgradepopup_leftLay"></div><div class="upgradepopup_topLay"></div><div class="upgradepopup_centerLay"></div><div>');if(!B){$(A).find(".upgradepopup_leftLay").css("background","rgba(255, 255, 255, 0.38)")}}$("body").append(A);$(A).fadeIn(400);return A},defreeze:function(A){$(A).fadeOut(400,function(){$(this).remove()})},remove:function(){if(_p!=undefined){_p.close()}},loading:function(A){if(_p!=undefined){_p.load(A)}},settings:function(){if(_p!=undefined){return _p.settings}}};$.upgrade={create:function(A){var B={};B.zcFeatureName=A.zcFeatureName;B.featureType=A.featureType;B.zccpn=A.zccpn;$.ajax({url:"/userhome/"+A.sharedBy+"/upgradepopup",type:"POST",beforeSend:showLoading(),data:B,success:function(D,C,E){hideLoading();if(D!=undefined){iCustomizePopup({body:D,containerClass:"zc-dem-upgrade-plan",parentClass:"zc-dem-upgrade-popup-container"});if(!A.isDashboard){$(".zc-dem-upgrade-popup-wrapper").zcScrollPane({autoReinit:true})}if(A.successCallBk!=undefined){A.successCallBk()}}}})}};"use strict";if(!window.ZSEC){Object.defineProperty(window,"ZSEC",{value:{},writable:false,configurable:false,enumerable:false})}Object.defineProperty(ZSEC,"util",{value:{},writable:false,configurable:false,enumerable:false});(function(){if(!Object.defineProperty||!(function(){try{Object.defineProperty({},"x",{});return true}catch(B){return false}}())){var A=Object.defineProperty;Object.defineProperty=function(D,E,C){if(A){try{return A(D,E,C)}catch(B){}}if(D!==Object(D)){throw TypeError("Object.defineProperty called on non-object")}if(Object.prototype.__defineGetter__&&("get" in C)){Object.prototype.__defineGetter__.call(D,E,C.get)}if(Object.prototype.__defineSetter__&&("set" in C)){Object.prototype.__defineSetter__.call(D,E,C.set)}if("value" in C){D[E]=C.value}return D}}}());ZSEC.util.defineProperty=function ZSECDefineProperty(F,E,D,C,A,B,G){if(!C&&E in F){return }A=A==true;B=B==true;G=G==true;return Object.defineProperty(F,E,{value:D,writable:A,configurable:B,enumerable:G})};ZSEC.util.defineProperty(ZSEC,"version","4.0",true);ZSEC.util.defineProperty(ZSEC,"constants",ZSEC.constants||{},true);ZSEC.util.ArrayIndexOf=Array.prototype.indexOf;if(!ZSEC.util.ArrayIndexOf){ZSEC.util.ArrayIndexOf=function(C){if(this===void 0||this===null){throw TypeError()}var D=Object(this);var A=D.length>>>0;if(A===0){return -1}var E=0;if(arguments.length>0){E=Number(arguments[1]);if(isNaN(E)){E=0}else{if(E!==0&&E!==(1/0)&&E!==-(1/0)){E=(E>0||-1)*Math.floor(Math.abs(E))}}}if(E>=A){return -1}var B=E>=0?E:Math.max(A-Math.abs(E),0);for(;B<A;B++){if(B in D&&D.charAt(B)===C){return B}}return -1}}if(!String.prototype.codePointAt){var codePointAt=function(A){if(this==null){throw TypeError()}var D=String(this);var E=D.length;var C=A?Number(A):0;if(C!=C){C=0}if(C<0||C>=E){return undefined}var F=D.charCodeAt(C);var B;if(F>=55296&&F<=56319&&E>C+1){B=D.charCodeAt(C+1);if(B>=56320&&B<=57343){return(F-55296)*1024+B-56320+65536}}return F};ZSEC.util.defineProperty(String.prototype,"codePointAt",codePointAt,false)}else{ZSEC.util.defineProperty(String.prototype,"codePointAt",String.prototype.codePointAt,true)}if(!String.fromCodePoint){var stringFromCharCode=String.fromCharCode;var floor=Math.floor;var fromCodePoint=function(){var H=16384;var D=[];var G;var F;var C=-1;var E=arguments.length;if(!E){return""}var A="";while(++C<E){var B=Number(arguments[C]);if(!isFinite(B)||B<0||B>1114111||floor(B)!=B){throw RangeError("Invalid code point: "+B)}if(B<=65535){D.push(B)}else{B-=65536;G=(B>>10)+55296;F=(B%1024)+56320;D.push(G,F)}if(C+1==E||D.length>H){A+=stringFromCharCode.apply(null,D);D.length=0}}return A};ZSEC.util.defineProperty(String,"fromCodePoint",fromCodePoint,false)}else{ZSEC.util.defineProperty(String,"fromCodePoint",String.fromCodePoint,true)}(function(){var A={log:function(B){if(navigator&&navigator.userAgent){var D=navigator.userAgent;var C=D.match(/opera|chrome|safari|firefox|msie|trident(?=\/)/i);if(C&&C[0].search(/trident|msie/i)<0){window.console.log("%cSTOP!","color:red;font-size:xx-large;font-weight:bold;");window.console.log("%cThis is a browser feature intended for developers. Do not enter or paste code which you don't understand. It may allow attackers to steal your information or impersonate you.\nSee https://en.wikipedia.org/wiki/Self-XSS for more details","font-size:large;");return }}window.console.log("STOP!\nThis is a browser feature intended for developers. Do not enter or paste code which you don't understand. It may allow attackers to steal your information or impersonate you.\nSee https://en.wikipedia.org/wiki/Self-XSS for more details")}};ZSEC.util.defineProperty(ZSEC,"Console",A,true,false,false,true)})();ZSEC.Console.log();"use strict";(function(B){var G={};var D="34=&quot|38=&amp|60=&lt|62=&gt|160=&nbsp|161=&iexcl|162=&cent|163=&pound|164=&curren|165=&yen|166=&brvbar|167=&sect|168=&uml|169=&copy|170=&ordf|171=&laquo|172=&not|173=&shy|174=&reg|175=&macr|176=&deg|177=&plusmn|178=&sup2|179=&sup3|180=&acute|181=&micro|182=&para|183=&middot|184=&cedil|185=&sup1|186=&ordm|187=&raquo|188=&frac14|189=&frac12|190=&frac34|191=&iquest|192=&Agrave|193=&Aacute|194=&Acirc|195=&Atilde|196=&Auml|197=&Aring|198=&AElig|199=&Ccedil|200=&Egrave|201=&Eacute|202=&Ecirc|203=&Euml|204=&Igrave|205=&Iacute|206=&Icirc|207=&Iuml|208=&ETH|209=&Ntilde|210=&Ograve|211=&Oacute|212=&Ocirc|213=&Otilde|214=&Ouml|215=&times|216=&Oslash|217=&Ugrave|218=&Uacute|219=&Ucirc|220=&Uuml|221=&Yacute|222=&THORN|223=&szlig|224=&agrave|225=&aacute|226=&acirc|227=&atilde|228=&auml|229=&aring|230=&aelig|231=&ccedil|232=&egrave|233=&eacute|234=&ecirc|235=&euml|236=&igrave|237=&iacute|238=&icirc|239=&iuml|240=&eth|241=&ntilde|242=&ograve|243=&oacute|244=&ocirc|245=&otilde|246=&ouml|247=&divide|248=&oslash|249=&ugrave|250=&uacute|251=&ucirc|252=&uuml|253=&yacute|254=&thorn|255=&yuml|338=&OElig|339=&oelig|352=&Scaron|353=&scaron|376=&Yuml|402=&fnof|710=&circ|732=&tilde|913=&Alpha|914=&Beta|915=&Gamma|916=&Delta|917=&Epsilon|918=&Zeta|919=&Eta|920=&Theta|921=&Iota|922=&Kappa|923=&Lambda|924=&Mu|925=&Nu|926=&Xi|927=&Omicron|928=&Pi|929=&Rho|931=&Sigma|932=&Tau|933=&Upsilon|934=&Phi|935=&Chi|936=&Psi|937=&Omega|945=&alpha|946=&beta|947=&gamma|948=&delta|949=&epsilon|950=&zeta|951=&eta|952=&theta|953=&iota|954=&kappa|955=&lambda|956=&mu|957=&nu|958=&xi|959=&omicron|960=&pi|961=&rho|962=&sigmaf|963=&sigma|964=&tau|965=&upsilon|966=&phi|967=&chi|968=&psi|969=&omega|977=&thetasym|978=&upsih|982=&piv|8194=&ensp|8195=&emsp|8201=&thinsp|8204=&zwnj|8205=&zwj|8206=&lrm|8207=&rlm|8211=&ndash|8212=&mdash|8216=&lsquo|8217=&rsquo|8218=&sbquo|8220=&ldquo|8221=&rdquo|8222=&bdquo|8224=&dagger|8225=&Dagger|8226=&bull|8230=&hellip|8240=&permil|8242=&prime|8243=&Prime|8249=&lsaquo|8250=&rsaquo|8254=&oline|8260=&frasl|8364=&euro|8465=&image|8472=&weierp|8476=&real|8482=&trade|8501=&alefsym|8592=&larr|8593=&uarr|8594=&rarr|8595=&darr|8596=&harr|8629=&crarr|8656=&lArr|8657=&uArr|8658=&rArr|8659=&dArr|8660=&hArr|8704=&forall|8706=&part|8707=&exist|8709=&empty|8711=&nabla|8712=&isin|8713=&notin|8715=&ni|8719=&prod|8721=&sum|8722=&minus|8727=&lowast|8730=&radic|8733=&prop|8734=&infin|8736=&ang|8743=&and|8744=&or|8745=&cap|8746=&cup|8747=&int|8756=&there4|8764=&sim|8773=&cong|8776=&asymp|8800=&ne|8801=&equiv|8804=&le|8805=&ge|8834=&sub|8835=&sup|8836=&nsub|8838=&sube|8839=&supe|8853=&oplus|8855=&otimes|8869=&perp|8901=&sdot|8968=&lceil|8969=&rceil|8970=&lfloor|8971=&rfloor|10216=&lang|10217=&rang|9674=&loz|9824=&spades|9827=&clubs|9829=&hearts|9830=&diams";D=D.split("|");for(var E=0;E<D.length;E++){var F=D[E].split("=");G[F[0]]=F[1]}function C(J){var I=[];for(var H=0;H<J.length;H++){I.push(J[H].charCodeAt(0))}return I}var A={characterToEntityMap:G,IMMUNE_HTML:C(new Array(",",".","-","_"," ")),IMMUNE_HTMLATTR:C(new Array(",",".","-","_")),IMMUNE_CSS:C(new Array()),IMMUNE_JAVASCRIPT:C(new Array(",",".","_"))};ZSEC.util.defineProperty(ZSEC,"Encoder",B(A),true,false,false,true)}(function encoder(C){var G={};var B=C.characterToEntityMap;var D=[];for(var M=0;M<255;M++){if(M>=48&&M<=57||M>=65&&M<=90||M>=97&&M<=122){D[M]=null}else{D[M]=M.toString(16)}}var I=function(O){if(O<256){return D[O]}return O.toString(16)};var H=function(P,R){if(ZSEC.util.ArrayIndexOf.call(P,R)!=-1){return String.fromCodePoint(R)}var Q=I(R);if(Q==null){return String.fromCodePoint(R)}if((R<=31&&R!=9&&R!=10&&R!=13)||(R>=127&&R<=159)||R==32){return"&#x20;"}var O=B[R];if(O!=null){return O+";"}return"&#x"+Q+";"};var J=function(P,S){if(ZSEC.util.ArrayIndexOf.call(P,S)!=-1){return String.fromCharCode(S)}var Q=I(S);if(Q==null){return String.fromCharCode(S)}var O=S.toString(16);if(S<256){var R="00".substr(O.length);return"\\x"+R+O.toUpperCase()}R="0000".substr(O.length);return"\\u"+R+O.toUpperCase()};var F=function(O,Q){if(ZSEC.util.ArrayIndexOf.call(O,Q)!=-1){return String.fromCodePoint(Q)}var P=I(Q);if(P==null){return String.fromCodePoint(Q)}return"\\"+P+" "};function L(S,T,O,P){if(T==null||T==undefined||"string"!=typeof T){return T}var Q="";for(var R=0;R<T.length;R++){if(P){var U=T.codePointAt(R);Q+=O(S,U,P);if(U>65535){R++}}else{Q+=O(S,T.charCodeAt(R))}}return Q}G.encodeForHTML=function K(O){return L(C.IMMUNE_HTML,O,H,true)};G.encodeForHTMLAttribute=function A(O){return L(C.IMMUNE_HTMLATTR,O,H,true)};G.encodeForJavaScript=function N(O){return L(C.IMMUNE_JAVASCRIPT,O,J,false)};G.encodeForCSS=function E(O){return L(C.IMMUNE_CSS,O,F,true)};if(Object.freeze){Object.freeze(G)}return G}));"use strict";(function(A){window.DOMPurify=A(window)}(function factory(AG){var y=function(AT){return factory(AT)};y.version="0.8.5";y.removed=[];if(!AG||!AG.document||AG.document.nodeType!==9){y.isSupported=false;return y}var u=false;var w=false;var F=AG.document;var m=F;var I=AG.DocumentFragment;var AA=AG.HTMLTemplateElement;var d=AG.Node;var AB=AG.NodeFilter;var AC=AG.NamedNodeMap||AG.MozNamedAttrMap;var a=F.createTextNode("a").constructor;var n=F.createComment("a").constructor;var Z=AG.DOMParser;if(typeof AA==="function"){var G=F.createElement("template");if(G.content&&G.content.ownerDocument){F=G.content.ownerDocument}}var e=F.implementation;var O=F.createNodeIterator;var f=F.getElementsByTagName;var c=F.createDocumentFragment;var AL=m.importNode;var H={};y.isSupported=typeof e.createHTMLDocument!=="undefined"&&F.documentMode!==9;var AE=function(AV,AU){var AT=AU.length;while(AT--){if(typeof AU[AT]==="string"){AU[AT]=AU[AT].toLowerCase()}AV[AU[AT]]=true}return AV};var AO=function(AT){var AU={};var AV;for(AV in AT){if(AT.hasOwnProperty(AV)){AU[AV]=AT[AV]}}return AU};var s=null;var AI=AE({},[]);var Y=null;var o=AE({},[]);var R=null;var C=null;var T=true;var P=true;var K=false;var AS=false;var AR=false;var W=/\{\{[\s\S]*|[\s\S]*\}\}/gm;var AK=/<%[\s\S]*|[\s\S]*%>/gm;var q=false;var N=true;var z=false;var AF=false;var B=false;var Q=true;var E=true;var v=AE({},["audio","head","math","script","svg","video","style"]);var AH=AE({},["audio","video","img","source","image"]);var J=AE({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]);var U=null;var AQ=F.createElement("form");var S=function(AT){if(typeof AT!=="object"){AT={}}s="ALLOWED_TAGS" in AT?AE({},AT.ALLOWED_TAGS):AI;Y="ALLOWED_ATTR" in AT?AE({},AT.ALLOWED_ATTR):o;R="FORBID_TAGS" in AT?AE({},AT.FORBID_TAGS):{};C="FORBID_ATTR" in AT?AE({},AT.FORBID_ATTR):{};T=AT.ALLOW_ARIA_ATTR!==false;P=AT.ALLOW_DATA_ATTR!==false;K=AT.ALLOW_UNKNOWN_PROTOCOLS||false;AS=AT.SAFE_FOR_JQUERY||false;AR=AT.SAFE_FOR_TEMPLATES||false;q=AT.WHOLE_DOCUMENT||false;z=AT.RETURN_DOM||false;AF=AT.RETURN_DOM_FRAGMENT||false;B=AT.RETURN_DOM_IMPORT||false;N=AT.FORCE_BODY!==false;Q=AT.SANITIZE_DOM!==false;E=AT.KEEP_CONTENT!==false;if(AR){P=false}if(AF){z=true}if(AT.ADD_URI_SAFE_ATTR){AE(J,AT.ADD_URI_SAFE_ATTR)}if(E){s["#text"]=true}if(q){AE(s,["html","head","body"])}if(s.table){AE(s,["tbody"])}if(Object&&"freeze" in Object){Object.freeze(AT)}U=AT};var X=function(AT){y.removed.push({element:AT});try{AT.parentNode.removeChild(AT)}catch(AU){AT.outerHTML=""}};var V=function(AT,AV){try{y.removed.push({attribute:AV.getAttributeNode(AT),from:AV})}catch(AU){y.removed.push({attribute:null,from:AV})}AV.removeAttribute(AT)};var D=function(AU){var AW,AT;if(N){AU="<remove></remove>"+AU}if(u){try{AW=new Z().parseFromString(AU,"text/html")}catch(AV){}}if(w){addToSet(R,["title"])}if(!AW||!AW.documentElement){AW=e.createHTMLDocument("");AT=AW.body;AT.parentNode.removeChild(AT.parentNode.firstElementChild);AT.outerHTML=AU}if(typeof AW.getElementsByTagName==="function"){return AW.getElementsByTagName(q?"html":"body")[0]}return f.call(AW,q?"html":"body")[0]};if(y.isSupported){(function(){try{var AU=D('<svg><p><style><img src="</style><img src=x onerror=alert(1)//">');if(AU.querySelector("svg img")){u=true}}catch(AT){}})();(function(){try{var AU=D("<x/><title>&lt;/title&gt;&lt;img&gt;");if(AU.querySelector("title").innerHTML.match(/<\/title/)){w=true}}catch(AT){}})()}var A=function(AT){return O.call(AT.ownerDocument||AT,AT,AB.SHOW_ELEMENT|AB.SHOW_COMMENT|AB.SHOW_TEXT,function(){return AB.FILTER_ACCEPT},false)};var M=function(AT){if(AT instanceof a||AT instanceof n){return false}if(typeof AT.nodeName!=="string"||typeof AT.textContent!=="string"||typeof AT.removeChild!=="function"||!(AT.attributes instanceof AC)||typeof AT.removeAttribute!=="function"||typeof AT.setAttribute!=="function"){return true}return false};var b=function(AT){return(typeof d==="object"?AT instanceof d:AT&&typeof AT==="object"&&typeof AT.nodeType==="number"&&typeof AT.nodeName==="string")};var AP=function(AU){var AT,AV;AM("beforeSanitizeElements",AU,null);if(M(AU)){X(AU);return true}AT=AU.nodeName.toLowerCase();AM("uponSanitizeElement",AU,{tagName:AT,allowedTags:s});if(!s[AT]||R[AT]){if(E&&!v[AT]&&typeof AU.insertAdjacentHTML==="function"){try{AU.insertAdjacentHTML("AfterEnd",AU.innerHTML)}catch(AW){}}X(AU);return true}if(AT!="style"){if(AS&&!AU.firstElementChild&&(!AU.content||!AU.content.firstElementChild)&&/</g.test(AU.textContent)){y.removed.push({element:AU.cloneNode()});if(AU.innerHTML){AU.innerHTML=AU.innerHTML.replace(/</g,"&lt;")}else{AU.innerHTML=AU.textContent.replace(/</g,"&lt;")}}if(AR&&AU.nodeType===3){AV=AU.textContent;AV=AV.replace(W," ");AV=AV.replace(AK," ");if(AU.textContent!==AV){y.removed.push({element:AU.cloneNode()});AU.textContent=AV}}}else{if(AS&&!AU.firstElementChild&&(!AU.content||!AU.content.firstElementChild)&&/</g.test(AU.textContent)){y.removed.push({element:AU.cloneNode()});AU.innerHTML=AU.textContent.replace(/</g,"\\3c ")}}AM("afterSanitizeElements",AU,null);return false};var l=/^data-[-\w.\u00B7-\uFFFF]/;var h=/^aria-[-\w]+$/;var L=/^(?:(?:https?|mailto|tel):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))/i;var p=/^(?:\w+script|data):/i;var AN=/[\x00-\x20\xA0\u1680\u180E\u2000-\u2029\u205f\u3000]/g;var AD=function(AU){var AZ,AT,Aa,Ad,AX,AW,Ab,AV;AM("beforeSanitizeAttributes",AU,null);AW=AU.attributes;if(!AW){return }Ab={attrName:"",attrValue:"",keepAttr:true,allowedAttributes:Y};AV=AW.length;while(AV--){AZ=AW[AV];AT=AZ.name;Aa=AZ.value.trim();Ad=AT.toLowerCase();Ab.attrName=Ad;Ab.attrValue=Aa;Ab.keepAttr=true;AM("uponSanitizeAttribute",AU,Ab);Aa=Ab.attrValue;if(Ad==="name"&&AU.nodeName==="IMG"&&AW.id){AX=AW.id;AW=Array.prototype.slice.apply(AW);V("id",AU);V(AT,AU);if(AW.indexOf(AX)>AV){AU.setAttribute("id",AX.value)}}else{if(AT==="id"){AU.setAttribute(AT,"")}V(AT,AU)}if(!Ab.keepAttr){continue}if(Q&&(Ad==="id"||Ad==="name")&&(Aa in F||Aa in AQ)){continue}if(AR){Aa=Aa.replace(W," ");Aa=Aa.replace(AK," ")}var Ac=false;if(P&&l.test(Ad)){Ac=true}else{if(T&&h.test(Ad)){Ac=true}else{if(!Y[Ad]||C[Ad]){continue}else{if(J[Ad]){Ac=true}else{if(L.test(Aa.replace(AN,""))){Ac=true}else{if((Ad==="src"||Ad==="xlink:href")&&Aa.indexOf("data:")===0&&AH[AU.nodeName.toLowerCase()]){Ac=true}else{if(K&&!p.test(Aa.replace(AN,""))){Ac=true}else{if(!Aa){Ac=true}else{continue}}}}}}}}try{AU.setAttribute(AT,Aa);y.removed.pop()}catch(AY){}}AM("afterSanitizeAttributes",AU,null)};var AJ=function(AT){var AV;var AU=A(AT);AM("beforeSanitizeShadowDOM",AT,null);while((AV=AU.nextNode())){AM("uponSanitizeShadowNode",AV,null);if(AP(AV)){continue}if(AV.content instanceof I){AJ(AV.content)}AD(AV)}AM("afterSanitizeShadowDOM",AT,null)};var AM=function(AV,AT,AU){if(!H[AV]){return }H[AV].forEach(function(AW){AW.call(y,AT,AU,U)})};y.sanitize=function(AY,AU){var AT,AX,AW,Aa,AZ,AV;if(!AY){AY="<!-->"}if(typeof AY!=="string"&&!b(AY)){if(typeof AY.toString!=="function"){throw new TypeError("toString is not a function")}else{AY=AY.toString()}}if(!y.isSupported){if(typeof AG.toStaticHTML==="object"||typeof AG.toStaticHTML==="function"){if(typeof AY==="string"){return AG.toStaticHTML(AY)}else{if(b(AY)){return AG.toStaticHTML(AY.outerHTML)}}}return AY}S(AU);y.removed=[];if(AY instanceof d){AT=D("<!-->");AX=AT.ownerDocument.importNode(AY,true);if(AX.nodeType===1&&AX.nodeName==="BODY"){AT=AX}else{AT.appendChild(AX)}}else{if(!z&&!q&&AY.indexOf("<")===-1){return AY}AT=D(AY);if(!AT){return z?null:""}}if(N){X(AT.firstChild)}AZ=A(AT);while((AW=AZ.nextNode())){if(AW.nodeType===3&&AW===Aa){continue}if(AP(AW)){continue}if(AW.content instanceof I){AJ(AW.content)}AD(AW);Aa=AW}if(z){if(AF){AV=c.call(AT.ownerDocument);while(AT.firstChild){AV.appendChild(AT.firstChild)}}else{AV=AT}if(B){AV=AL.call(m,AV,true)}return AV}return q?AT.outerHTML:AT.innerHTML};y.addHook=function(AU,AT){if(typeof AT!=="function"){return }H[AU]=H[AU]||[];H[AU].push(AT)};y.removeHook=function(AT){if(H[AT]){H[AT].pop()}};y.removeHooks=function(AT){if(H[AT]){H[AT]=[]}};y.removeAllHooks=function(){H={}};return y}));function addToSet(C,B){var A=B.length;while(A--){C[B[A]]=true}return C}function addObjsToSet(C,A){for(var B in A){if(A.hasOwnProperty(B)){C[B]=true}}return C}function removeFromSet(D,C){var B={};for(var A in D){if(D.hasOwnProperty(A)){if(A!=C){B[A]=D[A]}}}return B}(function(A){var B={};B.ALLOW_ARIA_ATTR=true;B.ALLOW_DATA_ATTR=true;B.ALLOW_UNKNOWN_PROTOCOLS=false;B.SAFE_FOR_JQUERY=false;B.SAFE_FOR_TEMPLATES=false;B.WHOLE_DOCUMENT=false;B.RETURN_DOM=false;B.RETURN_DOM_FRAGMENT=false;B.RETURN_DOM_IMPORT=false;B.FORCE_BODY=true;B.SANITIZE_DOM=true;B.KEEP_CONTENT=true;B.STYLE_VALIDATION=true;B.REMOVE_ONEVENTS=true;B.ALLOWED_STYLE="NONE";B.ALLOWED_TAGS="a|abbr|acronym|address|area|article|aside|audio|b|bdi|bdo|big|blink|blockquote|body|br|button|canvas|caption|center|cite|code|col|colgroup|content|data|datalist|dd|decorator|del|details|dfn|dir|div|dl|dt|element|em|fieldset|figcaption|figure|font|footer|form|h1|h2|h3|h4|h5|h6|head|header|hgroup|hr|html|i|img|input|ins|kbd|label|legend|li|main|map|mark|marquee|menu|menuitem|meter|nav|nobr|ol|optgroup|option|output|p|pre|progress|q|rp|rt|ruby|s|samp|section|select|shadow|small|source|spacer|span|strike|strong|sub|summary|sup|table|tbody|td|template|textarea|tfoot|th|thead|time|title|tr|track|tt|u|ul|var|video|wbr|#text".split("|");B.ALLOWED_ATTR="accept|action|align|alt|autocomplete|background|bgcolor|border|cellpadding|cellspacing|checked|cite|class|clear|color|cols|colspan|coords|datetime|default|dir|disabled|download|enctype|face|for|headers|height|hidden|high|href|hreflang|id|ismap|label|lang|list|loop|low|max|maxlength|media|method|min|multiple|name|noshade|novalidate|nowrap|open|optimum|pattern|placeholder|poster|preload|pubdate|radiogroup|readonly|rel|required|rev|reversed|role|rows|rowspan|spellcheck|scope|selected|shape|size|span|srclang|start|src|step|summary|tabindex|title|target|type|usemap|valign|value|width|xmlns|sandbox".split("|");B.ALLOWED_STYLE_PROPS="azimuth|background|background-attachment|background-color|background-image|background-position|content|background-repeat|border-collapse|border-color|border-top-color|border-right-color|border-bottom-color|border-left-color|bottom|caption-side|clear|color|cue-after|cue-before|direction|display|elevation|empty-cells|float|font-size|font-size-adjust|font-stretch|font-style|font-variant|font-weight|height|left|letter-spacing|line-height|list-style-image|list-style-position|list-style-type|marker-offset|max-height|max-width|min-height|min-width|orphans|outline-color|overflow|page-break-after|page-break-before|page-break-inside|pause-after|pause-before|pitch|pitch-range|position|richness|right|size|speak|speak-header|speak-numeral|speak-punctuation|speech-rate|stress|table-layout|text-indent|text-transform|top|unicode-bidi|vertical-align|visibility|volume|white-space|widows|width|word-spacing|border-style|border-top-style|border-right-style|border-bottom-style|border-left-style|border-top-width|border-right-width|border-bottom-width|border-left-width|border-width|margin|margin-top|margin-right|margin-bottom|margin-left|outline-style|outline-width|padding|padding-top|padding-right|padding-bottom|padding-left|border|border-top|border-right|border-bottom|border-left|cue|list-style|marks|outline|pause|text-decoration|border-spacing|clip|counter-increment|clip|cursor|text-shadow|font|font-family|page|play-during|text-align|voice-family".split("|");B.FORBID_TAGS=[];B.FORBID_ATTR=[];B.ALLOWED_TAGS_OBJ={};B.ALLOWED_ATTR_OBJ={};B.FORBID_TAGS_OBJ={};B.FORBID_ATTR_OBJ={};B.SANDBOX_SAFE_DOMAINS=[];B.ADD_URI_SAFE_ATTR=[];B.EXTENDS=["GLOBAL_ATTRIBUTES","GLOBAL_TAGS","FORBID_TAGS","FORBID_ATTR","GLOBAL_APPEND_ATTRIBUTES","GLOBAL_ATTRIBUTE_RULES","ADD_URI_SAFE_ATTR","TAG_RULES"];B.TAG_RULES={a:{APPEND_ATTRIBUTES:[{NAME:"rel",VALUE:"noopener noreferrer",CRITERIA:[{NAME:"target",CONTAINS:"_blank"}]}]}};B.GLOBAL_APPEND_ATTRIBUTES=[];B.GLOBAL_ATTRIBUTE_RULES={};ZSEC.util.defineProperty(ZSEC,"HTMLPurifier",A(B,DOMPurify(window)),true,false,false,true);delete window.DOMPurify}(function factory(e,a){var S=addToSet({},["script"]);var U=addToSet({},["srcdoc"]);var f=["ALLOW_ARIA_ATTR","ALLOW_DATA_ATTR","ALLOW_UNKNOWN_PROTOCOLS","SAFE_FOR_JQUERY","SAFE_FOR_TEMPLATES","WHOLE_DOCUMENT","RETURN_DOM","RETURN_DOM_FRAGMENT","RETURN_DOM_IMPORT","FORCE_BODY","SANITIZE_DOM","KEEP_CONTENT","ALLOWED_STYLE_PROPS","SANDBOX_SAFE_DOMAINS"];var Y=["ALLOWED_TAGS","ALLOWED_ATTR","FORBID_TAGS","FORBID_ATTR"];var Q=["ALLOWED_TAGS_OBJ","ALLOWED_ATTR_OBJ","FORBID_TAGS_OBJ","FORBID_ATTR_OBJ"];var B=["ADD_URI_SAFE_ATTR","GLOBAL_APPEND_ATTRIBUTES","GLOBAL_ATTRIBUTE_RULES","TAG_RULES"];var A=addToSet({},f);var W=addToSet({},Y);var T=addToSet({},Q);var V=addToSet({},B);V=addToSet(V,Y);V=addToSet(V,Q);var L=addToSet({},f.concat(["STYLE_VALIDATION","ALLOWED_STYLE","EXTENDS","REMOVE_ONEVENTS","GLOBAL_ATTRIBUTES","GLOBAL_TAGS"],Y,Q,B));var F={iframe:{NAME:"iframe",ATTRIBUTE_RULES:{sandbox:{NAME:"sandbox",SKIP_ON_SAME_DOMAIN:true,NOT_CONTAINS:["allow-top-navigation","allow-popups-to-escape-sandbox"],DEFAULT_VALUE:"allow-popups allow-forms allow-scripts allow-same-origin"}},APPEND_ATTRIBUTES:[{NAME:"sandbox",VALUE:"allow-popups allow-forms allow-scripts allow-same-origin",CRITERIA:[{SKIP_ON_SAME_DOMAIN:false}]}]},embed:{NAME:"embed",ATTRIBUTE_RULES:{type:{NAME:"type",EQUAL:"application/pdf",DEFAULT_VALUE:"application/pdf"}},APPEND_ATTRIBUTES:[{NAME:"typemustmatch",VALUE:"true"},{NAME:"type",VALUE:"application/pdf"}]},object:{NAME:"object",ATTRIBUTE_RULES:{type:{NAME:"type",EQUAL:"application/pdf",DEFAULT_VALUE:"application/pdf"}},APPEND_ATTRIBUTES:[{NAME:"typemustmatch",VALUE:"true"},{NAME:"type",VALUE:"application/pdf"}]}};var b=false;var c;var R=addToSet({},e.ALLOWED_STYLE_PROPS);function K(n){if(!n||n.constructor!==Object){return e}var m={};for(var o in e){if(e.hasOwnProperty(o)){if(o in n){if(o in A){if(o==="SANDBOX_SAFE_DOMAINS"&&n[o].constructor===Array){e[o]=e[o].concat(n[o])}if(n[o]==true||n[o]==false){m[o]=n[o]}else{m[o]=e[o]}}}else{m[o]=e[o]}}}if(m.SAFE_FOR_TEMPLATES){m.ALLOW_DATA_ATTR=false}if(m.RETURN_DOM_FRAGMENT){m.RETURN_DOM=true}if(m.KEEP_CONTENT){m.ALLOWED_TAGS_OBJ["#text"]=true}return m}function l(m){for(var n in m){if(m.hasOwnProperty(n)&&m[n].constructor==String){if(m[n]&&R[n]){b=true}else{if(m[n]){if(n!="cssText"&&!/^\d.*/.test(n)){m[n]="";c=true}}}}}}function J(o){for(var m=o.length-1;m>=0;m--){var n=o[m];if((n.type==1&&n.selectorText)||(n.type==8&&n.keyText)){if(n.style){l(n.style)}}else{if((n.type==4||n.type==7)&&n.cssRules){J(n.cssRules)}}}}function E(m,o){for(var n=o.length-1;n>=0;n--){if(o[n].type==1||o[n].type==4||o[n].type==7){m.push(o[n].cssText)}}}function h(AA,n,s){var s=s==undefined?AA.IS_MANDATORY:s;if(AA.NAME&&!n.hasAttribute(AA.NAME.toLowerCase())){return AA.IS_FORBIDDEN||!s}if(AA.IS_FORBIDDEN){return false}if(n.tagName.toLowerCase()==="iframe"&&(AA.SKIP_ON_SAME_DOMAIN===true||AA.SKIP_ON_SAME_DOMAIN===false||e.SANDBOX_SAFE_DOMAINS.length>0)){var o,q;var y=document.createElement("a");y.href=n.getAttribute("src");o=y.cloneNode(false);if(e.SANDBOX_SAFE_DOMAINS.length>0){var p;for(p=0;p<e.SANDBOX_SAFE_DOMAINS.length;p++){var v=e.SANDBOX_SAFE_DOMAINS[p];if(v.constructor===RegExp&&o.host.search(v)!==-1){return false}else{if(v.constructor===String&&o.host===v){return false}}}}var z=document.createElement("a");z.href=window.location.href;q=z.cloneNode(false);if(q.protocol==o.protocol&&q.host==o.host&&q.port==o.port){return AA.SKIP_ON_SAME_DOMAIN}return !AA.SKIP_ON_SAME_DOMAIN}var AB=n.getAttribute(AA.NAME.toLowerCase());if(AB===undefined||AB===null){AB=""}if(AB.constructor==String){if(!AA.DONT_TRIM){AB=AB.trim()}var w=AA.CASE_SENSITIVE||false;if(!w){AB=AB.toLowerCase()}if(AA.MAX_LENGTH&&AB.length>AA.MAX_LENGTH){return false}if(AA.MIN_LENGTH&&AB.length<AA.MIN_LENGTH){return false}if(AA.REGEX!=undefined){if(AA.REGEX.constructor==RegExp&&AB.search(AA.REGEX)==-1){return false}else{if(AA.REGEX.constructor==Array){for(var p=0;p<AA.REGEX.length;p++){if(AB.search(AA.REGEX[p])==-1){return false}}}}}}if(AA.LIST&&AA.LIST.indexOf(AB)==-1){return false}if(AA.TYPE=="INTEGER"||AA.TYPE=="FLOAT"){var m;try{m=AA.TYPE=="INTEGER"?window.parseInt(AB,10):window.parseFloat(AB)}catch(u){return false}if(window.isNaN(m)){return false}if((AA.GREATER_THAN!=undefined)&&m<=AA.GREATER_THAN){return false}if((AA.GREATER_THAN_OR_EQUAL!=undefined)&&m<AA.GREATER_THAN_OR_EQUAL){return false}if((AA.LESSER_THAN!=undefined)&&m>=AA.LESSER_THAN){return false}if((AA.LESSER_THAN_OR_EQUAL!=undefined)&&m>AA.LESSER_THAN_OR_EQUAL){return false}if((AA.EQUAL!=undefined)&&m!=AA.EQUAL){return false}if((AA.NOT_EQUAL!=undefined)&&m==AA.NOT_EQUAL){return false}}else{if(AB.constructor==String){if(AA.STARTS_WITH!=undefined&&AB.indexOf(AA.STARTS_WITH)!=0){return false}if(AA.ENDS_WITH!=undefined&&AB.lastIndexOf(AA.ENDS_WITH)!=(AB.length-AA.ENDS_WITH.length)){return false}if(AA.CONTAINS!=undefined){if(AA.CONTAINS.constructor==String&&AB.indexOf(AA.CONTAINS)==-1){return false}else{if(AA.CONTAINS.constructor==Array){for(var p=0;p<AA.CONTAINS.length;p++){if(AB.indexOf(AA.CONTAINS[p])==-1){return false}}}}}if(AA.NOT_CONTAINS!=undefined){if(AA.NOT_CONTAINS.constructor==String&&AB.indexOf(AA.NOT_CONTAINS)>-1){return false}else{if(AA.NOT_CONTAINS.constructor==Array){for(var p=0;p<AA.NOT_CONTAINS.length;p++){if(AB.indexOf(AA.NOT_CONTAINS[p])>-1){return false}}}}}if(AA.EQUAL!=undefined&&AB!==AA.EQUAL){return false}if(AA.NOT_EQUAL!=undefined&&AB===AA.NOT_EQUAL){return false}}}return true}function O(m){if(!m){return m}if(m.constructor==Object){for(var n in m){if(m.hasOwnProperty(n)){m[n]=H(m[n])}}}return m}function d(n){if(!n){return n}if(n.constructor==Array){for(var o=0;o<n.length;o++){if(n[o].CRITERIA){for(var m=0;m<n[o].CRITERIA.length;m++){n[o].CRITERIA[m]=H(n[o].CRITERIA[m])}}}}return n}function H(q){if(q){var n=["STARTS_WITH","ENDS_WITH","CONTAINS","EQUAL","NOT_EQUAL","LIST"];var m=q.CASE_SENSITIVE||false;if(!m){for(var p=0;p<n.length;p++){var o=n[p];if(q[o]){q[o]=N(q[o])}}}}return q}function N(n){if(n&&n.constructor==String){return n.toLowerCase()}else{if(n.constructor==Array){for(var m=0;m<n.length;m++){n[m]=N(n[m])}}}return n}function M(q,o){if(!q||q.constructor==Object){return q}var n={};for(var m=0;m<q.length;m++){var p=q[m];n[p[o]]=p}return n}function I(o,s){if(!o){return }for(var q=0;q<o.length;q++){var p=o[q];if(!s.hasAttribute(p.NAME.toLowerCase())){var m=true;if(p.CRITERIA){for(var n=0;n<p.CRITERIA.length;n++){if(!h(p.CRITERIA[n],s,true)){m=false;break}}}if(m){s.setAttribute(p.NAME,p.VALUE)}else{if(p.DEFAULT_VALUE!=undefined){s.setAttribute(p.NAME,p.DEFAULT_VALUE)}}}}}function P(o,m){if(!m||m.constructor!==Object){return o}if(!o||o.constructor!==Object){return m}for(var n in m){if(m.hasOwnProperty(n)&&n in o){if(o[n].APPEND_ATTRIBUTES==undefined){o[n].APPEND_ATTRIBUTES=m[n].APPEND_ATTRIBUTES}if(o[n].ATTRIBUTE_RULES==undefined){o[n].ATTRIBUTE_RULES=m[n].ATTRIBUTE_RULES}}else{o[n]=m[n]}}return o}function D(p,q,m){if(q&&!h(q,p)){var s=/\$\{[A-Z._]+?\}/;var n=/^(?:\w+script|data):/i;var v=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g;if(q.DEFAULT_VALUE!==undefined){var o=s.exec(q.DEFAULT_VALUE);var w=q.DEFAULT_VALUE;if(o){var u=p.getAttribute(m);switch(o[0]){case"${ZSEC.URL_COMPONENT}":u=window.encodeURIComponent(u);break}w=q.DEFAULT_VALUE.replace(o[0],u)}if(!n.test(w.replace(v,""))){p.setAttribute(m,w)}else{p.removeAttribute(m)}}else{p.removeAttribute(m)}return false}return true}function C(){e.FORBID_TAGS_OBJ=addObjsToSet(e.FORBID_TAGS_OBJ,S);e.FORBID_ATTR_OBJ=addObjsToSet(e.FORBID_ATTR_OBJ,U);for(var m in W){if(W.hasOwnProperty(m)){e[m+"_OBJ"]=addToSet(e[m+"_OBJ"],e[m])}}a.removeAllHooks();c=false;if(e.ALLOWED_STYLE=="NONE"){e.FORBID_TAGS_OBJ=addToSet(e.FORBID_TAGS_OBJ,["style"]);e.FORBID_ATTR_OBJ=addToSet(e.FORBID_ATTR_OBJ,["style"])}if(e.ALLOWED_STYLE=="INLINE"||e.ALLOWED_STYLE=="ALL"){if(e.STYLE_VALIDATION){a.addHook("afterSanitizeAttributes",function(o){if(!o.ownerDocument.baseURI){var p=document.createElement("base");p.href=document.baseURI;o.ownerDocument.head.appendChild(p)}if(o.hasAttribute("style")){var n="";c=false;l(o.style);if(c){n=o.style.cssText}else{n=o.getAttribute("style")}if(n.length){o.setAttribute("style",n)}else{o.removeAttribute("style")}}})}if(e.ALLOWED_STYLE=="INLINE"){e.FORBID_TAGS_OBJ=addToSet(e.FORBID_TAGS_OBJ,["style"]);e.FORBID_ATTR_OBJ=removeFromSet(e.FORBID_ATTR_OBJ,"style")}}if(e.ALLOWED_STYLE=="INTERNAL"||e.ALLOWED_STYLE=="ALL"){if(e.STYLE_VALIDATION){a.addHook("uponSanitizeElement",function(o,p){if(p.tagName==="style"){if(o.sheet!=null){var q=o.sheet.cssRules;c=false;J(q);if(c){var n=[];E(n,q);o.textContent=n.join("\n")}}}})}if(e.ALLOWED_STYLE=="INTERNAL"){e.FORBID_ATTR_OBJ=addToSet(e.FORBID_ATTR_OBJ,["style"]);e.FORBID_TAGS_OBJ=removeFromSet(e.FORBID_TAGS_OBJ,"style")}}if(e.ALLOWED_STYLE=="ALL"){e.FORBID_TAGS_OBJ=removeFromSet(e.FORBID_TAGS_OBJ,"style");e.FORBID_ATTR_OBJ=removeFromSet(e.FORBID_ATTR_OBJ,"style")}if(e.GLOBAL_ATTRIBUTE_RULES||e.TAG_RULES){a.addHook("afterSanitizeAttributes",function(s){var w=s.nodeName.toLowerCase();var u=e.GLOBAL_ATTRIBUTE_RULES;var q=e.TAG_RULES&&e.TAG_RULES[w]&&e.TAG_RULES[w].ATTRIBUTE_RULES;var n=F&&F[w]&&F[w].ATTRIBUTE_RULES;var o=s.attributes.length;while(o--){var p=s.attributes[o].name;var v=q&&q[p]||u&&u[p];if(D(s,v,p)){D(s,n&&n[p],p)}}})}if(e.GLOBAL_APPEND_ATTRIBUTES||e.TAG_RULES){a.addHook("afterSanitizeAttributes",function(o){var n=o.nodeName.toLowerCase();I(e.TAG_RULES&&e.TAG_RULES[n]&&e.TAG_RULES[n].APPEND_ATTRIBUTES,o);I(e.GLOBAL_APPEND_ATTRIBUTES,o);I(F&&F[n]&&F[n].APPEND_ATTRIBUTES,o)})}if(e.REMOVE_ONEVENTS){a.addHook("uponSanitizeAttribute",function(n,o){if(o.attrName.indexOf("on")==0){o.keepAttr=false}})}}function X(s){if(typeof s=="object"){s.ALLOWED_TAGS=s.GLOBAL_TAGS;s.ALLOWED_ATTR=s.GLOBAL_ATTRIBUTES;for(var z in L){if(L.hasOwnProperty(z)&&(s[z]==undefined)&&!(z in V)){s[z]=e[z]}}s.TAG_RULES=M(s.TAG_RULES,"NAME");if(s.TAG_RULES&&s.TAG_RULES.constructor==Object){for(var n in s.TAG_RULES){if(s.TAG_RULES.hasOwnProperty(n)){var AA=s.TAG_RULES[n];AA.APPEND_ATTRIBUTES=d(AA.APPEND_ATTRIBUTES);if(!AA.ATTRIBUTE_RULES){AA.ATTRIBUTE_RULES={}}else{O(M(AA.ATTRIBUTE_RULES,"NAME"));for(var w in AA.ATTRIBUTE_RULES){if(!AA.ATTRIBUTE_RULES.hasOwnProperty(w)){continue}if(s.GLOBAL_ATTRIBUTES&&s.GLOBAL_ATTRIBUTES.constructor==Array){s.GLOBAL_ATTRIBUTES.push(w)}else{s.GLOBAL_ATTRIBUTES=[];s.GLOBAL_ATTRIBUTES.push(w)}}}}}}s.GLOBAL_ATTRIBUTE_RULES=O(M(s.GLOBAL_ATTRIBUTE_RULES,"NAME"));s.GLOBAL_APPEND_ATTRIBUTES=d(s.GLOBAL_APPEND_ATTRIBUTES);if(s.EXTENDS){for(var q=0;q<s.EXTENDS.length;q++){var AB=s.EXTENDS[q];if(AB=="GLOBAL_TAGS"){AB="ALLOWED_TAGS"}if(AB=="GLOBAL_ATTRIBUTES"){AB="ALLOWED_ATTR"}switch(AB){case"ALLOWED_TAGS":case"ALLOWED_ATTR":case"FORBID_TAGS":case"FORBID_ATTR":AB+="_OBJ";s[AB]={};if(e[AB]){s[AB]=addObjsToSet(s[AB],e[AB])}break;case"ADD_URI_SAFE_ATTR":case"GLOBAL_APPEND_ATTRIBUTES":if(!s[AB]){s[AB]=[]}if(!e[AB]||e[AB].constructor!==Array){break}s[AB]=s[AB].concat(e[AB]);break;case"GLOBAL_ATTRIBUTE_RULES":if(!s.GLOBAL_ATTRIBUTE_RULES){s.GLOBAL_ATTRIBUTE_RULES={}}if(e.GLOBAL_ATTRIBUTE_RULES&&e.GLOBAL_ATTRIBUTE_RULES.constructor==Object){for(var p in e.GLOBAL_ATTRIBUTE_RULES){if(e.GLOBAL_ATTRIBUTE_RULES.hasOwnProperty(p)&&!s.GLOBAL_ATTRIBUTE_RULES[p]){s.GLOBAL_ATTRIBUTE_RULES[p]=e.GLOBAL_ATTRIBUTE_RULES[p]}}}break;case"TAG_RULES":if(!s.TAG_RULES){s.TAG_RULES={}}s.TAG_RULES=P(s.TAG_RULES,e.TAG_RULES);break}}}for(var m in W){if(W.hasOwnProperty(m)){if(!s[m+"_OBJ"]){s[m+"_OBJ"]={}}if(s[m]!=undefined){if(s[m].constructor===Array){s[m+"_OBJ"]=addToSet(s[m+"_OBJ"],s[m])}}else{s[m]=[]}}}for(var o=0;o<B.length;o++){var u=B[o];if(!s[u]){s[u]=[]}}if(s.ALLOWED_STYLE=="ALL"){s.FORBID_TAGS_OBJ=removeFromSet(s.FORBID_TAGS_OBJ,"style");s.FORBID_ATTR_OBJ=removeFromSet(s.FORBID_ATTR_OBJ,"style");s.ALLOWED_TAGS_OBJ=addToSet(s.ALLOWED_TAGS_OBJ,["style"]);s.ALLOWED_ATTR_OBJ=addToSet(s.ALLOWED_ATTR_OBJ,["style"])}else{if(s.ALLOWED_STYLE=="INLINE"){s.FORBID_ATTR_OBJ=removeFromSet(s.FORBID_ATTR_OBJ,"style");s.ALLOWED_ATTR_OBJ=addToSet(s.ALLOWED_ATTR_OBJ,["style"]);s.FORBID_TAGS_OBJ=addToSet(s.FORBID_TAGS_OBJ,["style"]);s.ALLOWED_TAGS_OBJ=removeFromSet(s.ALLOWED_TAGS_OBJ,"style")}else{if(s.ALLOWED_STYLE=="INTERNAL"){s.FORBID_TAGS_OBJ=removeFromSet(s.FORBID_TAGS_OBJ,"style");s.ALLOWED_TAGS_OBJ=addToSet(s.ALLOWED_TAGS_OBJ,["style"]);s.FORBID_ATTR_OBJ=addToSet(s.FORBID_ATTR_OBJ,["style"]);s.ALLOWED_ATTR_OBJ=removeFromSet(s.ALLOWED_ATTR_OBJ,"style")}else{if(s.ALLOWED_STYLE=="NONE"){s.FORBID_TAGS_OBJ=addToSet(s.FORBID_TAGS_OBJ,["style"]);s.FORBID_ATTR_OBJ=addToSet(s.FORBID_ATTR_OBJ,["style"]);s.ALLOWED_TAGS_OBJ=removeFromSet(s.ALLOWED_TAGS_OBJ,"style");s.ALLOWED_ATTR_OBJ=removeFromSet(s.ALLOWED_ATTR_OBJ,"style")}}}}for(var AC in W){if(W.hasOwnProperty(AC)){for(var y in s[AC+"_OBJ"]){if(s[AC+"_OBJ"].hasOwnProperty(y)){s[AC].push(y)}}s[AC+"_OBJ"]=addToSet(s[AC+"_OBJ"],s[AC])}}if(ZSEC.configValidator){ZSEC.configValidator.HTMLPurifierValidation(s,L,W,S,U)}}else{s={};for(var v in e){if(e.hasOwnProperty(v)){s[v]=e[v].valueOf()}}}return s}C();var Z=function(m){m=X(m);return factory(m,a(window))};var G=function(p,o){var n=K(o);var m=a.sanitize(p,n);Z.removed=a.removed;return m};Z.isSupported=a.isSupported;Z.removed="";ZSEC.util.defineProperty(Z,"sanitize",G,false,false,true);return Z}));"use strict";ZSEC.util.defineProperty(ZSEC,"configValidator",{},false,false,true);(function(A){function B(K,F,C,E,M){var G=addToSet({},["ALLOW_ARIA_ATTR","ALLOW_DATA_ATTR","ALLOW_UNKNOWN_PROTOCOLS","SAFE_FOR_JQUERY","SAFE_FOR_TEMPLATES","WHOLE_DOCUMENT","RETURN_DOM","RETURN_DOM_FRAGMENT","RETURN_DOM_IMPORT","FORCE_BODY","SANITIZE_DOM","KEEP_CONTENT","STYLE_VALIDATION","REMOVE_ONEVENTS"]);for(var O in K){if(!(O in F)){throw new Error("Invalid Flag in configuration! Value: "+O+". Must be one of the following: "+JSON.stringify(["ALLOW_ARIA_ATTR","ALLOW_DATA_ATTR","ALLOW_UNKNOWN_PROTOCOLS","SAFE_FOR_JQUERY","SAFE_FOR_TEMPLATES","WHOLE_DOCUMENT","RETURN_DOM","RETURN_DOM_FRAGMENT","RETURN_DOM_IMPORT","FORCE_BODY","SANITIZE_DOM","KEEP_CONTENT","STYLE_VALIDATION","ALLOWED_STYLE","ALLOWED_TAGS","ALLOWED_ATTR","FORBID_TAGS","FORBID_ATTR","ADD_URI_SAFE_ATTR","EXTENDS","GLOBAL_APPEND_ATTRIBUTES","GLOBAL_ATTRIBUTE_RULES","REMOVE_ONEVENTS"]))}}for(var N in G){if(!(K[N]===true||K[N]===false)){throw new Error("Invalid Value for '"+N+"' in the configuration. It needs to be either 'true' or 'false'")}}if(K.SAFE_FOR_TEMPLATES){if(K.ALLOW_DATA_ATTR){throw new Error("'ALLOW_DATA_ATTR' should not be set when 'SAFE_FOR_TEMPLATES' is true")}}if(K.ALLOWED_STYLE){K.ALLOWED_STYLE=K.ALLOWED_STYLE.toUpperCase();if(!(K.ALLOWED_STYLE=="ALL"||K.ALLOWED_STYLE=="INTERNAL"||K.ALLOWED_STYLE=="INLINE"||K.ALLOWED_STYLE=="NONE")){throw new Error("Invalid Value for 'ALLOWED_STYLE' in the configuration. It needs to be either 'ALL', 'INTERNAL', 'INLINE' or 'NONE'")}}if(K.ADD_URI_SAFE_ATTR){if(!(K.ADD_URI_SAFE_ATTR.constructor===Array)){throw new Error("Invalid Value for 'ADD_URI_SAFE_ATTR' in the configuration.It must be an Array")}}else{K.ADD_URI_SAFE_ATTR=[]}if(K.GLOBAL_APPEND_ATTRIBUTES){for(var L=0;L<K.GLOBAL_APPEND_ATTRIBUTES.length;L++){if(K.GLOBAL_APPEND_ATTRIBUTES[L].NAME!=undefined&&K.GLOBAL_APPEND_ATTRIBUTES[L].VALUE!=undefined){if(K.GLOBAL_APPEND_ATTRIBUTES[L].CRITERIA){for(var I=0;I<K.GLOBAL_APPEND_ATTRIBUTES[L].CRITERIA.length;I++){var H=K.GLOBAL_APPEND_ATTRIBUTES[L].CRITERIA[I];if(!H.NAME){throw new Error("Invalid value for MAX_LENGTH in GLOBAL_APPEND_ATTRIBUTES rules",K.GLOBAL_APPEND_ATTRIBUTES[L])}if(H.MAX_LENGTH&&H.MAX_LENGTH.constructor!==Number){throw new Error("Invalid value for MAX_LENGTH in GLOBAL_APPEND_ATTRIBUTES rules",K.GLOBAL_APPEND_ATTRIBUTES[L])}if(H.MIN_LENGTH&&H.MIN_LENGTH.constructor!==Number){throw new Error("Invalid value for MIN_LENGTH in GLOBAL_APPEND_ATTRIBUTES rules",K.GLOBAL_APPEND_ATTRIBUTES[L])}if(H.REGEX&&H.REGEX.constructor!==RegExp){throw new Error("Invalid value for REGEX in GLOBAL_APPEND_ATTRIBUTES rules",K.GLOBAL_APPEND_ATTRIBUTES[L])}if(H.LIST&&H.LIST.constructor!==Array){throw new Error("Invalid value for LIST in GLOBAL_APPEND_ATTRIBUTES rules",K.GLOBAL_APPEND_ATTRIBUTES[L])}}}}else{throw new Error("The Attribute Name and Attribute Value must be mentioned for GLOBAL_APPEND_ATTRIBUTES rules",K.GLOBAL_APPEND_ATTRIBUTES[L])}}}else{K.GLOBAL_APPEND_ATTRIBUTES=[]}if(K.GLOBAL_ATTRIBUTE_RULES){for(var J in K.GLOBAL_ATTRIBUTE_RULES){if(K.GLOBAL_ATTRIBUTE_RULES.hasOwnProperty(J)){var D=K.GLOBAL_ATTRIBUTE_RULES[J];if(!(D.NAME==undefined)){if(!(D.ACTION==undefined)){if(D.ACTION!="REMOVE_ATTRIBUTE"&&D.ACTION!="REMOVE_ATTRIBUTE_VALUE"&&D.ACTION!="REPLACE"){throw new Error("Invalid value for ACTION in GLOBAL_ATTRIBUTE_RULES rule. Must be one of 'REMOVE_ELEMENT', 'REMOVE_ATTRIBUTE', 'REMOVE_ATTRIBUTE_VALUE', or 'REPLACE'",D)}if(D.MAX_LENGTH&&D.MAX_LENGTH.constructor!==Number){throw new Error("Invalid value for MAX_LENGTH in GLOBAL_ATTRIBUTE_RULES rules",D)}if(D.MIN_LENGTH&&D.MIN_LENGTH.constructor!==Number){throw new Error("Invalid value for MIN_LENGTH in GLOBAL_ATTRIBUTE_RULES rules",D)}if(D.REGEX&&D.REGEX.constructor!==RegExp){throw new Error("Invalid value for REGEX in GLOBAL_ATTRIBUTE_RULES rules",D)}if(D.LIST&&D.LIST.constructor!==Array){throw new Error("Invalid value for LIST in GLOBAL_ATTRIBUTE_RULES rules",D)}}else{throw new Error("ACTION must be mentioned for GLOBAL_ATTRIBUTE_RULES rules",D)}}else{throw new Error("The Attribute Name must be mentioned for GLOBAL_ATTRIBUTE_RULES rules",D)}}}}else{K.GLOBAL_ATTRIBUTE_RULES={}}if(K.ALLOWED_STYLE=="ALL"){if(K.FORBID_TAGS.indexOf("style")>-1||K.FORBID_ATTR.indexOf("style")>-1){throw new Error("You have added style to the forbidden tag/attribute list but have specified to not remove it in the 'ALLOWED_STYLE' flag by setting it to 'ALL'")}}else{if(K.ALLOWED_STYLE=="INLINE"){if(K.FORBID_ATTR.indexOf("style")>-1){throw new Error("You have added style to the forbidden tag/attribute list but have specified to not remove it in the 'ALLOWED_STYLE' flag by setting it to 'INLINE'")}if(K.ALLOWED_TAGS.indexOf("style")>-1){throw new Error("You have added style to the allowed tag list but have specified to remove it in the 'ALLOWED_STYLE' flag by setting it to 'INLINE'")}}else{if(K.ALLOWED_STYLE=="INTERNAL"){if(K.FORBID_TAGS.indexOf("style")>-1){throw new Error("You have added style to the forbidden tag/attribute list but have specified to not remove it in the 'ALLOWED_STYLE' flag by setting it to 'INTERNAL'")}if(K.ALLOWED_ATTR.indexOf("style")>-1){throw new Error("You have added style to the allowed attribute list but have specified to remove it in the 'ALLOWED_STYLE' flag by setting it to 'INTERNAL'")}}else{if(K.ALLOWED_STYLE=="NONE"){if(K.ALLOWED_TAGS.indexOf("style")>-1||K.ALLOWED_ATTR.indexOf("style")>-1){throw new Error("You have added style to the allowed tag/attribute list but have specified to remove it in the 'ALLOWED_STYLE' flag by setting it to 'NONE'")}}}}}for(var L in K.ALLOWED_TAGS_OBJ){if(L.toLowerCase() in K.FORBID_TAGS_OBJ){if(L!="style"){throw new Error("Conflict in Allowed and Forbidden Tags! Tag '"+L+"' is given in FORBID_TAGS and ALLOWED_TAGS in configuration!")}}if(L.toLowerCase() in E){throw new Error("Tag '"+L+"' is forbidden by default. The following Tags are forbidden by default: 'script','iframe' ")}}for(var L in K.ALLOWED_ATTR_OBJ){if(L.toLowerCase() in K.FORBID_ATTR_OBJ){if(L!="style"){throw new Error("Conflict in Allowed and Forbidden Attributes! Attribute '"+L+"' is given in FORBID_ATTR and ALLOWED_ATTR in configuration!")}}if(L.toLowerCase() in M){throw new Error("Attribute '"+L+"' is forbidden by default. The following Attributes are forbidden by default: ")}}}ZSEC.util.defineProperty(A,"HTMLPurifierValidation",B,false,false,true)})(ZSEC.configValidator);(function(A){ZSEC.util.defineProperty(ZSEC,"secureRedirector",A(),true,false,false,true)}(function(){var F=navigator.userAgent.indexOf("MSIE")!==-1;var E=window.open;function A(L,J){if(typeof L.length==="undefined"){C(L);if(J){G(L,A)}}else{if(typeof L!=="string"&&!(L instanceof String)){for(var K=0;K<L.length;K++){C(L[K]);if(J){G(L,A)}}}}}function C(O){if(O.nodeType!=1){return }var J=O.nodeName;if(J=="A"||J=="a"||J=="MATH"||J=="math"){B(O,"click",I)}var L=O.childNodes;if(L&&L.length){var K=L.length;for(var M=0;M<K;M++){var N=L[M];if(N.nodeType==1){C(N)}}}}function G(K,N){var L=window.MutationObserver||window.WebKitMutationObserver,J=window.addEventListener;if(L){var M=new L(function(O,Q){for(var T=0;T<O.length;T++){var S=O[T].addedNodes.length;if(S){var P=O[T].addedNodes;for(var R=0;R<S;R++){N(P[R])}}}});M.observe(K,{childList:true,subtree:true})}else{if(J){K.addEventListener("DOMNodeInserted",function(O){N(O.target)},false)}}}A.open=function(L,J,K){var M;if(D(J)){return E.apply(window,arguments)}else{if(!F){return H(L,J,K)}else{M=E.apply(window,arguments);M.opener=null;return M}}};A.patch=function(){window.open=function(){return A.open.apply(this,arguments)}};function I(O){var N,M,L,K;O=O||window.event;N=O.currentTarget||O.srcElement;L=N.getAttribute("href");if(!L){L=N.getAttribute("xlink:href");if(!L){return }}K=(O.ctrlKey||O.shiftKey||O.metaKey);M=N.getAttribute("target");var J=N.getAttribute("xlink:show");if(!K&&(!M||D(M))&&!J){return }A.open(L);if(O.preventDefault){O.preventDefault()}else{O.returnValue=false}return false}function B(N,L,M){var J,K;if(N.addEventListener){return N.addEventListener(L,M,false)}J="on"+L;if(N.attachEvent){N.attachEvent(J,M)}else{if(N[J]){K=N[J];N[J]=function(){M();K()}}else{N[J]=M}}}function H(M,J,N){var O,P,L,Q,K;O=document.createElement("iframe");O.style.display="none";document.body.appendChild(O);P=O.contentDocument||O.contentWindow.document;Q='"'+ZSEC.Encoder.encodeForJavaScript(M)+'"';if(J){Q+=', "'+ZSEC.Encoder.encodeForJavaScript(J)+'"'}if(N){Q+=', "'+ZSEC.Encoder.encodeForJavaScript(N)+'"'}L=P.createElement("script");L.type="text/javascript";L.text="window.parent = null; window.top = null;window.frameElement = null; var child = window.open("+Q+");try{child.opener = null;}catch(e){}";P.body.appendChild(L);K=O.contentWindow.child;document.body.removeChild(O);return K}function D(J){return J==="_top"||J==="_self"||J==="_parent"}if(Object.freeze){Object.freeze(A)}return A}));"use strict";(function(){var A={};A.filterXML=function(G){var F="";for(var E=0,D=G.length;E<D;E++){var C=G.codePointAt(E);var B=G.charAt(E);if((C==9)||(C==10)||(C==13)||((C>=32)&&(C<=55295))||((C>=57344)&&(C<=65533))||((C>=65536)&&(C<=1114111))){F+=B}if(C>65535){E++}}return F};if(Object.freeze){Object.freeze(A)}ZSEC.util.defineProperty(ZSEC,"TextFilter",A,true,false,false,true)})();"use strict";(function(){var A={unsafeProtocolRegex:/^(?:\w+script|data)$/i,sanitizeAction:{ACTION_ENCODE:"ENCODE",ACTION_REMOVE:"REMOVE"}};var B={};(function(Z){var G,T=2147483647,N=36,P=1,R=26,K=38,O=700,Q=72,I=128,f="-",W=/^xn--/,F=/[^\x20-\x7E]/,C=/[\x2E\u3002\uFF0E\uFF61]/g,S={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},J=N-P,b=Math.floor,Y=String.fromCharCode,h;function a(l){throw new RangeError(S[l])}function d(o,m){var n=o.length;var l=[];while(n--){l[n]=m(o[n])}return l}function E(m,n){var p=m.split("@");var l="";if(p.length>1){l=p[0]+"@";m=p[1]}m=m.replace(C,"\x2E");var q=m.split(".");var o=d(q,n).join(".");return l+o}function M(o){var n=[],m=0,p=o.length,q,l;while(m<p){q=o.charCodeAt(m++);if(q>=55296&&q<=56319&&m<p){l=o.charCodeAt(m++);if((l&64512)==56320){n.push(((q&1023)<<10)+(l&1023)+65536)}else{n.push(q);m--}}else{n.push(q)}}return n}function c(l){return d(l,function(n){var m="";if(n>65535){n-=65536;m+=Y(n>>>10&1023|55296);n=56320|n&1023}m+=Y(n);return m}).join("")}function H(l){if(l-48<10){return l-22}if(l-65<26){return l-65}if(l-97<26){return l-97}return N}function X(m,l){return m+22+75*(m<26)-((l!=0)<<5)}function D(o,m,n){var l=0;o=n?b(o/O):o>>1;o+=b(o/m);for(;o>J*R>>1;l+=N){o=b(o/J)}return b(l+(J+1)*o/(o+K))}function V(AC){var o=[],s=AC.length,v,y=0,m=I,z=Q,q,u,AA,l,AD,p,AB,AF,AE;q=AC.lastIndexOf(f);if(q<0){q=0}for(u=0;u<q;++u){if(AC.charCodeAt(u)>=128){a("not-basic")}o.push(AC.charCodeAt(u))}for(AA=q>0?q+1:0;AA<s;){for(l=y,AD=1,p=N;;p+=N){if(AA>=s){a("invalid-input")}AB=H(AC.charCodeAt(AA++));if(AB>=N||AB>b((T-y)/AD)){a("overflow")}y+=AB*AD;AF=p<=z?P:(p>=z+R?R:p-z);if(AB<AF){break}AE=N-AF;if(AD>b(T/AE)){a("overflow")}AD*=AE}v=o.length+1;z=D(y-l,v,l==0);if(b(y/v)>T-m){a("overflow")}m+=b(y/v);y%=v;o.splice(y++,0,m)}return c(o)}function L(AD){var s,AF,AA,o,AB,z,u,l,y,AH,AE,p=[],w,v,AG,AC;AD=M(AD);w=AD.length;s=I;AF=0;AB=Q;for(z=0;z<w;++z){AE=AD[z];if(AE<128){p.push(Y(AE))}}AA=o=p.length;if(o){p.push(f)}while(AA<w){for(u=T,z=0;z<w;++z){AE=AD[z];if(AE>=s&&AE<u){u=AE}}v=AA+1;if(u-s>b((T-AF)/v)){a("overflow")}AF+=(u-s)*v;s=u;for(z=0;z<w;++z){AE=AD[z];if(AE<s&&++AF>T){a("overflow")}if(AE==s){for(l=AF,y=N;;y+=N){AH=y<=AB?P:(y>=AB+R?R:y-AB);if(l<AH){break}AC=l-AH;AG=N-AH;p.push(Y(X(AH+AC%AG,0)));l=b(AC/AG)}p.push(Y(X(l,0)));AB=D(AF,v,AA==o);AF=0;++AA}}++AF;++s}return p.join("")}function U(l){return E(l,function(m){return W.test(m)?V(m.slice(4).toLowerCase()):m})}function e(l){return E(l,function(m){return F.test(m)?"xn--"+L(m):m})}G={version:"1.4.1",ucs2:{decode:M,encode:c},decode:V,encode:L,toASCII:e,toUnicode:U};Z.punycode=G})(B);B.sanitize=function(O,D){if(!O){return""}D=D||{};D.ALLOWED_PROTOCOLS=D.ALLOWED_PROTOCOLS||["https","http"];D.RETURN_PUNYCODE=D.RETURN_PUNYCODE!=false;D.ACTION=D.ACTION||A.sanitizeAction.ACTION_ENCODE;D.RETURN_OBJECT=D.RETURN_OBJECT||false;D.RETURN_ORIGINAL=D.RETURN_ORIGINAL||false;var H;var P=document.createElement("a");P.href=O;H=P.cloneNode(false);var R=H.protocol.slice(0,-1);var I=H.host;var E=H.port;var S=H.pathname;var K=H.hash;var Q=H.href;var C=true;var G=true;if(!D.RETURN_PUNYCODE){I=B.punycode.toUnicode(I);Q=B.punycode.toUnicode(Q)}else{I=B.punycode.toASCII(I);Q=B.punycode.toASCII(Q)}if(D.ALLOWED_PROTOCOLS){G=false;if(D.ALLOWED_PROTOCOLS.constructor===Array&&D.ALLOWED_PROTOCOLS.length>0){for(var J=0;J<D.ALLOWED_PROTOCOLS.length&&G!=true;J++){var F=D.ALLOWED_PROTOCOLS[J];if(F.constructor===RegExp){if(F.test(R)){G=true}}else{if(F.constructor===String){if(F==R){G=true}}}}}}else{if(A.unsafeProtocolRegex.test(R)){G=false}}if(D.ALLOWED_DOMAINS){C=false;var N=B.punycode.toASCII(I);var L=B.punycode.toUnicode(I);if(D.ALLOWED_DOMAINS.constructor===Array&&D.ALLOWED_DOMAINS.length>0){for(var J=0;J<D.ALLOWED_DOMAINS.length&&C!=true;J++){var M=D.ALLOWED_DOMAINS[J];if(M.constructor===RegExp){if(M.test(N)||M.test(L)){C=true}}else{if(M.constructor===String){if(M==N||M==L){C=true}}}}}}if(C){if(G){if(D.RETURN_OBJECT){return{PROTOCOL:R,DOMAIN:I,PORT:E,PATH:S,HASH:K,RESOLVED_URL:Q,ORIGINAL_URL:O}}if(D.RETURN_ORIGINAL){return O}return Q}else{if(D.ACTION==A.sanitizeAction.ACTION_ENCODE){return Q.replace(/:/,"%3A")}}}return""};B.sanitize.config={ACTION:A.sanitizeAction.ACTION_ENCODE,ALLOWED_PROTOCOLS:["https","http"],RETURN_PUNYCODE:true,RETURN_OBJECT:false,RETURN_ORIGINAL:false};if(Object.freeze){B=Object.freeze(B)}ZSEC.util.defineProperty(ZSEC,"URLValidator",B,true,false,false,true)})();var HtmlPage_Config_Obj={TAG_RULES:[{NAME:"iframe",ATTRIBUTE_RULES:[{NAME:"frameborder",LIST:["0","1"]},{NAME:"sandbox",SKIP_ON_SAME_DOMAIN:true,NOT_CONTAINS:["allow-top-navigation","allow-popups-to-escape-sandbox"],DEFAULT_VALUE:"allow-popups allow-forms allow-scripts allow-same-origin allow-presentation allow-downloads"},{NAME:"allowtransparency",LIST:["true","false"]},{NAME:"allow",LIST:["microphone"]},{NAME:"allowFullScreen",REGEX:/^[a-zA-Z]+$/},{NAME:"scrolling",LIST:["yes","no","auto"],CASE_SENSITIVE:false}],APPEND_ATTRIBUTES:[{NAME:"sandbox",VALUE:"allow-popups allow-forms allow-scripts allow-same-origin allow-presentation allow-downloads",CRITERIA:[{SKIP_ON_SAME_DOMAIN:false}]}]},{NAME:"video",ATTRIBUTE_RULES:[{NAME:"controlsList",LIST:["nodownload"]}]},{NAME:"embed",ATTRIBUTE_RULES:[{NAME:"type",EQUAL:"application/pdf",DEFAULT_VALUE:"application/pdf"}],APPEND_ATTRIBUTES:[{NAME:"typemustmatch",VALUE:"true"},{NAME:"type",VALUE:"application/pdf"}]},{NAME:"dialog",ATTRIBUTE_RULES:[{NAME:"open",REGEX:/^$/,MAX_LENGTH:0}]},{NAME:"div",ATTRIBUTE_RULES:[{NAME:"elName",REGEX:/^[a-zA-Z\-]+$/},{NAME:"formLinkName",REGEX:/^[a-zA-Z0-9_]+$/},{NAME:"appLinkName",REGEX:/^[a-zA-Z0-9_]+$/},{NAME:"viewLinkName",REGEX:/^[a-zA-Z0-9_]+$/},{NAME:"reportLinkName",REGEX:/^[a-zA-Z0-9_]+$/},{NAME:"sharedby",REGEX:/^[A-Za-z0-9_.@]+$/},{NAME:"params",REGEX:/(([a-zA-Z0-9_]+)=([a-zA-Z0-9_-]+)&amp;)*([a-zA-Z0-9_]+)=([a-zA-Z0-9_-]+)/},{NAME:"zcpage-headerhtml",LIST:["true","false"]},{NAME:"zcpage-footerhtml",LIST:["true","false"]},{NAME:"zcpage-spacing",REGEX:/([0-9]+)(px)*/},{NAME:"zcpage-headerspacing-bottom",REGEX:/(([0-9]+)(px)*)/},{NAME:"zcpage-headerspacing-top",REGEX:/(([0-9]+)(px)*)/},{NAME:"zcpage-footerspacing-top",REGEX:/(([0-9]+)(px)*)/},{NAME:"zcpage-footerspacing-bottom",REGEX:/(([0-9]+)(px)*)/}]},{NAME:"meta",ATTRIBUTE_RULES:[{NAME:"http-equiv",LIST:["refresh"]},{NAME:"content",REGEX:/^[0-9]+$/}]}],GLOBAL_ATTRIBUTES:["accesskey","controlsList","allow","allowFullScreen","type","typemustmatch","http-equiv","content","reportLinkName","scrolling","allowTransparency","frameborder","elName","formLinkName","appLinkName","sharedby","viewLinkName","zcpage-headerhtml","params","zcpage-footerhtml","zcpage-spacing","zcpage-headerspacing-bottom","zcpage-headerspacing-top","accent-height","accumulate","additive","alignment-baseline","zcpage-footerspacing-top","zcpage-footerspacing-bottom","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mode","min","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","surfacescale","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","u1","u2","unicode","values","viewbox","visibility","vert-adv-y","vert-origin-x","vert-origin-y","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","y","y1","y2","z","zoomandpan","autoplay","muted","controls"],GLOBAL_ATTRIBUTE_RULES:[{NAME:"autoplay",MAX_LENGTH:0,ACTION:"REMOVE_ATTRIBUTE",REGEX:/^$/},{NAME:"muted",MAX_LENGTH:0,ACTION:"REMOVE_ATTRIBUTE",REGEX:/^$/},{NAME:"controls",MAX_LENGTH:0,ACTION:"REMOVE_ATTRIBUTE",REGEX:/^$/},{NAME:"accesskey",ACTION:"REMOVE_ATTRIBUTE",REGEX:/^[a-zA-Z0-9 ]+$/}],GLOBAL_TAGS:["video","embed","meta","link","iframe","dialog","div","svg","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","line","clippath","defs","desc","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","switch","symbol","text","textpath","title","tref","tspan","view","vkern","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","image"],FORCE_BODY:true,STYLE_VALIDATION:false,SANDBOX_SAFE_DOMAINS:ZCGlobal.zcPublicServer,ALLOWED_STYLE_PROPS:["alignment-baseline","baseline-shift","clip-path","clip-rule","color-interpolation","color-interpolation-filters","color-profile","color-rendering","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","image-rendering","kerning","lighting-color","marker-end","marker-mid","marker-start","mask","opacity","shape-rendering","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","transform","text-rendering","writing-mode","azimuth","background","background-attachment","background-color","background-image","background-position","content","background-repeat","border-collapse","border-color","border-top-color","border-right-color","border-bottom-color","border-left-color","bottom","caption-side","clear","color","cue-after","cue-before","direction","display","elevation","empty-cells","float","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","height","left","letter-spacing","line-height","list-style-image","list-style-position","list-style-type","marker-offset","max-height","max-width","min-height","min-width","orphans","outline-color","overflow","page-break-after","page-break-before","page-break-inside","pause-after","pause-before","pitch","pitch-range","position","richness","right","size","speak","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","table-layout","text-indent","text-transform","top","unicode-bidi","vertical-align","visibility","volume","white-space","widows","width","word-spacing","border-style","border-top-style","border-right-style","border-bottom-style","border-left-style","border-top-width","border-right-width","border-bottom-width","border-left-width","border-width","margin","margin-top","margin-right","margin-bottom","margin-left","outline-style","outline-width","padding","padding-top","padding-right","padding-bottom","padding-left","border","border-top","border-right","border-bottom","border-left","cue","list-style","marks","outline","pause","text-decoration","border-spacing","clip","counter-increment","clip","cursor","text-shadow","font","font-family","page","play-during","text-align","voice-family"],ALLOWED_STYLE:"ALL",EXTENDS:["TAG_RULES","GLOBAL_TAGS","GLOBAL_ATTRIBUTES","FORCE_BODY","ALLOWED_STYLE","STYLE_VALIDATION","ALLOWED_STYLE_PROPS","GLOBAL_APPEND_ATTRIBUTES","GLOBAL_ATTRIBUTE_RULES","SANDBOX_SAFE_DOMAINS"]};var pageSanitizer=new ZSEC.HTMLPurifier(HtmlPage_Config_Obj);var BOT_TYPE={PRESALES:1,UPGRADE:2,SALES:3,PREMIUM_CHAT:4};var ZCLiveChat=(function(){var N=ZCGlobal.zcChatEnabled;var K=ZCGlobal.zcUpgradeChatEnabled;var I=ZCGlobal.zcPreSalesEnabled;var C=ZCGlobal.zcPremiumChatEnabled;var A="https://salesiq.zoho.com";var E=this;var M=false;E._isWeekend=false;var F=ZCGlobal.scopeName;var L=ZCGlobal.loginEmail;var B=ZCGlobal.loginZuid;var H=typeof (ZCGlobal.superAdminEmailId)=="undefined"?"":ZCGlobal.superAdminEmailId;var S=typeof (ZCGlobal.dataCenter)=="undefined"?"":ZCGlobal.dataCenter;var R=typeof (ZCGlobal.webAnalyticsInfo)=="undefined"?{}:ZCGlobal.webAnalyticsInfo;var G=R.IsPushEnabled&&!P();var D=R.IsCreatorCRMContact;var J=ZCGlobal.scopeId;E.initialize=function(){if(typeof ($zoho)=="undefined"){offset=+5.5;userMachineDate=new Date();utc=userMachineDate.getTime()+(userMachineDate.getTimezoneOffset()*60000);day=new Date(utc+(3600000*offset));if(!(day.getDay()==0||(day.getDay()==1&&day.getHours()<6)||(day.getDay()==6&&day.getHours()>=5))){var T="";var Y=BOT_TYPE.PRESALES;if(K){Y=BOT_TYPE.UPGRADE;T="1d331265221823e9203b13e8cdc8c1910c1d10d58f6a9e3d8476f188b5267960bffd00e1b022f2c8baa7a32f9f27c042"}else{if(C){Y=BOT_TYPE.PREMIUM_CHAT;T="e1e5c08cafe7bee687ac7d617e1d9572c0cfd5420c66fd1976a301e430c35587adbec8ffd06612974f8029a7b40f29fa"}else{if(N){Y=BOT_TYPE.SALES;T="7aa0180e0bbf15740d80f4d8e4b6d669510498e127627d4bc7f43712975300c7"}else{if(!G&&I){Y=BOT_TYPE.PRESALES;T="6112bd7bf89d73174c9bafa6811fdf9547d91915a628fb9eac0945c13e83c460d4f6a61f1b7d8b3fdd11130a436a38a5"}}}}if(S=="CHINA"&&((!G&&I)||N)){T="39a299b6b8b19824aeb97e0b9fdf501541c460abf85ce9bc5c2668bd8ad74fea"}if(T!=""){var V='var $zoho=$zoho || {};$zoho.salesiq = $zoho.salesiq || {widgetcode:"'+T+'",values:{},ready:function(){ $zoho.salesiq.visitor.feedback(function(){ var data= {}; data.source="window.minimise"; data.botType = '+Y+'; data.widgetCode="'+T+'"; data.loginZuid="'+B+'"; data.maintainState = "true"; data.id="zc-salesiq-promotion"; AssistBotListener.listen(data);}); $zoho.salesiq.chat.missed(function(){var data= {}; data.source="chat.missed"; data.widgetcode="'+T+'"; data.id="zc-salesiq-missed"; AssistBotListener.listen(data);});$zoho.salesiq.visitor.name("'+F+'");$zoho.salesiq.visitor.email("'+L+'"); $zoho.salesiq.visitor.info({"Super Admin Email" : "'+H+'" , "Data Center" : "'+S+'" , "Login User Email1" : "'+L+'"}); $zoho.salesiq.floatbutton.visible("hide");$zohosq.chat.enableCrossDomain("true");$zoho.salesiq.floatwindow.minimize(function(){$("#zcChat").show();});}};var d=document;s=d.createElement("script");s.type="text/javascript";s.id="zsiqscript";s.defer=true;s.src="'+A+'/widget";t=d.getElementsByTagName("script")[0];t.parentNode.insertBefore(s,t);d.write("<div id=\'zsiqwidget\'></div>");';O();var a=document.createElement("script");a.innerHTML=V;var U=document.getElementsByTagName("script")[0];U.parentNode.insertBefore(a,U);if(ZCGlobal&&ZCGlobal.isC4){var X;var W=function(){return $($("#siqiframe")[0]).length&&$($("#siqiframe")[0].contentWindow.document.getElementById("window-ribbon")).length};if(W()){X&&clearInterval(X);Z()}else{X=setInterval(function(){if(W()){X&&clearInterval(X);Z()}},500)}var Z=function(){var b=$("#siqiframe")[0].contentWindow.document.getElementById("window-ribbon");if(!$(b).hasClass("c4-live-chat")){$(b).addClass("c4-live-chat")}}}}}else{E._isWeekend=true}if(G){var T="accbb8eb52d309d13817ff494a2007e012d6973fc15ea32000268559d614b849";var V='var $zoho=$zoho || {}; $zoho.salesiq = $zoho.salesiq || {widgetcode:"'+T+'", values:{},ready:function(){$zoho.salesiq.floatbutton.visible("hide");$zoho.salesiq.tracking.domain("zoho.com.cn");ZCLiveChat.pushAnalyticsData();}};var d=document;s=d.createElement("script");s.type="text/javascript";s.id="zsiqscript";s.defer=true;s.src="https://salesiq.zoho.com.cn/widget";t=d.getElementsByTagName("script")[0];t.parentNode.insertBefore(s,t)';var a=document.createElement("script");a.innerHTML=V;var U=document.getElementsByTagName("script")[0];U.parentNode.insertBefore(a,U);$("body").addClass("zc-hide-assist-bot")}}};E.showError=function(T){if(typeof (iAlert)!="undefined"){iAlert(T)}else{if(typeof (ZCApp)!="undefined"&&typeof (ZCApp.showErrorDialog)!="undefined"){ZCApp.showErrorDialog("",T)}else{if(typeof ($.alert)!="undefined"){if(E._isWeekend){$.alert({msg:i18n.chatsupportweekends})}else{$.alert({msg:i18n.chatsupportrestrictionmsg})}}}}};E.show=function(){if(E._isWeekend){E.showError(i18n["zc.support.chatsupport.weekends"])}else{if(typeof ($zoho)!="undefined"){$zoho.salesiq.floatwindow.visible("show")}}};E.hide=function(){if(E._isWeekend){E.showError(i18n["zc.support.chatsupport.weekends"])}else{if(typeof ($zoho)!="undefined"){$zoho.salesiq.floatwindow.visible("hide")}}};E.start=function(T){if(E._isWeekend){E.showError(i18n["zc.support.chatsupport.weekends"])}else{if(typeof ($zoho)!="undefined"){if(T){T.userName&&$zoho.salesiq.visitor.name(T.userName);T.emailId&&$zoho.salesiq.visitor.email(T.emailId);T.emailId&&$zoho.salesiq.visitor.info({"Login User Email2":T.emailId});T.question&&$zoho.salesiq.visitor.question(T.question)}$zoho.salesiq.chat.start();ZCLiveChat.show()}}};E.initialize();function O(){var T=ZCGlobal.loginEmail;if(T==""||T==null||T==undefined){url="/userhome/"+ZCGlobal.scopeName+"/chatEmailIdTracking";$.ajax({url:url,success:function(V,U,W){}})}}function P(){try{var T=ZCGlobal.loginZuid+"_WEBANALYTICS";return localStorage.getItem(T)=="true"?true:false}catch(U){return false}}function Q(){try{var T=ZCGlobal.loginZuid+"_WEBANALYTICS";localStorage.setItem(T,"true")}catch(U){}}E.pushAnalyticsData=function(){try{var V=D?"DIRECT_SIGN_UP":"EXISTING_SIGN_UP";var T={};if(J!="-100"){T.zsoid=J;V=D?"DIRECT_ORG_CREATION":"EXISTING_ORG_CREATION";Q()}T.op=V;T.e=L;T.sn="ZohoCreator";$zoho.salesiq.visitor.customaction(JSON.stringify(T))}catch(U){}};return{show:function(){return self.show()},hide:function(){return self.hide()},start:function(T){return self.start(T)},load:function(){$("#zcChat").hide();ZCLiveChat.show()},emailCheck:O,pushAnalyticsData:pushAnalyticsData}}());var AssistBotListener=new function(){var K=false;var Q="1001";var J="zc-salesiq-active";var P=function(R){return"zc_promo_"+R.botType+"_"+R.promoCode+"_"+R.loginZuid};var I=function(R){ZCWebStorage.setItem(P(R),"true")};var D=function(R){if(ZCWebStorage.getItem(P(R))=="true"){return true}return false};var A=function(S,R){var T={};T.promoCode=S.promoCode;T.botType=S.botType;T.isCancel=R;$.ajax({url:"/userhome/"+ZCGlobal.scopeName+"/assisBotPromo",data:T,error:function(){K=true}})};var N=function(R){$(R).removeClass(J)};var O=function(R){return $(R).attr("doTrack")=="true"?true:false};var L=function(R){ZCLiveChat.hide();$(R).addClass(J)};var E=function(R){return $(R).find("#zc-salesiq-overlay")};var C=function(R){return $(R).find("#zc-salesiq-close")};var G=function(R){return $(R).find("#zc-promo-link")};var H=function(R){return $(R).attr("id")=="zc-promo-link"?true:false};var F=function(R){return $(R).attr("link_url")};var M=function(R){return $(R).is(":visible")};var B=function(){return $("."+J)};this.listen=function(U){if(U.source=="window.minimise"||U.source=="chat.missed"){var R=$("#"+U.id);if(R.length==0){return }var T=U.maintainState=="true"?true:false;var W=typeof (R.attr("zc-promoCode"))=="undefined"?Q:R.attr("zc-promoCode");var X=U.botType;U.promoCode=W;if(T&&D(U)){return }L(R);var V=[];V.push(E(R));V.push(C(R));V.push(G(R));for(var S in V){$(V[S]).off("click").on("click",function(a){var Z=$(a.target);var b=H(Z);if(T){I(U)}N(R);if(O(Z)){A(U,!b)}if(b){var Y=F(Z);if(Y){window.open(Y)}}})}$(document).keyup(function(Y){if(Y.keyCode===27){var Z=B();if(Z.length>0){E(Z).click()}}})}}};