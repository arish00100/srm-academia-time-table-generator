function ZE(initobj){if(this.state="loading",this.mode="richtext",this.afterload=[],this.initobj=initobj||{},this.outerdiv=document.getElementById(initobj.id),this.editordiv=void 0,this.toolbardiv=void 0,this.toolbarobject=void 0,this.popupid="ze_popups",this.popupdiv=void 0,this.createToolbar(),this.createEditor(),ZE_Init.needEditorStats&&(this.clickCount={}),ZE_Init.needplaintext&&(this.createPlainText(),"plaintext"===initobj.mode)){var avoidFocus=ZE_Init.needEditorFocus?!1:!0;this.plainText(initobj.content,avoidFocus)}ZE_Init.isIE11=/Trident\/7.0;/.test(navigator.userAgent)&&/rv:11.0/i.test(navigator.userAgent),ZE.sentInitRequest()}ZE.create=function(initobj){if(ZE_Init.loading){var load=function(){ZE_Init.isRTL?ZE_Init.loadURL(ZE_Init.cssPath+"/css/"+ZE_Init.theme+"/ze1_rtl.min.css","css"):ZE_Init.loadURL(ZE_Init.cssPath+"/css/"+ZE_Init.theme+"/ze1.min.css","css"),ZE_Init.is_ie?ZE_Init.loadURL(ZE_Init.jsPath+"/js/ze_ie1.min.js","js"):ZE_Init.loadURL(ZE_Init.jsPath+"/js/ze1.min.js","js")};setTimeout(load,0),delete ZE_Init.loading}return new ZE(initobj)},ZE.prototype.afterEditorLoad=function(tempfunction){var editor=this;editor.state?editor.afterload.push(tempfunction):tempfunction()},ZE.prototype.setContent=function(html){var tempfunction,editor=this,_mode=editor.mode;if("undefined"!=typeof html)if(editor.state)tempfunction=function(html){return function(){editor.setContent(html)}}(html),editor.afterload.push(tempfunction);else if(_mode&&"plaintext"===_mode)editor._textarea.value=html;else{editor.doc.body.innerHTML=html,editor.win.focus();try{editor.updateToolbar()}catch(e){}}},ZE.setProcessedContent=function(html){var editor=this,_mode=editor.mode;html=_mode&&"plaintext"===_mode?html.replace(/\n/gi,"<br />"):html.replace(/<br.*?>/gi,"\n")},ZE.i18n=function(key){var lang=ZE_Init.language;return lang&&"en"!=lang?ZE.i18nObj[key]||key:key},ZE.prototype.getContent=function(){var _textarea,_textarea_value,_doc,editor=this,_mode=editor.mode,_spellcheck=editor.toolbarobject.spellcheck;if(_spellcheck&&"ze_selected"===_spellcheck.className&&editor.removeSpellcheckspans(),_mode&&"plaintext"===_mode){if(_textarea=editor._textarea,_textarea&&(_textarea_value=_textarea.value))return ZE_Init.setContentProcessed&&(_textarea_value=_textarea_value.replace(/\r+/gi,""),_textarea_value=_textarea_value.replace(/\n/gi,"<br />")),_textarea_value}else if(_doc=editor.doc)return _doc.body.innerHTML;return""},ZE.prototype.createPlainText=function(){var editor=this,_span=document.createElement("span"),I18N=ZE.i18n;editor.mode="richtext",editor.span=_span,_span.innerHTML="&laquo; "+I18N("Plain Text"),_span.className="ze_plain",_span.onclick=function(ev){if(ev=ev||window.event,editor._stopEvent(ev),confirm(I18N("Converting this to plain text will lose some formatting")+".\n\n"+I18N("Are you sure you want to continue")+"?")){var _spellcheck=editor.toolbarobject.spellcheck;_spellcheck&&"ze_selected"===_spellcheck.className&&editor.removeSpellcheckEvent(),editor.plainText(editor.getContent()),ZE_Init.modeChange&&ZE_Init.modeChange(editor.mode)}},editor.toolbardiv.appendChild(_span)},ZE.prototype.plainText=function(content,avoidFocus){for(var editor=this,uls=editor.toolbardiv.getElementsByTagName("ul"),_span=editor.span,I18N=ZE.i18n,_textarea=editor._textarea,i=uls.length-1;i>=0;i--)uls[i].style.display="none";var _spellcheck=editor.toolbarobject.spellcheck;_spellcheck&&(_spellcheck.parentNode.parentNode.parentNode.style.display=""),_span.innerHTML="&raquo; "+I18N("Rich Text"),_span.style.display="",_span.onclick=function(ev){ev=ev||window.event,editor._stopEvent(ev),editor.richText(editor._textarea.value),ZE_Init.modeChange&&ZE_Init.modeChange(editor.mode)},editor.mode="plaintext",_textarea||(_textarea=document.createElement("textarea"),_textarea.className="ze_area",editor._textarea=_textarea,editor.editordiv.appendChild(_textarea),_textarea.onbeforedeactivate=function(){var sel=document.selection;sel&&(editor.textrange=sel.createRange())}),content&&(_textarea.value=ZE.getText(content)),editor.iframe.style.display="none",_textarea.style.height=editor.iframe.style.height,_textarea.style.display="";try{avoidFocus||(_textarea.focus(),_textarea.setSelectionRange&&_textarea.setSelectionRange(0,0))}catch(e){}},ZE.prototype.richText=function(content){for(var editor=this,uls=editor.toolbardiv.getElementsByTagName("ul"),_span=editor.span,I18N=ZE.i18n,_textarea=editor._textarea,i=uls.length-1;i>=0;i--)uls[i].style.display="";_span.innerHTML="&laquo; "+I18N("Plain Text"),_span.onclick=function(ev){if(ev=ev||window.event,editor._stopEvent(ev),confirm(I18N("Converting this to plain text will lose some formatting")+".\n\n"+I18N("Are you sure you want to continue")+"?")){ev=ev||window.event,editor._stopEvent(ev);var _spellcheck=editor.toolbarobject.spellcheck;_spellcheck&&"ze_selected"===_spellcheck.className&&editor.removeSpellcheckEvent(),editor.plainText(editor.getContent()),ZE_Init.modeChange&&ZE_Init.modeChange(editor.mode)}},editor.mode="richtext",_textarea.style.display="none",content&&(editor.doc.body.innerHTML=ZE.getFormattedContent(content)),editor.iframe.style.height=_textarea.style.height,editor.iframe.style.display="",setTimeout(function(){editor.win.focus(),editor.updateToolbar()},0)},ZE.getFormattedContent=function(html){return html.replace(/\ /gi," ").replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/\n/gi,"<br>")},ZE.getText=function(html){if(html){var htmlToText=function(html){var divElem,i,aElem=[],regExArr=[],aTagList=[],styleElem=[];if(divElem=document.createElement("div"),divElem.innerHTML="",html=html.replace(/\n+/gi,""),html=html.replace(/\r+/gi,""),html=html.replace(/<!--.*?-->/gi,""),html=html.replace(/<head>.*?<\/head>/gi,""),html=html.replace(/<br.*?>/gi,"\n"),html=html.replace(/<hr.*?>/gi,"\n"),html=html.replace(/<\/p>/gi,"\n"),html=html.replace(/<\/div>/gi,"\n"),html=html.replace(/<\/h[1-6]>/gi,"\n"),html=html.replace(/<\/tr>/gi,"\n"),html=html.replace(/<\/li>/gi,"\n"),html=html.replace(/<\/td>/gi," "),html=html.replace(/<\/th>/gi," "),styleElem=html.match(/<style.*?<\/style>/g))for(i=0;i<styleElem.length;i++)html=html.replace(new RegExp(styleElem[i]),"");if(aElem=html.match(/<a data-hugatt="hugatt".*?<\/a>/g),aElem||(aElem=html.match(/<a data-hugatt='hugatt'.*?<\/a>/g)),aElem){for(i=0;i<aElem.length;i++)divElem.innerHTML+=aElem[i],regExArr.push(new RegExp(aElem[i]));for(aTagList=divElem.getElementsByTagName("a"),i=0;i<aElem.length;i++)html=html.replace(regExArr[i],aTagList[i].getAttribute("href"))}return html=html.replace(/<.*?>/gi,""),html=html.replace(/&nbsp;/gi," "),html=html.replace(/&lt;/gi,"<"),html=html.replace(/&gt;/gi,">"),html=html.replace(/&amp;/gi,"&")},isBlockQuote=html.search(/<blockquote/gi);if(-1!=isBlockQuote){var firstIndex=html.search(/<blockquote/gi),lastIndex=html.toLowerCase().lastIndexOf("</blockquote>"),blockquotehtml=html.substring(firstIndex,lastIndex+13);return html=html.replace(blockquotehtml,"##===###===##"),blockquotehtml=htmlToText(blockquotehtml),blockquotehtml=blockquotehtml.replace(/\n/gi,"\n > "),blockquotehtml=" > "+blockquotehtml,html=htmlToText(html),-1!=html.search(/##===###===##/gi)&&(html=html.replace("##===###===##",blockquotehtml)),html}return htmlToText(html)}return""},ZE.prototype.setMode=function(mode){var editor=this,_mode=editor.mode;"plaintext"===mode?_mode!==mode&&editor.plainText(""):"richtext"!==_mode&&editor.richText("")},ZE.prototype.focusAtStart=function(){var editor=this,win=editor.win,doc=editor.doc,selection=win.getSelection()||doc.selection;selection.collapse(doc.body,0),setTimeout(function(){win.focus()},300)},ZE.getContextValue=function(){return ZE_Init.contextVal?"/"+ZE_Init.contextVal:""},ZE.getCSRFParamName=function(){return ZE_Init.csrfParamVal||"zereqid"},ZE.getCSRFCookie=function(editor){"use strict";if(ZE_Init.csrfCookieVal&&ZE_Init.csrfParamVal)return ZE_Init.csrfCookieVal;var name=ZE_Init.csrfCookieName||"ZE_CSRF_TOKEN";name=new RegExp("^"+name+"=");for(var ckarr=editor.doc.cookie.split(";"),i=0;i<ckarr.length;i++){var ck=ckarr[i].trim();if(name.test(ck))return ck.replace(name,"")}return null},ZE.sentInitRequest=function(resend){var req_img_iframe=document.getElementById("ze_img_request"),contextValue=ZE.getContextValue();req_img_iframe?"true"==resend&&(req_img_iframe.src=contextValue+"/ze/blank?t="+(new Date).getTime()):(document.getElementById("ze_popups").innerHTML+="<iframe name='ze_img_request' id='ze_img_request' style='width:0px;height:0px;border:0px;' ></iframe>",req_img_iframe=document.getElementById("ze_img_request"),req_img_iframe.src=contextValue+"/ze/blank?t="+(new Date).getTime())},ZE.extend=function(srcObj,targetObj){var key;for(key in targetObj)targetObj.hasOwnProperty(key)&&(srcObj[key]=targetObj[key]);return srcObj},ZE.getHookMethod=function(originator,fn){"use strict";return"function"==typeof fn?function(currentNode,data,config){config.originator&&config.originator===originator&&fn(currentNode,data)}:void 0},ZE.addHook=function(hookName,fn){"use strict";"function"==typeof fn&&DOMPurify.addHook(hookName,fn)},ZE.removeHook=function(hookName,fn){"use strict";"function"==typeof fn&&DOMPurify.removeHook(hookName,fn)};!function(factory){"use strict";var root="undefined"==typeof window?null:window;root.DOMPurify=factory(root)}(function factory(window){"use strict";var DOMPurify=function(window){return factory(window)};if(DOMPurify.version="0.7.4",!window||!window.document||9!==window.document.nodeType)return DOMPurify.isSupported=!1,DOMPurify;var document=window.document,originalDocument=document,DocumentFragment=window.DocumentFragment,HTMLTemplateElement=window.HTMLTemplateElement,NodeFilter=window.NodeFilter,NamedNodeMap=window.NamedNodeMap||window.MozNamedAttrMap,Text=window.Text,Comment=window.Comment,DOMParser=window.DOMParser;"function"==typeof HTMLTemplateElement&&(document=document.createElement("template").content.ownerDocument);var implementation=document.implementation,createNodeIterator=document.createNodeIterator,getElementsByTagName=document.getElementsByTagName,createDocumentFragment=document.createDocumentFragment,importNode=originalDocument.importNode,hooks={};DOMPurify.isSupported="undefined"!=typeof implementation.createHTMLDocument&&9!==document.documentMode;var _addToSet=function(set,array){for(var l=array.length;l--;)set[array[l]]=!0;return set},_cloneObj=function(object){var property,newObject={};for(property in object)object.hasOwnProperty(property)&&(newObject[property]=object[property]);return newObject},ALLOWED_TAGS=null,DEFAULT_ALLOWED_TAGS=_addToSet({},["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr","svg","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","switch","symbol","text","textpath","title","tref","tspan","view","vkern","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmuliscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mpspace","msqrt","mystyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","#text"]),ALLOWED_ATTR=null,DEFAULT_ALLOWED_ATTR=_addToSet({},["accept","action","align","alt","autocomplete","background","bgcolor","border","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","coords","datetime","default","dir","disabled","download","enctype","face","for","headers","height","hidden","high","href","hreflang","id","ismap","label","lang","list","loop","low","max","maxlength","media","method","min","multiple","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","rows","rowspan","spellcheck","scope","selected","shape","size","span","srclang","start","src","step","style","summary","tabindex","title","type","usemap","valign","value","width","xmlns","accent-height","accumulate","additivive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mode","min","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","surfacescale","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","u1","u2","unicode","values","viewbox","visibility","vert-adv-y","vert-origin-x","vert-origin-y","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","y","y1","y2","z","zoomandpan","accent","accentunder","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","display","displaystyle","fence","frame","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),FORBID_TAGS=null,FORBID_ATTR=null,ALLOW_DATA_ATTR=!0,SAFE_FOR_JQUERY=!1,SAFE_FOR_TEMPLATES=!1,MUSTACHE_EXPR=/\{\{[\s\S]*|[\s\S]*\}\}/gm,ERB_EXPR=/<%[\s\S]*|[\s\S]*%>/gm,WHOLE_DOCUMENT=!1,RETURN_DOM=!1,RETURN_DOM_FRAGMENT=!1,RETURN_DOM_IMPORT=!1,SANITIZE_DOM=!0,KEEP_CONTENT=!0,FORBID_CONTENTS=_addToSet({},["audio","head","math","script","style","svg","video"]),DATA_URI_TAGS=_addToSet({},["audio","video","img","source"]),URI_SAFE_ATTRIBUTES=_addToSet({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),CONFIG=null,formElement=document.createElement("form"),_parseConfig=function(cfg){"object"!=typeof cfg&&(cfg={}),ALLOWED_TAGS="ALLOWED_TAGS"in cfg?_addToSet({},cfg.ALLOWED_TAGS):DEFAULT_ALLOWED_TAGS,ALLOWED_ATTR="ALLOWED_ATTR"in cfg?_addToSet({},cfg.ALLOWED_ATTR):DEFAULT_ALLOWED_ATTR,FORBID_TAGS="FORBID_TAGS"in cfg?_addToSet({},cfg.FORBID_TAGS):{},FORBID_ATTR="FORBID_ATTR"in cfg?_addToSet({},cfg.FORBID_ATTR):{},ALLOW_DATA_ATTR=cfg.ALLOW_DATA_ATTR!==!1,SAFE_FOR_JQUERY=cfg.SAFE_FOR_JQUERY||!1,SAFE_FOR_TEMPLATES=cfg.SAFE_FOR_TEMPLATES||!1,WHOLE_DOCUMENT=cfg.WHOLE_DOCUMENT||!1,RETURN_DOM=cfg.RETURN_DOM||!1,RETURN_DOM_FRAGMENT=cfg.RETURN_DOM_FRAGMENT||!1,RETURN_DOM_IMPORT=cfg.RETURN_DOM_IMPORT||!1,SANITIZE_DOM=cfg.SANITIZE_DOM!==!1,KEEP_CONTENT=cfg.KEEP_CONTENT!==!1,SAFE_FOR_TEMPLATES&&(ALLOW_DATA_ATTR=!1),RETURN_DOM_FRAGMENT&&(RETURN_DOM=!0),cfg.ADD_TAGS&&(ALLOWED_TAGS===DEFAULT_ALLOWED_TAGS&&(ALLOWED_TAGS=_cloneObj(ALLOWED_TAGS)),_addToSet(ALLOWED_TAGS,cfg.ADD_TAGS)),cfg.ADD_ATTR&&(ALLOWED_ATTR===DEFAULT_ALLOWED_ATTR&&(ALLOWED_ATTR=_cloneObj(ALLOWED_ATTR)),_addToSet(ALLOWED_ATTR,cfg.ADD_ATTR)),KEEP_CONTENT&&(ALLOWED_TAGS["#text"]=!0),Object&&"freeze"in Object&&Object.freeze(cfg),CONFIG=cfg},_forceRemove=function(node){try{node.parentNode.removeChild(node)}catch(e){node.outerHTML=""}},_initDocument=function(dirty){var doc,body;try{doc=(new DOMParser).parseFromString(dirty,"text/html");var _head=doc.getElementsByTagName("head")[0];_head.childNodes.length>0&&doc.getElementsByTagName("body")[0].appendChild(_head.childNodes[0]);var i,imgTags=doc.body.getElementsByTagName("img");for(i=0;i<imgTags.length;i++){var src=imgTags[i].src,Index=src.lastIndexOf("."),length=src.length,filetype=src.slice(Index+1,length);if("svg"===filetype.toLowerCase()){var svgImg=doc.body.getElementsByTagName("img")[i];svgImg.parentNode.removeChild(svgImg)}}}catch(e){}return doc||(doc=implementation.createHTMLDocument(""),body=doc.body,body.parentNode.removeChild(body.parentNode.firstElementChild),body.outerHTML=dirty),"function"==typeof doc.getElementsByTagName?doc.getElementsByTagName(WHOLE_DOCUMENT?"html":"body")[0]:getElementsByTagName.call(doc,WHOLE_DOCUMENT?"html":"body")[0]},_createIterator=function(root){return createNodeIterator.call(root.ownerDocument||root,root,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT,function(){return NodeFilter.FILTER_ACCEPT},!1)},_isClobbered=function(elm){return elm instanceof Text||elm instanceof Comment?!1:"string"==typeof elm.nodeName&&"string"==typeof elm.textContent&&"function"==typeof elm.removeChild&&elm.attributes instanceof NamedNodeMap&&"function"==typeof elm.removeAttribute&&"function"==typeof elm.setAttribute?!1:!0},_sanitizeElements=function(currentNode){var tagName,content;if(_executeHook("beforeSanitizeElements",currentNode,null),_isClobbered(currentNode))return _forceRemove(currentNode),!0;if(tagName=currentNode.nodeName.toLowerCase(),_executeHook("uponSanitizeElement",currentNode,{tagName:tagName}),!ALLOWED_TAGS[tagName]||FORBID_TAGS[tagName]){if(KEEP_CONTENT&&!FORBID_CONTENTS[tagName]&&"function"==typeof currentNode.insertAdjacentHTML)try{currentNode.insertAdjacentHTML("AfterEnd",currentNode.innerHTML)}catch(e){}return _forceRemove(currentNode),!0}return!SAFE_FOR_JQUERY||currentNode.firstElementChild||currentNode.content&&currentNode.content.firstElementChild||(currentNode.innerHTML=currentNode.textContent.replace(/</g,"&lt;")),SAFE_FOR_TEMPLATES&&3===currentNode.nodeType&&(content=currentNode.textContent,content=content.replace(MUSTACHE_EXPR," "),content=content.replace(ERB_EXPR," "),currentNode.textContent=content),_executeHook("afterSanitizeElements",currentNode,null),!1},DATA_ATTR=/^data-[\w.\u00B7-\uFFFF-]/,IS_ALLOWED_URI=/^(?:(?:(?:f|ht)tps?|mailto|tel):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,ATTR_WHITESPACE=/[\x00-\x20\xA0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,_sanitizeAttributes=function(currentNode){var attr,name,value,lcName,idAttr,attributes,hookEvent,l;if(_executeHook("beforeSanitizeAttributes",currentNode,null),attributes=currentNode.attributes){for(hookEvent={attrName:"",attrValue:"",keepAttr:!0},l=attributes.length;l--;)if(attr=attributes[l],name=attr.name,value=attr.value,lcName=name.toLowerCase(),hookEvent.attrName=lcName,hookEvent.attrValue=value,hookEvent.keepAttr=!0,_executeHook("uponSanitizeAttribute",currentNode,hookEvent),value=hookEvent.attrValue,"name"===lcName&&"IMG"===currentNode.nodeName&&attributes.id?(idAttr=attributes.id,attributes=Array.prototype.slice.apply(attributes),currentNode.removeAttribute("id"),currentNode.removeAttribute(name),attributes.indexOf(idAttr)>l&&currentNode.setAttribute("id",idAttr.value)):("id"===name&&currentNode.setAttribute(name,""),currentNode.removeAttribute(name)),hookEvent.keepAttr&&(!SANITIZE_DOM||"id"!==lcName&&"name"!==lcName||!(value in window||value in document||value in formElement))&&(SAFE_FOR_TEMPLATES&&(value=value.replace(MUSTACHE_EXPR," "),value=value.replace(ERB_EXPR," ")),ALLOWED_ATTR[lcName]&&!FORBID_ATTR[lcName]&&(URI_SAFE_ATTRIBUTES[lcName]||IS_ALLOWED_URI.test(value.replace(ATTR_WHITESPACE,""))||"src"===lcName&&0===value.indexOf("data:")&&DATA_URI_TAGS[currentNode.nodeName.toLowerCase()])||ALLOW_DATA_ATTR&&DATA_ATTR.test(lcName)))try{currentNode.setAttribute(name,value)}catch(e){}_executeHook("afterSanitizeAttributes",currentNode,null)}},_sanitizeShadowDOM=function(fragment){var shadowNode,shadowIterator=_createIterator(fragment);for(_executeHook("beforeSanitizeShadowDOM",fragment,null);shadowNode=shadowIterator.nextNode();)_executeHook("uponSanitizeShadowNode",shadowNode,null),_sanitizeElements(shadowNode)||(shadowNode.content instanceof DocumentFragment&&_sanitizeShadowDOM(shadowNode.content),_sanitizeAttributes(shadowNode));_executeHook("afterSanitizeShadowDOM",fragment,null)},_executeHook=function(entryPoint,currentNode,data){hooks[entryPoint]&&hooks[entryPoint].forEach(function(hook){hook.call(DOMPurify,currentNode,data,CONFIG)})};return DOMPurify.sanitize=function(dirty,cfg){var body,currentNode,oldNode,nodeIterator,returnNode;if(dirty||(dirty=""),"string"!=typeof dirty){if("function"!=typeof dirty.toString)throw new TypeError("toString is not a function");dirty=dirty.toString()}if(!DOMPurify.isSupported)return"object"==typeof window.toStaticHTML||"function"==typeof window.toStaticHTML?window.toStaticHTML(dirty):dirty;if(_parseConfig(cfg),!RETURN_DOM&&!WHOLE_DOCUMENT&&-1===dirty.indexOf("<"))return dirty;if(body=_initDocument(dirty),!body)return RETURN_DOM?null:"";for(nodeIterator=_createIterator(body);currentNode=nodeIterator.nextNode();)(3!==currentNode.nodeType||currentNode!==oldNode)&&(_sanitizeElements(currentNode)||(currentNode.content instanceof DocumentFragment&&_sanitizeShadowDOM(currentNode.content),_sanitizeAttributes(currentNode),oldNode=currentNode));if(RETURN_DOM){if(RETURN_DOM_FRAGMENT)for(returnNode=createDocumentFragment.call(body.ownerDocument);body.firstChild;)returnNode.appendChild(body.firstChild);else returnNode=body;return RETURN_DOM_IMPORT&&(returnNode=importNode.call(originalDocument,returnNode,!0)),returnNode}return WHOLE_DOCUMENT?body.outerHTML:body.innerHTML},DOMPurify.addHook=function(entryPoint,hookFunction){"function"==typeof hookFunction&&(hooks[entryPoint]=hooks[entryPoint]||[],hooks[entryPoint].push(hookFunction))},DOMPurify.removeHook=function(entryPoint){hooks[entryPoint]&&hooks[entryPoint].pop()},DOMPurify.removeHooks=function(entryPoint){hooks[entryPoint]&&(hooks[entryPoint]=[])},DOMPurify.removeAllHooks=function(){hooks=[]},DOMPurify});ZE.prototype.updateToolbar=function(){var j,color,editor=this,toolbarobject=editor.toolbarobject,doc=editor.doc;for(j in toolbarobject)switch(j){case"bold":case"italic":case"underline":case"strikethrough":case"superscript":case"subscript":case"justifyleft":case"justifyright":case"justifycenter":case"justifyfull":case"insertorderedlist":case"insertunorderedlist":doc.queryCommandState(j)?toolbarobject[j].setAttribute("class","ze_selected"):toolbarobject[j].removeAttribute("class");break;case"fontcolor":toolbarobject[j].getElementsByTagName("img")[0].style.borderBottomColor=doc.queryCommandValue("forecolor");break;case"bgcolor":color=doc.queryCommandValue("hilitecolor"),/transparent/i.test(color)&&(color=doc.queryCommandValue("backcolor")),toolbarobject[j].getElementsByTagName("img")[0].style.borderBottomColor=color}},ZE.prototype.createEditor=function(){var _iframe,_div,editor=this,_document=document,_initobj=editor.initobj,_editorheight=_initobj.editorheight;_iframe=_document.createElement("iframe"),editor.iframe=_iframe,_iframe.className="ze_area",_editorheight&&(_iframe.style.height=_editorheight+"px"),editor.editordiv.appendChild(_iframe),_document.getElementById(editor.popupid)||(_div=_document.createElement("div"),_div.id=editor.popupid,_div.style.width="0px",_div.style.height="0px",_div.style.overflow="hidden",_div.style.lineHeight="auto",_document.body.appendChild(_div)),editor.popupdiv=_document.getElementById(editor.popupid),_iframe.onload=function(){_iframe.onload=null;var css,afterload_array,afterload_array_length,setClassOnBody,fontFamily,fontSize,win=_iframe.contentWindow,doc=win.document,_initobjContent=_initobj.content,outGoingFontFamily=ZE_Init.outGoingFontFamily,outGoingFontSize=ZE_Init.outGoingFontSize;if(editor.win=win,editor.doc=doc,"plaintext"!==_initobj.mode&&(doc.open(),doc.write(_initobjContent||"<br>"),doc.close()),ZE_Init.editorCSS&&(css=doc.createElement("link"),css.type="text/css",css.rel="stylesheet",css.href=ZE_Init.isRTL?ZE_Init.cssPath+"/css/zeditor_rtl.min.css":ZE_Init.cssPath+"/css/zeditor.min.css",doc.getElementsByTagName("head")[0].appendChild(css)),_iframe.contentDocument.designMode="on",ZE_Init.needEditorFocus){win.focus();try{editor.updateToolbar()}catch(e){}}if(doc.addEventListener("mouseup",function(){editor.updateToolbar()},!0),doc.addEventListener("keypress",function(ev){{var key,kcode=ev.keyCode,shift=ev.shiftKey,meta=ev.metaKey,alt=ev.altKey,ctrl=ev.ctrlKey;editor.doc}if(9===kcode)ZE_Init.tabKeyHandling&&(shift||ctrl||(win.getSelection().collapseToStart(),doc.execCommand("insertHTML",!1,"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"),editor._stopEvent(ev)));else if((ctrl||meta)&&!alt&&!shift)switch(key=String.fromCharCode(ev.charCode).toLowerCase()){case"b":editor.execCommand(ev,"bold");break;case"i":editor.execCommand(ev,"italic");break;case"u":editor.execCommand(ev,"underline");break;case"l":editor.execCommand(ev,"justifyleft");break;case"e":editor.execCommand(ev,"justifycenter");break;case"r":editor.execCommand(ev,"justifyright");break;case"j":editor.execCommand(ev,"justifyfull");break;case"k":editor.execCommand(ev,"link")}editor.updateToolbar()},!0),setClassOnBody=function(fontFamily,fontSize){var _style,FontSize,PtToPx={8:10,10:13,12:16,14:18,18:24,24:32,36:48};fontSize=fontSize.toString(),FontSize=-1!==fontSize.indexOf("px")?fontSize:PtToPx[parseInt(fontSize)]+"px",_style=doc.createElement("style"),_style.type="text/css",_style.innerHTML=ZE_Init.isRTL?".ze_body{font-family:"+fontFamily+";font-size:"+FontSize+";direction:rtl;} table{font-size:100%} .MsoNormal{margin: 0px}":".ze_body{font-family:"+fontFamily+";font-size:"+FontSize+";} table{font-size:100%} .MsoNormal{margin: 0px}",doc.getElementsByTagName("head")[0].appendChild(_style),doc.body.className="ze_body"},outGoingFontFamily||outGoingFontSize?outGoingFontSize?setClassOnBody(outGoingFontFamily,outGoingFontSize):setClassOnBody(outGoingFontFamily,ZE_Init.defaultFontSize):(fontFamily=_initobj.defaultfontfamily||ZE_Init.defaultFontFamily||"",fontSize=_initobj.defaultfontsize||ZE_Init.defaultFontSize||"",setClassOnBody(fontFamily,fontSize)),delete editor.state,editor.afterload)for(afterload_array=editor.afterload,afterload_array_length=afterload_array.length;afterload_array_length--;)afterload_array.shift()();delete editor.afterload}},ZE.prototype._stopEvent=function(ev){ev.preventDefault(),ev.stopPropagation()};ZE.prototype.createToolbar=function(){var toolbararray,ze_editor,toolbardiv,btnonclick,toolbararray_length,_ul,_li,_div,toolbarinnerarray,j,toolbarinnerarray_length,commandArray,_command_name,_class,_a,_img,seperatorimage,_anchor_previous_sibling,_previous_anchor,editor=this,toolbarobject={},initobj_toolbar=editor.initobj.toolbar,_document=document,fragment=_document.createDocumentFragment(),I18N=ZE.i18n,imgPath=ZE_Init.imgPath,i=0;for(toolbararray=initobj_toolbar?ZE_Init.toolbarOrderGenerate(initobj_toolbar):ZE_Init.toolbarOrder,ze_editor=_document.createElement("div"),ze_editor.className="ze",ZE_Init.needEditorBorder||(ze_editor.style.borderWidth="0px"),editor.editordiv=ze_editor,fragment.appendChild(ze_editor),editor.toolbarobject=toolbarobject,toolbardiv=_document.createElement("div"),toolbardiv.className="ze_toolbarbg",ze_editor.appendChild(toolbardiv),editor.toolbardiv=toolbardiv,btnonclick=function(command){return function(ev){return editor._stopEvent(ev),editor.execCommand(ev,command),!1}},toolbararray_length=toolbararray.length;toolbararray_length>i;i++){for(_ul=_document.createElement("ul"),_ul.className="ze_multitoolbar",_li=_document.createElement("li"),_ul.appendChild(_li),_div=_document.createElement("div"),_li.appendChild(_div),toolbarinnerarray=toolbararray[i],j=0,toolbarinnerarray_length=toolbarinnerarray.length;toolbarinnerarray_length>j;j++)commandArray=toolbarinnerarray[j],_command_name=commandArray[0],_class=commandArray[2],_a=_document.createElement("a"),_a.title=_a.href=I18N(commandArray[1]),_a.tabIndex="-1",_a.addEventListener("click",btnonclick(_command_name),!0),_a.addEventListener("mousedown",function(ev){return editor._stopEvent(ev),!1},!0),toolbarobject[_command_name]=_a,_div.appendChild(_a),0===j&&_a.appendChild(_document.createElement("b")),_img=_document.createElement("img"),_img.align="absmiddle",_img.className=1===toolbarinnerarray_length?"ze_tabmenuicon "+_class+"si":"ze_tabmenuicon "+_class,_img.src=imgPath+"/images/spacer.gif",_a.appendChild(_img),j===toolbarinnerarray_length-1?(_a.insertBefore(_document.createElement("em"),_img),("insertoptions"===_command_name||"spellcheckoptions"===_command_name)&&(_a.style.width="12px",_anchor_previous_sibling=_a.previousSibling,_anchor_previous_sibling&&(_previous_anchor=_anchor_previous_sibling.previousSibling,_previous_anchor&&"A"===_previous_anchor.nodeName&&(_previous_anchor.style.width="25px")))):(seperatorimage=_document.createElement("img"),seperatorimage.className="ze_sep_img",seperatorimage.src=imgPath+"/images/spacer.gif",_div.appendChild(seperatorimage));toolbardiv.appendChild(_ul)}toolbarobject.heading&&!function(){var _span=toolbarobject.heading.appendChild(_document.createElement("span"));_span.className="ze_heading_menu",_span.appendChild(_document.createTextNode("Nr"))}(),"function"==typeof ZE_Init.afterToolbarGenerate&&ZE_Init.afterToolbarGenerate(toolbarobject),editor.outerdiv.appendChild(fragment)};